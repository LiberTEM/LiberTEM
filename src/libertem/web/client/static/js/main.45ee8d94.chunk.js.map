{"version":3,"sources":["job/components/ResultImage.module.css","images/LiberTEM logo-medium.png","cluster/actions.ts","helpers/actionHelpers.ts","helpers/index.ts","messages.ts","browser/actions.ts","cluster/components/GPUSelector.tsx","cluster/components/LocalConnectionForm.tsx","cluster/components/TCPConnectionForm.tsx","cluster/components/ClusterConnectionForm.tsx","channel/components/ChannelConnecting.tsx","channel/components/ChannelShutdown.tsx","channel/components/ChannelStatus.tsx","browser/components/FileBrowserEntry.tsx","config/actions.ts","browser/components/FileBrowserHeader.tsx","browser/components/FileEntry.tsx","browser/components/FolderEntry.tsx","browser/components/PathDropDownItem.tsx","browser/components/PathInput.tsx","browser/components/RecentFiles.tsx","browser/components/PathBar.tsx","browser/components/FileBrowser.tsx","job/types.ts","browser/components/BrowserWrapper.tsx","widgets/BusySpinner.tsx","widgets/BusyWrapper.tsx","widgets/HandleParent.tsx","job/components/ResultImage.tsx","job/components/Result.tsx","job/components/Selectors.tsx","job/components/ResultList.tsx","widgets/constraints.ts","widgets/styles.ts","widgets/Disk.tsx","widgets/DraggableHandle.tsx","compoundAnalysis/actions.ts","widgets/kbdHandler.ts","compoundAnalysis/components/DefaultFrameView.tsx","compoundAnalysis/components/FramePicker.tsx","compoundAnalysis/components/ModeSelector.tsx","widgets/Rect.tsx","compoundAnalysis/components/roi/RectROI.tsx","compoundAnalysis/components/roi/RoiPicker.tsx","compoundAnalysis/components/roi/DiskROI.tsx","compoundAnalysis/components/layouts/AnalysisLayoutTwoCol.tsx","helpers/apiHelpers.ts","compoundAnalysis/api.ts","compoundAnalysis/getMetadata.tsx","compoundAnalysis/components/Download.tsx","compoundAnalysis/components/Toolbar.tsx","compoundAnalysis/helpers.ts","compoundAnalysis/components/CenterOfMassAnalysis.tsx","helpers/svg.ts","widgets/Ring.tsx","compoundAnalysis/components/layouts/AnalysisLayoutTwoRes.tsx","compoundAnalysis/components/Clustering.tsx","compoundAnalysis/components/DiskMaskAnalysis.tsx","compoundAnalysis/components/FEM.tsx","compoundAnalysis/components/FFTFramePicker.tsx","compoundAnalysis/components/FFTSumFrames.tsx","compoundAnalysis/components/FFTFrameView.tsx","compoundAnalysis/components/layouts/AnalysisLayoutThreeCol.tsx","compoundAnalysis/components/FFTAnalysis.tsx","compoundAnalysis/components/PointSelectionAnalysis.tsx","compoundAnalysis/components/RadialFourierAnalysis.tsx","compoundAnalysis/components/RingMaskAnalysis.tsx","compoundAnalysis/types.ts","compoundAnalysis/components/base/Analysis.tsx","compoundAnalysis/components/base/AnalysisList.tsx","helpers/reducerHelpers.ts","compoundAnalysis/components/base/AnalysisSelect.tsx","dataset/components/AddAnalysis.tsx","dataset/api.ts","dataset/validate.ts","dataset/helpers.ts","dataset/components/DatasetParams.tsx","dataset/actions.ts","dataset/components/DatasetInfo.tsx","errors/actions.ts","dataset/components/DatasetToolbar.tsx","dataset/components/Dataset.tsx","dataset/components/BLOParamsForm.tsx","dataset/components/DatasetTypeSelect.tsx","dataset/components/EMPADParamsForm.tsx","dataset/components/FRMS6ParamsForm.tsx","dataset/components/HDF5ParamsForm.tsx","dataset/components/K2ISParamsForm.tsx","dataset/components/TupleInputPart.tsx","dataset/components/TupleInput.tsx","dataset/components/MIBParamsForm.tsx","dataset/components/RawFileParamsForm.tsx","dataset/components/SEQParamsForm.tsx","dataset/components/SERParamsForm.tsx","dataset/components/DatasetOpen.tsx","dataset/components/DatasetOpenSpinner.tsx","dataset/components/DatasetList.tsx","channel/actions.ts","errors/components/Error.tsx","errors/components/ErrorList.tsx","helpers/hooks.ts","About.tsx","clusterStatus/localStatus.tsx","clusterStatus/NotConnected.tsx","clusterStatus/TCPStatus.tsx","clusterStatus/Cluster.tsx","shutdown/api.ts","shutdown/components/ShutdownButton.tsx","Menu.tsx","App.tsx","registerServiceWorker.ts","config/helpers.ts","browser/api.ts","channel/messages.ts","browser/sagas.ts","channel/sagas.ts","cluster/api.ts","cluster/sagas.ts","analysis/actions.ts","job/actions.ts","job/api.ts","compoundAnalysis/sagas.ts","config/api.ts","config/sagas.ts","dataset/sagas.ts","sagas.ts","analysis/reducers.ts","browser/reducers.ts","channel/reducers.ts","cluster/reducers.ts","compoundAnalysis/reducers.ts","config/reducers.ts","dataset/reducers.ts","errors/reducers.ts","job/reducers.ts","store.ts","index.tsx"],"names":["module","exports","ActionTypes","createAction","type","payload","meta","undefined","Actions","notConnected","NOT_CONNECTED","connect","params","CONNECT","connecting","CONNECTING","connected","details","CONNECTED","error","msg","timestamp","id","ERROR","assertNotReached","message","Error","defaultDebounce","fn","delay","_","maxWait","getEnumValues","e","Object","keys","ClusterTypes","DatasetTypes","AdditionalInfo","DatasetStatus","AnalysisTypes","ClusterTypeMetadata","LOCAL","label","TCP","helpText","GPUSelector","config","name","setFieldValue","options","devices","cudas","map","key","value","text","defaultValue","hasCupy","has_cupy","haveCudaDevices","length","disabled","showWarning","Message","warning","visible","Header","href","rel","target","Dropdown","onChange","data","placeholder","fluid","multiple","selection","withFormik","mapPropsToValues","ownProps","numWorkers","localCores","handleSubmit","values","formikBag","onSubmit","props","touched","errors","isSubmitting","dirty","handleChange","handleBlur","handleReset","Form","Field","htmlFor","onBlur","Modal","trigger","Icon","link","Content","Button","primary","address","lastConnection","mapDispatchToProps","connectToCluster","clusterActions","clusterTypeOptions","t","ClusterConnectionForm","state","clusterType","lastConnectionType","setType","setState","this","inline","Segment","renderForm","React","ChannelConnecting","icon","loading","ChannelShutdown","negative","messages","waiting","clusterMessages","ConnectedNotReady","haveConfig","useSelector","clusterConnection","status","ChannelStatus","children","channelStatus","list","path","LIST_DIRECTORY","dirListing","dirs","files","drives","places","DIRECTORY_LISTING","open","OPEN","cancel","CANCEL","select","SELECT","selectFullPath","SELECT_FULL_PATH","detectParams","DETECT_PARAMS","paramsDetected","PARAMS_DETECTED","TimeStamp","ts","date","Date","fmtDate","toLocaleDateString","fmtTime","toLocaleTimeString","title","style","display","whiteSpace","width","marginRight","FileSize","fmtSize","bytes","si","thresh","Math","abs","size","unit","units","u","toFixed","humanFileSize","textAlign","Cell","overflow","textOverflow","FileBrowserEntry","onClick","myStyle","cursor","tsStyles","paddingRight","flexGrow","owner","ctime","mtime","FileBrowserHeader","alignRight","paddingBottom","FileEntry","dispatch","browserActions","window","setTimeout","FETCH","FETCHED","FETCH_FAILED","TOGGLE_STAR","toString","newProps","Item","initialPath","enableReinitialize","Input","autoComplete","lastOpened","fileHistory","separator","recentFiles","filter","item","floating","Menu","content","option","idx","refresh","currentPath","handleInputChange","goUp","toggleStar","configActions","starred","driveOptions","placeOptions","starOptions","isStarred","includes","starredIcon","bookmarkTitle","listRef","scrollToTop","current","scrollToItem","sortByKey","array","getKey","sort","a","b","x","y","JobRunning","JobStatus","browser","isLoading","getSortKey","toLowerCase","dirEntries","dir","fileEntries","f","entries","concat","cellFn","index","overflowY","ref","height","itemCount","itemSize","Group","as","isOpen","busy","openDataset","formVisible","labelPosition","BusySpinner","margin","padding","position","bottom","right","color","opacity","BusyWrapper","HandleParent","currentHandle","handleDragStart","h","handleDrop","handleMouseMove","externalMouseMove","handleMouseLeave","externalLeave","handleMouseUp","externalMouseUp","onMouseMove","onMouseLeave","onMouseUp","onKeyDown","onKeyboardEvent","outline","tabIndex","fill","renderHandles","handles","i","elem","ResultImage","job","channel","result","results","className","styles","fallback","viewBox","default","xlinkHref","imageURL","ResultWrapper","styled","svg","Result","extraHandles","extraWidgets","running","DONE","Selectors","div","ResultListPlaceholder","border","ResultList","selectedChannel","selectChannel","analysis","jobsById","displayedJob","dt","endTimestamp","startTimestamp","currentResult","subtitle","selectors","getMsg","selectedImg","getJob","genericRender","ResultImageSelector","availableImages","description","compoundAnalysis","compoundAnalyses","byId","analyses","analysisIndex","jobs","inRectConstraint","p","max","min","cbToRadius","cx","cy","cb","dx","dy","sqrt","dist","keepOnCY","riConstraint","outerPos","otherX","roConstraints","innerPos","defaultMaskStyles","imageWidth","fillOpacity","strokeOpacity","stroke","strokeWidth","Disk","imageHeight","r","StyledCircle","circle","Cross","FocusGroup","g","Handle","scale","withCross","focusRef","args","transform","crossSpec","cross","d","relativeCoords","parent","ownerSVGElement","inWidthAttr","getAttribute","inWidth","getBoundingClientRect","getScalingFactor","parentPos","pageX","left","pageXOffset","pageY","top","pageYOffset","DraggableHandle","posRef","dragging","drag","move","stopDrag","applyConstraint","constraint","startDrag","preventDefault","parentOnDragStart","focus","onDragMove","constrained","parentOnDrop","handleKeyDown","update","delta","shiftKey","handleKeyEvent","newCoords","visibility","onMouseDown","renderCommon","renderDragging","DefaultModes","DefaultRois","dataset","analysisType","CREATE","autoStart","CREATED","compoundAnalysisId","ENABLE_AUTOSTART","RUN","RUNNING","jobIndex","REMOVE","REMOVED","useFramePicker","enabled","scanWidth","scanHeight","setCx","setCy","useDispatch","useEffect","compoundAnalysisActions","PICK_FRAME","parameters","onPickChange","pickX","pickY","newX","round","newY","coords","onDragStart","onDrop","ModeSelector","modes","currentMode","onModeChange","Rect","ymin","xmin","useRectROI","minLength","useState","setx","sety","setwidth","setheight","handleCornerChange","newx","newy","handleShapeChange","smthHandle","rectRoiParameters","roi","shape","rectRoiHandles","rectRoiWidgets","useRoiPicker","roiParameters","handle","analysisActions","clearTimeout","JSON","stringify","useDefaultFrameView","doAutoStart","availableModes","SUM","SD","PICK","availableRois","ALL","DISK","RECT","frameMode","setMode","setRoi","frameModeSelector","newMode","roiSelector","newRoi","widgets","pickCoords","pickHandles","setR","handleCenterChange","newCx","newCy","handleRChange","newR","rHandle","diskRoiParameters","diskRoiHandles","diskRoiWidgets","useDiskROI","SD_FRAMES","SUM_FRAMES","frameViewTitle","AnalysisLayoutTwoCol","toolbar","attached","Grid","columns","Row","Column","getApiBasePath","loc","location","pathname","endsWith","genericDelete","basePath","fetch","credentials","method","json","genericPut","body","createOrUpdateAnalysis","analysisId","removeAnalysis","createOrUpdateCompoundAnalysis","removeCompoundAnalysis","getNotebook","url","getMetadata","typeName","CompoundAnalysisMetadata","DownloadItems","currentFormat","analysesById","some","jobId","SUCCESS","desc","getAnalysisDescription","includeInDownload","getDownloadChannels","join","CopyScripts","dependency","initial_setup","ctx","plot","notebook","setNotebook","cell","code","padded","floated","navigator","clipboard","writeText","then","CurrentNotebook","copyNotebook","clearing","firstPart","secondPart","scrolling","DownloadScripts","downloadUrl","Download","formats","resultFileFormats","formatOptions","identifier","setFormat","onFormatChange","panes","menuItem","render","Tab","Pane","Toolbar","busyIdxs","onApply","applyIconProps","analysisIdxsToInclude","filteredAnalyses","indexOf","reduce","prevValue","every","getAnalysisStatus","CenterOfMassAnalysis","frameViewWidgets","resultHandles","resultWidgets","CENTER_OF_MASS","getPathArc","center","start","end","radius","degree","points","push","getLocationFromAngle","clockWise","getCirclePath","radian","PI","cos","sin","Ring","ri","pathSpec","ro","fillRule","AnalysisLayoutTwoRes","mid","clustparams","title1","title2","title3","ClustAnalysis","setRi","setRo","riHandle","roHandle","minDist","setMinDist","nPeaks","setNPeaks","nClust","setNClust","handleRIChange","handleROChange","SUM_SIG","CLUST","n_clust","n_peaks","min_dist","paramsVisible","setParamsVisible","Accordion","Title","active","event","step","valueAsNumber","DiskMaskAnalysis","APPLY_DISK_MASK","FEMAnalysis","FEM","useFFTFramePicker","real_rad","real_centerx","real_centery","PICK_FFT_FRAME","useFFTSumFrames","FFTSUM_FRAMES","useFFTFrameView","AnalysisLayoutThreeCol","FFTAnalysis","radIn","radOut","frameViewWidgetsfft","check","setCheck","realCenterX","realCenterY","realRad","frameViewWidgetsreal","APPLY_FFT_MASK","rad_in","rad_out","checked","PointSelectionAnalysis","APPLY_POINT_SELECTOR","RadialFourierAnalysis","nBins","maxOrder","RADIAL_FOURIER","n_bins","max_order","RingMaskAnalysis","APPLY_RING_MASK","component","AnalysisDispatcherComponent","datasets","AnalysisComponent","mainType","AnalysisList","ids","Analysis","updateById","partialRecord","newObj","assign","newById","insertById","record","constructById","items","acc","filterWithPred","pred","toggleItemInList","analysisTypeOptions","AnalysisSelect","labeled","button","handleAddAnalysis","deleteDataset","detectDataset","encodeURIComponent","schemaCache","getSchema","cached","Promise","resolve","schemaResponse","convertErrors","res","forEach","err","fieldName","dataPath","replace","match","plainName","schema","validate","Ajv","compile","parseNumList","nums","split","part","trim","getInitial","otherwise","getInitialName","pathfind","isKnownDatasetType","detectedType","v","isAdditionalInfo","param","withValidation","opts","formToJson","setSubmitting","validateOpen","validateOnChange","validateOnBlur","renderParams","Table","Array","DatasetParams","HeaderCell","Body","DiagElem","diagnostics","renderValue","DiagElems","DatasetInfo","cachedParams","detectedParams","CANCEL_OPEN","DELETE","DELETED","DETECT","DETECTED","DETECT_FAILED","handleRemoveDataset","datasetActions","DatasetContainer","OPENING","DELETING","dividing","marginTop","marginBottom","horizontal","Popup","flexShrink","initial","BLO","isValidating","onCancel","datasetTypeOptions","DatasetTypeSelect","currentType","scan_size","EMPAD","FRMS6","dataset_paths","ds_path","HDF5","dsPathInput","dsPathOptions","dsPath","search","K2IS","TupleInputPart","tupleKey","tupleInputChangeHandle","commaPressHandle","tupleRef","keyCode","TupleInput","minLen","maxLen","tupleInputValue","initialList","parseNumListWithPadding","tupleInputRefsArray","val","newTupleInputValue","newTupleDim","hidden","basic","pop","MIB","enable_direct","detector_size","dtype","RAW","SEQ","SER","getDefaultDSType","didReset","openState","formCachedParams","formDetectedParams","getFormInitial","additionalInfo","allInfo","info","getAdditionalInfo","DatasetOpen","setReset","formInitial","defaultType","datasetType","setDatasetType","doSetType","form","formPath","commonParams","uuid","onReset","MIBParamsForm","BLOParamsForm","K2ISParamsForm","SEQParamsForm","busyPath","DatasetList","dsId","Dataset","DISMISS","DISMISS_ALL","dismiss","errorActions","onDismiss","channelConnected","latestErrors","slice","showModal","handleEsc","ev","document","addEventListener","removeEventListener","version","revision","List","src","alt","LocalStatus","localCore","cudaText","setcudaText","cpu","cuda","NotConnected","TCPStatus","host","clustOverview","setOverview","setIdx","expandMsg","setMsg","overview","node","clusterExpanded","ClusterDetails","localcore","colorType","grey","setColor","setStatus","disable","setDisable","blue","clusterDetails","initialState","INITIAL_STATE","jobStarted","JOB_STARTED","finishJob","FINISH_JOB","taskResult","TASK_RESULT","jobError","JOB_ERROR","close","CLOSE","shutdown","SHUTDOWN","closeloop","CLOSE_LOOP","cancelled","CANCELLED","analysisCreated","ANALYSIS_CREATED","analysisUpdated","ANALYSIS_UPDATED","analysisRemoved","ANALYSIS_REMOVED","doShutdown","closeLoopAction","channelActions","shutdownAction","ShutdownButton","modal","modalOpen","modalClose","handleShutdown","response","now","closeOnDimmerClick","onClose","HeaderMenu","fixed","Cluster","App","Container","logo","isLocalhost","Boolean","hostname","registerValidSW","swUrl","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","catch","joinPaths","parts","removeSep","RegExp","escapeRegExp","mergeLocalStorage","serverConfig","localSettings","localStorage","getItem","getDefaultLocalConfig","localSettingsParsed","parse","defaultConfig","setLocalStorage","cwd","setItem","makeUnique","inp","curr","getDirectoryListing","MessageTypes","directoryListingSaga","fetchOnRequest","fetchDirectoryListing","fetchDirectoryListOnOpen","fork","take","action","newPath","call","put","browserState","alternative","home","createMessage","messageType","attribs","Messages","objectURL","BINARY","webSocketSaga","actionsFromChannel","handleBinaryParts","handleTaskResult","handleFinishJob","createWebSocketChannel","eventChannel","emit","onMessage","Blob","channelMessages","URL","createObjectURL","parsed","onOpen","END","onError","ws","WebSocket","port","getApiWSURL","socketChannel","CREATE_DATASET","DELETE_DATASET","CANCEL_JOB_DONE","numParts","binMsg","followup","numMessages","images","descriptions","connection","checkClusterConnection","getClusterDetail","connectSaga","putClusterStatus","trackClusterConnection","clusterConnectionSaga","conn","takeEvery","all","UPDATED","startJob","cancelJob","cleanupOnRemove","createCompoundAnalysisSaga","createFromServerState","createOrUpdate","analysisSidecar","removeJobsForAnalysis","doRemoveAnalysisSaga","analysisRootSaga","selectDataset","selectCompoundAnalysis","selectAnalysis","selectJob","sidecarTask","msgPart","oldJobId","newAnalysisId","updatedCompoundAnalysis","actionChannel","buffers","sliding","runOrParamsChannel","existingAnalysisId","jobActions","getConfig","getConfigOnReconnect","getConfigSaga","updateLocalStorageConfig","firstConfigFetch","configRootSaga","configResponse","mergedConfig","removeItem","createDatasetSaga","deleteDatasetSaga","doDetectDataset","doOpenDataset","openDatasetSagaFullPath","openDatasetSaga","datasetRootSaga","resp","fullPath","detectResult","shouldOpen","datasetParams","doDetectDatasetRes","rootSaga","initialAnalysisState","ChannelStatusCodes","initialBrowserState","initialChannelState","WAITING","initialClusterConnectionState","initialCompoundAnalysisState","initialConfigState","cpus","initialDatasetState","initialOpenDatasetState","initialErrorState","initialJobState","rootReducer","combineReducers","newCompoundAnalysis","newAnalyses","ca","oldJobs","analysisState","analysisIdForJob","find","READY","DISCONNECTED","ds","createResult","CREATING","IN_PROGRESS","jobState","newLastOpened","newFileHistory","newLastConnection","place","sagaMiddleware","createSagaMiddleware","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","applyMiddleware","ReactDOM","getElementById","process","origin","headers","get","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker","run"],"mappings":"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","file":"static/js/main.45ee8d94.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"default\":\"ResultImage_default__1X7FO\",\"fallback\":\"ResultImage_fallback__kO3cw\"};","module.exports = __webpack_public_path__ + \"static/media/LiberTEM logo-medium.7999e0dc.png\";","import { ActionsUnion, createAction } from '../helpers/actionHelpers';\nimport { ConnectRequestParams, HostDetails } from '../messages';\n\nexport enum ActionTypes {\n    NOT_CONNECTED = 'CLUSTER_NOT_CONNECTED',\n    CONNECT = 'CLUSTER_CONNECT',\n    CONNECTING = 'CLUSTER_CONNECTING',\n    CONNECTED = 'CLUSTER_CONNECTED',\n    ERROR = 'CLUSTER_ERROR'\n    \n}\n\nexport const Actions = {\n    notConnected: () => createAction(ActionTypes.NOT_CONNECTED),\n    connect: (params: ConnectRequestParams) => createAction(ActionTypes.CONNECT, { params },),\n    connecting: () => createAction(ActionTypes.CONNECTING),\n    connected: (params: ConnectRequestParams, details: HostDetails[] ) => createAction(ActionTypes.CONNECTED, { params, details }),\n    error: (msg: string, timestamp: number, id: string) => createAction(ActionTypes.ERROR, { msg, timestamp, id }),\n\n}\n\nexport type Actions = ActionsUnion<typeof Actions>;\n","import { ActionCreatorsMapObject } from \"redux\";\n\nexport interface Action<T extends string> {\n    type: T\n}\n\nexport interface ActionWithPayload<T extends string, P> extends Action<T> {\n    payload: P\n}\n\nexport interface ActionWithMeta<T extends string, P, M> extends ActionWithPayload<T, P> {\n    meta: M\n}\n\nexport function createAction<T extends string>(type: T): Action<T>\nexport function createAction<T extends string, P, M>(type: T, payload?: P): ActionWithPayload<T, P>\nexport function createAction<T extends string, P, M>(type: T, payload?: P, meta?: M): ActionWithMeta<T, P, M>\nexport function createAction<T extends string, P, M>(type: T, payload?: P, meta?: M) {\n    if (meta === undefined && payload === undefined) {\n        return { type };\n    } else if (meta === undefined) {\n        return { type, payload };\n    } else {\n        return { type, payload, meta }\n    }\n}\n\nexport type ActionsUnion<A extends ActionCreatorsMapObject> = ReturnType<A[keyof A]>","import * as _ from \"lodash\";\n\nexport function assertNotReached(message: string): never {\n    throw new Error(message);\n}\n\nexport function defaultDebounce<T extends (...args: any[]) => any>(fn: T, delay: number = 50) {\n    return _.debounce(fn, delay, { maxWait: delay });\n}\n\nexport function getEnumValues<E>(e: E): Array<keyof E> {\n    return Object.keys(e) as Array<keyof E>;\n}","import { JobList } from \"./analysis/types\"\n\n/*\n * Common\n */\n\nexport interface FollowupPart {\n    numMessages: number,\n    descriptions: Array<{ title: string, desc: string, includeInDownload: boolean }>,\n}\n\nexport interface MsgPartConfig {\n    version: string,\n    revision: string,\n    localCores: number,\n    devices: {\n        cpus: number[],\n        cudas: number[],\n        has_cupy: boolean,\n    }\n    cwd: string,\n    separator: string,\n    resultFileFormats: {\n        [id: string]: {\n            identifier: string,\n            description: string,\n        }\n    },\n}\n\nexport interface GetConfigResponse {\n    status: \"ok\",\n    config: MsgPartConfig,\n}\n\n/*\n * Connection\n */\n\nexport enum ClusterTypes {\n    LOCAL = \"LOCAL\",\n    TCP = \"TCP\",\n}\n\nexport const ClusterTypeMetadata: { [s: string]: { [s: string]: string } } = {\n    [ClusterTypes.LOCAL]: {\n        label: \"Create local cluster\",\n    },\n    [ClusterTypes.TCP]: {\n        label: \"Connect to cluster\",\n        helpText: \"can be either local or remote, connection via TCP\",\n    }\n}\n\nexport interface ConnectRequestLocalCluster {\n    type: ClusterTypes.LOCAL,\n    numWorkers?: number,\n    cudas: number[],\n}\n\nexport interface ConnectRequestTCP {\n    type: ClusterTypes.TCP,\n    address: string,\n}\n\nexport type ConnectRequestParams = ConnectRequestLocalCluster | ConnectRequestTCP\n\nexport interface ConnectRequest {\n    connection: ConnectRequestParams\n}\n\nexport type ConnectResponse = {\n    status: \"ok\",\n    connection: ConnectRequest,\n} | {\n    status: \"disconnected\",\n    connection: {},\n} | {\n    status: \"error\",\n    messageType: string,\n    msg: string,\n}\n\nexport interface HostDetails {\n    host: string,\n    cpu: number,\n    cuda: number,\n    service: number,\n}\n\nexport interface ClusterDetailsResponse {\n    status: \"ok\",\n    messageType: string,\n    details: HostDetails[],\n}\n\n/*\n * Dataset\n */\n\nexport enum DatasetTypes {\n    HDF5 = \"HDF5\",\n    RAW = \"RAW\",\n    MIB = \"MIB\",\n    BLO = \"BLO\",\n    K2IS = \"K2IS\",\n    SER = \"SER\",\n    FRMS6 = \"FRMS6\",\n    EMPAD = \"EMPAD\",\n    SEQ = \"SEQ\",\n}\n\nexport interface DatasetParamsCommon {\n    name: string,\n}\n\nexport enum AdditionalInfo {\n    dataset_paths = \"dataset_paths\",\n}\n\nexport type DatasetParamsHDF5 = {\n    type: DatasetTypes.HDF5,\n    path: string,\n    ds_path: string,\n    dataset_paths: string[],\n} & DatasetParamsCommon\n\nexport type DatasetParamsRaw = {\n    type: DatasetTypes.RAW,\n    path: string,\n    dtype: string,\n    detector_size: number[],\n    enable_direct: boolean,\n    scan_size: number[],\n} & DatasetParamsCommon\n\nexport type DatasetParamsMIB = {\n    type: DatasetTypes.MIB,\n    path: string,\n    scan_size: number[],\n} & DatasetParamsCommon\n\nexport type DatasetParamsBLO = {\n    type: DatasetTypes.BLO,\n    path: string,\n} & DatasetParamsCommon\n\nexport type DatasetParamsK2IS = {\n    type: DatasetTypes.K2IS,\n    path: string,\n} & DatasetParamsCommon\n\nexport type DatasetParamsSER = {\n    type: DatasetTypes.SER,\n    path: string,\n} & DatasetParamsCommon\n\nexport type DatasetParamsFRMS6 = {\n    type: DatasetTypes.FRMS6,\n    path: string,\n} & DatasetParamsCommon\n\nexport type DatasetParamsEMPAD = {\n    type: DatasetTypes.EMPAD,\n    path: string,\n    scan_size: number[],\n} & DatasetParamsCommon\n\nexport type DatasetParamsSEQ = {\n    type: DatasetTypes.SEQ,\n    path: string,\n    scan_size: number[],\n} & DatasetParamsCommon\n\nexport type DatasetFormParams = DatasetParamsHDF5 | DatasetParamsRaw | DatasetParamsMIB | DatasetParamsBLO | DatasetParamsK2IS | DatasetParamsSER | DatasetParamsFRMS6 | DatasetParamsEMPAD | DatasetParamsSEQ\n\nexport interface DatasetCreateParams {\n    id: string,\n    params: DatasetFormParams,\n}\n\nexport enum DatasetStatus {\n    OPEN = \"OPEN\",\n    OPENING = \"OPENING\",\n    DELETING = \"DELETING\",\n}\n\nexport interface DiagElemMsg {\n    name: string,\n    value: string | DiagElemMsg[],\n}\n\ninterface DatasetCommon {\n    id: string,\n    params: DatasetFormParams,\n}\n\nexport type DatasetOpening = DatasetCommon & {\n    status: DatasetStatus.OPENING,\n}\n\nexport type DatasetDeleting = DatasetCommon & {\n    status: DatasetStatus.DELETING,\n}\n\nexport type DatasetOpen = DatasetCommon & {\n    status: DatasetStatus.OPEN,\n    params: {\n        shape: number[],\n    }\n    diagnostics: DiagElemMsg[],\n}\n\nexport type Dataset = DatasetOpening | DatasetOpen | DatasetDeleting;\n\nexport interface OpenDatasetRequest {\n    dataset: DatasetCreateParams\n}\n\nexport interface OpenDatasetResponseOk {\n    status: \"ok\",\n    dataset: string,  // TODO: uuid type?\n    details: Dataset,\n}\n\nexport interface OpenDatasetResponseError {\n    status: \"error\",\n    dataset: string,\n    msg: string,\n}\n\nexport type OpenDatasetResponse = OpenDatasetResponseOk | OpenDatasetResponseError\n\nexport interface DeleteDatasetResponse {\n    status: \"ok\",\n    dataset: string,\n}\n\nexport interface DetectDatasetSuccessResponse {\n    status: \"ok\",\n    datasetParams: DatasetFormParams,\n}\n\nexport interface DetectDatasetErrorResponse {\n    status: \"error\",\n    path: string,\n    msg: string,\n}\n\nexport type DetectDatasetResponse = DetectDatasetSuccessResponse | DetectDatasetErrorResponse;\n\nexport interface DataSetOpenSchemaSuccessResponse {\n    status: \"ok\",\n    ds_type: string,\n    schema: object,\n}\n\nexport interface DataSetOpenSchemaErrorResponse {\n    status: \"error\",\n    ds_type: string,\n    msg: string,\n}\n\nexport type DataSetOpenSchemaResponse = DataSetOpenSchemaSuccessResponse | DataSetOpenSchemaErrorResponse;\n\nexport type MsgPartInitialDataset = DatasetOpen\n\n// type alias to add client-side state to datasets\nexport type DatasetState = Dataset & {}\n\n/*\n * Job\n */\nexport interface MsgPartJob {\n    id: string,\n    analysis: string,\n}\n\nexport interface MaskDefRing {\n    shape: \"ring\",\n    cx: number,\n    cy: number,\n    ri: number,\n    ro: number\n}\n\n\nexport interface MaskDefDisk {\n    shape: \"disk\",\n    cx: number,\n    cy: number,\n    r: number,\n}\n\nexport interface PointDef {\n    shape: \"point\",\n    cx: number,\n    cy: number,\n}\n\n// TODO: shape doesn't really make sense here, needs to be restructured\nexport interface CenterOfMassParams {\n    shape: \"com\",\n    cx: number,\n    cy: number,\n    r: number,\n}\n\nexport interface PickFrameParams {\n    x: number,\n    y: number,\n}\n\nexport interface FFTSumFramesParams {\n    real_rad: number | null,\n    real_centerx: number | null,\n    real_centery: number | null,\n}\n\nexport interface PickFFTFrameParams {\n    x: number,\n    y: number,\n    real_rad: number | null,\n    real_centerx: number | null,\n    real_centery: number | null,\n}\nexport interface RadialFourierParams {\n    shape: \"radial_fourier\",\n    cx: number,\n    cy: number,\n    ri: number,\n    ro: number,\n    n_bins: number,\n    max_order: number\n}\n\nexport interface FFTParams {\n    rad_in: number,\n    rad_out: number,\n    real_rad: number | null,\n    real_centerx: number | null,\n    real_centery: number | null,\n}\n\n\nexport interface FrameParams {\n    roi: {\n        shape: \"rect\",\n        x: number,\n        y: number,\n        width: number,\n        height: number,\n    } | {\n        shape: \"disk\",\n        cx: number,\n        cy: number,\n        r: number,\n    } |\n    {}\n}\n\nexport interface ClustParams {\n    roi: {\n        shape: \"rect\",\n        x: number,\n        y: number,\n        width: number,\n        height: number,\n    } | {}\n    cx: number,\n    cy: number,\n    ri: number,\n    ro: number,\n    n_peaks: number,\n    n_clust: number,\n    min_dist: number,\n}\n\nexport enum AnalysisTypes {\n    APPLY_RING_MASK = \"APPLY_RING_MASK\",\n    APPLY_DISK_MASK = \"APPLY_DISK_MASK\",\n    APPLY_POINT_SELECTOR = \"APPLY_POINT_SELECTOR\",\n    CENTER_OF_MASS = \"CENTER_OF_MASS\",\n    SUM_FRAMES = \"SUM_FRAMES\",\n    SD_FRAMES = \"SD_FRAMES\",\n    PICK_FRAME = \"PICK_FRAME\",\n    PICK_FFT_FRAME = \"PICK_FFT_FRAME\",\n    APPLY_FFT_MASK = \"APPLY_FFT_MASK\",\n    FFTSUM_FRAMES = \"FFTSUM_FRAMES\",\n    RADIAL_FOURIER = \"RADIAL_FOURIER\",\n    FEM = \"FEM\",\n    CLUST = \"CLUST\",\n    SUM_SIG = \"SUM_SIG\",\n}\n\nexport interface RingMaskDetails {\n    analysisType: AnalysisTypes.APPLY_RING_MASK,\n    parameters: MaskDefRing,\n}\n\nexport interface FFTDetails {\n    analysisType: AnalysisTypes.APPLY_FFT_MASK,\n    parameters: FFTParams,\n}\n\nexport interface FEMDetails {\n    analysisType: AnalysisTypes.FEM,\n    parameters: MaskDefRing,\n}\n\nexport interface DiskMaskDetails {\n    analysisType: AnalysisTypes.APPLY_DISK_MASK,\n    parameters: MaskDefDisk,\n}\n\nexport interface PointDefDetails {\n    analysisType: AnalysisTypes.APPLY_POINT_SELECTOR,\n    parameters: PointDef,\n}\n\nexport interface CenterOfMassDetails {\n    analysisType: AnalysisTypes.CENTER_OF_MASS,\n    parameters: CenterOfMassParams,\n}\n\nexport interface SumFramesDetails {\n    analysisType: AnalysisTypes.SUM_FRAMES,\n    parameters: FrameParams\n}\n\nexport interface SDFramesDetails {\n    analysisType: AnalysisTypes.SD_FRAMES,\n    parameters: FrameParams\n}\n\nexport interface SumSigDetails {\n    analysisType: AnalysisTypes.SUM_SIG,\n    parameters: {}\n}\n\nexport interface FFTSumFramesDetails {\n    analysisType: AnalysisTypes.FFTSUM_FRAMES,\n    parameters: FFTSumFramesParams,\n}\n\nexport interface PickFrameDetails {\n    analysisType: AnalysisTypes.PICK_FRAME,\n    parameters: PickFrameParams,\n}\n\nexport interface PickFFTFrameDetails {\n    analysisType: AnalysisTypes.PICK_FFT_FRAME,\n    parameters: PickFFTFrameParams,\n}\n\nexport interface RadialFourierDetails {\n    analysisType: AnalysisTypes.RADIAL_FOURIER,\n    parameters: RadialFourierParams,\n}\n\nexport interface ClustDetails {\n    analysisType: AnalysisTypes.CLUST,\n    parameters: ClustParams,\n}\n\nexport type AnalysisParameters = MaskDefRing | MaskDefDisk | CenterOfMassParams | PointDef | PickFrameParams | RadialFourierParams | FFTParams | PickFFTFrameParams | FFTSumFramesParams | ClustParams;\nexport type AnalysisDetails = RingMaskDetails | DiskMaskDetails | CenterOfMassDetails | PointDefDetails | SumFramesDetails | SDFramesDetails | PickFrameDetails | RadialFourierDetails | FEMDetails | FFTDetails | FFTSumFramesDetails | PickFFTFrameDetails | SumSigDetails | ClustDetails;\n\nexport interface MsgPartAnalysis {\n    analysis: string,\n    dataset: string,\n    details: AnalysisDetails,\n    jobs: JobList,\n}\n\nexport type CreateOrUpdateAnalysisRequest = Omit<MsgPartAnalysis, \"analysis\" | \"jobs\">;\n\nexport type CreateAnalysisResponse = {\n    status: \"ok\",\n    messageType: \"ANALYSIS_CREATED\",\n} & MsgPartAnalysis\n\nexport type UpdateAnalysisResponse = {\n    status: \"ok\",\n    messageType: \"ANALYSIS_UPDATED\",\n} & MsgPartAnalysis\n\nexport type RemoveAnalysisResponse = {\n    status: \"ok\"\n    messageType: \"ANALYSIS_REMOVED\",\n    analysis: string,\n} | {\n    status: \"error\",\n    messageType: \"ANALYSIS_REMOVAL_FAILED\",\n    msg: string,\n    analysis: string,\n}\n\nexport interface CompoundAnalysisDetails {\n    mainType: AnalysisTypes,\n    analyses: string[],\n}\n\nexport interface MsgPartCompoundAnalysis {\n    compoundAnalysis: string,\n    dataset: string,\n    details: CompoundAnalysisDetails,\n}\n\nexport interface CreateOrUpdateCompoundAnalysisRequest {\n    dataset: string,\n    details: CompoundAnalysisDetails,\n}\n\nexport type CreateCompoundAnalysisResponse = {\n    status: \"ok\",\n    messageType: \"COMPOUND_ANALYSIS_CREATED\",\n} & MsgPartCompoundAnalysis;\n\nexport type RemoveCompoundAnalysisResponse = {\n    status: \"ok\"\n    messageType: \"COMPOUND_ANALYSIS_REMOVED\",\n    analysis: string,\n} | {\n    status: \"error\",\n    messageType: \"COMPOUND_ANALYSIS_REMOVAL_FAILED\",\n    msg: string,\n    analysis: string,\n}\n\nexport interface StartJobRequest {\n    job: {\n        analysis: string,\n    }\n}\n\nexport interface StartJobResponse {\n    status: \"ok\",\n    job: string,\n    details: MsgPartJob,\n}\n\nexport interface CancelJobResponse {\n    status: \"ok\",\n    job: string,\n}\n\n/*\n * fs browser\n */\n\n// some named place, i.e. \"Documents\", \"Home\", ...\nexport interface FSPlace {\n    title: string,\n    path: string,\n    key: string,\n}\n\nexport interface DirectoryListingDetails {\n    name: string,\n    size: number,\n    ctime: number,\n    mtime: number,\n    owner: string,\n}\n\nexport interface DirectoryListingResponseOK {\n    status: \"ok\",\n    path: string,\n    files: DirectoryListingDetails[],\n    dirs: DirectoryListingDetails[],\n    drives: string[],\n    places: FSPlace[],\n}\n\nexport interface DirectoryListingResponseError {\n    status: \"error\",\n    path: string,\n    code: string,\n    msg: string,\n    alternative?: string,\n}\n\nexport type DirectoryListingResponse = DirectoryListingResponseOK | DirectoryListingResponseError;\n\nexport interface ShutdownResponse {\n    status: \"ok\",\n    messageType: \"SERVER_SHUTDOWN\",\n}\n\nexport interface  CopyAnalysis{\n    analysis: string,\n    plot: string[],\n}\n\nexport interface CopyNotebookResponse {\n    dependency: string,\n    initial_setup: string,\n    ctx: string,\n    dataset: string,\n    analysis: CopyAnalysis[],\n}\n","import { ActionsUnion, createAction } from \"../helpers/actionHelpers\";\nimport { DatasetFormParams, DirectoryListingDetails, FSPlace } from \"../messages\";\n\nexport enum ActionTypes {\n    LIST_DIRECTORY = 'BROWSER_LIST_DIRECTORY',\n    LIST_FULL_PATH = 'BROWSER_LIST_DIRECTORY_FULL',\n    DIRECTORY_LISTING = 'BROWSER_DIRECTORY_LISTING',\n    DETECT_PARAMS = 'BROWSER_DETECT_PARAMS',\n    PARAMS_DETECTED = 'BROWSER_PARAMS_DETECTED',\n    ERROR = 'BROWSER_ERROR',\n    OPEN = 'BROWSER_OPEN',\n    CANCEL = 'BROWSER_CANCEL',\n    SELECT = 'BROWSER_SELECT',\n    SELECT_FULL_PATH = 'BROWSER_SELECT_FULL_PATH',\n}\n\nexport const Actions = {\n    list: (path: string, name?: string) => createAction(ActionTypes.LIST_DIRECTORY, { path, name }),\n    dirListing: (path: string, dirs: DirectoryListingDetails[], files: DirectoryListingDetails[], drives: string[], places: FSPlace[]) => createAction(ActionTypes.DIRECTORY_LISTING, { path, dirs, files, drives, places }),\n    open: () => createAction(ActionTypes.OPEN),\n    cancel: () => createAction(ActionTypes.CANCEL),\n    select: (path: string, name: string) => createAction(ActionTypes.SELECT, { path, name }),\n    selectFullPath: (path: string) => createAction(ActionTypes.SELECT_FULL_PATH, { path }),\n    error: (msg: string, timestamp: number, id: string) => createAction(ActionTypes.ERROR, { msg, timestamp, id }),\n    detectParams: (path: string) => createAction(ActionTypes.DETECT_PARAMS, { path }),\n    paramsDetected: (path: string, params: DatasetFormParams) => createAction(ActionTypes.PARAMS_DETECTED, { path, params }),\n}\n\nexport type Actions = ActionsUnion<typeof Actions>;","import * as React from \"react\";\nimport { Dropdown, DropdownProps, Message } from \"semantic-ui-react\";\nimport { ConfigState } from \"../../config/reducers\";\n\ninterface GPUSelectorProps {\n    config: ConfigState,\n    name: string,\n    setFieldValue: (name: string, value: any) => void,\n}\n\n\nexport const GPUSelector: React.FC<GPUSelectorProps> = ({\n    config, name, setFieldValue,\n}) => {\n    const options = config.devices.cudas.map(id => {\n        return { key: id, value: id, text: `GPU ${id}` };\n    });\n    const defaultValue = config.devices.cudas;\n    const myHandleChange = (e: React.ChangeEvent<any>, data: DropdownProps) => {\n        setFieldValue(name, data.value);\n    }\n    const hasCupy = config.devices.has_cupy;\n    const haveCudaDevices = config.devices.cudas.length > 0;\n    const disabled = hasCupy || !haveCudaDevices;\n    const showWarning = !hasCupy && haveCudaDevices;\n    return (\n        <>\n            {showWarning ?\n                <Message warning={true} visible={true}>\n                    <Message.Header>No cupy installation found</Message.Header>\n                    <p>\n                        To make use of the built-in GPU support, make\n                        sure to install <a href=\"https://cupy.chainer.org/\" rel=\"noreferrer noopener\" target=\"_blank\">cupy</a>\n                    </p>\n                </Message> : ''\n            }\n            <Dropdown onChange={myHandleChange}\n                disabled={disabled}\n                placeholder='Select CUDA devices'\n                fluid={true} multiple={true} selection={true}\n                defaultValue={defaultValue}\n                options={options} />\n        </>\n    );\n};\n","import { FormikProps, withFormik } from \"formik\";\nimport * as React from \"react\";\nimport { Button, Form, Icon, Modal } from \"semantic-ui-react\";\nimport { ConfigState } from \"../../config/reducers\";\nimport { Omit } from \"../../helpers/types\";\nimport { ClusterTypes, ConnectRequestLocalCluster } from \"../../messages\";\nimport { GPUSelector } from \"./GPUSelector\";\n\ntype FormValues = Omit<ConnectRequestLocalCluster, \"type\"> & {\n    cudas: number[],\n};\n\ninterface FormProps {\n    onSubmit: (params: ConnectRequestLocalCluster) => void,\n    config: ConfigState,\n}\n\ntype MergedProps = FormikProps<FormValues> & FormProps;\n\nconst LocalConnectionForm: React.SFC<MergedProps> = ({\n    config,\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    setFieldValue,\n    handleReset,\n}) => {\n    return (\n        <Form onSubmit={handleSubmit}>\n            <Form.Field>\n                <label htmlFor=\"numWorkers\">Number of Workers:</label>\n                <input type=\"number\" name=\"numWorkers\" value={values.numWorkers}\n                    onChange={handleChange}\n                    onBlur={handleBlur} />\n                {errors.numWorkers && touched.numWorkers && errors.numWorkers}\n            </Form.Field>\n            <Form.Field>\n                <label htmlFor=\"cudas\">\n                    CUDA devices to use{' '}\n                    <Modal trigger={<Icon name=\"info circle\" link={true}/>}>\n                        <Modal.Header>\n                            CUDA information\n                        </Modal.Header>\n                        <Modal.Content>\n                            <p>\n                                For some operations, LiberTEM can automatically make use of your graphics card,\n                                if it supports CUDA.\n                            </p>\n                            <ul>\n                                <li>Number of CUDA devices found: {config.devices.cudas.length}</li>\n                                <li>cupy installation found:{' '}{config.devices.has_cupy ? 'Yes' : 'No'}</li>\n                            </ul>\n                            <p>cupy needs to be installed to make use of any CUDA devices on your system. Also,\n                                the matching cuda libraries and graphics drivers need to be installed. Please\n                                refer to{' '}\n                                <a href=\"https://docs-cupy.chainer.org/en/stable/install.html\" target=\"_blank\" rel=\"noopener noreferrer\">\n                                    the cupy documentation\n                                </a>{' '}\n                                for more information.\n                            </p>\n                        </Modal.Content>\n                    </Modal>\n                </label>\n                <GPUSelector name=\"cudas\" config={config} setFieldValue={setFieldValue} />\n            </Form.Field>\n            <Button primary={true} type=\"submit\" disabled={isSubmitting}>Connect</Button>\n        </Form>\n    )\n}\n\nexport default withFormik<FormProps, FormValues>({\n    mapPropsToValues: (ownProps: FormProps) => ({\n        numWorkers: ownProps.config.localCores,\n        cudas: [],\n    }),\n    handleSubmit: (values, formikBag) => {\n        const { onSubmit } = formikBag.props;\n        onSubmit({\n            type: ClusterTypes.LOCAL,\n            ...values,\n        });\n    }\n})(LocalConnectionForm);\n","\nimport { FormikProps, withFormik } from \"formik\";\nimport * as React from \"react\";\nimport { Button, Form } from \"semantic-ui-react\";\nimport { ConfigState } from \"../../config/reducers\";\nimport { Omit } from \"../../helpers/types\";\nimport { ClusterTypes, ConnectRequestTCP } from \"../../messages\";\n\ntype FormValues = Omit<ConnectRequestTCP, \"type\">;\n\ninterface FormProps {\n    onSubmit: (params: ConnectRequestTCP) => void,\n    config: ConfigState,\n}\n\ntype MergedProps = FormikProps<FormValues> & FormProps;\n\nconst TCPConnectionForm: React.SFC<MergedProps> = ({\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    handleReset,\n}) => {\n    return (\n        <Form onSubmit={handleSubmit}>\n            <Form.Field>\n                <label htmlFor=\"address\">Scheduler URI</label>\n                <input type=\"text\" name=\"address\" value={values.address}\n                    onChange={handleChange}\n                    onBlur={handleBlur} />\n                {errors.address && touched.address && errors.address}\n            </Form.Field>\n            <Button primary={true} type=\"submit\" disabled={isSubmitting}>Connect</Button>\n        </Form>\n    )\n}\n\nexport default withFormik<FormProps, FormValues>({\n    mapPropsToValues: (ownProps: FormProps) => ({\n        address: ownProps.config.lastConnection.address,\n    }),\n    handleSubmit: (values, formikBag) => {\n        const { onSubmit } = formikBag.props;\n        onSubmit({\n            type: ClusterTypes.TCP,\n            ...values\n        });\n    }\n})(TCPConnectionForm);\n","\nimport * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Dropdown, DropdownProps, Segment } from \"semantic-ui-react\";\nimport * as clusterActions from \"../../cluster/actions\";\nimport { getEnumValues } from \"../../helpers\";\nimport { ClusterTypeMetadata, ClusterTypes, ConnectRequestParams } from \"../../messages\";\nimport { RootReducer } from \"../../store\";\nimport LocalConnectionForm from \"./LocalConnectionForm\";\nimport TCPConnectionForm from \"./TCPConnectionForm\";\n\n\nconst mapDispatchToProps = {\n    connectToCluster: clusterActions.Actions.connect,\n};\n\nconst mapStateToProps = (state: RootReducer) => {\n    return {\n        config: state.config,\n        lastConnectionType: state.config.lastConnection.type\n    }\n}\n\ntype MergedProps = DispatchProps<typeof mapDispatchToProps> & ReturnType<typeof mapStateToProps>;\n\nconst clusterTypeKeys = getEnumValues(ClusterTypes);\nconst clusterTypeOptions = clusterTypeKeys.map(t => ({\n    text: ClusterTypeMetadata[ClusterTypes[t]].label,\n    value: ClusterTypes[t],\n}));\n\ninterface ConnectionParamsState {\n    clusterType: ClusterTypes\n}\n\nclass ClusterConnectionForm extends React.Component<MergedProps, ConnectionParamsState> {\n    public state = {\n        clusterType: this.props.lastConnectionType,\n    }\n\n    public setType = (type: ClusterTypes) => {\n        this.setState({\n            clusterType: type,\n        });\n    }\n\n    public handleChange = (e: React.SyntheticEvent, data: DropdownProps) => {\n        const value = data.value as ClusterTypes;\n        this.setType(value);\n    }\n\n    public handleSubmit = (params: ConnectRequestParams) => {\n        this.props.connectToCluster(params);\n    }\n\n    public renderForm() {\n        const { clusterType } = this.state;\n        const { config } = this.props;\n\n        switch (clusterType) {\n            case ClusterTypes.LOCAL: {\n                return <LocalConnectionForm config={config} onSubmit={this.handleSubmit} />\n            }\n            case ClusterTypes.TCP: {\n                return <TCPConnectionForm config={config} onSubmit={this.handleSubmit} />\n            }\n        }\n    }\n\n    public render() {\n        return (\n            <>\n                <div>\n                    <Dropdown\n                        inline={true}\n                        options={clusterTypeOptions}\n                        value={this.state.clusterType}\n                        onChange={this.handleChange}\n                    />\n                </div>\n                <Segment>\n                    {this.renderForm()}\n                </Segment>\n            </>\n        )\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ClusterConnectionForm);","import * as React from 'react';\nimport { Icon, Message } from 'semantic-ui-react';\n\ninterface ChannelConnectingProps {\n    msg: string,\n}\n\nconst ChannelConnecting: React.SFC<ChannelConnectingProps> = ({ msg }) => (\n    <Message icon={true}>\n        <Icon name='cog' loading={true} />\n        <Message.Content>\n            <Message.Header>Connecting to LiberTEM</Message.Header>\n            {msg}\n        </Message.Content>\n    </Message>\n)\n\nexport default ChannelConnecting;","import * as React from \"react\";\nimport { Icon, Message } from \"semantic-ui-react\";\n\nconst ChannelShutdown: React.SFC = () => (\n    <Message negative={true} icon={true}>\n        <Icon name=\"shutdown\" />\n        <Message.Content>\n            <Message.Header>Connection is closed</Message.Header>\n            <p>please close the tab</p>\n        </Message.Content>\n    </Message>\n);\n\nexport default ChannelShutdown;\n","import * as React from \"react\";\nimport { useSelector } from \"react-redux\";\nimport ClusterConnectionForm from \"../../cluster/components/ClusterConnectionForm\";\nimport { assertNotReached } from \"../../helpers\";\nimport { RootReducer } from \"../../store\";\nimport ChannelConnecting from \"./ChannelConnecting\";\nimport ChannelShutdown from './ChannelShutdown'\n\nconst messages = {\n    waiting: \"Waiting...\",\n    connecting: \"Connecting...\",\n}\n\nconst clusterMessages = {\n    connected: \"Connected, waiting for initial state...\",\n    unknown: \"Connected, fetching cluster status...\",\n    connecting: \"Connecting to cluster\"\n}\n\nconst ConnectedNotReady: React.SFC = () => {\n    const haveConfig = useSelector((state: RootReducer) => state.config.haveConfig);\n    const clusterConnection = useSelector((state: RootReducer) => state.clusterConnection);\n\n    if (!haveConfig) {\n        return <ChannelConnecting msg=\"waiting for configuration...\" />;\n    }\n    if (clusterConnection.status === \"disconnected\") {\n        return <ClusterConnectionForm />\n    } else if (clusterConnection.status === \"connected\") {\n        return <ChannelConnecting msg={clusterMessages.connected} />;\n    } else if (clusterConnection.status === \"unknown\") {\n        return <ChannelConnecting msg={clusterMessages.unknown} />;\n    } else if (clusterConnection.status === \"connecting\") {\n        return <ChannelConnecting msg={clusterMessages.connecting} />\n    }\n    assertNotReached(\"should not happen\");\n}\n\nconst ChannelStatus: React.SFC = ({ children }) => {\n    const channelStatus = useSelector((state: RootReducer) => state.channelStatus);\n\n    switch (channelStatus.status) {\n        case \"waiting\":\n        case \"connecting\": {\n            return <ChannelConnecting msg={messages[channelStatus.status]} />;\n        }\n        case \"connected\": {\n            return <ConnectedNotReady />\n        }\n        case \"ready\":\n            return <>{children}</>;\n        case \"disconnected\":\n            return <ChannelShutdown />\n        default:\n            assertNotReached(\"should not happen\");\n    }\n}\n\nexport default ChannelStatus;","import * as React from \"react\";\nimport { Icon, SemanticICONS } from \"semantic-ui-react\";\nimport { DirectoryListingDetails } from \"../../messages\";\n\n\ninterface FileBrowserEntryProps {\n    style: object,\n    details: DirectoryListingDetails,\n    onClick?: () => void,\n    icon?: SemanticICONS,\n}\n\ninterface TimeStampProps {\n    ts: number,\n}\n\nexport const TimeStamp: React.SFC<TimeStampProps> = ({ ts }) => {\n    const date = new Date(ts * 1000);\n    const fmtDate = date.toLocaleDateString();\n    const fmtTime = date.toLocaleTimeString();\n    const title = `${fmtDate} ${fmtTime}`;\n    return (\n        <div style={{ display: \"flex\", whiteSpace: \"nowrap\" }} title={title}>\n            <div style={{ width: \"50%\", marginRight: \"10px\" }}>{fmtDate}</div>\n            <div style={{ width: \"45%\" }}>{fmtTime}</div>\n        </div>\n    )\n}\n\n// adapted from https://stackoverflow.com/a/14919494/540644\nfunction humanFileSize(bytes: number, si: boolean = false) {\n    const thresh = si ? 1000 : 1024;\n    if (Math.abs(bytes) < thresh) {\n        return {\n            size: bytes,\n            unit: 'B',\n        }\n    }\n    const units = si\n        ? ['kB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB']\n        : ['KiB', 'MiB', 'GiB', 'TiB', 'PiB', 'EiB', 'ZiB', 'YiB'];\n    let u = -1;\n    do {\n        bytes /= thresh;\n        ++u;\n    } while (Math.abs(bytes) >= thresh && u < units.length - 1);\n\n    return {\n        size: bytes.toFixed(1),\n        unit: units[u],\n    }\n}\n\ninterface FileSizeProps {\n    size: number,\n    si?: boolean,\n}\n\nexport const FileSize: React.SFC<FileSizeProps> = ({ size, si }) => {\n    const fmtSize = humanFileSize(size, si)\n    return (\n        <div style={{ textAlign: \"right\" }}>\n            {fmtSize.size} {fmtSize.unit}\n        </div>\n    );\n}\n\nexport const Cell: React.SFC<{ title?: string }> = ({ children, title }) => {\n    const styles: React.CSSProperties = {\n        whiteSpace: \"nowrap\",\n        overflow: \"hidden\",\n        textOverflow: \"ellipsis\",\n        marginRight: \"10px\",\n    }\n    return (\n        <div style={styles} title={title}>{children}</div>\n    );\n}\n\n\nclass FileBrowserEntry extends React.Component<FileBrowserEntryProps> {\n    public onClick = (e: React.MouseEvent) => {\n        const { onClick } = this.props;\n        if (onClick) {\n            onClick();\n        }\n    }\n\n    public render() {\n        const { details, style, icon } = this.props;\n        const myStyle: React.CSSProperties = {\n            cursor: \"pointer\",\n            ...style,\n        };\n\n        const tsStyles: React.CSSProperties = {\n            textAlign: \"right\",\n        };\n\n        return (\n            <div onClick={this.onClick} style={myStyle}>\n                <div style={{ display: \"flex\", paddingRight: \"10px\" }}>\n                    <div style={{ width: \"20%\", flexGrow: 1 }}>\n                        <Cell title={details.name}>\n                            {icon && <Icon name={icon} />}\n                            {details.name}\n                        </Cell>\n                    </div>\n                    <div style={{ width: \"10%\" }}><Cell><FileSize size={details.size} si={false} /></Cell></div>\n                    <div style={{ width: \"10%\" }}><Cell>{details.owner}</Cell></div>\n                    <div style={{ width: \"18%\", ...tsStyles }}>\n                        <Cell><TimeStamp ts={details.ctime} /></Cell>\n                    </div>\n                    <div style={{ width: \"18%\", ...tsStyles }}>\n                        <Cell><TimeStamp ts={details.mtime} /></Cell>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default FileBrowserEntry;","import { ActionsUnion, createAction } from \"../helpers/actionHelpers\";\nimport { ConfigParams } from \"./reducers\";\n\nexport enum ActionTypes {\n    FETCHED = \"CONFIG_FETCHED\",\n    FETCH = \"CONFIG_FETCH\",\n    FETCH_FAILED = \"CONFIG_FETCH_FAILED\",\n    TOGGLE_STAR = \"CONFIG_TOGGLE_STAR\",\n}\n\nexport const Actions = {\n    fetch: () => createAction(ActionTypes.FETCH),\n    fetched: (config: ConfigParams) => createAction(ActionTypes.FETCHED, { config }),\n    fetchFailed: (msg: string, timestamp: number, id: string) => createAction(ActionTypes.FETCH_FAILED, { msg, timestamp, id }),\n    toggleStar: (path: string) => createAction(ActionTypes.TOGGLE_STAR, { path }),\n}\n\nexport type Actions = ActionsUnion<typeof Actions>;","import * as React from \"react\";\nimport { Cell } from \"./FileBrowserEntry\";\n\nconst FileBrowserHeader: React.SFC = () => {\n    const alignRight: React.CSSProperties = {\n        textAlign: \"right\",\n    };\n\n    // ugly hack: padding-right to compensate for scrollbar size\n    return (\n        <div style={{ paddingRight: \"20px\", paddingBottom: \"10px\" }}>\n            <div style={{ display: \"flex\" }}>\n                <div style={{ width: \"20%\", flexGrow: 1 }}>\n                    <Cell>Name</Cell>\n                </div>\n                <div style={{ width: \"10%\", ...alignRight }}>\n                    <Cell>Size</Cell>\n                </div>\n                <div style={{ width: \"10%\" }}>\n                    <Cell>Owner</Cell>\n                </div>\n                <div style={{ width: \"18%\", ...alignRight }}>\n                    <Cell>Created</Cell>\n                </div>\n                <div style={{ width: \"18%\", ...alignRight }}>\n                    <Cell>Modified</Cell>\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default FileBrowserHeader;","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\nimport { DirectoryListingDetails } from \"../../messages\";\nimport * as browserActions from '../actions';\nimport FileBrowserEntry from \"./FileBrowserEntry\";\n\ninterface FileEntryProps {\n    path: string,\n    style: object,\n    details: DirectoryListingDetails,\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch, ownProps: FileEntryProps) => {\n    return {\n        select: () => dispatch(browserActions.Actions.select(ownProps.path, ownProps.details.name)),\n    };\n}\n\ntype MergedProps = FileEntryProps & ReturnType<typeof mapDispatchToProps>;\n\nclass FileEntry extends React.Component<MergedProps> {\n    public render() {\n        const { details, style, select } = this.props;\n\n        return (\n            <FileBrowserEntry onClick={select} style={style} details={details}\n                icon=\"file outline\" />\n        )\n    }\n}\n\nexport default connect(null, mapDispatchToProps)(FileEntry);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\nimport { DirectoryListingDetails } from \"../../messages\";\nimport * as browserActions from '../actions';\nimport FileBrowserEntry from \"./FileBrowserEntry\";\n\nconst mapDispatchToProps = (dispatch: Dispatch, ownProps: FolderEntryProps) => {\n    return {\n        list: () => {\n            dispatch(browserActions.Actions.list(ownProps.path, ownProps.details.name));\n            window.setTimeout(() => ownProps.onChange(), 0);\n        },\n    };\n}\n\ninterface FolderEntryProps {\n    path: string,\n    style: object,\n    details: DirectoryListingDetails,\n    onChange: () => void,\n}\n\ntype MergedProps = FolderEntryProps & ReturnType<typeof mapDispatchToProps>;\n\nconst FolderEntry: React.SFC<MergedProps> = ({ list, details, style, onChange }) => {\n    return (\n        <FileBrowserEntry onClick={list} style={style} details={details} icon=\"folder\" />\n    )\n}\n\nexport default connect(null, mapDispatchToProps)(FolderEntry);\n","import * as React from 'react';\nimport { connect } from \"react-redux\";\nimport { Dispatch } from 'redux';\nimport { Dropdown, DropdownItemProps } from \"semantic-ui-react\";\nimport * as browserActions from '../actions';\n\nconst mapDispatchToProps = (dispatch: Dispatch, ownProps: DropdownItemProps) => {\n    return {\n        list: () => {\n            if (ownProps.value !== undefined) {\n                dispatch(browserActions.Actions.list(ownProps.value.toString()));\n                window.setTimeout(() => ownProps.onChange(), 0);\n            }\n        },\n    };\n}\n\ntype MergedProps = ReturnType<typeof mapDispatchToProps> & DropdownItemProps & {\n    onChange: () => void,\n};\n\nconst PathDropDownItem: React.SFC<MergedProps> = ({ list, ...props }) => {\n    const newProps = {\n        onClick: list,\n        ...props,\n    }\n    return <Dropdown.Item {...newProps} />;\n}\n\nexport default connect(null, mapDispatchToProps)(PathDropDownItem);","import { FormikProps, withFormik } from \"formik\";\nimport * as React from \"react\";\nimport { Form, Input } from \"semantic-ui-react\";\n\ninterface FormValues {\n    path: string,\n}\n\ninterface PathInputProps {\n    onChange: (path: string) => void,\n    initialPath: string,\n}\n\ntype MergedProps = FormikProps<FormValues> & PathInputProps;\n\nconst PathInput: React.SFC<MergedProps> = ({\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    handleReset,\n}) => {\n    return (\n        <Form onSubmit={handleSubmit} style={{ flexGrow: 1 }}>\n            <Form.Field>\n                <Input autoComplete=\"off\" onBlur={handleBlur} onChange={handleChange} value={values.path} name=\"path\" />\n            </Form.Field>\n        </Form>\n    )\n}\n\nexport default withFormik<PathInputProps, FormValues>({\n    mapPropsToValues: ({ initialPath }) => ({\n        path: initialPath,\n    }),\n    handleSubmit: (values, formikBag) => {\n        const { onChange } = formikBag.props;\n        onChange(values.path);\n    },\n    enableReinitialize: true,\n})(PathInput);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\nimport { Dropdown, DropdownItemProps } from \"semantic-ui-react\";\nimport { DatasetTypes } from \"../../messages\";\nimport { RootReducer } from \"../../store\";\nimport * as browserActions from '../actions';\n\n\ntype DropdownOptions = Array<{\n    text: string,\n    value: {\n        type: DatasetTypes,\n        path: string,\n    },\n}>;\n\nconst mapStateToProps = (state: RootReducer) => {\n    return {\n        lastOpened: state.config.lastOpened,\n        fileHistory: state.config.fileHistory,\n        separator: state.config.separator,\n    };\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch) => {\n    return {\n        select: (path: string) => dispatch(browserActions.Actions.selectFullPath(path)),\n    };\n}\n\ntype MergedProps = ReturnType<typeof mapStateToProps> & ReturnType<typeof mapDispatchToProps>;\n\nconst RecentFiles: React.SFC<MergedProps> = ({ lastOpened, fileHistory, select }) => {\n\n    const recentFiles: DropdownOptions = fileHistory.filter((path: string) => lastOpened[path]).map((path: string) => {\n        const item = lastOpened[path];\n        return {\n            text: item.path,\n            value: {\n                type: item.type,\n                path: item.path,\n            },\n        };\n    });\n\n    const onClick = (e: React.MouseEvent<HTMLDivElement>, data: DropdownItemProps) => data.value && select(data.value.toString())\n\n    return (\n        <Dropdown item={true} text=\"Recent\" floating={true}>\n            <Dropdown.Menu>\n                <Dropdown.Header content=\"recent datasets\" />\n                {recentFiles.map((option, idx) => (\n                    <Dropdown.Item key={idx} value={option.value.path} content={option.text} onClick={onClick} />\n                ))}\n            </Dropdown.Menu>\n        </Dropdown>\n    );\n}\n\n\nexport default connect(mapStateToProps, mapDispatchToProps)(RecentFiles);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\nimport { Dropdown, Menu } from \"semantic-ui-react\";\nimport * as configActions from '../../config/actions';\nimport * as browserActions from '../actions';\nimport { FSPlaces } from \"../types\";\nimport PathDropDownItem from \"./PathDropDownItem\";\nimport PathInput from \"./PathInput\";\nimport RecentFiles from \"./RecentFiles\";\n\nconst mapDispatchToProps = (dispatch: Dispatch, ownProps: PathBarProps) => {\n    return {\n        refresh: () => {\n            dispatch(browserActions.Actions.list(ownProps.currentPath));\n            window.setTimeout(() => ownProps.onChange(), 0);\n        },\n        handleInputChange: (path: string) => {\n            dispatch(browserActions.Actions.list(path));\n            window.setTimeout(() => ownProps.onChange(), 0);\n        },\n        goUp: () => {\n            dispatch(browserActions.Actions.list(ownProps.currentPath, '..'));\n            window.setTimeout(() => ownProps.onChange(), 0);\n        },\n        toggleStar: () => {\n            dispatch(configActions.Actions.toggleStar(ownProps.currentPath));\n        }\n    };\n}\n\ninterface PathBarProps {\n    currentPath: string,\n    onChange: () => void,\n    drives: string[],\n    places: FSPlaces,\n    starred: string[],\n}\n\ntype MergedProps = ReturnType<typeof mapDispatchToProps> & PathBarProps;\n\nconst PathBar: React.SFC<MergedProps> = ({ currentPath, drives, places, starred, onChange, refresh, goUp, handleInputChange, toggleStar }) => {\n    const driveOptions = drives.map((path) => ({ key: path, text: path }));\n    const placeOptions = Object.keys(places).map((key) => ({ key: places[key].path, text: places[key].title }));\n    const starOptions = starred.map((path) => ({ key: path, text: path }));\n    const isStarred = starred.includes(currentPath);\n    const starredIcon = isStarred ? \"star\" : \"star outline\";\n    const bookmarkTitle = isStarred ? \"Remove from bookmarks\" : \"Bookmark this location\";\n\n    return (\n        <Menu>\n            <RecentFiles />\n            <Dropdown text=\"Go to...\" floating={true} item={true}>\n                <Dropdown.Menu>\n                    <Dropdown.Header content=\"Drives\" />\n                    {driveOptions.map((option) => {\n                        return <PathDropDownItem key={option.key} value={option.key} content={option.text} onChange={onChange} />\n                    })}\n                    <Dropdown.Header content=\"Places\" />\n                    {placeOptions.map((option) => {\n                        return <PathDropDownItem key={option.key} value={option.key} content={option.text} onChange={onChange} />\n                    })}\n                    <Dropdown.Header content=\"Starred\" />\n                    {starOptions.length === 0 && \n                        <Dropdown.Item key=\"empty\" value=\"empty\" content=\"No bookmarks yet\" />\n                    }\n                    {starOptions.map((option) => {\n                        return <PathDropDownItem key={option.key} value={option.key} content={option.text} onChange={onChange} />\n                    })}\n                </Dropdown.Menu>\n            </Dropdown>\n            <Menu.Item title={bookmarkTitle} icon={starredIcon} onClick={toggleStar} />\n            <Menu.Item icon=\"arrow up\" onClick={goUp} />\n            <Menu.Item style={{ flexGrow: 1 }}>\n                <PathInput onChange={handleInputChange} initialPath={currentPath} />\n            </Menu.Item>\n            <Menu.Item icon=\"refresh\" onClick={refresh} />\n        </Menu>\n    );\n}\n\n\nexport default connect(null, mapDispatchToProps)(PathBar);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { FixedSizeList as List } from \"react-window\";\nimport { Dispatch } from \"redux\";\nimport { Button, Header, Segment } from \"semantic-ui-react\";\nimport { DirectoryListingDetails } from \"../../messages\";\nimport { RootReducer } from \"../../store\";\nimport * as browserActions from '../actions';\nimport FileBrowserHeader from \"./FileBrowserHeader\";\nimport FileEntry from \"./FileEntry\";\nimport FolderEntry from \"./FolderEntry\";\nimport PathBar from \"./PathBar\";\n\nconst mapStateToProps = (state: RootReducer) => {\n    const { browser, config } = state;\n    return {\n        files: browser.files,\n        dirs: browser.dirs,\n        path: browser.path,\n        drives: browser.drives,\n        places: browser.places,\n        isLoading: browser.isLoading,\n        starred: config.starred,\n    };\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch) => {\n    return {\n        cancel: () => dispatch(browserActions.Actions.cancel()),\n    };\n}\n\ntype MergedProps = ReturnType<typeof mapStateToProps> & ReturnType<typeof mapDispatchToProps>;\n\ninterface EntryFnArgs {\n    index: number,\n    style: object\n}\ntype EntryFn = (arg: EntryFnArgs) => void\n\nconst listRef = React.createRef<List>();\n\nconst scrollToTop = () => {\n    if (listRef.current === null) {\n        return;\n    }\n    listRef.current.scrollToItem(0);\n}\n\nfunction sortByKey<T extends object>(array: T[], getKey: (item: T) => any) {\n    return array.sort((a, b) => {\n        const x = getKey(a);\n        const y = getKey(b);\n        return ((x < y) ? -1 : ((x > y) ? 1 : 0));\n    });\n}\n\nconst FileBrowser: React.SFC<MergedProps> = ({ files, dirs, path, drives, places, starred, cancel, isLoading }) => {\n    const getSortKey = (item: DirectoryListingDetails) => item.name.toLowerCase();\n    const dirEntries = sortByKey(dirs, getSortKey).map((dir) => (style: object) => <FolderEntry style={style} onChange={scrollToTop} path={path} details={dir} />);\n    const fileEntries = sortByKey(files, getSortKey).map((f) => ((style: object) => <FileEntry style={style} path={path} details={f} />));\n    const entries = dirEntries.concat(fileEntries);\n\n    const cellFn: EntryFn = ({ index, style }) => {\n        return entries[index](style)\n    }\n\n    let list = (\n        <List style={{ overflowY: \"scroll\" }} ref={listRef} height={300} width=\"100%\" itemCount={entries.length} itemSize={35}>\n            {cellFn}\n        </List>\n    );\n\n    if (isLoading) {\n        // FIXME: hardcoded height\n        list = (\n            <Segment loading={true} style={{ height: \"300px\" }} />\n        )\n    }\n\n    return (\n        <Segment.Group>\n            <Segment>\n                <Header as=\"h2\">Open dataset</Header>\n            </Segment>\n            <Segment>\n                <PathBar currentPath={path} drives={drives} places={places} starred={starred} onChange={scrollToTop} />\n            </Segment>\n            <Segment>\n                <FileBrowserHeader />\n                {list}\n            </Segment>\n            <Segment>\n                <Button onClick={cancel}>Cancel</Button>\n            </Segment>\n        </Segment.Group>\n    );\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(FileBrowser);","\nexport interface JobResultType {\n    imageURL: string,\n    description: { title: string, desc: string, includeInDownload: boolean },\n}\n\nexport enum JobRunning {\n    CREATING = 'CREATING',\n    RUNNING = 'RUNNING',\n    DONE = 'DONE',\n}\n\nexport enum JobStatus {\n    CREATING = 'CREATING',\n    IN_PROGRESS = 'IN_PROGRESS',\n    CANCELLED = 'CANCELLED',\n    SUCCESS = 'SUCCESS',\n    ERROR = 'ERROR',\n}\n\nexport interface JobStateCommon {\n    id: string,\n    analysis: string,\n    status: JobStatus,\n    startTimestamp: number,\n    results: JobResultType[],\n}\n\nexport type JobStateStart = JobStateCommon & {\n    running: JobRunning.CREATING | JobRunning.RUNNING,\n}\n\nexport type JobStateDone = JobStateCommon & {\n    running: JobRunning.DONE,\n    endTimestamp: number,\n}\n\nexport type JobState = JobStateStart | JobStateDone;","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Button, Icon } from \"semantic-ui-react\";\nimport { RootReducer } from \"../../store\";\nimport * as browserActions from '../actions';\nimport FileBrowser from \"./FileBrowser\";\n\nexport const mapStateToProps = (state: RootReducer) => {\n    return {\n        isOpen: state.browser.isOpen,\n        busy: state.openDataset.busy,\n        formVisible: state.openDataset.formVisible,\n    }\n}\n\nexport const mapDispatchToProps = {\n    open: browserActions.Actions.open,\n}\n\ntype MergedProps = ReturnType<typeof mapStateToProps> & DispatchProps<typeof mapDispatchToProps>;\n\nconst BrowserWrapper: React.SFC<MergedProps> = ({ formVisible, isOpen, open, busy }) => {\n    if(formVisible || busy) {\n        return null;\n    } else if (!isOpen) {\n        return (\n            <Button icon={true} labelPosition=\"left\" onClick={open}>\n                <Icon name='add' />\n                Browse\n            </Button>\n        );\n    } else {\n        return (\n            <FileBrowser />\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(BrowserWrapper)\n","import * as React from \"react\";\nimport { Icon } from \"semantic-ui-react\";\n\nconst BusySpinner: React.SFC = () => {\n    const styles: React.CSSProperties = {\n        margin: 0,\n        padding: 0,\n        position: \"absolute\",\n        bottom: \"10px\",\n        right: \"10px\",\n        color: \"white\",\n        opacity: 0.7,\n        filter: \"drop-shadow(0 0 3px #000)\",\n    };\n    return (\n        <Icon name=\"cog\" loading={true} style={styles} />\n    )\n}\n\nexport default BusySpinner;","import * as React from \"react\";\nimport BusySpinner from \"./BusySpinner\";\n\ninterface BusyWrapperProps {\n    busy: boolean,\n}\n\nconst BusyWrapper: React.SFC<BusyWrapperProps> = ({ children, busy }) => {\n    const styles: React.CSSProperties = {\n        position: \"relative\",\n    };\n    return (\n        <div style={styles}>\n            {children}\n            {busy && <BusySpinner />}\n        </div>\n    )\n}\n\nexport default BusyWrapper;","import * as React from \"react\";\nimport { DraggableHandle } from \"./DraggableHandle\";\nimport { HandleRenderFunction } from \"./types\";\n\nexport interface HandleParentProps {\n    width: number,\n    height: number,\n    onKeyboardEvent?: React.KeyboardEventHandler<SVGElement>,\n    handles: HandleRenderFunction[],\n}\n\nexport class HandleParent extends React.Component<HandleParentProps> {\n    public currentHandle: DraggableHandle | undefined;\n\n    public handleDragStart = (h: DraggableHandle): void => {\n        this.currentHandle = h;\n    }\n\n    public handleDrop = (): void => {\n        this.currentHandle = undefined;\n    }\n\n    public handleMouseMove = (e: React.MouseEvent<SVGElement>): void => {\n        if (this.currentHandle) {\n            return this.currentHandle.externalMouseMove(e);\n        }\n    }\n\n    public handleMouseLeave = (e: React.MouseEvent<SVGElement>): void => {\n        if (this.currentHandle) {\n            this.currentHandle.externalLeave(e);\n        }\n    }\n\n    public handleMouseUp = (e: React.MouseEvent<SVGElement>): void => {\n        if (this.currentHandle) {\n            this.currentHandle.externalMouseUp(e);\n        }\n    }\n\n    public render() {\n        const { width, height } = this.props;\n        const styles = {\n            outline: \"1px dashed black\"\n        }\n        return (\n            <g\n                onMouseMove={this.handleMouseMove}\n                onMouseLeave={this.handleMouseLeave}\n                onMouseUp={this.handleMouseUp}\n                onKeyDown={this.props.onKeyboardEvent}\n                style={styles}\n                tabIndex={0}\n            >\n                <rect style={{ fill: \"transparent\" }}\n                    x={0} y={0} width={width} height={height}\n                />\n                {this.renderHandles()}\n            </g>\n        );\n    }\n\n    public renderHandles() {\n        const { handles, onKeyboardEvent } = this.props;\n        // we need to inform the handle when there are move/up/leave events\n        // on this parent element, for which we need to know the current handle.\n        // so we pass the handle a dragstart/drop function and kindly ask it\n        // to call us if it starts to be dragged or is dropped.\n        return handles.map((h, i) => {\n            const elem = h(this.handleDragStart, this.handleDrop, onKeyboardEvent);\n            if (React.isValidElement(elem)) {\n                return React.cloneElement(elem, { key: i });\n            }\n            return null;\n        });\n    }\n}\n\nexport default HandleParent;","import * as React from \"react\";\nimport { JobState } from \"../types\";\nimport styles from \"./ResultImage.module.css\";\n\ninterface ResultImageProps {\n    job: JobState,\n    channel: number,\n    width: number,\n    height: number,\n}\n\nconst ResultImage: React.SFC<ResultImageProps> = ({ job, channel, width, height }) => {\n    const result = job.results[channel];\n    if (result === undefined) {\n        return (\n            <svg className={styles.fallback} width={width} height={height} viewBox={`0 0 ${width} ${height}`} key={-1} />\n        )\n    }\n    return (\n        <image className={styles.default} xlinkHref={result.imageURL} width={width} height={height} />\n    );\n}\n\nexport default ResultImage;","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport styled from 'styled-components';\nimport BusyWrapper from \"../../widgets/BusyWrapper\";\nimport HandleParent from \"../../widgets/HandleParent\";\nimport { HandleRenderFunction } from \"../../widgets/types\";\nimport { JobRunning, JobState } from \"../types\";\nimport ResultImage from \"./ResultImage\";\n\ninterface ResultProps {\n    width: number,\n    height: number,\n    job: JobState,\n    extraHandles?: HandleRenderFunction,\n    extraWidgets?: React.ReactElement<SVGElement>,\n    channel: number,\n}\n\nconst ResultWrapper = styled.svg`\n    display: block;\n    border: 1px solid black;\n    width: 100%;\n    height: auto;\n`;\n\ntype MergedProps = ResultProps;\n\nclass Result extends React.Component<MergedProps> {\n    public renderHandles() {\n        const { width, height, extraHandles } = this.props;\n        let handles: HandleRenderFunction[] = [];\n        if (extraHandles) {\n            handles = [...handles, extraHandles];\n        }\n\n        return (\n            <HandleParent width={width} height={height} handles={handles} />\n        )\n    }\n\n    public render() {\n        const { job, channel, width, height, extraWidgets } = this.props;\n        const busy = job.running !== JobRunning.DONE;\n\n        return (\n            <BusyWrapper busy={busy}>\n                <ResultWrapper width={width} height={height} viewBox={`0 0 ${width} ${height}`}>\n                    <ResultImage job={job} channel={channel} width={width} height={height} />\n                    {extraWidgets}\n                    {this.renderHandles()}\n                </ResultWrapper>\n            </BusyWrapper>\n        );\n    }\n};\n\nexport default connect(null, null)(Result);","import styled from 'styled-components';\n\n\nconst Selectors = styled.div`\n    display: flex;\n    & > * {\n        margin-right: 10px;\n    }\n`;\n\n\n\nexport default Selectors;","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Dropdown, DropdownProps } from \"semantic-ui-react\";\nimport { RootReducer } from \"../../store\";\nimport { HandleRenderFunction } from \"../../widgets/types\";\nimport { JobRunning, JobState } from \"../types\";\nimport Result from \"./Result\";\nimport Selectors from \"./Selectors\";\n\ninterface ResultListProps {\n    width: number,\n    height: number,\n    selectors?: React.ReactElement<any>,\n    extraHandles?: HandleRenderFunction,\n    extraWidgets?: React.ReactElement<SVGElement>,\n    subtitle?: React.ReactNode,\n}\n\ninterface ExternalResultListProps {\n    compoundAnalysis: string,\n    analysisIndex: number,\n}\n\nconst mapStateToProps = (state: RootReducer, ownProps: ExternalResultListProps) => {\n    const compoundAnalysis = state.compoundAnalyses.byId[ownProps.compoundAnalysis];\n    const analysis = state.analyses.byId[compoundAnalysis.details.analyses[ownProps.analysisIndex]];\n\n    return {\n        jobsById: state.jobs.byId,\n        analysis,\n        compoundAnalysis,\n        analysisIndex: ownProps.analysisIndex,\n    };\n};\n\ntype MergedProps = ResultListProps & ReturnType<typeof mapStateToProps>;\n\ninterface ResultListState {\n    selectedChannel: number,\n}\n\nconst ResultListPlaceholder: React.SFC<{ width: number, height: number }> = ({ width, height }) => {\n    return (\n        <svg\n            style={{\n                display: \"block\",\n                border: \"1px solid black\",\n                width: \"100%\",\n                height: \"auto\"\n            }}\n            width={width} height={height}\n            viewBox={`0 0 ${width} ${height}`} key={-1} />\n    );\n}\n\n\nclass ResultList extends React.Component<MergedProps, ResultListState> {\n    public state: ResultListState = { selectedChannel: 0 };\n\n    public selectChannel = (e: React.SyntheticEvent, data: DropdownProps) => {\n        const value = data.value as number;\n        this.setState({ selectedChannel: value });\n    }\n\n    public getJob() {\n        const {\n            analysis, jobsById,\n        } = this.props;\n        if (!analysis || !analysis.displayedJob || !jobsById[analysis.displayedJob]) {\n            return undefined;\n        }\n        return jobsById[analysis.displayedJob];\n    }\n\n    public getMsg(job?: JobState) {\n        if (!job) {\n            return <>&nbsp;</>;\n        }\n        if (job.running === JobRunning.DONE) {\n            const dt = (job.endTimestamp - job.startTimestamp) / 1000;\n            return <>Analysis done in {dt.toFixed(3)}s</>;\n        } else {\n            return <>Analysis running...</>;\n        }\n    }\n\n    public genericRender(currentResult: React.ReactElement, job?: JobState) {\n        const { subtitle, children, selectors } = this.props;\n        const msg = this.getMsg(job);\n        return (\n            <div>\n                {currentResult}\n                {children}\n                <Selectors>\n                    <ResultImageSelector job={job} handleChange={this.selectChannel} selectedImg={this.state.selectedChannel} />\n                    {selectors}\n                </Selectors>\n                <p>{subtitle} {msg}</p>\n            </div>\n        );\n    }\n\n    public render() {\n        const job = this.getJob();\n        const {\n            width, height,\n            extraHandles, extraWidgets\n        } = this.props;\n\n        if (!job) {\n            return this.genericRender(<ResultListPlaceholder width={width} height={height} />, job);\n        }\n\n        return this.genericRender(\n            <Result job={job}\n                extraHandles={extraHandles}\n                extraWidgets={extraWidgets}\n                width={width} height={height}\n                channel={this.state.selectedChannel}\n            />,\n            job\n        );\n    }\n}\n\ninterface ImageSelectorProps {\n    job?: JobState,\n    handleChange: (e: React.SyntheticEvent, data: DropdownProps) => void,\n    selectedImg: number,\n}\n\nconst ResultImageSelector: React.SFC<ImageSelectorProps> = ({ job, handleChange, selectedImg }) => {\n    if (!job) {\n        return null;\n    }\n    const availableImages = job.results.map((result, idx) => ({ text: result.description.title, value: idx }));\n    return (\n        <>\n            <div>\n                Channel:{' '}\n                <Dropdown\n                    inline={true}\n                    options={availableImages}\n                    value={selectedImg}\n                    onChange={handleChange}\n                />\n            </div>\n        </>\n    )\n}\n\n\nexport default connect(mapStateToProps)(ResultList);\n","export const inRectConstraint = (width: number, height: number) => (p: Point2D) => {\n    return {\n        x: Math.max(0, Math.min(width - 1, p.x)),\n        y: Math.max(0, Math.min(height - 1, p.y)),\n    }\n}\n\nexport const dist = (cx: number, cy: number, x: number, y: number) => {\n    const dx = cx - x;\n    const dy = cy - y;\n    return Math.sqrt(dx * dx + dy * dy);\n}\n\nexport const cbToRadius = (cx: number, cy: number, cb: ((r: number) => void) | undefined) => (x: number, y: number) => cb && cb(dist(cx, cy, x, y))\n\nexport const keepOnCY = (cy: number) => (p: Point2D) => {\n    return {\n        x: p.x,\n        y: cy,\n    }\n}\n\nexport const keepXLargerThan = (otherX: number) => (p: Point2D) => {\n    return {\n        x: otherX > p.x ? otherX : p.x,\n        y: p.y,\n    }\n}\n\nexport const keepXSmallerThan = (otherX: number) => (p: Point2D) => {\n    return {\n        x: otherX < p.x ? otherX : p.x,\n        y: p.y,\n    }\n}\n\nexport const riConstraint = (outerPos: number, cy: number) => (p: Point2D) => {\n    return keepXLargerThan(outerPos)(\n        keepOnCY(cy)(p)\n    );\n}\n\nexport const roConstraints = (innerPos: number, cy: number) => (p: Point2D) => {\n    return keepXSmallerThan(innerPos)(\n        keepOnCY(cy)(p)\n    );\n}","import { CSSProperties } from \"react\";\n\nexport const defaultMaskStyles = (imageWidth: number): CSSProperties => ({\n    fillOpacity: 0.3,\n    fill: \"red\",\n    strokeOpacity: 0.7,\n    stroke: \"red\",\n    strokeWidth: imageWidth / 128 / 3,\n});","import * as React from \"react\";\nimport { defaultMaskStyles } from \"./styles\";\n\nexport interface DiskProps {\n    imageWidth: number,\n    imageHeight: number,\n    cx: number,\n    cy: number,\n    r: number,\n}\n\nconst Disk: React.SFC<DiskProps> = ({ imageWidth, imageHeight, cx, cy, r }) => {\n    return (\n        <circle cx={cx + .5} cy={cy + .5} r={r} style={{ ...defaultMaskStyles(imageWidth) }} />\n    );\n}\n\nexport default Disk;","import * as React from \"react\";\nimport styled from 'styled-components';\nimport { handleKeyEvent, ModifyCoords } from \"./kbdHandler\";\n\nexport type HandleProps = {\n    x: number,\n    y: number,\n    scale: number,\n    withCross?: boolean,\n    focusRef: React.RefObject<SVGGElement>,\n} & React.SVGProps<SVGGElement>;\n\nconst StyledCircle = styled.circle`\n    stroke: red;\n    stroke-width: 1;\n    fill: transparent;\n    g:focus > & {\n        stroke: lightgreen;\n    }\n`;\n\nconst Cross = styled.path`\n    stroke: red;\n    stroke-width: 1;\n    fill: transparent;\n    g:focus > & {\n        stroke: lightgreen;\n    }\n`;\n\nconst FocusGroup = styled.g`\n    &:focus { outline: none; }\n`;\n\nconst Handle: React.SFC<HandleProps> = ({ scale, x, y, withCross, focusRef, ...args }) => {\n    const r = 3;\n    // scaleMatrix is needed to set the origin of the scale\n    const scaleMatrix = `matrix(${scale}, 0, 0, ${scale}, ${x - scale * x}, ${y - scale * y})`;\n    const style: React.CSSProperties = { transform: scaleMatrix };\n    const crossSpec = `\n        M${x - 4 - r / 2} ${y} L ${x - r / 2} ${y} M${x + r / 2} ${y} L ${x + 4 + r / 2} ${y}\n        M${x} ${y - 4 - r / 2} L ${x} ${y - r / 2} M${x} ${y + r / 2} L ${x} ${y + 4 + r / 2}\n    `;\n    const cross = withCross ? <Cross d={crossSpec} style={style} /> : null;\n    return (\n        <FocusGroup {...args} ref={focusRef}>\n            <StyledCircle cx={x} cy={y} r={r} style={style} />\n            {cross}\n        </FocusGroup>\n    )\n}\n\nexport interface DraggableHandleProps {\n    x: number,\n    y: number,\n    withCross?: boolean,\n    imageWidth?: number,\n    onDragMove?: (x: number, y: number) => void,\n    parentOnDragStart: (h: DraggableHandle) => void,\n    parentOnDrop: (x: number, y: number) => void,\n    onKeyboardEvent?: (e: React.KeyboardEvent<SVGElement>) => void,\n    constraint?: (p: Point2D) => Point2D,\n}\n\nexport function getScalingFactor(elem: SVGElement): number {\n    const svg = elem.ownerSVGElement;\n    if (svg === null) {\n        throw new Error(\"no owner SVG element?\");\n    }\n    const inWidthAttr = svg.getAttribute(\"width\");\n    if (inWidthAttr === null) {\n        throw new Error(\"no width on SVG element?\");\n    }\n    const inWidth = +inWidthAttr;\n    const svgMeasurements = svg.getBoundingClientRect();\n    return svgMeasurements.width / inWidth;\n}\n\nfunction relativeCoords(e: React.MouseEvent, parent: SVGElement) {\n    const f = getScalingFactor(parent);\n    const parentPos = parent.getBoundingClientRect();\n    const res = {\n        x: (e.pageX - (parentPos.left + window.pageXOffset)) / f,\n        y: (e.pageY - (parentPos.top + window.pageYOffset)) / f,\n    }\n    return res;\n}\n\n/**\n * stateful draggable handle, to be used as part of <svg/>\n */\nexport class DraggableHandle extends React.Component<DraggableHandleProps> {\n    public posRef: React.RefObject<SVGRectElement>;\n    public focusRef: React.RefObject<SVGGElement>;\n\n    public state = {\n        dragging: false,\n        drag: { x: 0, y: 0 },\n    }\n\n    constructor(props: DraggableHandleProps) {\n        super(props);\n        this.posRef = React.createRef<SVGRectElement>();\n        this.focusRef = React.createRef<SVGGElement>();\n    }\n\n    // mousemove event from outside (delegated from surrounding element)\n    public externalMouseMove = (e: React.MouseEvent<SVGElement>): void => {\n        this.move(e);\n    }\n\n    // mouseleave event from outside (delegated from surrounding element)\n    public externalLeave = (e: React.MouseEvent<SVGElement>): void => {\n        this.stopDrag(e);\n    }\n\n    // mouseup event from outside (delegated from surrounding element)\n    public externalMouseUp = (e: React.MouseEvent<SVGElement>): void => {\n        this.stopDrag(e);\n    }\n\n    public applyConstraint = (p: Point2D) => {\n        const { constraint } = this.props;\n        if (constraint) {\n            return constraint(p);\n        } else {\n            return p;\n        }\n    }\n\n    public startDrag = (e: React.MouseEvent<SVGElement>): void => {\n        e.preventDefault();\n        const { parentOnDragStart } = this.props;\n        if (this.posRef.current) {\n            this.setState({\n                dragging: true,\n                drag: this.applyConstraint(relativeCoords(e, this.posRef.current)),\n            });\n            if (parentOnDragStart) {\n                parentOnDragStart(this);\n            }\n            if (this.focusRef.current && this.focusRef.current.focus) {\n                this.focusRef.current.focus();\n            }\n        } else {\n            throw new Error(\"startDrag without posRef\");\n        }\n    }\n\n    public move = (e: React.MouseEvent<SVGElement>): void => {\n        const { onDragMove } = this.props;\n        if (!this.state.dragging) {\n            return;\n        }\n        if (this.posRef.current) {\n            this.setState({\n                drag: this.applyConstraint(relativeCoords(e, this.posRef.current)),\n            }, () => {\n                if (onDragMove) {\n                    const constrained = this.applyConstraint(this.state.drag)\n                    onDragMove(constrained.x, constrained.y);\n                }\n            })\n        } else {\n            throw new Error(\"move without posRef\");\n        }\n    }\n\n    public stopDrag = (e: React.MouseEvent<SVGElement>): void => {\n        const { parentOnDrop } = this.props;\n        const { dragging, drag } = this.state;\n        if (!dragging) {\n            return;\n        }\n        this.setState({\n            dragging: false,\n        })\n        if (parentOnDrop) {\n            parentOnDrop(drag.x, drag.y);\n        }\n    }\n\n    public handleKeyDown = (e: React.KeyboardEvent<SVGElement>) => {\n        const update = (fn: ModifyCoords) => {\n            const { x, y, onDragMove } = this.props;\n            const newCoords = fn(x, y);\n            const constrained = this.applyConstraint(newCoords);\n            if (onDragMove) {\n                onDragMove(constrained.x, constrained.y);\n            }\n        }\n        handleKeyEvent(e, update);\n    }\n\n    public renderCommon(x: number, y: number) {\n        const { imageWidth } = this.props;\n        const scale = imageWidth === undefined ? 1 : imageWidth / 128;\n        // empty zero-size <rect> as relative position reference\n        return (\n            <g>\n                <rect\n                    style={{ visibility: \"hidden\" }}\n                    ref={this.posRef}\n                    x={0} y={0} width={0} height={0}\n                />\n                <Handle scale={scale} x={x + .5} y={y + .5} withCross={this.props.withCross}\n                    focusRef={this.focusRef}\n                    onMouseUp={this.stopDrag}\n                    onMouseMove={this.move}\n                    onMouseDown={this.startDrag}\n                    onKeyDown={this.handleKeyDown}\n                    tabIndex={0}\n                />\n            </g>\n        );\n    }\n\n    public renderDragging() {\n        const { x, y } = this.state.drag;\n        return this.renderCommon(x, y);\n    }\n\n    public render() {\n        const { x, y } = this.props;\n        // either render from state (when dragging) or from props\n        if (this.state.dragging) {\n            return this.renderDragging();\n        } else {\n            return this.renderCommon(x, y);\n        }\n    }\n}\n\nexport default DraggableHandle;\n","import { ActionsUnion, createAction } from \"../helpers/actionHelpers\";\nimport { AnalysisDetails, AnalysisTypes, CompoundAnalysisDetails } from \"../messages\";\nimport { CompoundAnalysis } from \"./types\";\n\n\nexport enum ActionTypes {\n    CREATE = 'COMPOUND_ANALYSIS_CREATE',\n    CREATED = 'COMPOUND_ANALYSIS_CREATED',\n    UPDATED = 'COMPOUND_ANALYSIS_UPDATED',\n    RUN = 'COMPOUND_ANALYSIS_RUN',\n    RUNNING = 'COMPOUND_ANALYSIS_RUNNING',\n    REMOVE = 'COMPOUND_ANALYSIS_REMOVE',\n    REMOVED = 'COMPOUND_ANALYSIS_REMOVED',\n    ERROR = 'COMPOUND_ANALYSIS_ERROR',\n    ENABLE_AUTOSTART = 'COMPOUND_ANALYSIS_ENABLE_AUTOSTART',\n}\n\nexport const Actions = {\n    create: (dataset: string, analysisType: AnalysisTypes) => createAction(ActionTypes.CREATE, { dataset, analysisType }),\n    created: (\n        compoundAnalysis: CompoundAnalysis, autoStart: boolean\n    ) => createAction(ActionTypes.CREATED, { compoundAnalysis, autoStart }),\n    enableAutoStart: (\n        compoundAnalysisId: string\n    ) => createAction(ActionTypes.ENABLE_AUTOSTART, { compoundAnalysisId }),\n    updated: (id: string, details: CompoundAnalysisDetails) => createAction(ActionTypes.UPDATED, { id, details }),\n    run: (id: string, analysisIndex: number, details: AnalysisDetails) => createAction(ActionTypes.RUN, { id, analysisIndex, details }),\n    running: (id: string, job: string, analysisIndex: number) => createAction(ActionTypes.RUNNING, { id, job, jobIndex: analysisIndex }),\n    remove: (id: string) => createAction(ActionTypes.REMOVE, { id }),\n    removed: (id: string) => createAction(ActionTypes.REMOVED, { id }),\n    error: (msg: string, timestamp: number, id: string) => createAction(ActionTypes.ERROR, { msg, timestamp, id }),\n}\n\nexport type Actions = ActionsUnion<typeof Actions>;\n\nexport type ActionParts = {\n    [K in keyof typeof Actions]: ReturnType<typeof Actions[K]>\n}","export type ModifyCoords = ((x: number, y: number) => ({ x: number, y: number }));\n\n/**\n * Call this function whenever a keyboard event happens. The keyboard event is then translated\n * to a coordinate transformation, which is passed to the update callback. The update callback is\n * only called if relevant keys were pressed (example: arrow keys).\n * \n * @param e keyboard event\n * @param update a callback to handle coordinate updates\n */\nexport const handleKeyEvent = (e: React.KeyboardEvent<SVGElement>, update: (fn: ModifyCoords) => void) => {\n    let delta = 1;\n    if (e.shiftKey) {\n        delta = 10;\n    }\n    switch (e.key) {\n        case \"ArrowUp\":\n            update((x: number, y: number) => ({ x, y: y - delta }));\n            break;\n        case \"ArrowDown\":\n            update((x: number, y: number) => ({ x, y: y + delta }));\n            break;\n        case \"ArrowLeft\":\n            update((x: number, y: number) => ({ x: x - delta, y }));\n            break;\n        case \"ArrowRight\":\n            update((x: number, y: number) => ({ x: x + delta, y }));\n            break;\n        default:\n            return;\n    }\n    e.preventDefault();\n}\n","import * as React from \"react\";\nimport { useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { AnalysisTypes } from \"../../messages\";\nimport { HandleRenderFunction } from \"../../widgets/types\";\nimport * as compoundAnalysisActions from \"../actions\";\nimport useFramePicker from \"./FramePicker\";\nimport ModeSelector from \"./ModeSelector\";\nimport { useDiskROI } from \"./roi/DiskROI\";\nimport { useRectROI } from \"./roi/RectROI\";\nimport { useRoiPicker } from \"./roi/RoiPicker\";\n\n\nexport enum DefaultModes {\n    SUM = \"SUM\",\n    SD = \"SD\",\n    PICK = \"PICK\",\n}\n\nexport enum DefaultRois {\n    ALL = \"ALL\",\n    DISK = \"DISK\",\n    RECT = \"RECT\",\n}\n\nconst useDefaultFrameView = ({\n    scanWidth, scanHeight, compoundAnalysisId, doAutoStart,\n}: {\n    scanWidth: number, scanHeight: number, compoundAnalysisId: string,\n    doAutoStart: boolean,\n}) => {\n    const availableModes = [\n        {\n            text: \"Average\",\n            value: DefaultModes.SUM,\n        },\n        {\n            text: \"Standard Deviation\",\n            value: DefaultModes.SD,\n        },\n        {\n            text: \"Pick\",\n            value: DefaultModes.PICK,\n        },\n    ]\n\n    const availableRois = [\n        {\n            text: \"All\",\n            value: DefaultRois.ALL,\n        },\n        {\n            text: \"Disk\",\n            value: DefaultRois.DISK,\n        },\n        {\n            text: \"Rect\",\n            value: DefaultRois.RECT,\n        },\n    ]\n\n    const [frameMode, setMode] = useState(DefaultModes.SUM);\n    const [roi, setRoi] = useState(DefaultRois.ALL);\n\n    const dispatch = useDispatch();\n\n    const updateFrameMode = (newMode: DefaultModes) => {\n        dispatch(compoundAnalysisActions.Actions.enableAutoStart(compoundAnalysisId));\n        setMode(newMode);\n    }\n\n    const updateRoi = (newRoi: DefaultRois) => {\n        dispatch(compoundAnalysisActions.Actions.enableAutoStart(compoundAnalysisId));\n        setRoi(newRoi);\n    }\n\n    const frameModeSelector = <ModeSelector modes={availableModes} currentMode={frameMode} onModeChange={updateFrameMode} label=\"Mode\" />\n\n    let roiSelector = <ModeSelector modes={availableRois} currentMode={roi} onModeChange={updateRoi} label=\"ROI\" />\n\n    if (frameMode === DefaultModes.PICK) {\n        roiSelector = <></>;\n    }\n\n    const [cx, setCx] = React.useState(Math.round(scanWidth / 2));\n    const [cy, setCy] = React.useState(Math.round(scanHeight / 2));\n\n    const { coords: pickCoords, handles: pickHandles } = useFramePicker({\n        enabled: frameMode === DefaultModes.PICK,\n        scanWidth, scanHeight,\n        analysisIndex: 0,\n        compoundAnalysisId,\n        cx, cy, setCx, setCy\n    });\n\n    const { rectRoiHandles, rectRoiWidgets, rectRoiParameters } = useRectROI({ scanHeight, scanWidth })\n    const { diskRoiHandles, diskRoiWidgets, diskRoiParameters } = useDiskROI({ scanHeight, scanWidth })\n\n    const nullHandles: HandleRenderFunction = (onDragStart, onDrop) => null\n    let handles = nullHandles;\n\n    let widgets;\n    let params = { roi: {} };\n    switch (roi) {\n        case DefaultRois.DISK:\n            handles = diskRoiHandles;\n            widgets = diskRoiWidgets;\n            params = diskRoiParameters;\n            break;\n        case DefaultRois.RECT:\n            handles = rectRoiHandles;\n            widgets = rectRoiWidgets;\n            params = rectRoiParameters;\n            break;\n    }\n\n    switch (frameMode) {\n        case DefaultModes.PICK:\n            handles = pickHandles;\n            widgets = undefined;\n            break;\n    }\n\n    useRoiPicker({\n        enabled: frameMode === DefaultModes.SD && doAutoStart,\n        scanWidth, scanHeight,\n        analysisIndex: 0,\n        compoundAnalysisId,\n        roiParameters: params,\n        analysisType: AnalysisTypes.SD_FRAMES\n    })\n\n    useRoiPicker({\n        enabled: frameMode === DefaultModes.SUM && doAutoStart,\n        scanWidth, scanHeight,\n        analysisIndex: 0,\n        compoundAnalysisId,\n        roiParameters: params,\n        analysisType: AnalysisTypes.SUM_FRAMES,\n    })\n\n    const frameViewTitle = (\n        frameMode !== DefaultModes.PICK ? null : <>Pick: x={pickCoords.cx}, y={pickCoords.cy} &emsp;</>\n    )\n\n    return {\n        frameViewTitle,\n        frameModeSelector: (<>{frameModeSelector} {roiSelector}</>),\n        roiSelector,\n        handles,\n        widgets,\n    }\n}\n\nexport default useDefaultFrameView;","import React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { AnalysisParameters, AnalysisTypes } from \"../../messages\";\nimport { inRectConstraint } from \"../../widgets/constraints\";\nimport DraggableHandle from \"../../widgets/DraggableHandle\";\nimport { HandleRenderFunction } from \"../../widgets/types\";\nimport * as compoundAnalysisActions from \"../actions\";\n\nconst useFramePicker = ({\n    enabled, scanWidth, scanHeight, analysisIndex, compoundAnalysisId, cx, cy, setCx, setCy\n}: {\n    enabled: boolean, scanWidth: number, scanHeight: number,\n    analysisIndex: number, compoundAnalysisId: string,\n    cx: number, cy: number, setCx: (newCx: number) => void, setCy: (newCy: number) => void,\n}) => {\n\n    const dispatch = useDispatch();\n\n    React.useEffect(() => {\n        if (enabled) {\n            const params: AnalysisParameters = {\n                x: cx,\n                y: cy,\n            };\n\n            dispatch(compoundAnalysisActions.Actions.run(compoundAnalysisId, analysisIndex, {\n                analysisType: AnalysisTypes.PICK_FRAME,\n                parameters: params,\n            }))\n        }\n    }, [compoundAnalysisId, cx, cy, enabled, analysisIndex, dispatch]);\n\n    const onPickChange = (pickX: number, pickY: number) => {\n        const newX = Math.round(pickX);\n        const newY = Math.round(pickY);\n        if (cx === newX && cy === newY) {\n            return;\n        }\n        setCx(newX);\n        setCy(newY);\n    }\n\n    const renderPickHandle: HandleRenderFunction = (onDragStart, onDrop) => (\n        <DraggableHandle x={cx} y={cy} withCross={true}\n            imageWidth={scanWidth}\n            onDragMove={onPickChange}\n            parentOnDragStart={onDragStart}\n            parentOnDrop={onDrop}\n            constraint={inRectConstraint(scanWidth, scanHeight)} />\n    )\n\n    return { coords: { cx, cy }, handles: renderPickHandle };\n}\n\nexport default useFramePicker;","import * as React from \"react\";\nimport { Dropdown, DropdownProps } from \"semantic-ui-react\";\n\n\ntype ModeOptions = Array<{\n    text: string;\n    value: any;\n}>;\n\ninterface ModeSelectorProps {\n    modes: ModeOptions,\n    currentMode: any,\n    onModeChange: (mode: any) => void,\n    label: string,\n}\n\nconst ModeSelector: React.FunctionComponent<ModeSelectorProps> = ({\n    modes, currentMode, onModeChange, label\n}) => {\n\n    const onChange = (e: React.SyntheticEvent, data: DropdownProps) => {\n        onModeChange(data.value)\n    }\n\n    return (\n        <>\n            <div>\n                {label}:{' '}\n                <Dropdown\n                    inline={true}\n                    options={modes}\n                    value={currentMode}\n                    onChange={onChange}\n                />\n            </div>\n        </>\n    )\n}\n\nexport default ModeSelector;","import * as React from \"react\";\nimport { defaultMaskStyles } from \"./styles\";\n\nexport interface RectProps {\n    imageWidth: number,\n    imageHeight: number,\n    x: number,\n    y: number,\n    width: number,\n    height: number,\n}\n\nconst Rect: React.SFC<RectProps> = ({ imageWidth, imageHeight, x, y, width, height }) => {\n    let ymin: number;\n    let xmin: number;\n    if (height*width > 0) {\n    ymin = Math.min(y, y+height);\n    xmin = Math.min(x, x+width);}\n    else if (height > 0 && width < 0) \n    {ymin = y;\n    xmin = x+width;}\n    else \n    {ymin = y+height;\n    xmin = x;}\n    return (\n        <rect x={xmin + .5} y={ymin + .5} width={Math.abs(width)} height={Math.abs(height)} style={{ ...defaultMaskStyles(imageWidth) }} />\n    );\n}\n\nexport default Rect;\n\n","import * as React from \"react\";\nimport { useState } from \"react\";\n\nimport { FrameParams } from \"../../../messages\";\nimport DraggableHandle from \"../../../widgets/DraggableHandle\";\nimport Rect from \"../../../widgets/Rect\";\nimport { HandleRenderFunction } from \"../../../widgets/types\";\n\n\nconst useRectROI = ({ scanWidth, scanHeight }: {\n    scanWidth: number;\n    scanHeight: number;\n}) => {\n    const minLength = Math.min(scanWidth, scanHeight);\n    const [x, setx] = useState(scanWidth / 2);\n    const [y, sety] = useState(scanHeight / 2);\n    const [width, setwidth] = useState(minLength / 8);\n    const [height, setheight] = useState(minLength / 8);\n\n\n    const rectRoiParameters: FrameParams = {\n        roi: {\n            shape: \"rect\",\n            x,\n            y,\n            width,\n            height,\n        },\n    }\n\n\n    const handleCornerChange = (newx: number, newy: number) => {\n        setx(newx);\n        sety(newy);\n    };\n\n    const handleShapeChange = (newx: number, newy: number) => {\n        setwidth(newx - x);\n        setheight(newy - y);\n    };\n\n    const smthHandle = {\n        x: x + width,\n        y: y + height,\n    }\n\n    const rectRoiHandles: HandleRenderFunction = (handleDragStart, handleDrop) => (<>\n        <DraggableHandle x={x} y={y}\n            imageWidth={scanWidth}\n            onDragMove={handleCornerChange}\n            parentOnDragStart={handleDragStart}\n            parentOnDrop={handleDrop} />\n        <DraggableHandle x={smthHandle.x} y={smthHandle.y}\n            imageWidth={scanWidth}\n            onDragMove={handleShapeChange}\n            parentOnDragStart={handleDragStart}\n            parentOnDrop={handleDrop} />\n    </>);\n\n    const rectRoiWidgets = (\n        <Rect x={x} y={y} width={width} height={height}\n            imageWidth={scanWidth} imageHeight={scanHeight}\n        />\n    );\n\n    return {\n        rectRoiParameters,\n        rectRoiHandles,\n        rectRoiWidgets,\n    };\n};\n\nexport { useRectROI };\n\n","import * as React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { AnalysisTypes, FrameParams } from \"../../../messages\";\nimport * as analysisActions from \"../../actions\";\n\n\nconst useRoiPicker = ({ compoundAnalysisId, enabled, analysisIndex, roiParameters, analysisType }: {\n    scanWidth: number;\n    scanHeight: number;\n    enabled: boolean;\n    analysisIndex: number,\n    compoundAnalysisId: string;\n    roiParameters: FrameParams;\n    analysisType: AnalysisTypes.SD_FRAMES | AnalysisTypes.SUM_FRAMES\n}) => {\n    const dispatch = useDispatch();\n\n    React.useEffect(() => {\n        const handle = setTimeout(() => {\n            if (enabled) {\n                const analysisDetails = {\n                    analysisType,\n                    parameters: roiParameters,\n                };\n                dispatch(analysisActions.Actions.run(compoundAnalysisId, analysisIndex, analysisDetails))\n            }\n        }, 100);\n\n        return () => clearTimeout(handle);\n        // rules-of-hooks can't be statically validated here\n        // eslint-disable-next-line\n    }, [analysisType, compoundAnalysisId, enabled, analysisIndex, JSON.stringify(roiParameters), dispatch]);\n\n    return {\n    };\n};\n\nexport { useRoiPicker };\n\n","import * as React from \"react\";\nimport { useState } from \"react\";\n\nimport { FrameParams } from \"../../../messages\";\nimport { cbToRadius, inRectConstraint, keepOnCY } from \"../../../widgets/constraints\";\nimport Disk from \"../../../widgets/Disk\";\nimport DraggableHandle from \"../../../widgets/DraggableHandle\";\nimport { HandleRenderFunction } from \"../../../widgets/types\";\n\nconst useDiskROI = ({ scanWidth, scanHeight }: {\n    scanWidth: number;\n    scanHeight: number;\n}) => {\n    const minLength = Math.min(scanWidth, scanHeight);\n    const [cx, setCx] = useState(scanWidth / 2);\n    const [cy, setCy] = useState(scanHeight / 2);\n    const [r, setR] = useState(minLength / 8);\n\n\n    const diskRoiParameters: FrameParams = {\n        roi: {\n            shape: \"disk\",\n            cx,\n            cy,\n            r,\n        },\n    }\n\n\n    const handleCenterChange = (newCx: number, newCy: number) => {\n        setCx(newCx);\n        setCy(newCy);\n    };\n\n    const handleRChange = (newR: number) => {\n        setR(newR);\n    };\n\n    const rHandle = {\n        x: cx - r,\n        y: cy,\n    }\n\n    const diskRoiHandles: HandleRenderFunction = (handleDragStart, handleDrop) => (<>\n        <DraggableHandle x={cx} y={cy}\n            imageWidth={scanWidth}\n            onDragMove={handleCenterChange}\n            parentOnDragStart={handleDragStart}\n            parentOnDrop={handleDrop}\n            constraint={inRectConstraint(scanWidth, scanHeight)} />\n        <DraggableHandle x={rHandle.x} y={rHandle.y}\n            imageWidth={scanWidth}\n            onDragMove={cbToRadius(cx, cy, handleRChange)}\n            parentOnDragStart={handleDragStart}\n            parentOnDrop={handleDrop}\n            constraint={keepOnCY(cy)} />\n    </>);\n\n    const diskRoiWidgets = (\n        <Disk cx={cx} cy={cy} r={r}\n            imageWidth={scanWidth} imageHeight={scanHeight}\n        />\n    );\n\n    return {\n        diskRoiParameters,\n        diskRoiHandles,\n        diskRoiWidgets,\n    };\n};\n\nexport { useDiskROI };\n\n","import * as React from \"react\";\nimport { Grid, Header, Icon, Segment } from \"semantic-ui-react\";\n\ninterface AnalysisLayoutTwoColProps {\n    title: string,\n    subtitle: React.ReactNode,\n    left: React.ReactNode,\n    right: React.ReactNode,\n    toolbar?: React.ReactNode,\n}\n\ntype MergedProps = AnalysisLayoutTwoColProps;\n\nconst AnalysisLayoutTwoCol: React.SFC<MergedProps> = ({\n    title, subtitle,\n    left, right,\n    toolbar,\n}) => {\n    return (\n        <>\n            <Header as='h3' attached=\"top\">\n                <Icon name=\"cog\" />\n                <Header.Content>{title}</Header.Content>\n            </Header>\n            <Segment attached={true}>\n                <Grid columns={2}>\n                    <Grid.Row>\n                        <Grid.Column>\n                            {left}\n                            <p>{subtitle}</p>\n                        </Grid.Column>\n                        <Grid.Column>\n                            {right}\n                        </Grid.Column>\n                    </Grid.Row>\n                </Grid>\n            </Segment>\n            {toolbar}\n        </>\n    )\n}\n\nexport default AnalysisLayoutTwoCol","export function getApiBasePath() {\n    const loc = window.location.pathname;\n\n    if(loc.endsWith('/')) {\n        return `${loc}api/`;\n    } else {\n        return `${loc}/api/`;\n    }\n}\n\nexport function getApiWSURL() {\n    const basePath = getApiBasePath();\n    return `ws://${window.location.hostname}:${window.location.port}${basePath}events/`;\n}\n\nexport async function genericDelete(path: string) {\n    const basePath = getApiBasePath();\n    const r = await fetch(`${basePath}${path}`, {\n        credentials: \"same-origin\",\n        method: \"DELETE\",\n    });\n    return await r.json();\n}\n\nexport async function genericPut(path: string, payload: object) {\n    const basePath = getApiBasePath();\n    const r = await fetch(`${basePath}${path}`, {\n        body: JSON.stringify(payload),\n        credentials: \"same-origin\",\n        method: \"PUT\",\n    });\n    return await r.json();\n}","import { genericDelete, genericPut, getApiBasePath } from \"../helpers/apiHelpers\";\nimport { AnalysisDetails, CompoundAnalysisDetails, CopyNotebookResponse, CreateAnalysisResponse, CreateCompoundAnalysisResponse, CreateOrUpdateAnalysisRequest, CreateOrUpdateCompoundAnalysisRequest, RemoveAnalysisResponse, RemoveCompoundAnalysisResponse } from \"../messages\";\n\nexport async function createOrUpdateAnalysis(\n    compoundAnalysisId: string, analysisId: string,\n    dataset: string, details: AnalysisDetails\n): Promise<CreateAnalysisResponse> {\n    const payload: CreateOrUpdateAnalysisRequest = {\n        dataset,\n        details,\n    };\n    return await genericPut(`compoundAnalyses/${compoundAnalysisId}/analyses/${analysisId}/`, payload);\n}\n\nexport async function removeAnalysis(compoundAnalysisId: string, analysisId: string): Promise<RemoveAnalysisResponse> {\n    return await genericDelete(`compoundAnalyses/${compoundAnalysisId}/analyses/${analysisId}/`)\n}\n\nexport async function createOrUpdateCompoundAnalysis(compoundAnalysisId: string, dataset: string, details: CompoundAnalysisDetails): Promise<CreateCompoundAnalysisResponse> {\n    const payload: CreateOrUpdateCompoundAnalysisRequest = {\n        dataset,\n        details,\n    };\n    return await genericPut(`compoundAnalyses/${compoundAnalysisId}/`, payload);\n}\n\nexport async function removeCompoundAnalysis(compoundAnalysisId: string): Promise<RemoveCompoundAnalysisResponse> {\n    return await genericDelete(`compoundAnalyses/${compoundAnalysisId}/`)\n}\n\nexport async function getNotebook(compoundAnalysisId: string): Promise<CopyNotebookResponse>{\n    const basePath = getApiBasePath();\n    const url = `${basePath}compoundAnalyses/${compoundAnalysisId}/copy/notebook/`;\n    const r = await fetch(url, {\n        method: 'GET',\n        credentials: \"same-origin\",\n    });\n    return await r.json();\n}\n","import { AnalysisTypes } from \"../messages\";\nimport { CompoundAnalysisMetadata, CompoundAnalysisMetadataItem } from \"./types\";\n// keyof typeof: https://stackoverflow.com/a/42623905/540644\nexport const getMetadata = (typeName: keyof typeof AnalysisTypes): CompoundAnalysisMetadataItem => {\n    const type: AnalysisTypes = AnalysisTypes[typeName];\n    return CompoundAnalysisMetadata[type];\n};\n","import * as React from \"react\";\nimport { useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { Button, Dropdown, DropdownProps, Header, Icon, Modal, Segment, Tab} from \"semantic-ui-react\";\nimport { AnalysisState } from \"../../analysis/types\";\nimport { getApiBasePath } from \"../../helpers/apiHelpers\";\nimport { JobStatus } from \"../../job/types\";\nimport { CopyAnalysis } from \"../../messages\";\nimport { RootReducer } from \"../../store\";\nimport { getNotebook } from '../api'\nimport { getMetadata } from \"../getMetadata\";\nimport { CompoundAnalysisState } from \"../types\";\n\ninterface DownloadItemsProps {\n    compoundAnalysis: CompoundAnalysisState,\n    currentFormat?: string,\n}\n\nconst DownloadItems: React.SFC<DownloadItemsProps> = ({\n    compoundAnalysis, currentFormat\n}) => {\n\n    const basePath = getApiBasePath();\n    const downloadUrl = (analysisId: string) => (\n        `${basePath}compoundAnalyses/${compoundAnalysis.compoundAnalysis}/analyses/${analysisId}/download/${currentFormat}/`\n    )\n\n    const analysesById = useSelector((state: RootReducer) => {\n        return state.analyses.byId;\n    });\n\n    const jobsById = useSelector((state: RootReducer) => {\n        return state.jobs.byId;\n    });\n\n    const analyses = compoundAnalysis.details.analyses.map(analysis => {\n        return analysesById[analysis];\n    }).filter(analysis => {\n        return analysis.jobs.some(jobId => jobsById[jobId].status === JobStatus.SUCCESS);\n    })\n\n    const getAnalysisDescription = (analysis: AnalysisState) => {\n        return getMetadata(analysis.details.analysisType).desc;\n    }\n\n    const getDownloadChannels = (analysis: AnalysisState) => {\n        if(!analysis.displayedJob) {\n            return [];\n        }\n        return jobsById[analysis.displayedJob].results.filter(\n            result => result.description.includeInDownload\n        ).map(\n            result => result.description.title\n        )\n    }\n\n    return (\n        <ul>\n            {analyses.map((analysis) => {\n                return (\n                    <li key={analysis.id}>\n                        <a href={downloadUrl(analysis.id)}>\n                            {getAnalysisDescription(analysis)} (channels: {getDownloadChannels(analysis).join(\", \")})\n                        </a>\n                    </li>\n                );\n            })}\n        </ul>\n    )\n}\n\ninterface DownloadItemsProps {\n    compoundAnalysis: CompoundAnalysisState,\n}\n\nconst CopyScripts: React.SFC<DownloadItemsProps> = ({ compoundAnalysis }) => {\n    const initialAnalysis: CopyAnalysis[] = [\n        {\n            analysis: \"\",\n            plot: [\"\"],\n        },\n    ];\n\n    const [notebook, setNotebook] = useState({\n        dependency: \"\",\n        initial_setup: \"\",\n        ctx: \"\",\n        dataset: \"\",\n        analysis: initialAnalysis,\n    });\n\n    const cell = (code: string) => {\n        const copy = () => {\n            navigator.clipboard.writeText(code);\n        };\n\n        return (\n            <Segment padded={true}>\n                <Button floated={\"right\"} icon={\"copy\"} onClick={copy} />\n                <pre>{code}</pre>\n            </Segment>\n        );\n    };\n\n    const copyCompleteNotebook = () => {\n        const firstPart = [notebook.dependency, notebook.initial_setup, notebook.ctx, notebook.dataset].join(\"\\n\\n\");\n        const joinCode = (analysis: CopyAnalysis) => {\n                return `${analysis.analysis}\\n${analysis.plot.join(\"\\n\\n\")}`\n        }\n        const secondPart = notebook.analysis.map(joinCode).join(\"\\n\\n\");\n        navigator.clipboard.writeText(`${firstPart}\\n\\n${secondPart}`);\n    };\n\n    useEffect(() => {\n        const copyNotebook = async () => {\n            await getNotebook(compoundAnalysis.compoundAnalysis).then(CurrentNotebook => {\n                setNotebook({\n                    dependency: CurrentNotebook.dependency,\n                    initial_setup: CurrentNotebook.initial_setup,\n                    ctx: CurrentNotebook.ctx,\n                    dataset: CurrentNotebook.dataset,\n                    analysis: CurrentNotebook.analysis,\n                });\n            });\n        };\n        copyNotebook();\n    }, [compoundAnalysis.compoundAnalysis]);\n\n    return (\n        <>\n            <Segment clearing={true}>\n                <Header floated={\"left\"}>Notebook</Header>\n                <Button icon={true} labelPosition=\"left\" floated={\"right\"} onClick={copyCompleteNotebook}>\n                    <Icon name=\"copy\" />\n                    Complete notebook\n                </Button>\n            </Segment>\n            <Modal.Content scrolling={true}>\n                {[notebook.dependency, notebook.initial_setup, notebook.ctx, notebook.dataset].map(cell)}\n                {notebook.analysis.map(analysis => {\n                    return (\n                        <>\n                            {cell(analysis.analysis)}\n                            {analysis.plot.map(cell)}\n                        </>\n                    );\n                })}\n            </Modal.Content>\n        </>\n    );\n}; \n\n\nconst DownloadScripts: React.SFC<DownloadItemsProps> = ({ compoundAnalysis }) => {\n    const basePath = getApiBasePath();\n    const downloadUrl = `${basePath}compoundAnalyses/${compoundAnalysis.compoundAnalysis}/download/notebook/`;\n\n    return (\n        <ul>\n            <li>\n                <a href={downloadUrl}>notebook corresponding to analysis</a>\n            </li>\n        </ul>\n    );\n};\n\ninterface DownloadProps {\n    compoundAnalysis: CompoundAnalysisState,\n}\n\ntype FormatOptions = Array<{\n    text: string;\n    value: any;\n}>;\n\nconst Download: React.SFC<DownloadProps> = ({ compoundAnalysis }) => {\n    const formats = useSelector((state: RootReducer) => state.config.resultFileFormats);\n    const formatOptions: FormatOptions = Object.keys(formats).map(identifier => {\n        return {\n            value: identifier,\n            text: formats[identifier].description,\n        }\n    });\n\n    const [currentFormat, setFormat] = useState(formatOptions[0]?.value);\n\n    // we may be called before the config is completely loaded, so we\n    // need to set the format after the list of formats is available\n    React.useEffect(() => {\n        if(formatOptions.length !== 0 && !currentFormat) {\n            setFormat(formatOptions[0].value);\n        }\n    }, [formatOptions, currentFormat])\n\n    const onFormatChange = (e: React.SyntheticEvent, data: DropdownProps) => {\n        setFormat(data.value);\n    }\n\n    const panes = [\n        {\n            menuItem: \"Download result\",\n            render: () => (\n                <Tab.Pane>\n                    <Header >\n                        Download Results, format: <Dropdown inline={true} options={formatOptions} onChange={onFormatChange} value={currentFormat} />\n                    </Header>\n                    <Header as=\"h3\">Available results:</Header>\n                    <DownloadItems compoundAnalysis={compoundAnalysis} currentFormat={currentFormat} />\n                </Tab.Pane>\n            ),\n        },\n        {\n            menuItem: \"Download notebook\",\n            render: () => (\n                <Tab.Pane>\n                    <Header as=\"h3\">Available scripts: </Header>\n                    <DownloadScripts compoundAnalysis={compoundAnalysis} />\n                </Tab.Pane>\n            ),\n        },\n        {\n            menuItem: \"Copy notebook\",\n            render: () => (\n                <Tab.Pane>\n                    <CopyScripts compoundAnalysis={compoundAnalysis} />\n                </Tab.Pane>\n            ),\n        },\n    ];\n      \n\n    return (\n        <Modal trigger={\n            <Button icon={true}>\n                <Icon name='download' />\n                Download\n            </Button>\n        }>\n            <Tab panes={panes} />\n        </Modal>\n    );\n}\n\nexport default Download;","import * as React from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Button, Icon, IconProps, Segment } from \"semantic-ui-react\";\nimport { RootReducer } from \"../../store\";\nimport * as analysisActions from \"../actions\";\nimport { getAnalysisStatus } from \"../helpers\";\nimport { CompoundAnalysisState } from \"../types\";\nimport Download from \"./Download\";\n\ninterface ToolbarProps {\n    compoundAnalysis: CompoundAnalysisState,\n    busyIdxs: number[],\n    onApply: () => void,\n}\n\n\ntype MergedProps = ToolbarProps;\n\nconst Toolbar: React.SFC<MergedProps> = ({ busyIdxs, onApply, compoundAnalysis }) => {\n    const dispatch = useDispatch();\n    const handleRemove = () => dispatch(analysisActions.Actions.remove(compoundAnalysis.compoundAnalysis));\n    const analyses = useSelector((state: RootReducer) => state.analyses);\n    const jobs = useSelector((state: RootReducer) => state.jobs);\n    const status = getAnalysisStatus(\n        compoundAnalysis, analyses, jobs,\n        busyIdxs\n    );\n    const running = status === \"busy\";\n    const applyIconProps: IconProps = running ? { name: 'cog', loading: true } : { name: 'check' }\n\n    return (\n        <Segment attached=\"bottom\">\n            <Button.Group>\n                <Button primary={true} onClick={onApply} icon={true}>\n                    <Icon {...applyIconProps} />\n                    Apply\n                </Button>\n                <Download compoundAnalysis={compoundAnalysis} />\n                <Button onClick={handleRemove} icon={true}>\n                    <Icon name='remove' />\n                    Remove\n                </Button>\n            </Button.Group>\n        </Segment>\n    );\n}\n\nexport default Toolbar;","import { AnalysisReducerState } from \"../analysis/reducers\";\nimport { JobReducerState } from \"../job/reducers\";\nimport { JobRunning } from \"../job/types\";\nimport { CompoundAnalysisState } from \"./types\";\n\nexport const getAnalysisStatus = (compoundAnalysis: CompoundAnalysisState, analyses: AnalysisReducerState, jobs: JobReducerState, analysisIdxsToInclude: number[] = []): \"idle\" | \"busy\" => {\n    let filteredAnalyses = compoundAnalysis.details.analyses;\n\n    if (analysisIdxsToInclude.length > 0) {\n        filteredAnalyses = filteredAnalyses.filter((analysisId: string, idx: number) => {\n            return analysisIdxsToInclude.indexOf(idx) !== -1;\n        })\n    }\n\n    return filteredAnalyses.reduce((prevValue: \"idle\" | \"busy\", analysisId: string) => {\n        const analysis = analyses.byId[analysisId];\n        if(!analysis) {\n            return prevValue; // no analysis, so \"all jobs\" are done\n        }\n        const allDone = analysis.jobs.every(\n            jobId => jobs.byId[jobId].running === JobRunning.DONE\n        );\n        return allDone ? prevValue : \"busy\";\n    }, \"idle\");\n}","import * as React from \"react\";\nimport { useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { defaultDebounce } from \"../../helpers\";\nimport ResultList from \"../../job/components/ResultList\";\nimport { AnalysisTypes } from \"../../messages\";\nimport { cbToRadius, inRectConstraint, keepOnCY } from \"../../widgets/constraints\";\nimport Disk from \"../../widgets/Disk\";\nimport { DraggableHandle } from \"../../widgets/DraggableHandle\";\nimport { HandleRenderFunction } from \"../../widgets/types\";\nimport * as compoundAnalysisActions from \"../actions\";\nimport { CompoundAnalysisProps } from \"../types\";\nimport useDefaultFrameView from \"./DefaultFrameView\";\nimport AnalysisLayoutTwoCol from \"./layouts/AnalysisLayoutTwoCol\";\nimport Toolbar from \"./Toolbar\";\n\nconst CenterOfMassAnalysis: React.SFC<CompoundAnalysisProps> = ({ compoundAnalysis, dataset }) => {\n    const { shape } = dataset.params;\n    const [scanHeight, scanWidth, imageHeight, imageWidth] = shape;\n    const minLength = Math.min(imageWidth, imageHeight);\n    const [cx, setCx] = useState(imageWidth / 2);\n    const [cy, setCy] = useState(imageHeight / 2);\n    const [r, setR] = useState(minLength / 4);\n\n    const dispatch = useDispatch();\n\n    const rHandle = {\n        x: cx - r,\n        y: cy,\n    }\n\n    const handleCenterChange = defaultDebounce((newCx: number, newCy: number) => {\n        setCx(newCx);\n        setCy(newCy);\n    });\n    const handleRChange = defaultDebounce(setR);\n\n    const frameViewHandles: HandleRenderFunction = (handleDragStart, handleDrop) => (<>\n        <DraggableHandle x={cx} y={cy}\n            imageWidth={imageWidth}\n            onDragMove={handleCenterChange}\n            parentOnDragStart={handleDragStart}\n            parentOnDrop={handleDrop}\n            constraint={inRectConstraint(imageWidth, imageHeight)} />\n        <DraggableHandle x={rHandle.x} y={rHandle.y}\n            imageWidth={imageWidth}\n            onDragMove={cbToRadius(cx, cy, handleRChange)}\n            parentOnDragStart={handleDragStart}\n            parentOnDrop={handleDrop}\n            constraint={keepOnCY(cy)} />\n    </>);\n\n    const frameViewWidgets = (\n        <Disk cx={cx} cy={cy} r={r}\n            imageWidth={imageWidth} imageHeight={imageHeight} />\n    )\n\n    const {\n        frameViewTitle, frameModeSelector,\n        handles: resultHandles, widgets: resultWidgets\n    } = useDefaultFrameView({\n        scanWidth,\n        scanHeight,\n        compoundAnalysisId: compoundAnalysis.compoundAnalysis,\n        doAutoStart: compoundAnalysis.doAutoStart,\n    })\n\n    const subtitle = <>{frameViewTitle} Disk: center=(x={cx.toFixed(2)}, y={cy.toFixed(2)}), r={r.toFixed(2)}</>;\n\n    const runAnalysis = () => {\n        dispatch(compoundAnalysisActions.Actions.run(compoundAnalysis.compoundAnalysis, 1, {\n            analysisType: AnalysisTypes.CENTER_OF_MASS,\n            parameters: {\n                shape: \"com\",\n                cx,\n                cy,\n                r\n            }\n        }));\n    };\n\n    const toolbar = <Toolbar compoundAnalysis={compoundAnalysis} onApply={runAnalysis} busyIdxs={[1]} />\n\n    return (\n        <AnalysisLayoutTwoCol\n            title=\"COM analysis\" subtitle={subtitle}\n            left={<>\n                <ResultList\n                    extraHandles={frameViewHandles} extraWidgets={frameViewWidgets}\n                    analysisIndex={0} compoundAnalysis={compoundAnalysis.compoundAnalysis}\n                    width={imageWidth} height={imageHeight}\n                    selectors={frameModeSelector}\n                />\n            </>}\n            right={<>\n                <ResultList\n                    analysisIndex={1} compoundAnalysis={compoundAnalysis.compoundAnalysis}\n                    width={scanWidth} height={scanHeight}\n                    extraHandles={resultHandles}\n                    extraWidgets={resultWidgets}\n                />\n            </>}\n            toolbar={toolbar}\n        />\n    );\n}\n\nexport default CenterOfMassAnalysis;","// from https://stackoverflow.com/a/45100420/540644\nexport function getPathArc(center: { x: number, y: number }, start: number, end: number, radius: number) {\n    if (end === start) { end += 360; }\n    let degree = end - start;\n    degree = degree < 0 ? (degree + 360) : degree;\n    const points = [];\n    points.push(getLocationFromAngle(start, radius, center));\n    points.push(getLocationFromAngle(start + degree / 3, radius, center));\n    points.push(getLocationFromAngle(start + degree * 2 / 3, radius, center));\n    points.push(getLocationFromAngle(end, radius, center));\n    return getCirclePath(points, radius, (degree < 180) ? 0 : 1);\n}\n\nfunction getCirclePath(points: Array<{ x: number, y: number }>, radius: number, clockWise: 0 | 1) {\n    return ['M', points[0].x, points[0].y,\n        'A', radius, radius, 0, 0, clockWise, points[1].x, points[1].y,\n        'A', radius, radius, 0, 0, clockWise, points[2].x, points[2].y,\n        'A', radius, radius, 0, 0, clockWise, points[3].x, points[3].y\n    ].join(' ');\n}\n\nfunction getLocationFromAngle(degree: number, radius: number, center: { x: number, y: number }) {\n    const radian = (degree * Math.PI) / 180;\n    return {\n        x: Math.cos(radian) * radius + center.x,\n        y: Math.sin(radian) * radius + center.y\n    }\n}\n","import * as React from \"react\";\nimport { getPathArc } from \"../helpers/svg\";\nimport { defaultMaskStyles } from \"./styles\";\n\nexport interface RingProps {\n    imageWidth: number,\n    cx: number,\n    cy: number,\n    ri: number,\n    ro: number,\n}\n\nconst Ring: React.SFC<RingProps> = ({ imageWidth, cx, cy, ri, ro }) => {\n    // see also: https://stackoverflow.com/a/37883328/540644\n    const pathSpecs = [\n        getPathArc({ x: cx + .5, y: cy + .5 }, 90, 90, ro),\n        getPathArc({ x: cx + .5, y: cy + .5 }, 90, 90, ri)\n    ]\n    const pathSpec = pathSpecs.join(' ');\n\n    return (\n        <path d={pathSpec} fillRule=\"evenodd\" style={{ ...defaultMaskStyles(imageWidth) }} />\n    );\n}\n\nexport default Ring;","import * as React from \"react\";\nimport { Grid, Header, Icon, Segment } from \"semantic-ui-react\";\n\ninterface AnalysisLayoutTwoResProps {\n    title: string,\n    subtitle: React.ReactNode,\n    left: React.ReactNode,\n    mid: React.ReactNode,\n    right: React.ReactNode,\n    clustparams: React.ReactNode,\n    toolbar?: React.ReactNode,\n    title1: string, \n    title2: React.ReactNode,\n    title3:string,\n\n}\n\ntype MergedProps = AnalysisLayoutTwoResProps;\n\nconst AnalysisLayoutTwoRes: React.SFC<MergedProps> = ({\n    title, subtitle,\n    left, mid, right,\n    toolbar, clustparams, title1, title2, title3\n}) => {\n    return (\n        <>\n            <Header as='h3' attached=\"top\">\n                <Icon name=\"cog\" />\n                <Header.Content>{title}</Header.Content>\n            </Header>\n            <Segment attached={true}>\n                <Grid columns={3}>\n                    <Grid.Row>\n                        <Grid.Column width={4}>\n                            <p>{title1}</p>\n                        </Grid.Column> \n\n                        <Grid.Column width={6}>\n                            <p>{title2}</p>   \n\n                        </Grid.Column>\n\n                        <Grid.Column width={6}>\n                            <p>{title3}</p>\n                        </Grid.Column>    \n                    </Grid.Row>\n\n                    <Grid.Row>\n                        <Grid.Column width={4}>\n                            {left}\n                        </Grid.Column>\n\n                        <Grid.Column width={6}>\n                            {mid}\n                        </Grid.Column>\n\n                        <Grid.Column width={6}>\n                            {right}\n                        </Grid.Column>\n\n                    </Grid.Row>\n\n                    <Grid.Row>\n                        <Grid.Column width={16}>\n\n                            <div>{clustparams}</div>\n                            <p>{subtitle}</p>\n\n                        </Grid.Column>\n\n                    </Grid.Row>\n                </Grid>\n                \n            </Segment>\n            \n            {toolbar}\n        </>\n    )\n}\n\nexport default AnalysisLayoutTwoRes","import * as React from \"react\";\nimport { useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { Accordion, Form, Icon } from \"semantic-ui-react\";\nimport { defaultDebounce } from \"../../helpers\";\nimport ResultList from \"../../job/components/ResultList\";\nimport { AnalysisTypes } from \"../../messages\";\nimport { cbToRadius, inRectConstraint, riConstraint, roConstraints } from \"../../widgets/constraints\";\nimport DraggableHandle from \"../../widgets/DraggableHandle\";\nimport Ring from \"../../widgets/Ring\";\nimport { HandleRenderFunction } from \"../../widgets/types\";\nimport * as compoundAnalysisActions from \"../actions\";\nimport { CompoundAnalysisProps } from \"../types\";\nimport useDefaultFrameView from \"./DefaultFrameView\";\nimport AnalysisLayoutTwoRes from \"./layouts/AnalysisLayoutTwoRes\";\nimport { useRectROI } from \"./roi/RectROI\";\nimport Toolbar from \"./Toolbar\";\n\n\nconst ClustAnalysis: React.SFC<CompoundAnalysisProps> = ({ compoundAnalysis, dataset }) => {\n    const { shape } = dataset.params;\n    const [scanHeight, scanWidth, imageHeight, imageWidth] = shape;\n    const minLength = Math.min(imageWidth, imageHeight);\n\n    const [cx, setCx] = useState(imageWidth / 2);\n    const [cy, setCy] = useState(imageHeight / 2);\n    const [ri, setRi] = useState(minLength / 4);\n    const [ro, setRo] = useState(minLength / 2);\n\n    const riHandle = {\n        x: cx - ri,\n        y: cy,\n    }\n    const roHandle = {\n        x: cx - ro,\n        y: cy,\n    }\n\n    const [minDist, setMinDist] = React.useState(1);\n\n    const minDistChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n        setMinDist(event.target.valueAsNumber);\n    }\n\n    const [nPeaks, setNPeaks] = React.useState(500);\n\n    const peakChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n        setNPeaks(event.target.valueAsNumber);\n    }\n\n    const [nClust, setNClust] = React.useState(20);\n\n    const clustChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n        setNClust(event.target.valueAsNumber);\n    }\n\n    const handleCenterChange = defaultDebounce((newCx: number, newCy: number) => {\n        setCx(newCx);\n        setCy(newCy);\n    });\n    const handleRIChange = defaultDebounce(setRi);\n    const handleROChange = defaultDebounce(setRo);\n\n    const frameViewHandles: HandleRenderFunction = (handleDragStart, handleDrop) => (<>\n        <DraggableHandle x={cx} y={cy}\n            imageWidth={imageWidth}\n            onDragMove={handleCenterChange}\n            parentOnDrop={handleDrop}\n            parentOnDragStart={handleDragStart}\n            constraint={inRectConstraint(imageWidth, imageHeight)} />\n        <DraggableHandle x={roHandle.x} y={roHandle.y}\n            imageWidth={imageWidth}\n            onDragMove={cbToRadius(cx, cy, handleROChange)}\n            parentOnDrop={handleDrop}\n            parentOnDragStart={handleDragStart}\n            constraint={roConstraints(riHandle.x, cy)} />\n        <DraggableHandle x={riHandle.x} y={riHandle.y}\n            imageWidth={imageWidth}\n            parentOnDrop={handleDrop}\n            parentOnDragStart={handleDragStart}\n            onDragMove={cbToRadius(cx, cy, handleRIChange)}\n            constraint={riConstraint(roHandle.x, cy)} />\n    </>);\n\n    const frameViewWidgets = (\n        <Ring cx={cx} cy={cy} ri={ri} ro={ro}\n            imageWidth={imageWidth} />\n    )\n\n    const dispatch = useDispatch();\n    const { rectRoiParameters, rectRoiHandles, rectRoiWidgets } = useRectROI({ scanWidth, scanHeight });\n\n    React.useEffect(() => {\n        if (compoundAnalysis.doAutoStart) {\n            dispatch(compoundAnalysisActions.Actions.run(compoundAnalysis.compoundAnalysis, 1, {\n                analysisType: AnalysisTypes.SUM_SIG,\n                parameters: {},\n            }))\n        }\n    }, [compoundAnalysis.compoundAnalysis, dispatch, compoundAnalysis.doAutoStart]);\n\n    const runAnalysis = () => {\n        dispatch(compoundAnalysisActions.Actions.run(compoundAnalysis.compoundAnalysis, 2, {\n            analysisType: AnalysisTypes.CLUST,\n            parameters: {\n                roi: rectRoiParameters.roi,\n                cx,\n                cy,\n                ri,\n                ro,\n                n_clust: nClust,\n                n_peaks: nPeaks,\n                min_dist: minDist\n            }\n        }));\n    };\n\n    const {\n        frameViewTitle, frameModeSelector,\n        handles: resultHandles,\n        widgets: resultWidgets,\n    } = useDefaultFrameView({\n        scanWidth,\n        scanHeight,\n        compoundAnalysisId: compoundAnalysis.compoundAnalysis,\n        doAutoStart: compoundAnalysis.doAutoStart,\n    })\n\n    const subtitle = (\n        <>{frameViewTitle} Ring: center=(x={cx.toFixed(2)}, y={cy.toFixed(2)}), ri={ri.toFixed(2)}, ro={ro.toFixed(2)}</>\n    )\n    const toolbar = <Toolbar compoundAnalysis={compoundAnalysis} onApply={runAnalysis} busyIdxs={[2]} />\n\n    const [paramsVisible, setParamsVisible] = React.useState(false);\n\n    const handleClick = (event: React.MouseEvent<HTMLDivElement>) => {\n        setParamsVisible(!paramsVisible);\n    }\n\n    const clustparams =\n        <Accordion>\n            <Accordion.Title active={paramsVisible} index={0} onClick={handleClick}>\n                <Icon name='dropdown' />\n                Parameters\n            </Accordion.Title>\n            <Accordion.Content active={paramsVisible}>\n                <Form>\n                    <Form.Field>\n                        <label> Number of clusters  <input type=\"number\" value={nClust} step=\"1\" min=\"2\" max=\"100\" onChange={clustChange} /> </label>\n                    </Form.Field>\n                    <Form.Field>\n                        <label>  Maximal number of possible peak positions to detect (better put higher value,\n        the output is limited to the number of peaks the algorithm could find)  <input type=\"number\" value={nPeaks} step=\"1\" min=\"5\" max=\"200\" onChange={peakChange} /> </label>\n                    </Form.Field>\n                    <Form.Field>\n                        <label>  Minimal distance in pixels between peaks  <input type=\"number\" value={minDist} step=\"1\" min=\"0\" max=\"100\" onChange={minDistChange} />  </label>\n                    </Form.Field>\n                </Form>\n            </Accordion.Content>\n        </Accordion>\n    return (\n        <AnalysisLayoutTwoRes\n            title=\"Region clustering\" subtitle={subtitle}\n            left={<>\n                <ResultList\n                    extraHandles={frameViewHandles} extraWidgets={frameViewWidgets}\n                    analysisIndex={0} compoundAnalysis={compoundAnalysis.compoundAnalysis}\n                    width={imageWidth} height={imageHeight}\n                    selectors={frameModeSelector}\n                />\n            </>}\n            mid={<>\n                <ResultList\n                    analysisIndex={1} compoundAnalysis={compoundAnalysis.compoundAnalysis}\n                    width={scanWidth} height={scanHeight}\n                    extraHandles={rectRoiHandles}\n                    extraWidgets={rectRoiWidgets}\n                />\n            </>}\n\n            right={<>\n                <ResultList\n                    analysisIndex={2} compoundAnalysis={compoundAnalysis.compoundAnalysis}\n                    width={scanWidth} height={scanHeight}\n                    extraHandles={resultHandles}\n                    extraWidgets={resultWidgets}\n                />\n            </>}\n            toolbar={toolbar}\n            clustparams={clustparams}\n\n            title1=\"Peaks inside the ring will be considered\"\n            title2=\"Choose specimen region\"\n            title3=\"Clustering result\"\n\n        />\n    );\n}\n\nexport default ClustAnalysis;","import * as React from \"react\";\nimport { useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport ResultList from \"../../job/components/ResultList\";\nimport { AnalysisTypes } from \"../../messages\";\nimport { cbToRadius, inRectConstraint, keepOnCY } from \"../../widgets/constraints\";\nimport Disk from \"../../widgets/Disk\";\nimport DraggableHandle from \"../../widgets/DraggableHandle\";\nimport { HandleRenderFunction } from \"../../widgets/types\";\nimport * as compoundAnalysisActions from \"../actions\";\nimport { CompoundAnalysisProps } from \"../types\";\nimport useDefaultFrameView from \"./DefaultFrameView\";\nimport AnalysisLayoutTwoCol from \"./layouts/AnalysisLayoutTwoCol\";\nimport Toolbar from \"./Toolbar\";\n\nconst DiskMaskAnalysis: React.SFC<CompoundAnalysisProps> = ({ compoundAnalysis, dataset }) => {\n    const { shape } = dataset.params;\n    const [scanHeight, scanWidth, imageHeight, imageWidth] = shape;\n\n    const minLength = Math.min(imageWidth, imageHeight);\n    const [cx, setCx] = useState(imageWidth / 2);\n    const [cy, setCy] = useState(imageHeight / 2);\n    const [r, setR] = useState(minLength / 4);\n\n    const handleCenterChange = (newCx: number, newCy: number) => {\n        setCx(newCx);\n        setCy(newCy);\n    };\n    const handleRChange = setR;\n\n    const rHandle = {\n        x: cx - r,\n        y: cy,\n    }\n\n    const frameViewHandles: HandleRenderFunction = (handleDragStart, handleDrop) => (<>\n        <DraggableHandle x={cx} y={cy}\n            imageWidth={imageWidth}\n            onDragMove={handleCenterChange}\n            parentOnDragStart={handleDragStart}\n            parentOnDrop={handleDrop}\n            constraint={inRectConstraint(imageWidth, imageHeight)} />\n        <DraggableHandle x={rHandle.x} y={rHandle.y}\n            imageWidth={imageWidth}\n            onDragMove={cbToRadius(cx, cy, handleRChange)}\n            parentOnDragStart={handleDragStart}\n            parentOnDrop={handleDrop}\n            constraint={keepOnCY(cy)} />\n    </>);\n\n    const frameViewWidgets = (\n        <Disk cx={cx} cy={cy} r={r}\n            imageWidth={imageWidth} imageHeight={imageHeight}\n        />\n    );\n\n    const dispatch = useDispatch();\n\n    const runAnalysis = () => {\n        dispatch(compoundAnalysisActions.Actions.run(compoundAnalysis.compoundAnalysis, 1, {\n            analysisType: AnalysisTypes.APPLY_DISK_MASK,\n            parameters: {\n                shape: \"disk\",\n                cx, cy, r\n            }\n        }));\n    };\n\n    const {\n        frameViewTitle, frameModeSelector,\n        handles: resultHandles, widgets: resultWidgets,\n    } = useDefaultFrameView({\n        scanWidth,\n        scanHeight,\n        compoundAnalysisId: compoundAnalysis.compoundAnalysis,\n        doAutoStart: compoundAnalysis.doAutoStart,\n    });\n\n    const subtitle = <>{frameViewTitle} Disk: center=(x={cx.toFixed(2)}, y={cy.toFixed(2)}), r={r.toFixed(2)}</>;\n\n    const toolbar = <Toolbar compoundAnalysis={compoundAnalysis} onApply={runAnalysis} busyIdxs={[1]} />\n\n    return (\n        <AnalysisLayoutTwoCol\n            title=\"Disk analysis\" subtitle={subtitle}\n            left={<>\n                <ResultList\n                    extraHandles={frameViewHandles} extraWidgets={frameViewWidgets}\n                    analysisIndex={0} compoundAnalysis={compoundAnalysis.compoundAnalysis}\n                    width={imageWidth} height={imageHeight}\n                    selectors={frameModeSelector}\n                />\n            </>}\n            right={<>\n                <ResultList\n                    analysisIndex={1} compoundAnalysis={compoundAnalysis.compoundAnalysis}\n                    width={scanWidth} height={scanHeight}\n                    extraHandles={resultHandles}\n                    extraWidgets={resultWidgets}\n                />\n            </>}\n            toolbar={toolbar}\n        />\n    );\n}\n\nexport default DiskMaskAnalysis;","import * as React from \"react\";\nimport { useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { defaultDebounce } from \"../../helpers\";\nimport ResultList from \"../../job/components/ResultList\";\nimport { AnalysisTypes } from \"../../messages\";\nimport { cbToRadius, inRectConstraint, riConstraint, roConstraints } from \"../../widgets/constraints\";\nimport DraggableHandle from \"../../widgets/DraggableHandle\";\nimport Ring from \"../../widgets/Ring\";\nimport { HandleRenderFunction } from \"../../widgets/types\";\nimport * as compoundAnalysisActions from \"../actions\";\nimport { CompoundAnalysisProps } from \"../types\";\nimport useDefaultFrameView from \"./DefaultFrameView\";\nimport AnalysisLayoutTwoCol from \"./layouts/AnalysisLayoutTwoCol\";\nimport Toolbar from \"./Toolbar\";\n\nconst FEMAnalysis: React.SFC<CompoundAnalysisProps> = ({ compoundAnalysis, dataset }) => {\n    const { shape } = dataset.params;\n    const [scanHeight, scanWidth, imageHeight, imageWidth] = shape;\n    const minLength = Math.min(imageWidth, imageHeight);\n\n    const [cx, setCx] = useState(imageWidth / 2);\n    const [cy, setCy] = useState(imageHeight / 2);\n    const [ri, setRi] = useState(minLength / 4);\n    const [ro, setRo] = useState(minLength / 2);\n\n    const riHandle = {\n        x: cx - ri,\n        y: cy,\n    }\n    const roHandle = {\n        x: cx - ro,\n        y: cy,\n    }\n\n    const handleCenterChange = defaultDebounce((newCx: number, newCy: number) => {\n        setCx(newCx);\n        setCy(newCy);\n    });\n    const handleRIChange = defaultDebounce(setRi);\n    const handleROChange = defaultDebounce(setRo);\n\n    const frameViewHandles: HandleRenderFunction = (handleDragStart, handleDrop) => (<>\n        <DraggableHandle x={cx} y={cy}\n            imageWidth={imageWidth}\n            onDragMove={handleCenterChange}\n            parentOnDrop={handleDrop}\n            parentOnDragStart={handleDragStart}\n            constraint={inRectConstraint(imageWidth, imageHeight)} />\n        <DraggableHandle x={roHandle.x} y={roHandle.y}\n            imageWidth={imageWidth}\n            onDragMove={cbToRadius(cx, cy, handleROChange)}\n            parentOnDrop={handleDrop}\n            parentOnDragStart={handleDragStart}\n            constraint={roConstraints(riHandle.x, cy)} />\n        <DraggableHandle x={riHandle.x} y={riHandle.y}\n            imageWidth={imageWidth}\n            parentOnDrop={handleDrop}\n            parentOnDragStart={handleDragStart}\n            onDragMove={cbToRadius(cx, cy, handleRIChange)}\n            constraint={riConstraint(roHandle.x, cy)} />\n    </>);\n\n    const frameViewWidgets = (\n        <Ring cx={cx} cy={cy} ri={ri} ro={ro}\n            imageWidth={imageWidth} />\n    )\n\n    const dispatch = useDispatch();\n\n    const runAnalysis = () => {\n        dispatch(compoundAnalysisActions.Actions.run(compoundAnalysis.compoundAnalysis, 1, {\n            analysisType: AnalysisTypes.FEM,\n            parameters: {\n                shape: \"ring\",\n                cx, cy, ri, ro,\n            }\n        }));\n    };\n\n    const {\n        frameViewTitle, frameModeSelector,\n        handles: resultHandles,\n        widgets: resultWidgets,\n    } = useDefaultFrameView({\n        scanWidth,\n        scanHeight,\n        compoundAnalysisId: compoundAnalysis.compoundAnalysis,\n        doAutoStart: compoundAnalysis.doAutoStart,\n    })\n\n    const subtitle = (\n        <>{frameViewTitle} Ring: center=(x={cx.toFixed(2)}, y={cy.toFixed(2)}), ri={ri.toFixed(2)}, ro={ro.toFixed(2)}</>\n    )\n\n    const toolbar = <Toolbar compoundAnalysis={compoundAnalysis} onApply={runAnalysis} busyIdxs={[1]} />\n\n    return (\n        <AnalysisLayoutTwoCol\n            title=\"Fluctuation EM (SD over Ring analysis)\" subtitle={subtitle}\n            left={<>\n                <ResultList\n                    extraHandles={frameViewHandles} extraWidgets={frameViewWidgets}\n                    analysisIndex={0} compoundAnalysis={compoundAnalysis.compoundAnalysis}\n                    width={imageWidth} height={imageHeight}\n                    selectors={frameModeSelector}\n                />\n            </>}\n            right={<>\n                <ResultList\n                    analysisIndex={1} compoundAnalysis={compoundAnalysis.compoundAnalysis}\n                    width={scanWidth} height={scanHeight}\n                    extraHandles={resultHandles}\n                    extraWidgets={resultWidgets}\n                />\n            </>}\n            toolbar={toolbar}\n        />\n    );\n}\n\nexport default FEMAnalysis;","import React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { AnalysisTypes } from \"../../messages\";\nimport { inRectConstraint } from \"../../widgets/constraints\";\nimport DraggableHandle from \"../../widgets/DraggableHandle\";\nimport { HandleRenderFunction } from \"../../widgets/types\";\nimport * as compoundAnalysisActions from \"../actions\";\n\nconst useFFTFramePicker = ({\n    enabled, scanWidth, scanHeight, analysisIndex, compoundAnalysisId,\n    cx, cy, real_rad, real_centerx, real_centery, setCx, setCy\n}: {\n    enabled: boolean, scanWidth: number, scanHeight: number,\n    analysisIndex: number, compoundAnalysisId: string,\n    cx: number, cy: number, setCx: (newCx: number) => void, setCy: (newCy: number) => void,\n    real_rad: number | null, real_centerx: number | null, real_centery: number | null\n}) => {\n\n    const dispatch = useDispatch();\n\n    React.useEffect(() => {\n        if (enabled) {\n            dispatch(compoundAnalysisActions.Actions.run(compoundAnalysisId, analysisIndex, {\n                analysisType: AnalysisTypes.PICK_FFT_FRAME,\n                parameters: { x: cx, y: cy, real_rad, real_centerx, real_centery },\n            }));\n        }\n    }, [compoundAnalysisId, cx, cy, enabled, analysisIndex, real_rad, real_centerx, real_centery, dispatch]);\n\n    const onPickChange = (pickX: number, pickY: number) => {\n        const newX = Math.round(pickX);\n        const newY = Math.round(pickY);\n        if (cx === newX && cy === newY) {\n            return;\n        }\n        setCx(newX);\n        setCy(newY);\n    }\n\n    const renderPickHandle: HandleRenderFunction = (onDragStart, onDrop) => (\n        <DraggableHandle x={cx} y={cy} withCross={true}\n            imageWidth={scanWidth}\n            onDragMove={onPickChange}\n            parentOnDragStart={onDragStart}\n            parentOnDrop={onDrop}\n            constraint={inRectConstraint(scanWidth, scanHeight)} />\n    )\n\n    return { coords: { cx, cy }, handles: renderPickHandle };\n}\n\nexport default useFFTFramePicker;","import React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { AnalysisTypes } from \"../../messages\";\nimport * as analysisActions from \"../actions\";\n\nconst useFFTSumFrames = ({\n    enabled, analysisIndex: jobIndex, compoundAnalysisId: analysisId, real_rad, real_centerx, real_centery\n}: {\n    enabled: boolean, analysisIndex: number, compoundAnalysisId: string, real_rad: number | null, real_centerx: number | null, real_centery: number | null\n}) => {\n    const dispatch = useDispatch();\n\n    React.useEffect(() => {\n        if (enabled) {\n            dispatch(analysisActions.Actions.run(analysisId, jobIndex, {\n                analysisType: AnalysisTypes.FFTSUM_FRAMES,\n                parameters: { real_rad, real_centerx, real_centery },\n            }));\n        }\n    }, [analysisId, enabled, jobIndex, real_rad, real_centerx, real_centery, dispatch]);\n};\n\nexport default useFFTSumFrames;\n","import * as React from \"react\";\nimport { useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { AnalysisTypes } from \"../../messages\";\nimport { HandleRenderFunction } from \"../../widgets/types\";\nimport * as compoundAnalysisActions from \"../actions\";\nimport useFFTFramePicker from \"./FFTFramePicker\";\nimport useFFTSumFrames from \"./FFTSumFrames\";\nimport useFramePicker from \"./FramePicker\";\nimport ModeSelector from \"./ModeSelector\";\nimport { useRoiPicker } from \"./roi/RoiPicker\";\n\nconst useFFTFrameView = ({\n    scanWidth, scanHeight, compoundAnalysisId, real_rad, real_centerx,\n    real_centery, doAutoStart,\n}: {\n    scanWidth: number, scanHeight: number, compoundAnalysisId: string,\n    real_rad: number | null, real_centerx: number | null, real_centery: number | null,\n    doAutoStart: boolean,\n}) => {\n    const availableModes = [\n        {\n            text: \"Pick\",\n            value: AnalysisTypes.PICK_FRAME,\n        },\n        {\n            text: \"Average\",\n            value: AnalysisTypes.SUM_FRAMES,\n        },\n    ];\n\n    const [frameMode, setMode] = useState(AnalysisTypes.SUM_FRAMES);\n\n    const dispatch = useDispatch();\n\n    const updateMode = (newMode: AnalysisTypes) => {\n        dispatch(compoundAnalysisActions.Actions.enableAutoStart(compoundAnalysisId));\n        setMode(newMode);\n    }\n\n    const frameModeSelector = <ModeSelector modes={availableModes} currentMode={frameMode} onModeChange={updateMode} label=\"Mode\" />\n\n    const [cx, setCx] = React.useState(Math.round(scanWidth / 2));\n    const [cy, setCy] = React.useState(Math.round(scanHeight / 2));\n\n    const { coords: pickCoords, handles: pickHandles } = useFramePicker({\n        enabled: frameMode === AnalysisTypes.PICK_FRAME && doAutoStart,\n        scanWidth, scanHeight,\n        analysisIndex: 1,\n        compoundAnalysisId,\n        cx, cy, setCx, setCy\n    });\n\n    useFFTFramePicker({\n        enabled: frameMode === AnalysisTypes.PICK_FRAME && doAutoStart,\n        scanWidth, scanHeight,\n        analysisIndex: 0,\n        compoundAnalysisId,\n        cx, cy, setCx, setCy, real_rad, real_centerx, real_centery\n    });\n\n    useRoiPicker({\n        enabled: frameMode === AnalysisTypes.SUM_FRAMES && doAutoStart,\n        analysisIndex: 1,\n        compoundAnalysisId,\n        scanWidth, scanHeight,\n        roiParameters: { roi: {} },\n        analysisType: AnalysisTypes.SUM_FRAMES,\n    })\n    useFFTSumFrames({\n        enabled: frameMode === AnalysisTypes.SUM_FRAMES && doAutoStart,\n        analysisIndex: 0,\n        compoundAnalysisId,\n        real_rad,\n        real_centerx,\n        real_centery\n    })\n\n    const frameViewTitle = (\n        frameMode !== AnalysisTypes.PICK_FRAME ? null : <>Pick: x={pickCoords.cx}, y={pickCoords.cy} &emsp;</>\n    )\n\n    const nullHandles: HandleRenderFunction = (onDragStart, onDrop) => null\n\n    return {\n        frameViewTitle,\n        handles: frameMode !== AnalysisTypes.PICK_FRAME ? nullHandles : pickHandles,\n\n        frameModeSelector,\n    }\n}\n\nexport default useFFTFrameView;","import * as React from \"react\";\nimport { Grid, Header, Icon, Segment } from \"semantic-ui-react\";\n\ninterface AnalysisLayoutThreeColProps {\n    title: string,\n    subtitle: React.ReactNode,\n    left: React.ReactNode,\n    mid: React.ReactNode,\n    right: React.ReactNode,\n    toolbar?: React.ReactNode,\n    title1: string,\n    title2: React.ReactNode,\n    title3: string,\n}\n\ntype MergedProps = AnalysisLayoutThreeColProps;\n\nconst AnalysisLayoutThreeCol: React.SFC<MergedProps> = ({\n    title, subtitle,\n    left, mid, right,\n    toolbar, title1, title2, title3\n}) => {\n    return (\n        <>\n            <Header as='h3' attached=\"top\">\n                <Icon name=\"cog\" />\n                <Header.Content>{title}</Header.Content>\n            </Header>\n            <Segment attached={true}>\n                <Grid columns={3}>\n                    <Grid.Row>\n                        <Grid.Column width={5}>\n                            <p>{title1}</p>\n                        </Grid.Column>\n\n                        <Grid.Column width={5}>\n                            <p>{title2}</p>\n                        </Grid.Column>\n\n                        <Grid.Column width={6}>\n                            <p>{title3}</p>\n                        </Grid.Column>\n                    </Grid.Row>\n\n                    <Grid.Row>\n                        <Grid.Column width={5}>\n                            {left}\n                        </Grid.Column>\n\n                        <Grid.Column width={5}>\n                            {mid}\n                        </Grid.Column>\n\n                        <Grid.Column width={6}>\n                            {right}\n                        </Grid.Column>\n\n                    </Grid.Row>\n\n                    <Grid.Row>\n                        <Grid.Column width={10}>\n                            <p>{subtitle}</p>\n                        </Grid.Column>\n\n                        <Grid.Column width={6} />\n                    </Grid.Row>\n                </Grid>\n            </Segment>\n            {toolbar}\n        </>\n    )\n}\n\nexport default AnalysisLayoutThreeCol","import * as React from \"react\";\nimport { useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { defaultDebounce } from \"../../helpers\";\nimport ResultList from \"../../job/components/ResultList\";\nimport { AnalysisTypes } from \"../../messages\";\nimport { cbToRadius, inRectConstraint, keepOnCY, riConstraint, roConstraints } from \"../../widgets/constraints\";\nimport Disk from \"../../widgets/Disk\";\nimport DraggableHandle from \"../../widgets/DraggableHandle\";\nimport Ring from \"../../widgets/Ring\";\nimport { HandleRenderFunction } from \"../../widgets/types\";\nimport * as compoundAnalysisActions from \"../actions\";\nimport { CompoundAnalysisProps } from \"../types\";\nimport useFFTFrameView from \"./FFTFrameView\";\nimport AnalysisLayoutThreeCol from \"./layouts/AnalysisLayoutThreeCol\";\nimport Toolbar from \"./Toolbar\";\n\n\nconst FFTAnalysis: React.SFC<CompoundAnalysisProps> = ({ compoundAnalysis, dataset }) => {\n    const { shape } = dataset.params;\n    const [scanHeight, scanWidth, imageHeight, imageWidth] = shape;\n    const minLength = Math.min(imageWidth, imageHeight);\n\n    const cx = imageWidth / 2;\n    const cy = imageHeight / 2;\n    const [radIn, setRi] = useState(minLength / 4);\n    const [radOut, setRo] = useState(minLength / 2);\n\n    const dispatch = useDispatch();\n    const riHandle = {\n        x: cx - radIn,\n        y: cy,\n    }\n    const roHandle = {\n        x: cx - radOut,\n        y: cy,\n    }\n\n\n    const handleRIChange = defaultDebounce(setRi);\n    const handleROChange = defaultDebounce(setRo);\n\n    const frameViewHandlesfft: HandleRenderFunction = (handleDragStart, handleDrop) => (<>\n\n        <DraggableHandle x={roHandle.x} y={roHandle.y}\n            imageWidth={imageWidth}\n            onDragMove={cbToRadius(cx, cy, handleROChange)}\n            parentOnDrop={handleDrop}\n            parentOnDragStart={handleDragStart}\n            constraint={roConstraints(riHandle.x, cy)} />\n        <DraggableHandle x={riHandle.x} y={riHandle.y}\n            imageWidth={imageWidth}\n            parentOnDrop={handleDrop}\n            parentOnDragStart={handleDragStart}\n            onDragMove={cbToRadius(cx, cy, handleRIChange)}\n            constraint={riConstraint(roHandle.x, cy)} />\n    </>);\n\n    const frameViewWidgetsfft = (\n        <Ring cx={cx} cy={cy} ri={radIn} ro={radOut}\n            imageWidth={imageWidth} />\n    )\n\n    const [check, setCheck] = React.useState(true);\n\n    const handleChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n        dispatch(compoundAnalysisActions.Actions.enableAutoStart(compoundAnalysis.compoundAnalysis));\n        setCheck(event.target.checked);\n    }\n\n    const [realCenterX, setCx] = useState(imageWidth / 2);\n    const [realCenterY, setCy] = useState(imageHeight / 2);\n    const [realRad, setR] = useState(minLength / 4);\n\n    const handleCenterChange = defaultDebounce((newCx: number, newCy: number) => {\n        dispatch(compoundAnalysisActions.Actions.enableAutoStart(compoundAnalysis.compoundAnalysis));\n        setCx(newCx);\n        setCy(newCy);\n    });\n    const handleRChange = defaultDebounce(setR);\n\n    const rHandle = {\n        x: realCenterX - realRad,\n        y: realCenterY,\n    }\n\n    const frameViewHandlesreal: HandleRenderFunction = (handleDragStart, handleDrop) => (<>\n        <DraggableHandle x={realCenterX} y={realCenterY}\n            imageWidth={imageWidth}\n            onDragMove={handleCenterChange}\n            parentOnDragStart={handleDragStart}\n            parentOnDrop={handleDrop}\n            constraint={inRectConstraint(imageWidth, imageHeight)} />\n        <DraggableHandle x={rHandle.x} y={rHandle.y}\n            imageWidth={imageWidth}\n            onDragMove={cbToRadius(realCenterX, realCenterY, handleRChange)}\n            parentOnDragStart={handleDragStart}\n            parentOnDrop={handleDrop}\n            constraint={keepOnCY(realCenterY)} />\n    </>);\n\n    const frameViewWidgetsreal = (\n        <Disk cx={realCenterX} cy={realCenterY} r={realRad}\n            imageWidth={imageWidth} imageHeight={imageHeight}\n        />\n    );\n\n    const runAnalysis = () => {\n        dispatch(compoundAnalysisActions.Actions.run(compoundAnalysis.compoundAnalysis, 2, {\n            analysisType: AnalysisTypes.APPLY_FFT_MASK,\n            parameters: {\n                rad_in: radIn,\n                rad_out: radOut,\n                real_rad: check ? realRad : null,\n                real_centerx: check ? realCenterX : null,\n                real_centery: check ? realCenterY : null\n            }\n        }));\n    };\n\n    const { frameViewTitle, frameModeSelector, handles: resultHandles } = useFFTFrameView({\n        scanWidth,\n        scanHeight,\n        compoundAnalysisId: compoundAnalysis.compoundAnalysis,\n        real_rad: check ? realRad : null,\n        real_centerx: check ? realCenterX : null,\n        real_centery: check ? realCenterY : null,\n        doAutoStart: compoundAnalysis.doAutoStart,\n    });\n\n    const toolbar = <Toolbar compoundAnalysis={compoundAnalysis} onApply={runAnalysis} busyIdxs={[2]} />\n\n    let subtitle;\n    let mid: React.ReactNode;\n    if (check) {\n        mid = (<>\n            <ResultList\n                extraHandles={frameViewHandlesreal} extraWidgets={frameViewWidgetsreal}\n                analysisIndex={1} compoundAnalysis={compoundAnalysis.compoundAnalysis}\n                width={imageWidth} height={imageHeight}\n                selectors={frameModeSelector}\n            />\n        </>)\n        subtitle = (\n            <>{frameViewTitle} real_rad={radIn.toFixed(2)}, real_center=(x={realCenterX.toFixed(2)}, y={realCenterY.toFixed(2)}), fourier_rad_in={radIn.toFixed(2)}, fourier_rad_out={radOut.toFixed(2)}</>\n        )\n    }\n    else {\n        mid = (<>\n            <ResultList\n                analysisIndex={1} compoundAnalysis={compoundAnalysis.compoundAnalysis}\n                width={imageWidth} height={imageHeight}\n                selectors={frameModeSelector}\n            />\n        </>)\n        subtitle = (\n            <>{frameViewTitle} fourier_rad_in={radIn.toFixed(2)}, fourier_rad_out={radOut.toFixed(2)}</>\n        )\n    }\n\n\n    return (\n        <AnalysisLayoutThreeCol\n            title=\"FFT analysis\" subtitle={subtitle}\n            left={<>\n                <ResultList\n                    extraHandles={frameViewHandlesfft} extraWidgets={frameViewWidgetsfft}\n                    analysisIndex={0} compoundAnalysis={compoundAnalysis.compoundAnalysis}\n                    width={imageWidth} height={imageHeight}\n                />\n            </>}\n            mid={mid}\n\n            right={<>\n                <ResultList\n                    analysisIndex={2} compoundAnalysis={compoundAnalysis.compoundAnalysis}\n                    width={scanWidth} height={scanHeight}\n                    extraHandles={resultHandles}\n                />\n            </>}\n            toolbar={toolbar}\n\n            title2={<><label> Masking out of zero order diffraction peak <input type=\"checkbox\" name=\"check\" onChange={handleChange} checked={check} /> </label>\n            </>}\n            title1=\"Masking of integration region in Fourier space\"\n            title3=\"Result of analysis\"\n\n        />\n    );\n}\n\n\nexport default FFTAnalysis;\n","import * as React from \"react\";\nimport { useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { defaultDebounce } from \"../../helpers\";\nimport ResultList from \"../../job/components/ResultList\";\nimport { AnalysisTypes } from \"../../messages\";\nimport { inRectConstraint } from \"../../widgets/constraints\";\nimport DraggableHandle from \"../../widgets/DraggableHandle\";\nimport { HandleRenderFunction } from \"../../widgets/types\";\nimport * as analysisActions from \"../actions\";\nimport { CompoundAnalysisProps } from \"../types\";\nimport useDefaultFrameView from \"./DefaultFrameView\";\nimport AnalysisLayoutTwoCol from \"./layouts/AnalysisLayoutTwoCol\";\nimport Toolbar from \"./Toolbar\";\n\n\nconst PointSelectionAnalysis: React.SFC<CompoundAnalysisProps> = ({ compoundAnalysis, dataset, }) => {\n    const { shape } = dataset.params;\n    const [scanHeight, scanWidth, imageHeight, imageWidth] = shape;\n\n    const [cx, setCx] = useState(imageWidth / 2);\n    const [cy, setCy] = useState(imageHeight / 2);\n    const handleCenterChange = defaultDebounce((newCx: number, newCy: number) => {\n        setCx(newCx);\n        setCy(newCy);\n    });\n\n    const frameViewHandles: HandleRenderFunction = (handleDragStart, handleDrop) => (<>\n        <DraggableHandle x={cx} y={cy} withCross={true}\n            onDragMove={handleCenterChange}\n            imageWidth={imageWidth}\n            parentOnDragStart={handleDragStart}\n            parentOnDrop={handleDrop}\n            constraint={inRectConstraint(imageWidth, imageHeight)} />\n    </>);\n\n    const {\n        frameViewTitle, frameModeSelector,\n        handles: resultHandles,\n        widgets: resultWidgets,\n    } = useDefaultFrameView({\n        scanWidth,\n        scanHeight,\n        compoundAnalysisId: compoundAnalysis.compoundAnalysis,\n        doAutoStart: compoundAnalysis.doAutoStart,\n    })\n\n    const subtitle = (\n        <>{frameViewTitle} Point: center=(x={cx.toFixed(2)}, y={cy.toFixed(2)})</>\n    )\n\n    const dispatch = useDispatch();\n\n    const runAnalysis = () => {\n        dispatch(analysisActions.Actions.run(compoundAnalysis.compoundAnalysis, 1, {\n            analysisType: AnalysisTypes.APPLY_POINT_SELECTOR,\n            parameters: {\n                shape: \"point\",\n                cx,\n                cy,\n            }\n        }));\n    };\n\n    const toolbar = <Toolbar compoundAnalysis={compoundAnalysis} onApply={runAnalysis} busyIdxs={[1]} />\n\n    return (\n        <AnalysisLayoutTwoCol\n            title=\"Point analysis\" subtitle={subtitle}\n            left={<>\n                <ResultList\n                    extraHandles={frameViewHandles}\n                    analysisIndex={0} compoundAnalysis={compoundAnalysis.compoundAnalysis}\n                    width={imageWidth} height={imageHeight}\n                    selectors={frameModeSelector}\n                />\n            </>}\n            right={<>\n                <ResultList\n                    analysisIndex={1} compoundAnalysis={compoundAnalysis.compoundAnalysis}\n                    width={scanWidth} height={scanHeight}\n                    extraHandles={resultHandles}\n                    extraWidgets={resultWidgets}\n                />\n            </>}\n            toolbar={toolbar}\n        />\n    );\n}\n\nexport default PointSelectionAnalysis;","import * as React from \"react\";\nimport { useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { defaultDebounce } from \"../../helpers\";\nimport ResultList from \"../../job/components/ResultList\";\nimport { AnalysisTypes } from \"../../messages\";\nimport { cbToRadius, inRectConstraint, riConstraint, roConstraints } from \"../../widgets/constraints\";\nimport DraggableHandle from \"../../widgets/DraggableHandle\";\nimport Ring from \"../../widgets/Ring\";\nimport { HandleRenderFunction } from \"../../widgets/types\";\nimport * as analysisActions from \"../actions\";\nimport { CompoundAnalysisProps } from \"../types\";\nimport useDefaultFrameView from \"./DefaultFrameView\";\nimport AnalysisLayoutTwoCol from \"./layouts/AnalysisLayoutTwoCol\";\nimport Toolbar from \"./Toolbar\";\n\nconst RadialFourierAnalysis: React.SFC<CompoundAnalysisProps> = ({ compoundAnalysis, dataset }) => {\n    const { shape } = dataset.params;\n    const [scanHeight, scanWidth, imageHeight, imageWidth] = shape;\n\n    const minLength = Math.min(imageWidth, imageHeight);\n    const [cx, setCx] = useState(imageWidth / 2);\n    const [cy, setCy] = useState(imageHeight / 2);\n    const [ri, setRi] = useState(minLength / 4);\n    const [ro, setRo] = useState(minLength / 2);\n    const [nBins] = useState(1);\n    const [maxOrder] = useState(8);\n\n    const riHandle = {\n        x: cx - ri,\n        y: cy,\n    }\n    const roHandle = {\n        x: cx - ro,\n        y: cy,\n    }\n\n    const handleCenterChange = defaultDebounce((newCx: number, newCy: number) => {\n        setCx(newCx);\n        setCy(newCy);\n    });\n    const handleRIChange = defaultDebounce(setRi);\n    const handleROChange = defaultDebounce(setRo);\n\n    const frameViewHandles: HandleRenderFunction = (handleDragStart, handleDrop) => (<>\n        <DraggableHandle x={cx} y={cy}\n            imageWidth={imageWidth}\n            onDragMove={handleCenterChange}\n            parentOnDrop={handleDrop}\n            parentOnDragStart={handleDragStart}\n            constraint={inRectConstraint(imageWidth, imageHeight)} />\n        <DraggableHandle x={roHandle.x} y={roHandle.y}\n            imageWidth={imageWidth}\n            onDragMove={cbToRadius(cx, cy, handleROChange)}\n            parentOnDrop={handleDrop}\n            parentOnDragStart={handleDragStart}\n            constraint={roConstraints(riHandle.x, cy)} />\n        <DraggableHandle x={riHandle.x} y={riHandle.y}\n            imageWidth={imageWidth}\n            parentOnDrop={handleDrop}\n            parentOnDragStart={handleDragStart}\n            onDragMove={cbToRadius(cx, cy, handleRIChange)}\n            constraint={riConstraint(roHandle.x, cy)} />\n    </>);\n\n    const frameViewWidgets = (\n        <Ring cx={cx} cy={cy} ri={ri} ro={ro}\n            imageWidth={imageWidth} />\n    )\n\n    const {\n        frameViewTitle, frameModeSelector,\n        handles: resultHandles,\n        widgets: resultWidgets,\n    } = useDefaultFrameView({\n        scanWidth,\n        scanHeight,\n        compoundAnalysisId: compoundAnalysis.compoundAnalysis,\n        doAutoStart: compoundAnalysis.doAutoStart,\n    })\n\n    const subtitle = (\n        <>{frameViewTitle} Ring: center=(x={cx.toFixed(2)}, y={cy.toFixed(2)}), ri={ri.toFixed(2)}, ro={ro.toFixed(2)}</>\n    )\n\n    const dispatch = useDispatch();\n\n    const runAnalysis = () => {\n        dispatch(analysisActions.Actions.run(compoundAnalysis.compoundAnalysis, 1, {\n            analysisType: AnalysisTypes.RADIAL_FOURIER,\n            parameters: {\n                shape: \"radial_fourier\",\n                cx, cy, ri, ro,\n                n_bins: nBins,\n                max_order: maxOrder,\n            }\n        }));\n    };\n\n    const toolbar = <Toolbar compoundAnalysis={compoundAnalysis} onApply={runAnalysis} busyIdxs={[1]} />\n\n    return (\n        <AnalysisLayoutTwoCol\n            title=\"Radial Fourier analysis\" subtitle={subtitle}\n            left={<>\n                <ResultList\n                    extraHandles={frameViewHandles} extraWidgets={frameViewWidgets}\n                    analysisIndex={0} compoundAnalysis={compoundAnalysis.compoundAnalysis}\n                    width={imageWidth} height={imageHeight}\n                    selectors={frameModeSelector}\n                />\n            </>}\n            right={<>\n                <ResultList\n                    analysisIndex={1} compoundAnalysis={compoundAnalysis.compoundAnalysis}\n                    width={scanWidth} height={scanHeight}\n                    extraHandles={resultHandles}\n                    extraWidgets={resultWidgets}\n                />\n            </>}\n            toolbar={toolbar}\n        />\n    );\n}\n\nexport default RadialFourierAnalysis;","import * as React from \"react\";\nimport { useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { defaultDebounce } from \"../../helpers\";\nimport ResultList from \"../../job/components/ResultList\";\nimport { AnalysisTypes } from \"../../messages\";\nimport { cbToRadius, inRectConstraint, riConstraint, roConstraints } from \"../../widgets/constraints\";\nimport DraggableHandle from \"../../widgets/DraggableHandle\";\nimport Ring from \"../../widgets/Ring\";\nimport { HandleRenderFunction } from \"../../widgets/types\";\nimport * as analysisActions from \"../actions\";\nimport { CompoundAnalysisProps } from \"../types\";\nimport useDefaultFrameView from \"./DefaultFrameView\";\nimport AnalysisLayoutTwoCol from \"./layouts/AnalysisLayoutTwoCol\";\nimport Toolbar from \"./Toolbar\";\n\nconst RingMaskAnalysis: React.SFC<CompoundAnalysisProps> = ({ compoundAnalysis, dataset }) => {\n    const { shape } = dataset.params;\n    const [scanHeight, scanWidth, imageHeight, imageWidth] = shape;\n    const minLength = Math.min(imageWidth, imageHeight);\n\n    const [cx, setCx] = useState(imageWidth / 2);\n    const [cy, setCy] = useState(imageHeight / 2);\n    const [ri, setRi] = useState(minLength / 4);\n    const [ro, setRo] = useState(minLength / 2);\n\n    const riHandle = {\n        x: cx - ri,\n        y: cy,\n    }\n    const roHandle = {\n        x: cx - ro,\n        y: cy,\n    }\n\n    const handleCenterChange = defaultDebounce((newCx: number, newCy: number) => {\n        setCx(newCx);\n        setCy(newCy);\n    });\n    const handleRIChange = defaultDebounce(setRi);\n    const handleROChange = defaultDebounce(setRo);\n\n    const frameViewHandles: HandleRenderFunction = (handleDragStart, handleDrop) => (<>\n        <DraggableHandle x={cx} y={cy}\n            imageWidth={imageWidth}\n            onDragMove={handleCenterChange}\n            parentOnDrop={handleDrop}\n            parentOnDragStart={handleDragStart}\n            constraint={inRectConstraint(imageWidth, imageHeight)} />\n        <DraggableHandle x={roHandle.x} y={roHandle.y}\n            imageWidth={imageWidth}\n            onDragMove={cbToRadius(cx, cy, handleROChange)}\n            parentOnDrop={handleDrop}\n            parentOnDragStart={handleDragStart}\n            constraint={roConstraints(riHandle.x, cy)} />\n        <DraggableHandle x={riHandle.x} y={riHandle.y}\n            imageWidth={imageWidth}\n            parentOnDrop={handleDrop}\n            parentOnDragStart={handleDragStart}\n            onDragMove={cbToRadius(cx, cy, handleRIChange)}\n            constraint={riConstraint(roHandle.x, cy)} />\n    </>);\n\n    const frameViewWidgets = (\n        <Ring cx={cx} cy={cy} ri={ri} ro={ro}\n            imageWidth={imageWidth} />\n    )\n\n    const dispatch = useDispatch();\n\n    const runAnalysis = () => {\n        dispatch(analysisActions.Actions.run(compoundAnalysis.compoundAnalysis, 1, {\n            analysisType: AnalysisTypes.APPLY_RING_MASK,\n            parameters: {\n                shape: \"ring\",\n                cx, cy, ri, ro,\n            }\n        }));\n    };\n\n    const {\n        frameViewTitle, frameModeSelector,\n        handles: resultHandles,\n        widgets: resultWidgets,\n    } = useDefaultFrameView({\n        scanWidth,\n        scanHeight,\n        compoundAnalysisId: compoundAnalysis.compoundAnalysis,\n        doAutoStart: compoundAnalysis.doAutoStart,\n    })\n\n    const subtitle = (\n        <>{frameViewTitle} Ring: center=(x={cx.toFixed(2)}, y={cy.toFixed(2)}), ri={ri.toFixed(2)}, ro={ro.toFixed(2)}</>\n    )\n\n    const toolbar = <Toolbar compoundAnalysis={compoundAnalysis} onApply={runAnalysis} busyIdxs={[1]} />\n\n    return (\n        <AnalysisLayoutTwoCol\n            title=\"Ring analysis\" subtitle={subtitle}\n            left={<>\n                <ResultList\n                    extraHandles={frameViewHandles} extraWidgets={frameViewWidgets}\n                    analysisIndex={0} compoundAnalysis={compoundAnalysis.compoundAnalysis}\n                    width={imageWidth} height={imageHeight}\n                    selectors={frameModeSelector}\n                />\n            </>}\n            right={<>\n                <ResultList\n                    analysisIndex={1} compoundAnalysis={compoundAnalysis.compoundAnalysis}\n                    width={scanWidth} height={scanHeight}\n                    extraHandles={resultHandles}\n                    extraWidgets={resultWidgets}\n                />\n            </>}\n            toolbar={toolbar}\n        />\n    );\n}\n\nexport default RingMaskAnalysis;","import { AnalysisTypes, DatasetOpen, PickFrameDetails, SumFramesDetails } from \"../messages\";\nimport CenterOfMassAnalysis from \"./components/CenterOfMassAnalysis\";\nimport ClustAnalysis from \"./components/Clustering\";\nimport DiskMaskAnalysis from \"./components/DiskMaskAnalysis\";\nimport FEM from \"./components/FEM\";\nimport FFTAnalysis from \"./components/FFTAnalysis\";\nimport PointSelectionAnalysis from \"./components/PointSelectionAnalysis\";\nimport RadialFourierAnalysis from \"./components/RadialFourierAnalysis\";\nimport RingMaskAnalysis from \"./components/RingMaskAnalysis\";\n\n\nexport type CompoundAnalysisStatus = \"busy\" | \"idle\";\n\nexport type JobHistory = string[][];\n\nexport type FrameAnalysisDetails = PickFrameDetails | SumFramesDetails;\n\nexport interface CompoundAnalysis {\n    compoundAnalysis: string,\n    dataset: string,\n    details: {\n        mainType: AnalysisTypes,\n        analyses: string[],\n    }\n}\n\n\n/**\n * CompoundAnalysisProps is the interface you should implement with your\n * CompoundAnalysis, as a functional component. For example:\n * \n * const MyAnalysis: React.FunctionalComponent<CompoundAnalysisProps> = ({ analysis, dataset }) = { ... }\n * \n */\n\nexport type CompoundAnalysisState = CompoundAnalysis & {\n    doAutoStart: boolean,\n};\n\nexport interface CompoundAnalysisProps {\n    compoundAnalysis: CompoundAnalysisState,\n    dataset: DatasetOpen,\n}\n\nexport interface CompoundAnalysisMetadataItem {\n    desc: string,\n    title: string,\n    component?: React.FunctionComponent<CompoundAnalysisProps>,\n}\n\n\n/**\n * list of all analyses; those having a component will be available for selection in the UI\n * \n * please fill in a title and description, and reference your component.\n */\nexport const CompoundAnalysisMetadata: { [s: string]: CompoundAnalysisMetadataItem } = {\n    [AnalysisTypes.APPLY_RING_MASK]: {\n        desc: \"Application of a ring mask\",\n        title: \"Ring\",\n        component: RingMaskAnalysis,\n    },\n    [AnalysisTypes.APPLY_DISK_MASK]: {\n        desc: \"Application of a disk mask\",\n        title: \"Disk\",\n        component: DiskMaskAnalysis,\n    },\n    [AnalysisTypes.FEM]: {\n        desc: \"Application of a ring mask\",\n        title: \"FEM (SD over Ring)\",\n        component: FEM,\n    },\n    [AnalysisTypes.CENTER_OF_MASS]: {\n        desc: \"The center of mass of all diffraction images\",\n        title: \"Center of mass\",\n        component: CenterOfMassAnalysis,\n    },\n    [AnalysisTypes.APPLY_POINT_SELECTOR]: {\n        desc: \"Image from a single pixel selected in the detector\",\n        title: \"Point selection\",\n        component: PointSelectionAnalysis,\n    },\n    [AnalysisTypes.SUM_FRAMES]: {\n        desc: \"A sum of all (or selected) detector frames\",\n        title: \"Sum all frames\",\n    },\n    [AnalysisTypes.SD_FRAMES]: {\n        desc: \"A SD of all (or selected) detector frames\",\n        title: \"SD all frames\",\n    },\n    [AnalysisTypes.PICK_FRAME]: {\n        desc: \"A single picked frame\",\n        title: \"Pick frame\",\n    },\n    [AnalysisTypes.PICK_FFT_FRAME]: {\n        desc: \"Fourier transform of a picked frame\",\n        title: \"Pick frame\",\n    },\n    [AnalysisTypes.APPLY_FFT_MASK]: {\n        desc: \"Application of a ring mask in Fourier space\",\n        title: \"FFT analysis\",\n        component: FFTAnalysis\n    },\n    [AnalysisTypes.FFTSUM_FRAMES]: {\n        desc: \"Fourier transform of sum of all detector frames\",\n        title: \"FFT of Sum all frames\",\n    },\n    [AnalysisTypes.RADIAL_FOURIER]: {\n        desc: \"Radial Fourier analysis over the selected ring\",\n        title: \"Radial Fourier\",\n        component: RadialFourierAnalysis,\n    },\n    [AnalysisTypes.CLUST]: {\n        desc: \"Region clustering based on non-zero order diffraction peaks positions\",\n        title: \"Clustering\",\n        component: ClustAnalysis,\n    },\n    [AnalysisTypes.SUM_SIG]: {\n        desc: \"Frame integration\",\n        title: \"Sum\",\n    },\n}","import * as React from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { DatasetStatus } from \"../../../messages\";\nimport { RootReducer } from \"../../../store\";\nimport { CompoundAnalysisMetadata, CompoundAnalysisState } from \"../../types\";\n\ninterface AnalysisDispatcherProps {\n    analysis: CompoundAnalysisState,\n}\n\nconst AnalysisDispatcherComponent: React.SFC<AnalysisDispatcherProps> = ({ analysis }) => {\n    const dataset = useSelector((state: RootReducer) => state.datasets.byId[analysis.dataset])\n\n    if (dataset.status !== DatasetStatus.OPEN) {\n        return null;\n    }\n\n    const AnalysisComponent = CompoundAnalysisMetadata[analysis.details.mainType].component;\n    if (!AnalysisComponent) {\n        throw new Error(\"unknown analysis type\");\n    }\n\n    return <AnalysisComponent dataset={dataset} compoundAnalysis={analysis} />;\n}\n\nexport default AnalysisDispatcherComponent;","import * as React from \"react\";\nimport { CompoundAnalysisReducerState } from \"../../reducers\";\nimport Analysis from \"./Analysis\";\n\ninterface AnalysisProps {\n    analyses: CompoundAnalysisReducerState,\n}\n\nconst AnalysisList: React.SFC<AnalysisProps> = ({ analyses }) => {\n    return (<>{\n        analyses.ids.map(analysisId => <Analysis key={analysisId} analysis={analyses.byId[analysisId]} />)\n    }</>);\n}\n\nexport default AnalysisList;","// tslint:disable-next-line:ban-types\ntype ImmutablePrimitive = undefined | null | boolean | string | number | Function;\n\nexport type Immutable<T> =\n    T extends ImmutablePrimitive ? T :\n    T extends Array<infer U> ? ImmutableArray<U> :\n    T extends Map<infer K, infer V> ? ImmutableMap<K, V> :\n    T extends Set<infer M> ? ImmutableSet<M> : ImmutableObject<T>;\n\nexport type ImmutableArray<T> = ReadonlyArray<Immutable<T>>;\nexport type ImmutableMap<K, V> = ReadonlyMap<Immutable<K>, Immutable<V>>;\nexport type ImmutableSet<T> = ReadonlySet<Immutable<T>>;\nexport type ImmutableObject<T> = { readonly [K in keyof T]: Immutable<T[K]> };\n\n\ntype DeepReadonly<T> =\n    T extends Array<infer R> ? DeepReadonlyArray<R> :\n    // tslint:disable-next-line:ban-types\n    T extends Function ? T :\n    T extends object ? DeepReadonlyObject<T> :\n    T;\n\ninterface DeepReadonlyArray<T> extends ReadonlyArray<DeepReadonly<T>> { }\n\ntype DeepReadonlyObject<T> = {\n    readonly [P in keyof T]: DeepReadonly<T[P]>;\n};\n\ninterface IdMap<R> {\n    [s: string]: R\n}\n\nexport interface ById<R> {\n    ids: string[],\n    byId: IdMap<R>,\n};\n\nexport type ByIdReadOnly<R> = DeepReadonly<ById<R>>;\n\nexport function updateById<R>(state: ById<R>, id: string, partialRecord: Partial<R>): ById<R> {\n    const newObj = Object.assign({}, state.byId[id], partialRecord);\n    const newById = Object.assign({}, state.byId, { [id]: newObj });\n    return Object.assign({}, state, { byId: newById });\n}\n\nexport function insertById<R>(state: ById<R>, id: string, record: R): ById<R> {\n    const newById = Object.assign({}, state.byId, { [id]: record });\n    const newIds = [...state.ids, id];\n    return { byId: newById, ids: newIds };\n}\n\nexport function constructById<R>(items: R[], key: (k: R) => string): IdMap<R> {\n    const byId = items.reduce((acc, item) => Object.assign(acc, {\n        [key(item)]: item,\n    }), {} as IdMap<R>);\n    return byId;\n}\n\nexport type Predicate<R> = (item: R) => boolean;\n\nexport function filterWithPred<R>(state: ById<R>, pred: Predicate<R>): ById<R> {\n    const ids: string[] = state.ids.filter(id => pred(state.byId[id]));\n    const byId: IdMap<R> = ids.reduce((acc, id) => Object.assign(acc, {\n        [id]: state.byId[id],\n    }), {});\n    return {\n        byId,\n        ids,\n    };\n}\n\nexport function filterWithPredReadOnly<R>(state: ByIdReadOnly<R>, pred: Predicate<DeepReadonly<R>>): ByIdReadOnly<R> {\n    const ids: DeepReadonly<string[]> = state.ids.filter(id => pred(state.byId[id]));\n    const byId: DeepReadonly<IdMap<R>> = ids.reduce((acc, id) => Object.assign(acc, {\n        [id]: state.byId[id],\n    }), {});\n    return {\n        byId,\n        ids,\n    };\n}\n\nexport function toggleItemInList<T>(list: T[], item: T): T[] {\n    if (list.includes(item)) {\n        return list.filter(i => i !== item)\n    } else {\n        return [item, ...list];\n    }\n}","import * as React from \"react\";\nimport { Dropdown, DropdownItemProps } from \"semantic-ui-react\";\nimport { getEnumValues } from \"../../../helpers\";\nimport { AnalysisTypes } from \"../../../messages\";\nimport { getMetadata } from \"../../getMetadata\";\n\nconst analysisTypeKeys = getEnumValues(AnalysisTypes);\nconst analysisTypeOptions = analysisTypeKeys.filter(t => getMetadata(t).component !== undefined).map(t => ({\n    text: getMetadata(t).title,\n    value: AnalysisTypes[t],\n}));\n\ninterface AnalysisSelectProps {\n    onClick: (analysisType: AnalysisTypes) => void,\n    label: string,\n}\n\nconst selectData = (fn: (v: AnalysisTypes) => void) => (e: React.MouseEvent, data: DropdownItemProps) => {\n    return fn(data.value as AnalysisTypes);\n}\n\nconst AnalysisSelect: React.SFC<AnalysisSelectProps> = ({ onClick, label }) => {\n    return (\n        <Dropdown text={label} icon='add' floating={true} labeled={true} button={true} className='icon'>\n            <Dropdown.Menu>\n                <Dropdown.Header content='implemented analyses' />\n                {analysisTypeOptions.map(option => <Dropdown.Item key={option.value} onClick={selectData(onClick)} {...option} />)}\n            </Dropdown.Menu>\n        </Dropdown>\n    );\n}\n\nexport default AnalysisSelect;","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\nimport * as compoundAnalysisActions from \"../../compoundAnalysis/actions\";\nimport AnalysisSelect from \"../../compoundAnalysis/components/base/AnalysisSelect\";\nimport { AnalysisTypes, DatasetState } from \"../../messages\";\n\ninterface DatasetProps {\n    dataset: DatasetState\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch, ownProps: DatasetProps) => {\n    return {\n        handleAddAnalysis: (type: AnalysisTypes) => {\n            dispatch(compoundAnalysisActions.Actions.create(ownProps.dataset.id, type));\n        },\n    }\n}\ntype MergedProps = DatasetProps & ReturnType<typeof mapDispatchToProps>;\n\nconst AddAnalysis: React.SFC<MergedProps> = ({ handleAddAnalysis }) => {\n    return <AnalysisSelect onClick={handleAddAnalysis} label='Add analysis' />\n}\n\n\nexport default connect(null, mapDispatchToProps)(AddAnalysis);","import { genericDelete, genericPut, getApiBasePath } from \"../helpers/apiHelpers\";\nimport { DataSetOpenSchemaResponse, DeleteDatasetResponse, DetectDatasetResponse, OpenDatasetRequest, OpenDatasetResponse } from \"../messages\";\n\nexport async function openDataset(id: string, dataset: OpenDatasetRequest): Promise<OpenDatasetResponse> {\n    return await genericPut(`datasets/${id}/`, dataset);\n}\n\nexport async function deleteDataset(id: string): Promise<DeleteDatasetResponse> {\n    return await genericDelete(`datasets/${id}/`);\n}\n\n\nexport async function detectDataset(path: string): Promise<DetectDatasetResponse> {\n    const basePath = getApiBasePath();\n    const r = await fetch(`${basePath}datasets/detect/?path=${encodeURIComponent(path)}`, {\n        credentials: \"same-origin\",\n        method: \"GET\",\n    });\n    return await r.json();\n}\n\ninterface SchemaCache {\n    [type: string]: DataSetOpenSchemaResponse,\n}\n\nconst schemaCache: SchemaCache = {};\n\nexport async function getSchema(type: string): Promise<DataSetOpenSchemaResponse> {\n    const basePath = getApiBasePath();\n    const cached = schemaCache[type];\n    if (cached) {\n        return new Promise((resolve) => resolve(cached));\n    } else {\n        const r = await fetch(`${basePath}datasets/schema/?type=${encodeURIComponent(type)}`, {\n            credentials: \"same-origin\",\n            method: \"GET\",\n        });\n        const schemaResponse = await r.json();\n        schemaCache[type] = schemaResponse;\n        return schemaResponse;\n    }\n}","import Ajv, { ErrorObject } from 'ajv';\nimport { FormikErrors, FormikValues } from 'formik';\nimport { DataSetOpenSchemaResponse } from '../messages';\nimport { getSchema } from './api';\n\nexport function convertErrors(errors: ErrorObject[]): FormikErrors<FormikValues> {\n    const res: FormikErrors<FormikValues> = {};\n    errors.forEach(err => {\n        // flatten field names, convert from array to object\n        // FIXME: doesn't support multiple errors per field yet (formik limitation?)\n        const expr = /^\\.([^[]+)(\\[[^]+\\])?$/\n        const fieldName = err.dataPath.replace(expr, (match, plainName) => {\n            return plainName;\n        });\n        res[fieldName] = err.message;\n    });\n    return res;\n}\n\nexport async function validateOpen(type: string, data: object) {\n    return getSchema(type).then((schemaResponse: DataSetOpenSchemaResponse) => {\n        if (schemaResponse.status === \"error\") {\n            throw new Error(schemaResponse.msg);\n        }\n        // FIXME: cache compiled schema\n        const schema = schemaResponse.schema;\n        const ajv = new Ajv();\n        const validate = ajv.compile(schema);\n        const valid = validate(data);\n        if (!valid) {\n            if (validate.errors) {\n                const converted = convertErrors(validate.errors);\n                throw converted;\n            } else {\n                throw new Error(\"unspecified error while validating fields\");\n            }\n        }\n    })\n}","import { withFormik } from \"formik\";\nimport * as pathfind from 'path';\nimport { AdditionalInfo, DatasetTypes } from \"../messages\";\nimport { OpenFormProps } from \"./types\";\nimport { validateOpen } from \"./validate\";\n\nexport function parseNumList(nums: string) {\n    return nums.split(\",\").filter(part => part.trim() !== \"\").map(part => +part);\n}\n\nexport function parseNumListWithPadding(nums: string, minLength: number) {\n    let initialList = new Array(minLength).fill(\"\");\n    if(nums) {\n      const value = nums.split(\",\");\n      if((minLength - value.length)>0) {\n        initialList = [...value, ...Array(minLength - value.length).fill(\"\")];\n      } else {\n          initialList = [...value];\n      }\n    }\n    return initialList;\n}\n\nexport function getInitial<T extends object, K extends keyof T, V>(key: K, otherwise: V, values?: T): V | T[K] {\n    if (!values) {\n        return otherwise;\n    }\n    const res = values[key] !== undefined ? values[key] : otherwise;\n    return res;\n}\n\nexport function getInitialName<T extends object, K extends keyof T>(key: K, otherwise: string, values?: T): string | T[K] {\n    if (!values) {\n        return pathfind.basename(otherwise);\n    }\n    const res = values[key] !== undefined ? values[key] : pathfind.basename(otherwise);\n    return res;\n}\n\nexport function isKnownDatasetType(detectedType: string) {\n  return (Object.keys(DatasetTypes).some((v) => v === detectedType) ? true : false);\n}\n\nexport function isAdditionalInfo(param: string) {\n  return (Object.keys(AdditionalInfo).some((v) => v === param) ? true : false);\n}\n\nexport function hasKey<O>(obj: O, key: keyof any): key is keyof O {\n  return key in obj\n}\n\ntype FormToJsonFn<SubmitParams, FormParams> = (inParams: FormParams, path: string) => SubmitParams;\ntype PropsToValuesFn<SubmitParams, FormParams> = (props: OpenFormProps<SubmitParams>) => FormParams;\n\ninterface WithValidationOpts<SubmitParams extends object, FormParams> {\n    formToJson: FormToJsonFn<SubmitParams, FormParams>,\n    mapPropsToValues: PropsToValuesFn<SubmitParams, FormParams>,\n    type: DatasetTypes,\n    // WrappedComponent: React.FunctionComponent<FormikProps<FormParams> & OpenFormProps<SubmitParams>>\n}\n\nexport function withValidation<SubmitParams extends object, FormParams>(\n    opts: WithValidationOpts<SubmitParams, FormParams>\n) {\n    return withFormik<OpenFormProps<SubmitParams>, FormParams>({\n        mapPropsToValues: opts.mapPropsToValues,\n        handleSubmit: (values, formikBag) => {\n            const { onSubmit, path } = formikBag.props;\n            const submitData = opts.formToJson(values, path);\n            onSubmit(submitData);\n            formikBag.setSubmitting(false);\n        },\n        validate: (values, props) => {\n            return validateOpen(opts.type, opts.formToJson(values, props.path));\n        },\n        enableReinitialize: true,\n        validateOnChange: true,\n        validateOnBlur: true,\n    });\n}\n","import * as React from \"react\";\nimport { Table } from \"semantic-ui-react\";\nimport { DatasetState } from \"../../messages\";\nimport { isAdditionalInfo } from \"../helpers\";\n\ninterface DatasetProps {\n    dataset: DatasetState\n}\n\nconst renderParamValue = (value: any) => {\n    if (value instanceof Array) {\n        return `(${value.join(\",\")})`;\n    } else {\n        return value;\n    }\n}\n\nconst renderParams = (params: any) => {\n    return Object.keys(params).map((key: string, idx: number) => {\n        // Only show parameters, not additional info\n        if(!isAdditionalInfo(key)) {\n            return (\n                <Table.Row key={idx}>\n                    <Table.Cell>{key}</Table.Cell>\n                    <Table.Cell>{renderParamValue(params[key])}</Table.Cell>\n                </Table.Row>\n            );\n        }\n        else {\n          return null;\n        }\n    })\n}\n\n\nconst DatasetParams: React.SFC<DatasetProps> = ({ dataset }) => {\n    return (\n        <Table>\n            <Table.Header>\n                <Table.Row>\n                    <Table.HeaderCell>Parameter</Table.HeaderCell>\n                    <Table.HeaderCell>Value</Table.HeaderCell>\n                </Table.Row>\n            </Table.Header>\n            <Table.Body>\n                {renderParams(dataset.params)}\n            </Table.Body>\n        </Table>\n    );\n}\n\n\nexport default DatasetParams;\n","import { ActionsUnion, createAction } from '../helpers/actionHelpers';\nimport { DatasetCreateParams, DatasetFormParams, DatasetState } from '../messages';\n\nexport enum ActionTypes {\n    OPEN = 'DATASET_OPEN',\n    CANCEL_OPEN = 'DATASET_CANCEL_OPEN',\n    CREATE = 'DATASET_CREATE',\n    CREATED = 'DATASET_CREATED',\n    ERROR = 'DATASET_ERROR',\n    DELETE = 'DATASET_DELETE',\n    DELETED = 'DATASET_DELETED',\n    DETECT = 'DATASET_DETECT',\n    DETECTED = 'DATASET_DETECTED',\n    DETECT_FAILED = 'DATASET_DETECT_FAILED',\n}\n\nexport const Actions = {\n    open: (path: string, cachedParams?: DatasetFormParams, detectedParams?: DatasetFormParams) => createAction(ActionTypes.OPEN, { path, cachedParams, detectedParams }),\n    cancelOpen: () => createAction(ActionTypes.CANCEL_OPEN),\n    create: (dataset: DatasetCreateParams) => createAction(ActionTypes.CREATE, { dataset }),\n    created: (dataset: DatasetState) => createAction(ActionTypes.CREATED, { dataset }),\n    error: (dataset: string, msg: string, timestamp: number, id: string) => createAction(ActionTypes.ERROR, { dataset, msg, timestamp, id }),\n    delete: (dataset: string) => createAction(ActionTypes.DELETE, { dataset }),\n    deleted: (dataset: string) => createAction(ActionTypes.DELETED, { dataset }),\n    detect: (path: string) => createAction(ActionTypes.DETECT, { path }),\n    detected: (path: string, params: DatasetFormParams) => createAction(ActionTypes.DETECTED, { path, params }),\n    detectFailed: (path: string) => createAction(ActionTypes.DETECT_FAILED, { path }),\n}\n\nexport type Actions = ActionsUnion<typeof Actions>;\n","import * as React from \"react\";\nimport { Table } from \"semantic-ui-react\";\nimport { DatasetOpen, DiagElemMsg } from \"../../messages\";\nimport DatasetParams from \"./DatasetParams\";\n\ninterface DatasetInfoProps {\n    dataset: DatasetOpen,\n}\n\nconst renderValue = (elem: DiagElemMsg) => {\n    if (elem.value instanceof Array) {\n        return <DiagElems diagnostics={elem.value} />\n    } else {\n        return elem.value;\n    }\n}\n\nconst DiagElem: React.SFC<{ elem: DiagElemMsg }> = ({ elem }) => {\n    return (\n        <Table.Row>\n            <Table.Cell>{elem.name}</Table.Cell>\n            <Table.Cell>{renderValue(elem)}</Table.Cell>\n        </Table.Row>\n    )\n}\n\nconst DiagElems: React.SFC<{ diagnostics: DiagElemMsg[] }> = ({ diagnostics }) => {\n    if (diagnostics.length === 0) {\n        return null;\n    }\n    return (\n        <Table>\n            <Table.Header>\n                <Table.Row>\n                    <Table.HeaderCell>Name</Table.HeaderCell>\n                    <Table.HeaderCell>Value</Table.HeaderCell>\n                </Table.Row>\n            </Table.Header>\n            <Table.Body>\n                {diagnostics.map((elem, idx) => (\n                    <DiagElem elem={elem} key={idx} />\n                ))}\n            </Table.Body>\n        </Table>\n    );\n}\n\nconst DatasetInfo: React.SFC<DatasetInfoProps> = ({ dataset }) => {\n    return (\n        <>\n            <DatasetParams dataset={dataset} />\n            <DiagElems diagnostics={dataset.diagnostics} />\n        </>\n    );\n}\n\nexport default DatasetInfo;","import { ActionsUnion, createAction } from \"../helpers/actionHelpers\";\n\nexport enum ActionTypes {\n    DISMISS = \"ERROR_DISMISS\",\n    DISMISS_ALL = \"ERROR_DISMISS_ALL\",\n}\n\nexport const Actions = {\n    dismiss: (id: string) => createAction(ActionTypes.DISMISS, { id }),\n    dismissAll: () => createAction(ActionTypes.DISMISS_ALL),\n}\n\nexport type Actions = ActionsUnion<typeof Actions>;","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\nimport { Button } from \"semantic-ui-react\";\nimport { DatasetState } from \"../../messages\";\nimport * as datasetActions from \"../actions\";\n\ninterface DatasetProps {\n    dataset: DatasetState,\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch, ownProps: DatasetProps) => {\n    return {\n        handleRemoveDataset: () => {\n            dispatch(datasetActions.Actions.delete(ownProps.dataset.id));\n        }\n    }\n}\n\ntype MergedProps = DatasetProps & ReturnType<typeof mapDispatchToProps>;\n\nconst DatasetToolbar: React.SFC<MergedProps> = ({ dataset, handleRemoveDataset }) => {\n    return (\n        <>\n            <Button icon=\"remove\" labelPosition=\"left\" onClick={handleRemoveDataset} content='Close Dataset' />\n        </>\n    );\n}\n\n\nexport default connect(null, mapDispatchToProps)(DatasetToolbar);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Header, Icon, Message, Modal, Popup, Segment } from 'semantic-ui-react';\nimport AnalysisList from \"../../compoundAnalysis/components/base/AnalysisList\";\nimport { CompoundAnalysisState } from \"../../compoundAnalysis/types\";\nimport { filterWithPred, Immutable, Predicate } from \"../../helpers/reducerHelpers\";\nimport { DatasetState, DatasetStatus } from \"../../messages\";\nimport { RootReducer } from \"../../store\";\nimport AddAnalysis from \"./AddAnalysis\";\nimport DatasetInfo from \"./DatasetInfo\";\nimport DatasetToolbar from \"./DatasetToolbar\";\n\ninterface DatasetProps {\n    dataset: DatasetState\n}\n\nconst mapStateToProps = (state: RootReducer, ownProps: DatasetProps) => {\n    const p: Predicate<Immutable<CompoundAnalysisState>> = (analysis: Immutable<CompoundAnalysisState>) => analysis.dataset === ownProps.dataset.id;\n    return {\n        analyses: filterWithPred(state.compoundAnalyses, p),\n    }\n}\n\ntype MergedProps = DatasetProps & ReturnType<typeof mapStateToProps>;\n\nconst DatasetComponent: React.SFC<MergedProps> = ({ dataset, analyses }) => {\n    const msg = {\n        [DatasetStatus.OPENING]: `Opening dataset ${dataset.params.name}`,\n        [DatasetStatus.DELETING]: `Closing dataset ${dataset.params.name}`,\n    }\n    if (dataset.status === DatasetStatus.OPENING || dataset.status === DatasetStatus.DELETING) {\n        return (\n            <>\n                <Header as=\"h2\" dividing={true}>{dataset.params.name}</Header>\n                <Message icon={true}>\n                    <Icon name='cog' loading={true} />\n                    <Message.Content>\n                        <Message.Header>{msg[dataset.status]}</Message.Header>\n                    </Message.Content>\n                </Message>\n            </>\n        );\n    }\n\n    return (\n        <Segment.Group style={{ marginTop: \"3em\", marginBottom: \"3em\" }}>\n            <Segment.Group horizontal={true}>\n                <Segment>\n                    <Header as=\"h2\">\n                        <Icon name=\"database\" />\n                        <Modal trigger={\n                            <Header.Content>\n                                {dataset.params.name}\n                                {' '}\n                                <Icon name=\"info circle\" size=\"small\" link={true} />\n                            </Header.Content>\n                        }>\n                            <Popup.Header>{dataset.params.type} Dataset {dataset.params.name}</Popup.Header>\n                            <Popup.Content>\n                                <DatasetInfo dataset={dataset} />\n                            </Popup.Content>\n                        </Modal>\n                    </Header>\n                </Segment>\n                <Segment style={{ flexShrink: 1, flexGrow: 0 }}>\n                    <DatasetToolbar dataset={dataset} />\n                </Segment>\n            </Segment.Group>\n            {\n                analyses.ids.length > 0 ? (\n                    <>\n                        <Segment>\n                            <AnalysisList analyses={analyses} />\n                        </Segment>\n                    </>\n                ) : null\n            }\n            <Segment textAlign=\"center\">\n                <AddAnalysis dataset={dataset} />\n            </Segment>\n        </Segment.Group>\n    );\n}\n\nconst DatasetContainer = connect(mapStateToProps)(DatasetComponent);\n\nexport default DatasetContainer;","import { ErrorMessage, Field, FormikProps } from \"formik\";\nimport * as React from \"react\";\nimport { Button, Form } from \"semantic-ui-react\";\nimport { Omit } from \"../../helpers/types\";\nimport { DatasetParamsBLO, DatasetTypes } from \"../../messages\";\nimport { getInitialName, withValidation } from \"../helpers\";\nimport { OpenFormProps } from \"../types\";\n\n// some fields have different types in the form vs. in messages\ntype DatasetParamsBLOForForm = Omit<DatasetParamsBLO, \"path\" | \"type\">;\n\ntype MergedProps = FormikProps<DatasetParamsBLOForForm> & OpenFormProps<DatasetParamsBLO>;\n\nconst BLOFileParamsForm: React.SFC<MergedProps> = ({\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    handleReset,\n    isValidating,\n    onCancel,\n}) => {\n    return (\n        <Form onSubmit={handleSubmit}>\n            <Form.Field>\n                <label htmlFor=\"id_name\">Name:</label>\n                <ErrorMessage name=\"name\" />\n                <Field name=\"name\" id=\"id_name\" />\n            </Form.Field>\n\n            <Button primary={true} type=\"submit\" disabled={isSubmitting || isValidating}>Load Dataset</Button>\n            <Button type=\"button\" onClick={onCancel}>Cancel</Button>\n            <Button type=\"button\" onClick={handleReset}>Reset</Button>\n        </Form>\n    )\n}\n\nexport default withValidation<DatasetParamsBLO, DatasetParamsBLOForForm>({\n    mapPropsToValues: ({path, initial }) => ({\n        name: getInitialName(\"name\",path,initial),\n    }),\n    formToJson: (values, path) => {\n        return {\n            path,\n            type: DatasetTypes.BLO,\n            name: values.name,\n        };\n    },\n    type: DatasetTypes.BLO,\n})(BLOFileParamsForm);\n","import * as React from \"react\";\nimport { Dropdown, DropdownProps } from \"semantic-ui-react\";\nimport { getEnumValues } from \"../../helpers\";\nimport { DatasetTypes } from \"../../messages\";\n\n\nconst datasetTypeKeys = getEnumValues(DatasetTypes);\nconst datasetTypeOptions = datasetTypeKeys.map(t => ({\n    // text: DatasetTypeMetadata[DatasetTypes[t as any]].short,\n    text: DatasetTypes[t],\n    value: DatasetTypes[t],\n}));\n\ninterface DatasetTypeSelectProps {\n    onClick: (e: React.SyntheticEvent, data: DropdownProps) => void,\n    currentType: DatasetTypes,\n}\n\nconst DatasetTypeSelect: React.SFC<DatasetTypeSelectProps> = ({ currentType, onClick }) => {\n    return (\n        <>\n            <Dropdown\n                inline={true}\n                options={datasetTypeOptions}\n                value={currentType}\n                onChange={onClick}\n            />\n        </>\n    );\n}\n\nexport default DatasetTypeSelect;","import { ErrorMessage, Field, FormikProps } from \"formik\";\nimport * as React from \"react\";\nimport { Button, Form } from \"semantic-ui-react\";\nimport { Omit } from \"../../helpers/types\";\nimport { DatasetParamsEMPAD, DatasetTypes } from \"../../messages\";\nimport { getInitial, getInitialName, parseNumList, withValidation } from \"../helpers\";\nimport { OpenFormProps } from \"../types\";\n\n// some fields have different types in the form vs. in messages\ntype DatasetParamsEMPADForForm = Omit<DatasetParamsEMPAD,\n    \"path\"\n    | \"type\"\n    | \"scan_size\"\n> & {\n    scan_size: string,\n};\n\ntype MergedProps = FormikProps<DatasetParamsEMPADForForm> & OpenFormProps<DatasetParamsEMPAD>;\n\nconst EMPADParamsForm: React.SFC<MergedProps> = ({\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    handleReset,\n    onCancel,\n}) => {\n    return (\n        <Form onSubmit={handleSubmit}>\n            <Form.Field>\n                <label htmlFor=\"id_name\">Name:</label>\n                <ErrorMessage name=\"name\" />\n                <Field name=\"name\" id=\"id_name\" />\n            </Form.Field>\n            <Form.Field>\n                <label htmlFor=\"id_scan_size\">Scan Size:</label>\n                <ErrorMessage name=\"scan_size\" />\n                <Field name=\"scan_size\" id=\"id_scan_size\" />\n            </Form.Field>\n            <Button primary={true} type=\"submit\" disabled={isSubmitting}>Load Dataset</Button>\n            <Button type=\"button\" onClick={onCancel}>Cancel</Button>\n            <Button type=\"button\" onClick={handleReset}>Reset</Button>\n        </Form>\n    )\n}\n\nexport default withValidation<DatasetParamsEMPAD, DatasetParamsEMPADForForm>({\n    mapPropsToValues: ({path, initial }) => ({\n        name: getInitialName(\"name\",path,initial),\n        scan_size: getInitial(\"scan_size\", \"\", initial).toString(),\n    }),\n    formToJson: (values, path) => {\n        return {\n            path,\n            type: DatasetTypes.EMPAD,\n            name: values.name,\n            scan_size: parseNumList(values.scan_size),\n        };\n    },\n    type: DatasetTypes.EMPAD,\n})(EMPADParamsForm);\n","import { ErrorMessage, Field, FormikProps } from \"formik\";\nimport * as React from \"react\";\nimport { Button, Form } from \"semantic-ui-react\";\nimport { Omit } from \"../../helpers/types\";\nimport { DatasetParamsFRMS6, DatasetTypes } from \"../../messages\";\nimport { getInitialName, withValidation } from \"../helpers\";\nimport { OpenFormProps } from \"../types\";\n\n// some fields have different types in the form vs. in messages\ntype DatasetParamsFRMS6ForForm = Omit<DatasetParamsFRMS6,\n    \"path\" | \"type\">;\n\ntype MergedProps = FormikProps<DatasetParamsFRMS6ForForm> & OpenFormProps<DatasetParamsFRMS6>;\nconst FRMS6ParamsForm: React.SFC<MergedProps> = ({\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    handleReset,\n    onCancel,\n}) => {\n    return (\n        <Form onSubmit={handleSubmit}>\n            <Form.Field>\n                <label htmlFor=\"id_name\">Name:</label>\n                <ErrorMessage name=\"name\" />\n                <Field name=\"name\" id=\"id_name\" />\n            </Form.Field>\n\n            <Button primary={true} type=\"submit\" disabled={isSubmitting}>Load Dataset</Button>\n            <Button type=\"button\" onClick={onCancel}>Cancel</Button>\n            <Button type=\"button\" onClick={handleReset}>Reset</Button>\n        </Form>\n    )\n}\n\nexport default withValidation<DatasetParamsFRMS6, DatasetParamsFRMS6ForForm>({\n    mapPropsToValues: ({ path, initial }) => ({\n        name: getInitialName(\"name\",path,initial),\n    }),\n    formToJson: (values, path) => {\n        return {\n            path,\n            type: DatasetTypes.FRMS6,\n            name: values.name,\n        };\n    },\n    type: DatasetTypes.FRMS6,\n})(FRMS6ParamsForm);\n","import { ErrorMessage, Field, FormikProps } from \"formik\";\nimport * as React from \"react\";\nimport { Button, Dropdown, DropdownProps, Form } from \"semantic-ui-react\";\nimport { Omit } from \"../../helpers/types\";\nimport { DatasetParamsHDF5, DatasetTypes } from \"../../messages\";\nimport { getInitial, getInitialName, withValidation } from \"../helpers\";\nimport { OpenFormProps } from \"../types\";\n\ntype DatasetParamsHDF5ForForm = Omit<DatasetParamsHDF5, \"path\" | \"type\">;\n\ntype MergedProps = FormikProps<DatasetParamsHDF5ForForm> & OpenFormProps<DatasetParamsHDF5>;\n\nconst HDF5ParamsForm: React.SFC<MergedProps> = ({\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    handleReset,\n    onCancel,\n    setFieldValue,\n}) => {\n\n    const dsPathOptions = values.dataset_paths.map(dsPath => ({ key: dsPath, text: dsPath, value: dsPath }));\n\n    // semantic-ui requires value to be set manually on option selection\n    const onDSPathChange = (e: React.SyntheticEvent, result: DropdownProps) => {\n      const { value } = result;\n      if (value) {\n        setFieldValue(\"ds_path\", value.toString());\n      }\n    };\n\n    let dsPathInput;\n    const isTimeOut = (values.dataset_paths.length === 0 ) ? true : false;\n    if (isTimeOut) {\n      dsPathInput = <Field name=\"ds_path\" id=\"id_ds_path\" />;\n    } else {\n      dsPathInput = <Dropdown name=\"ds_path\" id=\"id_ds_path\" placeholder=\"Select dataset\" fluid={true} search={true} selection={true} defaultValue={values.ds_path} onChange={onDSPathChange} options={dsPathOptions} />;\n    }\n\n    return (\n        <Form onSubmit={handleSubmit}>\n            <Form.Field>\n                <label htmlFor=\"id_name\">Name:</label>\n                <ErrorMessage name=\"name\" />\n                <Field name=\"name\" id=\"id_name\" />\n            </Form.Field>\n            <Form.Field>\n                <label htmlFor=\"id_ds_path\">HDF5 Dataset Path:</label>\n                <ErrorMessage name=\"ds_path\" />\n                {dsPathInput}\n            </Form.Field>\n            <Button primary={true} type=\"submit\" disabled={isSubmitting}>Load Dataset</Button>\n            <Button onClick={onCancel} >Cancel</Button>\n            <Button type=\"button\" onClick={handleReset}>Reset</Button>\n        </Form>\n    )\n}\n\nexport default withValidation<DatasetParamsHDF5, DatasetParamsHDF5ForForm>({\n    mapPropsToValues: ({path, initial }) => ({\n        name: getInitialName(\"name\",path,initial),\n        dataset_paths: getInitial(\"dataset_paths\", [], initial),\n        ds_path: getInitial(\"ds_path\", \"\", initial),\n    }),\n    formToJson: (values, path) => {\n        return {\n            path,\n            type: DatasetTypes.HDF5,\n            name: values.name,\n            ds_path: values.ds_path,\n            dataset_paths: values.dataset_paths,\n        };\n    },\n    type: DatasetTypes.HDF5,\n})(HDF5ParamsForm);\n","import { ErrorMessage, Field, FormikProps } from \"formik\";\nimport * as React from \"react\";\nimport { Button, Form } from \"semantic-ui-react\";\nimport { Omit } from \"../../helpers/types\";\nimport { DatasetParamsK2IS, DatasetTypes } from \"../../messages\";\nimport { getInitialName, withValidation } from \"../helpers\";\nimport { OpenFormProps } from \"../types\";\n\n// some fields have different types in the form vs. in messages\ntype DatasetParamsK2ISForForm = Omit<DatasetParamsK2IS,\n    \"path\" | \"type\">;\n\ntype MergedProps = FormikProps<DatasetParamsK2ISForForm> & OpenFormProps<DatasetParamsK2IS>;\n\nconst K2ISFileParamsForm: React.SFC<MergedProps> = ({\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    handleReset,\n    onCancel,\n}) => {\n    return (\n        <Form onSubmit={handleSubmit}>\n            <Form.Field>\n                <label htmlFor=\"id_name\">Name:</label>\n                <ErrorMessage name=\"name\" />\n                <Field name=\"name\" id=\"id_name\" />\n            </Form.Field>\n\n            <Button primary={true} type=\"submit\" disabled={isSubmitting}>Load Dataset</Button>\n            <Button type=\"button\" onClick={onCancel}>Cancel</Button>\n            <Button type=\"button\" onClick={handleReset}>Reset</Button>\n        </Form>\n    )\n}\n\nexport default withValidation<DatasetParamsK2IS, DatasetParamsK2ISForForm>({\n    mapPropsToValues: ({path, initial }) => ({\n        name: getInitialName(\"name\",path,initial),\n    }),\n    formToJson: (values, path) => {\n        return {\n            path,\n            type: DatasetTypes.K2IS,\n            name: values.name,\n        }\n    },\n    type: DatasetTypes.K2IS,\n})(K2ISFileParamsForm);\n","import * as React from \"react\";\n\ninterface TupleInputPartProps {\n    name: string,\n    id: string,\n    tupleKey: number,\n    value: number,\n    tupleInputChangeHandle: (idx: number, value: string) => void,\n    commaPressHandle: (idx: number) => void,\n    tupleRef: (ref:HTMLInputElement) => void,\n}\n\nconst TupleInputPart: React.FC<TupleInputPartProps> = ({ name, id, tupleKey, tupleInputChangeHandle, value, commaPressHandle, tupleRef }) => {\n\n   const onPartChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n      tupleInputChangeHandle(tupleKey, e.target.value);\n   }\n\n   const onCommaPress = (e: React.KeyboardEvent<HTMLInputElement>) => {\n     if(e.keyCode === 188) {\n       commaPressHandle(tupleKey);\n     }\n   }\n\n   return <input type=\"number\" name={name} id={id} key={tupleKey} onChange={onPartChange} value={value} onKeyDown={onCommaPress} ref={tupleRef} />;\n}\n\nexport default TupleInputPart;\n","import * as React from \"react\";\nimport { Button, Form } from \"semantic-ui-react\";\nimport { parseNumListWithPadding } from \"../helpers\";\nimport TupleInputPart from \"./TupleInputPart\";\n\ninterface TupleInputProps {\n    value: string,\n    minLen: number,\n    maxLen: number,\n    fieldName: string,\n    setFieldValue: (field: string, value: any, shouldValidate?: boolean) => void,\n}\n\nconst TupleInput: React.FC<TupleInputProps> = ({ value, minLen, maxLen, fieldName, setFieldValue }) => {\n\n    const tupleInputValue = parseNumListWithPadding(value, minLen);\n\n    const tupleInputRefsArray = React.useRef<HTMLInputElement[]>([]);\n\n    const tupleInputChangeHandle = (idx: number, val: string) => {\n      const newTupleInputValue = [...tupleInputValue];\n      newTupleInputValue[idx] = val;\n      setFieldValue(fieldName, newTupleInputValue.toString());\n    };\n\n    const commaPressHandle = (idx: number) => {\n      if(idx===(tupleInputValue.length-1)) {\n        newTupleDim();\n      } else {\n          tupleInputRefsArray.current[idx+1].focus();\n      }\n    }\n\n    const newTupleDim = () => {\n      if(tupleInputValue.length < maxLen) {\n        const newTupleInputValue = [...tupleInputValue];\n        newTupleInputValue.push(\"\");\n        setFieldValue(fieldName, newTupleInputValue.toString());\n      }\n    }\n\n    React.useEffect(() => {\n      if(tupleInputValue.length > minLen) {\n        tupleInputRefsArray.current[tupleInputValue.length-1].focus();\n      }\n    }, [tupleInputValue.length, minLen]);\n\n    const delTupleDim = () => {\n      if(tupleInputValue.length > minLen) {\n        const newTupleInputValue = [...tupleInputValue];\n        newTupleInputValue.pop();\n        setFieldValue(fieldName, newTupleInputValue.toString());\n      }\n    }\n\n    return (\n      <>\n        <Form.Group>\n          {tupleInputValue.map((val, idx) => {\n            const tupleRef = (ref:HTMLInputElement) => { tupleInputRefsArray.current[idx] = ref; }\n            return <Form.Field width={2} key={idx}><TupleInputPart tupleKey={idx} name={fieldName + \"_\" + idx} id={\"id_\" + fieldName + \"_\" + idx} value={val} tupleRef={tupleRef} tupleInputChangeHandle={tupleInputChangeHandle} commaPressHandle={commaPressHandle} /></Form.Field>\n          })}\n          <Form.Field hidden={minLen === maxLen}>\n            <Button onClick={newTupleDim} disabled={tupleInputValue.length === maxLen} type=\"button\" icon=\"add\" title=\"Add dimension\" basic={false} />\n            <Button onClick={delTupleDim} disabled={tupleInputValue.length === minLen} type=\"button\" icon=\"minus\" title=\"Remove dimension\" basic={false} />\n          </Form.Field>\n        </Form.Group>\n      </>\n    );\n}\n\nexport default TupleInput;\n","import { ErrorMessage, Field, FormikProps } from \"formik\";\nimport * as React from \"react\";\nimport { Button, Form } from \"semantic-ui-react\";\nimport { Omit } from \"../../helpers/types\";\nimport { DatasetParamsMIB, DatasetTypes } from \"../../messages\";\nimport { getInitial, getInitialName, parseNumList, withValidation } from \"../helpers\";\nimport { OpenFormProps } from \"../types\";\nimport TupleInput from \"./TupleInput\";\n\n// some fields have different types in the form vs. in messages\ntype DatasetParamsMIBForForm = Omit<DatasetParamsMIB,\n    \"path\"\n    | \"type\"\n    | \"scan_size\"\n> & {\n    scan_size: string,\n};\n\ntype FormValues = DatasetParamsMIBForForm\n\ntype MergedProps = FormikProps<FormValues> & OpenFormProps<DatasetParamsMIB>;\n\nconst MIBFileParamsForm: React.SFC<MergedProps> = ({\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    handleReset,\n    isValidating,\n    onCancel,\n    setFieldValue,\n}) => {\n\n    return (\n        <Form onSubmit={handleSubmit}>\n            <Form.Field>\n                <label htmlFor=\"id_name\">Name:</label>\n                <ErrorMessage name=\"name\" />\n                <Field name=\"name\" id=\"id_name\" />\n            </Form.Field>\n            <Form.Field>\n                <label htmlFor=\"id_scan_size_0\">Scan Size:</label>\n                <ErrorMessage name=\"scan_size\" />\n                <TupleInput value={values.scan_size} minLen={2} maxLen={2} fieldName=\"scan_size\" setFieldValue={setFieldValue} />\n            </Form.Field>\n            <Button primary={true} type=\"submit\" disabled={isSubmitting || isValidating}>Load Dataset</Button>\n            <Button type=\"button\" onClick={onCancel}>Cancel</Button>\n            <Button type=\"button\" onClick={handleReset}>Reset</Button>\n        </Form>\n    )\n}\n\nexport default withValidation<DatasetParamsMIB, DatasetParamsMIBForForm>({\n    formToJson: (values, path) => {\n        return {\n            path,\n            type: DatasetTypes.MIB,\n            name: values.name,\n            scan_size: parseNumList(values.scan_size),\n        }\n    },\n    mapPropsToValues: ({path, initial }) => ({\n        name: getInitialName(\"name\",path,initial),\n        scan_size: getInitial(\"scan_size\", \"\", initial).toString(),\n    }),\n    type: DatasetTypes.MIB,\n})(MIBFileParamsForm);\n","import { ErrorMessage, Field, FormikProps } from \"formik\";\nimport * as React from \"react\";\nimport { Button, Form } from \"semantic-ui-react\";\nimport { Omit } from \"../../helpers/types\";\nimport { DatasetParamsRaw, DatasetTypes } from \"../../messages\";\nimport { getInitial, getInitialName, parseNumList, withValidation } from \"../helpers\";\nimport { OpenFormProps } from \"../types\";\nimport TupleInput from \"./TupleInput\";\n\n// some fields have different types in the form vs. in messages\ntype DatasetParamsRawForForm = Omit<DatasetParamsRaw,\n    \"type\"\n    | \"path\"\n    | \"scan_size\"\n    | \"detector_size\"> & {\n        scan_size: string\n        detector_size: string,\n    };\n\ntype MergedProps = FormikProps<DatasetParamsRawForForm> & OpenFormProps<DatasetParamsRaw>;\n\nconst RawFileParamsForm: React.SFC<MergedProps> = ({\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    handleReset,\n    onCancel,\n    setFieldValue,\n}) => {\n\n    return (\n\n        <Form onSubmit={handleSubmit}>\n            <Form.Field>\n                <label htmlFor=\"id_name\">Name:</label>\n                <ErrorMessage name=\"name\" />\n                <Field name=\"name\" id=\"id_name\" />\n            </Form.Field>\n            <Form.Field>\n                <label htmlFor=\"id_scan_size_0\">Scan Size:</label>\n                <ErrorMessage name=\"scan_size\" />\n                <TupleInput value={values.scan_size} minLen={2} maxLen={2} fieldName=\"scan_size\" setFieldValue={setFieldValue} />\n            </Form.Field>\n            <Form.Field>\n                <label htmlFor=\"id_dtype\">Datatype (uint16, uint32, float32, float64, &gt;u2, ..., can be anything that is <a href=\"https://docs.scipy.org/doc/numpy-1.15.1/reference/arrays.dtypes.html\">understood by numpy as a dtype</a>):</label>\n                <ErrorMessage name=\"dtype\" />\n                <Field name=\"dtype\" id=\"id_dtype\" />\n            </Form.Field>\n            <Form.Field>\n                <label htmlFor=\"id_detector_size_0\">Detector Size (pixels, example: 256,256):</label>\n                <ErrorMessage name=\"detector_size\" />\n                <TupleInput value={values.detector_size} minLen={2} maxLen={2} fieldName=\"detector_size\" setFieldValue={setFieldValue} />\n            </Form.Field>\n            <Form.Field>\n                <label htmlFor=\"id_enable_direct\">Enable Direct I/O (for usage with fast SSDs and files much larger than RAM):</label>\n                <ErrorMessage name=\"enable_direct\" />\n                <Field type=\"checkbox\" name=\"enable_direct\" checked={values.enable_direct} id=\"id_enable_direct\" />\n            </Form.Field>\n            <Button primary={true} type=\"submit\" disabled={isSubmitting}>Load Dataset</Button>\n            <Button type=\"button\" onClick={onCancel}>Cancel</Button>\n            <Button type=\"button\" onClick={handleReset}>Reset</Button>\n        </Form>\n    )\n}\n\nexport default withValidation<DatasetParamsRaw, DatasetParamsRawForForm>({\n    mapPropsToValues: ({path, initial }) => ({\n        name: getInitialName(\"name\",path,initial),\n        enable_direct: getInitial(\"enable_direct\", false, initial),\n        detector_size: getInitial(\"detector_size\", \"\", initial).toString(),\n        scan_size: getInitial(\"scan_size\", \"\", initial).toString(),\n        dtype: getInitial(\"dtype\", \"float32\", initial),\n    }),\n    formToJson: (values, path) => {\n        return {\n            path,\n            type: DatasetTypes.RAW,\n            name: values.name,\n            dtype: values.dtype,\n            enable_direct: values.enable_direct,\n            scan_size: parseNumList(values.scan_size),\n            detector_size: parseNumList(values.detector_size),\n        }\n    },\n    type: DatasetTypes.RAW,\n})(RawFileParamsForm);\n","import { ErrorMessage, Field, FormikProps } from \"formik\";\nimport * as React from \"react\";\nimport { Button, Form } from \"semantic-ui-react\";\nimport { Omit } from \"../../helpers/types\";\nimport { DatasetParamsSEQ, DatasetTypes } from \"../../messages\";\nimport { getInitial, getInitialName, parseNumList, withValidation } from \"../helpers\";\nimport { OpenFormProps } from \"../types\";\nimport TupleInput from \"./TupleInput\";\n\n// some fields have different types in the form vs. in messages\ntype DatasetParamsSEQForForm = Omit<DatasetParamsSEQ,\n    \"path\"\n    | \"type\"\n    | \"scan_size\"\n> & {\n    scan_size: string,\n};\n\ntype FormValues = DatasetParamsSEQForForm\n\ntype MergedProps = FormikProps<FormValues> & OpenFormProps<DatasetParamsSEQ>;\n\nconst SEQFileParamsForm: React.SFC<MergedProps> = ({\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    handleReset,\n    isValidating,\n    onCancel,\n    setFieldValue,\n}) => {\n\n    return (\n        <Form onSubmit={handleSubmit}>\n            <Form.Field>\n                <label htmlFor=\"id_name\">Name:</label>\n                <ErrorMessage name=\"name\" />\n                <Field name=\"name\" id=\"id_name\" />\n            </Form.Field>\n            <Form.Field>\n                <label htmlFor=\"id_scan_size_0\">Scan Size:</label>\n                <ErrorMessage name=\"scan_size\" />\n                <TupleInput value={values.scan_size} minLen={2} maxLen={2} fieldName=\"scan_size\" setFieldValue={setFieldValue} />\n            </Form.Field>\n            <Button primary={true} type=\"submit\" disabled={isSubmitting || isValidating}>Load Dataset</Button>\n            <Button type=\"button\" onClick={onCancel}>Cancel</Button>\n            <Button type=\"button\" onClick={handleReset}>Reset</Button>\n        </Form>\n    )\n}\n\nexport default withValidation<DatasetParamsSEQ, DatasetParamsSEQForForm>({\n    formToJson: (values, path) => {\n        return {\n            path,\n            type: DatasetTypes.SEQ,\n            name: values.name,\n            scan_size: parseNumList(values.scan_size),\n        }\n    },\n    mapPropsToValues: ({ path, initial }) => ({\n        name: getInitialName(\"name\", path, initial),\n        scan_size: getInitial(\"scan_size\", \"\", initial).toString(),\n    }),\n    type: DatasetTypes.SEQ,\n})(SEQFileParamsForm);\n","import { ErrorMessage, Field, FormikProps } from \"formik\";\nimport * as React from \"react\";\nimport { Button, Form } from \"semantic-ui-react\";\nimport { Omit } from \"../../helpers/types\";\nimport { DatasetParamsSER, DatasetTypes } from \"../../messages\";\nimport { getInitialName, withValidation } from \"../helpers\";\nimport { OpenFormProps } from \"../types\";\n\n// some fields have different types in the form vs. in messages\ntype DatasetParamsSERForForm = Omit<DatasetParamsSER,\n    \"path\" | \"type\">;\n\ntype MergedProps = FormikProps<DatasetParamsSERForForm> & OpenFormProps<DatasetParamsSER>;\nconst SERParamsForm: React.SFC<MergedProps> = ({\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    handleReset,\n    onCancel,\n}) => {\n    return (\n        <Form onSubmit={handleSubmit}>\n            <Form.Field>\n                <label htmlFor=\"id_name\">Name:</label>\n                <ErrorMessage name=\"name\" />\n                <Field name=\"name\" id=\"id_name\" />\n            </Form.Field>\n\n            <Button primary={true} type=\"submit\" disabled={isSubmitting}>Load Dataset</Button>\n            <Button type=\"button\" onClick={onCancel}>Cancel</Button>\n            <Button type=\"button\" onClick={handleReset}>Reset</Button>\n        </Form>\n    )\n}\n\nexport default withValidation<DatasetParamsSER, DatasetParamsSERForForm>({\n    mapPropsToValues: ({path, initial }) => ({\n        name: getInitialName(\"name\",path,initial),\n    }),\n    formToJson: (values, path) => {\n        return {\n            path,\n            type: DatasetTypes.SER,\n            name: values.name,\n        }\n    },\n    type: DatasetTypes.SER,\n})(SERParamsForm);\n","import * as React from \"react\";\nimport { useDispatch, useSelector } from 'react-redux';\nimport { DropdownProps, Header, Segment } from \"semantic-ui-react\";\nimport uuid from \"uuid/v4\";\nimport { assertNotReached } from \"../../helpers\";\nimport { DatasetFormParams, DatasetTypes } from '../../messages';\nimport { RootReducer } from \"../../store\";\nimport * as datasetActions from \"../actions\";\nimport { hasKey, isAdditionalInfo } from \"../helpers\";\nimport { OpenDatasetState } from \"../types\";\nimport BLOParamsForm from \"./BLOParamsForm\";\nimport DatasetTypeSelect from \"./DatasetTypeSelect\";\nimport EMPADParamsForm from \"./EMPADParamsForm\";\nimport FRMS6ParamsForm from \"./FRMS6ParamsForm\";\nimport HDF5ParamsForm from \"./HDF5ParamsForm\";\nimport K2ISParamsForm from \"./K2ISParamsForm\";\nimport MIBParamsForm from \"./MIBParamsForm\";\nimport RawFileParamsForm from \"./RawFileParamsForm\";\nimport SEQParamsForm from \"./SEQParamsForm\";\nimport SERParamsForm from \"./SERParamsForm\";\n\n\n/**\n * Get the initial selection for the dataset type dropdown. If we have a previous\n * user selection, we use it, but only if the reset button was not pressed. If it was,\n * we use the detected dataset type, falling back to RAW.\n *\n * @param didReset flag: was the reset button pressed?\n * @param openState complete OpenDatasetState instance\n */\nconst getDefaultDSType = (didReset: boolean, openState: OpenDatasetState) => {\n    const { formCachedParams, formDetectedParams } = openState;\n    if (didReset) {\n        return formDetectedParams ? formDetectedParams.type : DatasetTypes.RAW;\n    }\n    if (formCachedParams) {\n        return formCachedParams.type;\n    }\n    if (formDetectedParams) {\n        return formDetectedParams.type;\n    }\n    return DatasetTypes.RAW;\n}\n\n\n/**\n * Get the initial form field values. If we have previously entered values, we\n * use these, otherwise we use the detected parameters. If the reset button was\n * clicked, we use the detected params, but keep the original name field,\n *\n * @param didReset flag: was the reset button pressed?\n * @param openState complete OpenDatasetState instance\n */\n\n// Fix this after separating info from params\nconst getAdditionalInfo = (formDetectedParams: DatasetFormParams) => {\n    const additionalInfo = Object.keys(formDetectedParams)\n        .filter(isAdditionalInfo)\n        .reduce((allInfo: object, info: string) => {\n            return hasKey(formDetectedParams, info) ? { ...allInfo, [info]: formDetectedParams[info] } : { ...allInfo };\n        }, {});\n    return additionalInfo;\n}\n\nconst getFormInitial = (didReset: boolean, openState: OpenDatasetState) => {\n    const { formCachedParams, formDetectedParams } = openState;\n    if (didReset) {\n        if (formDetectedParams) {\n            return {\n                ...formDetectedParams,\n                name: formCachedParams ? formCachedParams.name : \"\",\n            };\n        }\n        return undefined;\n    }\n    if (formCachedParams) {\n        if (formDetectedParams) {\n            const additionalInfo = getAdditionalInfo(formDetectedParams);\n            return { ...additionalInfo, ...formCachedParams };\n        }\n        return formCachedParams;\n    } else {\n        return formDetectedParams;\n    }\n}\n\n/**\n * Dispatch to specific dataset opening forms, including a selection of dataset type\n * via a dropdown.\n */\nconst DatasetOpen = () => {\n    const dispatch = useDispatch();\n    const openState = useSelector((state: RootReducer) => state.openDataset);\n\n    const [didReset, setReset] = React.useState(false);\n    const formInitial = getFormInitial(didReset, openState);\n    const defaultType = getDefaultDSType(didReset, openState);\n    const [datasetType, setDatasetType] = React.useState(defaultType);\n\n    const doSetType = (e: React.SyntheticEvent, data: DropdownProps) => setDatasetType(data.value as DatasetTypes);\n    // FIXME: find out how to make ts correctly correlate the types of FormComponent\n    // and initial and replace the huge switch below with something like:\n    // const initial = formInitial && datasetType === formInitial.type ? formInitial : undefined;\n    // const formComponentMap = {\n    //     [DatasetTypes.HDF5]: HDF5ParamsForm,\n    //     [DatasetTypes.RAW]: RawFileParamsForm,\n    //     [DatasetTypes.MIB]: MIBParamsForm,\n    //     [DatasetTypes.BLO]: BLOParamsForm,\n    //     [DatasetTypes.K2IS]: K2ISParamsForm,\n    //     [DatasetTypes.SER]: SERParamsForm,\n    //     [DatasetTypes.FRMS6]: FRMS6ParamsForm,\n    //     [DatasetTypes.EMPAD]: EMPADParamsForm,\n    // }\n    // const FormComponent = formComponentMap[datasetType];\n\n    const renderForm = (form: React.ReactNode) => {\n        return (\n            <Segment>\n                Type: <DatasetTypeSelect onClick={doSetType} currentType={datasetType} />\n                <Header as=\"h2\">Open: {openState.formPath}</Header>\n                {form}\n            </Segment>\n        );\n    }\n\n    const commonParams = {\n        path: openState.formPath,\n        onSubmit: (params: DatasetFormParams) => {\n            dispatch(datasetActions.Actions.create({\n                id: uuid(),\n                params,\n            }))\n        },\n        onCancel: () => dispatch(datasetActions.Actions.cancelOpen()),\n        onReset: () => {\n            setReset(true);\n            setDatasetType(getDefaultDSType(true, openState));\n        },\n    }\n\n    switch (datasetType) {\n        case DatasetTypes.HDF5: {\n            const initial = formInitial && datasetType === formInitial.type ? formInitial : undefined;\n            return renderForm(<HDF5ParamsForm {...commonParams} initial={initial} />);\n        }\n        case DatasetTypes.RAW: {\n            const initial = formInitial && datasetType === formInitial.type ? formInitial : undefined;\n            return renderForm(<RawFileParamsForm {...commonParams} initial={initial} />);\n        }\n        case DatasetTypes.MIB: {\n            const initial = formInitial && datasetType === formInitial.type ? formInitial : undefined;\n            return renderForm(<MIBParamsForm {...commonParams} initial={initial} />);\n        }\n        case DatasetTypes.BLO: {\n            const initial = formInitial && datasetType === formInitial.type ? formInitial : undefined;\n            return renderForm(<BLOParamsForm {...commonParams} initial={initial} />);\n        }\n        case DatasetTypes.K2IS: {\n            const initial = formInitial && datasetType === formInitial.type ? formInitial : undefined;\n            return renderForm(<K2ISParamsForm {...commonParams} initial={initial} />);\n        }\n        case DatasetTypes.SER: {\n            const initial = formInitial && datasetType === formInitial.type ? formInitial : undefined;\n            return renderForm(<SERParamsForm {...commonParams} initial={initial} />);\n        }\n        case DatasetTypes.FRMS6: {\n            const initial = formInitial && datasetType === formInitial.type ? formInitial : undefined;\n            return renderForm(<FRMS6ParamsForm {...commonParams} initial={initial} />);\n        }\n        case DatasetTypes.EMPAD: {\n            const initial = formInitial && datasetType === formInitial.type ? formInitial : undefined;\n            return renderForm(<EMPADParamsForm {...commonParams} initial={initial} />)\n        }\n        case DatasetTypes.SEQ: {\n            const initial = formInitial && datasetType === formInitial.type ? formInitial : undefined;\n            return renderForm(<SEQParamsForm {...commonParams} initial={initial} />);\n        }\n    }\n    return assertNotReached(\"unknown dataset type\");\n}\n\nexport default DatasetOpen;\n","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Header, Icon, Message } from \"semantic-ui-react\";\nimport { RootReducer } from \"../../store\";\n\nconst mapStateToProps = (state: RootReducer) => {\n    return {\n        busy: state.openDataset.busy,\n        path: state.openDataset.busyPath,\n    };\n}\n\ntype MergedProps = ReturnType<typeof mapStateToProps>;\n\nconst DatasetOpenSpinner: React.SFC<MergedProps> = ({ busy, path }) => {\n    if (!busy) {\n        return null;\n    }\n    return (\n        <>\n            <Header as=\"h2\" dividing={true}>Loading...</Header>\n            <Message icon={true}>\n                <Icon name='cog' loading={true} />\n                <Message.Content>\n                    <Message.Header>Detecting parameters for {path}</Message.Header>\n                </Message.Content>\n            </Message>\n        </>\n    );\n}\n\nexport default connect(mapStateToProps)(DatasetOpenSpinner);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport BrowserWrapper from \"../../browser/components/BrowserWrapper\";\nimport { RootReducer } from \"../../store\";\nimport { DatasetsState } from \"../types\";\nimport Dataset from \"./Dataset\";\nimport DatasetOpen from \"./DatasetOpen\";\nimport DatasetOpenSpinner from \"./DatasetOpenSpinner\";\n\ninterface DatasetListProps {\n    datasets: DatasetsState\n}\n\nconst mapStateToProps = (state: RootReducer) => {\n    return {\n        datasets: state.datasets,\n        formVisible: state.openDataset.formVisible,\n        formPath: state.openDataset.formPath,\n    };\n}\n\ntype MergedProps = DatasetListProps & ReturnType<typeof mapStateToProps>;\n\nclass DatasetList extends React.Component<MergedProps> {\n    public render() {\n        const { formVisible, datasets } = this.props;\n\n        return (\n            <>\n                {datasets.ids.map((dsId: string) => <Dataset dataset={datasets.byId[dsId]} key={dsId} />)}\n                <DatasetOpenSpinner />\n                {formVisible && <DatasetOpen />}\n                <BrowserWrapper />\n            </>\n        );\n    }\n}\n\nexport default connect(mapStateToProps)(DatasetList);","import { ActionsUnion, createAction } from \"../helpers/actionHelpers\";\nimport { JobResultType } from \"../job/types\";\nimport { AnalysisDetails, MsgPartAnalysis, MsgPartCompoundAnalysis, MsgPartInitialDataset, MsgPartJob } from \"../messages\";\n\nexport type PartialResultType = JobResultType;\n\nexport enum ActionTypes {\n    INITIAL_STATE = \"CHANNEL_INITIAL_STATE\",\n    JOB_STARTED = \"CHANNEL_JOB_STARTED\",\n    FINISH_JOB = \"CHANNEL_FINISH_JOB\",\n    TASK_RESULT = \"CHANNEL_TASK_RESULT\",\n    JOB_ERROR = \"CHANNEL_JOB_ERROR\",\n    OPEN = \"CHANNEL_OPEN\",\n    CLOSE = \"CHANNEL_CLOSE\",\n    ERROR = \"CHANNEL_ERROR\",\n    CANCELLED = \"CANCELLED\",\n    SHUTDOWN = \"CHANNEL_SHUTDOWN\",\n    CLOSE_LOOP = \"CHANNEL_LOOP_CLOSE\",\n    ANALYSIS_CREATED = \"ANALYSIS_CREATED\",\n    ANALYSIS_UPDATED = \"ANALYSIS_UPDATED\",\n    ANALYSIS_REMOVED = \"ANALYSIS_REMOVED\",\n}\n\nexport const Actions = {\n    initialState: (\n        jobs: MsgPartJob[],\n        datasets: MsgPartInitialDataset[],\n        compoundAnalyses: MsgPartCompoundAnalysis[],\n        analyses: MsgPartAnalysis[],\n        timestamp: number\n    ) => createAction(ActionTypes.INITIAL_STATE, { jobs, datasets, timestamp, compoundAnalyses, analyses }),\n    jobStarted: (job: string, dataset: string, timestamp: number) => createAction(ActionTypes.JOB_STARTED, { job, timestamp, dataset }),\n    finishJob: (job: string, results: JobResultType[], timestamp: number) => createAction(ActionTypes.FINISH_JOB, { job, results, timestamp }),\n    taskResult: (job: string, results: PartialResultType[], timestamp: number) => createAction(ActionTypes.TASK_RESULT, { job, results, timestamp }),\n    jobError: (job: string, msg: string, id: string, timestamp: number) => createAction(ActionTypes.JOB_ERROR, { job, msg, id, timestamp }),\n    open: (timestamp: number) => createAction(ActionTypes.OPEN, { timestamp }),\n    close: (timestamp: number) => createAction(ActionTypes.CLOSE, { timestamp }),\n    error: (msg: string, timestamp: number, id: string) => createAction(ActionTypes.ERROR, { msg, timestamp, id }),\n    shutdown: (timestamp: number) => createAction(ActionTypes.SHUTDOWN, { timestamp }),\n    closeloop: (timestamp: number) => createAction(ActionTypes.CLOSE_LOOP, { timestamp }),\n    cancelled: (job: string) => createAction(ActionTypes.CANCELLED, { job }),\n    analysisCreated: (analysis: string, dataset: string, details: AnalysisDetails) =>\n        createAction(ActionTypes.ANALYSIS_CREATED, { dataset, analysis, details }),\n    analysisUpdated: (analysis: string, dataset: string, details: AnalysisDetails) =>\n        createAction(ActionTypes.ANALYSIS_UPDATED, { dataset, analysis, details }),\n    analysisRemoved: (analysis: string) => createAction(ActionTypes.ANALYSIS_REMOVED, { analysis }),\n};\n\nexport type Actions = ActionsUnion<typeof Actions>;\n","import * as React from 'react';\nimport { connect } from 'react-redux';\nimport { Dispatch } from 'redux';\nimport { Message } from 'semantic-ui-react';\nimport * as errorActions from '../actions';\nimport { ErrorMessage } from '../reducers';\n\nconst mapDispatchToProps = (dispatch: Dispatch, ownProps: ErrorProps) => {\n    return {\n        dismiss: () => dispatch(errorActions.Actions.dismiss(ownProps.error.id)),\n    }\n}\n\ninterface ErrorProps {\n    error: ErrorMessage,\n}\n\ntype MergedProps = ErrorProps & ReturnType<typeof mapDispatchToProps>;\n\nconst ErrorComponent: React.SFC<MergedProps> = ({ dismiss, error }) => {\n    return (\n        <Message negative={true} onDismiss={dismiss}>{error.msg}</Message>\n    )\n}\n\nexport default connect(null, mapDispatchToProps)(ErrorComponent);","import * as React from \"react\";\nimport { connect, useDispatch } from \"react-redux\";\nimport { Modal } from \"semantic-ui-react\";\nimport { useDismissEscape } from \"../../helpers/hooks\";\nimport { RootReducer } from \"../../store\";\nimport { Actions } from \"../actions\";\nimport Error from \"./Error\";\n\nconst mapStateToProps = (state: RootReducer) => {\n    return {\n        errors: state.errors,\n        channelConnected: (state.channelStatus.status === \"connected\" ||\n            state.channelStatus.status === \"ready\"),\n    }\n}\n\ntype MergedProps = ReturnType<typeof mapStateToProps>;\n\nconst ErrorList: React.SFC<MergedProps> = ({ errors, channelConnected }) => {\n    const numShown = 3;\n    const latestErrors = errors.ids.slice(Math.max(0, errors.ids.length - numShown));\n    const showModal = errors.ids.length > 0 && channelConnected;\n\n    const dispatch = useDispatch();\n\n    const doDismiss = () => {\n        dispatch(Actions.dismissAll());\n    }\n\n    useDismissEscape(doDismiss);\n\n    return (\n        <Modal open={showModal}>\n            {latestErrors.map(error => <Error error={errors.byId[error]} key={error} />)}\n        </Modal>\n    );\n}\n\nexport default connect(mapStateToProps)(ErrorList);","import React from \"react\";\n\nexport const useDismissEscape = (dismiss: () => void) => {\n    React.useEffect(() => {\n        const handleEsc = (ev: KeyboardEvent) => {\n            if(ev.code === \"Escape\" || ev.keyCode === 27) {\n                dismiss();\n            }\n        }\n        document.addEventListener(\"keyup\", handleEsc);\n\n        return () => {\n            document.removeEventListener(\"keyup\", handleEsc);\n        };\n    });\n}","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Header, List } from \"semantic-ui-react\";\nimport { RootReducer } from \"./store\";\n\nconst mapStateToProps = (state: RootReducer) => {\n    return {\n        version: state.config.version,\n        revision: state.config.revision,\n    }\n}\n\ntype MergedProps = ReturnType<typeof mapStateToProps>;\n\nconst About: React.SFC<MergedProps> = ({ version, revision }) => {\n    return (\n        <>\n            <Header as=\"h3\">This is LiberTEM version {version} (revision {revision.slice(0, 8)})</Header>\n            <List>\n                <List.Item>\n                    <List.Icon name=\"github\" />\n                    <List.Content>\n                        Find us on <a href=\"https://github.com/LiberTEM/LiberTEM\">GitHub</a>\n                    </List.Content>\n                </List.Item>\n                <List.Item>\n                    <List.Icon name=\"bug\" />\n                    <List.Content>\n                        Found a bug? Got a feature request? Please <a href=\"https://github.com/LiberTEM/LiberTEM/issues/new\">open an issue!</a>\n                    </List.Content>\n                </List.Item>\n                <List.Item>\n                    <List.Icon name=\"legal\" />\n                    <List.Content>\n                        LiberTEM is licensed under the <a href=\"https://github.com/LiberTEM/LiberTEM/blob/master/LICENSE\">GNU General Public License v3.0</a>\n                    </List.Content>\n                </List.Item>\n                <List.Item>\n                    <List.Icon name=\"book\" />\n                    <List.Content>\n                        Read <a href=\"https://libertem.github.io/LiberTEM/\">the documentation</a>\n                    </List.Content>\n                </List.Item>\n                <List.Item>\n                    <List.Icon name=\"user\" />\n                    <List.Content>\n                        Read <a href=\"https://libertem.github.io/LiberTEM/acknowledgments.html\">the acknowledgments</a>\n                    </List.Content>\n                </List.Item>\n                <List.Item>\n                    <List.Icon name=\"gitter\" />\n                    <List.Content>\n                        Join our <a href=\"https://gitter.im/LiberTEM/Lobby\">chat on gitter!</a>\n                    </List.Content>\n                </List.Item>\n                <List.Item>\n                    <List.Icon name=\"linkify\" />\n                    <List.Content>\n                    <a href=\"https://doi.org/10.5281/zenodo.1477847\"><img src=\"https://zenodo.org/badge/DOI/10.5281/zenodo.1477847.svg\" alt=\"doi.org/10.5281/zenodo.1477847\"/></a>\n                    </List.Content>\n                </List.Item>\n            </List>\n        </>\n    );\n}\n\nexport default connect(mapStateToProps)(About);\n","import * as React from \"react\";\nimport { useEffect, useState } from \"react\";\nimport { List, Modal } from \"semantic-ui-react\";\nimport { HostDetails } from \"../messages\";\n\ninterface LocalStatusProps {\n    localCore: number;\n    cudas: number[];\n    details: HostDetails[];\n}\n\nconst LocalStatus: React.FC<LocalStatusProps> = ({ localCore, cudas, details }) => {\n    const [cudaText, setcudaText] = useState(\"\");\n\n    useEffect(() => {\n        if (cudas.length === 0) {\n            setcudaText(\"None selected\");\n        } else {\n            const ids = cudas\n                .map(id => {\n                    return ` ${id}`;\n                })\n                .join(\",\");\n            setcudaText(`GPU ${ids}`);\n        }\n    }, [cudas]);\n\n    return (\n        <Modal.Content>\n            <List>\n                <List.Item>\n                    <List.Content as=\"h4\">Connected to local cluster</List.Content>\n                </List.Item>\n                <List.Item>\n                    <List.Content>Number of local core : {localCore}</List.Content>\n                </List.Item>\n                <List.Item>\n                    <List.Content>Number of CPU workers : {details[0].cpu} </List.Content>\n                </List.Item>\n                <List.Item>\n                    <List.Content>Number of CUDA workers : {details[0].cuda}</List.Content>\n                </List.Item>\n                <List.Item>\n                    <List.Content>Selected CUDA devices : {cudaText}</List.Content>\n                </List.Item>\n            </List>\n        </Modal.Content>\n    );\n};\n\nexport default LocalStatus;\n","import * as React from \"react\";\nimport { List, Modal } from \"semantic-ui-react\";\n\nconst NotConnected: React.SFC = () => (\n        <Modal.Content>\n                <List>\n                    <List.Item>\n                        <List.Content>\n                            Not Connected\n                        </List.Content>\n                    </List.Item>\n                </List>\n        </Modal.Content>\n)\n\nexport default NotConnected;","import * as React from \"react\";\nimport { useEffect, useState } from \"react\";\nimport { Accordion, Button, Header, Icon, List, Modal, Segment } from \"semantic-ui-react\";\nimport { HostDetails } from \"../messages\";\n\nconst ClusterDetails = (details: HostDetails[]) => {\n    const [clustOverview, setOverview] = useState({\n        host: 0,\n        cpu: 0,\n        cuda: 0,\n    });\n\n    const [idx, setIdx] = useState(false);\n    const [expandMsg, setMsg] = useState(\"More Info\");\n\n    const handleClick = () => {\n        setIdx(!idx);\n        if (expandMsg === \"More Info\") {\n            setMsg(\"Less Info\");\n        } else {\n            setMsg(\"More Info\");\n        }\n    };\n\n    useEffect(() => {\n        const overview = {\n            host: 0,\n            cpu: 0,\n            cuda: 0,\n        };\n        details.forEach(node => {\n            overview.host += 1;\n            overview.cpu += node.cpu;\n            overview.cuda += node.cuda;\n        });\n        setOverview(overview);\n    }, [details]);\n\n    const clusterExpanded = details.map((node: HostDetails) => {\n        return (\n            <Segment key={node.host}>\n                <List.Item >\n                    <List.Content>Number of hosts : {node.host}</List.Content>\n                    <List.Content>Number of CPU workers : {node.cpu}</List.Content>\n                    <List.Content>Number of CUDA workers : {node.cuda}</List.Content>\n                </List.Item>\n            </Segment>\n        );\n    });\n\n    return (\n        <>\n            <Segment>\n                <List.Item>\n                    <List.Content>Number of hosts : {clustOverview.host}</List.Content>\n                    <List.Content>Number of CPU workers : {clustOverview.cpu}</List.Content>\n                    <List.Content>Number of CUDA workers : {clustOverview.cuda}</List.Content>\n                </List.Item>\n            </Segment>\n            <Accordion>\n                <Accordion.Title active={idx} onClick={handleClick}>\n                    <Icon name=\"dropdown\" />\n                    {expandMsg}\n                </Accordion.Title>\n                <Accordion.Content active={idx}>\n                    <Segment.Group>{clusterExpanded}</Segment.Group>\n                </Accordion.Content>\n            </Accordion>\n        </>\n    );\n};\n\ninterface TCPStatusProps {\n    address: string;\n    details: HostDetails[];\n}\n\nconst TCPStatus: React.SFC<TCPStatusProps> = ({ address, details }) => {\n    const template = [\n        `import libertem.api as lt`,\n        `import distributed as dd`,\n        `from libertem.executor.dask import DaskJobExecutor\\n`,\n        `client = dd.Client(\"URI\")`,\n        `executor = DaskJobExecutor(client)\\n`,\n        `ctx = lt.Context(executor=executor)`,\n    ];\n\n    const connectionCode = template.join(\"\\n\");\n    const code = connectionCode.replace(\"URI\", address);\n    const copyToClipboard = () => {\n        navigator.clipboard.writeText(code);\n    };\n\n    return (\n        <Modal.Content>\n            <List>\n                <Header as=\"h4\" attached=\"top\">\n                    Connected to {address}\n                </Header>\n                <Segment.Group>{ClusterDetails(details)}</Segment.Group>\n                <List.Item>\n                    <List.Content>\n                        <Segment.Group>\n                            <Segment as=\"h5\">Connection code</Segment>\n                            <Segment>\n                                <Button floated={\"right\"} icon={\"copy\"} onClick={copyToClipboard} />\n                                <pre>\n                                    <code>\n                                        {code}\n                                    </code>\n                                </pre>\n                            </Segment>\n                        </Segment.Group>\n                    </List.Content>\n                </List.Item>\n            </List>\n        </Modal.Content>\n    );\n};\n\nexport default TCPStatus;\n","import * as React from \"react\";\nimport { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { Button, Modal, Popup } from \"semantic-ui-react\";\nimport { RootReducer } from \"../store\";\nimport LocalStatus from \"./localStatus\";\nimport NotConnected from \"./NotConnected\";\nimport TCPStatus from \"./TCPStatus\";\n\nconst mapStateToProps = (state: RootReducer) => {\n    return {\n        clusterConnection: state.clusterConnection,\n        channelStatus: state.channelStatus.status,\n        type: state.config.lastConnection.type,\n        localcore: state.config.localCores,\n        cudas: state.config.lastConnection.cudas,\n        address: state.config.lastConnection.address,\n    };\n};\n\ntype MergedProps = ReturnType<typeof mapStateToProps>;\n\nconst ClusterStatus: React.SFC<MergedProps> = ({ clusterConnection, channelStatus, type, localcore, cudas, address }) => {\n\n    enum colorType  {\n        blue= \"blue\",\n        grey= \"grey\"\n    }\n\n    const [color , setColor] = useState<colorType>(colorType.grey)\n    const [status, setStatus] =  useState(clusterConnection.status)\n    const [disable, setDisable] = useState(true)\n\n    useEffect(()=>{\n        if (channelStatus === \"connected\"|| channelStatus === \"ready\"){\n            setStatus(clusterConnection.status)\n            setDisable(false)\n            if (clusterConnection.status === \"connected\"){\n                setColor(colorType.blue)\n            }else{\n                setColor(colorType.grey)\n            }\n        }else{\n            setDisable(true)\n            setStatus(\"unknown\")\n            setColor(colorType.grey)\n        }\n\n    }, [clusterConnection, channelStatus, colorType])\n\n\n    const clusterDetails = () => {\n        if (clusterConnection.status === \"connected\") {\n            const { details } = clusterConnection;\n            if (type === \"LOCAL\") {\n                return <LocalStatus cudas={cudas} details={details} localCore={localcore} />;\n            } else {\n                return <TCPStatus address={address} details={details} />;\n            }\n        } else {\n            return <NotConnected />;\n        }\n    };\n\n    return (\n        <Modal\n            trigger={\n                <Button\n                    color= {color}\n                    content=\"Cluster info\"\n                    icon=\"plug\"\n                    labelPosition=\"left\"\n                    disabled={disable}\n                    label={{ as: \"a\", basic: true, content: status }} /> }\n            size=\"small\" >\n            <Popup.Header>Connection Info</Popup.Header>\n            <Popup.Content>{clusterDetails()}</Popup.Content>\n        </Modal>\n    );\n};\n\nexport default connect(mapStateToProps)(ClusterStatus);\n","import { genericDelete } from \"../helpers/apiHelpers\";\nimport { ShutdownResponse } from '../messages'\n\nexport async function doShutdown(): Promise<ShutdownResponse> {\n    return await genericDelete(`shutdown/`)\n}\n","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Button, Header, Icon, Modal } from \"semantic-ui-react\";\nimport * as channelActions from \"../../channel/actions\";\nimport { RootReducer } from \"../../store\";\nimport { doShutdown } from \"../api\";\n\nconst mapDispatchToProps = {\n    closeLoopAction: channelActions.Actions.closeloop,\n    shutdownAction: channelActions.Actions.shutdown,\n};\n\nconst mapStateToProps = (state: RootReducer) => {\n    return {\n        channel: state.channelStatus.status,\n    };\n};\n\ntype MergedProps = DispatchProps<typeof mapDispatchToProps> & ReturnType<typeof mapStateToProps>;\n\nclass ShutdownButton extends React.Component<MergedProps> {\n    public state = {\n        modal: false,\n        shutdown: false,\n    };\n\n    public modalOpen = () => {\n        this.setState({ modal: true });\n    };\n\n    public modalClose = () => {\n        this.setState({ modal: false });\n    };\n\n    public handleShutdown = () => {\n        this.setState({ shutdown: true });\n        doShutdown().then((response) => {\n            const timestamp = Date.now();\n            this.props.closeLoopAction(timestamp);\n        });\n    };\n\n    public componentDidUpdate() {\n        if (this.props.channel === \"waiting\" && this.state.shutdown) {\n            const timestamp = Date.now();\n            this.modalClose();\n            this.props.shutdownAction(timestamp);\n        }\n    }\n\n    public render() {\n        return (\n            <Modal\n                trigger={\n                    <Button\n                        content=\"Shutdown\"\n                        icon=\"shutdown\"\n                        onClick={this.modalOpen}\n                        disabled={this.state.shutdown}\n                        labelPosition=\"left\"\n                        floated=\"right\"\n                    />\n                }\n                open={this.state.modal}\n                closeOnDimmerClick={false}\n                onClose={this.modalClose}\n                size=\"mini\"\n            >\n                <Header icon=\"shutdown\" content=\"Confirm shutdown\" />\n                <Modal.Content>\n                    <p>Do you want to shutdown ?</p>\n                </Modal.Content>\n                <Modal.Actions>\n                    <Button onClick={this.modalClose} disabled={this.state.shutdown}>\n                        <Icon name=\"remove\" /> Cancel\n                    </Button>\n                    <Button primary={true} loading={this.state.shutdown} disabled={this.state.shutdown} onClick={this.handleShutdown}>\n                        <Icon name=\"checkmark\" /> Shutdown\n                    </Button>\n                </Modal.Actions>\n            </Modal>\n        );\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ShutdownButton);\n","import React from \"react\";\nimport { Button, Menu, Modal, Popup } from \"semantic-ui-react\";\nimport About from \"./About\";\nimport ClusterStatus from \"./clusterStatus/Cluster\"\nimport QuitButton from \"./shutdown/components/ShutdownButton\";\n\nconst HeaderMenu: React.SFC = () => {\n    return (\n        <Menu fixed=\"top\">\n            <Menu.Item>\n                <Modal trigger={<Button content=\"About\" />}>\n                    <Popup.Header>About LiberTEM</Popup.Header>\n                    <Popup.Content>\n                        <About />\n                    </Popup.Content>\n                </Modal>\n            </Menu.Item>\n            <Menu.Menu position=\"right\">\n                <Menu.Item>\n                    <ClusterStatus />\n                </Menu.Item>\n                <Menu.Item>\n                    <QuitButton />\n                </Menu.Item>\n            </Menu.Menu>\n        </Menu>\n    );\n};\n\nexport default HeaderMenu;\n","import * as React from \"react\";\nimport \"semantic-ui-css/semantic.min.css\";\nimport { Container } from \"semantic-ui-react\";\nimport ChannelStatus from \"./channel/components/ChannelStatus\";\nimport DatasetList from \"./dataset/components/DatasetList\";\nimport ErrorList from \"./errors/components/ErrorList\";\nimport logo from \"./images/LiberTEM logo-medium.png\";\nimport HeaderMenu from \"./Menu\";\n\nclass App extends React.Component {\n    public render() {\n        return (\n            <>\n                <HeaderMenu />\n                <Container style={{ margin: \"5em 1em 5em 1em\" }}>\n                    <div style={{ display: \"flex\" }}>\n                        <img src={logo} width=\"200\" height=\"46\" alt=\"LiberTEM\" style={{ marginBottom: \"20px\" }} />\n                    </div>\n                    <ErrorList />\n                    <ChannelStatus>\n                        <DatasetList />\n                    </ChannelStatus>\n                </Container>\n            </>\n        );\n    }\n}\n\nexport default App;\n","// tslint:disable:no-console\n// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the 'N+1' visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL!,\n      window.location.toString()\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker) {\n          installingWorker.onstatechange = () => {\n            if (installingWorker.state === 'installed') {\n              if (navigator.serviceWorker.controller) {\n                // At this point, the old content will have been purged and\n                // the fresh content will have been added to the cache.\n                // It's the perfect time to display a 'New content is\n                // available; please refresh.' message in your web app.\n                console.log('New content is available; please refresh.');\n              } else {\n                // At this point, everything has been precached.\n                // It's the perfect time to display a\n                // 'Content is cached for offline use.' message.\n                console.log('Content is cached for offline use.');\n              }\n            }\n          };\n        }\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type')!.indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import _ from 'lodash';\nimport { ClusterTypes, MsgPartConfig } from \"../messages\";\nimport { ConfigParams, ConfigState, LocalConfig } from \"./reducers\";\n\nconst CONFIG_KEY = \"LiberTEM.config\";\n\nexport function joinPaths(config: ConfigState, ...parts: string[]) {\n    const removeSep = (part: string) => part.replace(new RegExp(`${_.escapeRegExp(config.separator)}$`), \"\")\n    parts = [removeSep(parts[0]), ...parts.slice(1)];\n    return parts.map(part => part.trim()).join(config.separator);\n}\n\nexport function mergeLocalStorage(serverConfig: MsgPartConfig): ConfigParams {\n    const localSettings = window.localStorage.getItem(CONFIG_KEY);\n    if (localSettings === null) {\n        return Object.assign({}, getDefaultLocalConfig(), serverConfig);\n    }\n    const localSettingsParsed = JSON.parse(localSettings);\n    const defaultConfig = getDefaultLocalConfig();\n    const mergedConfig = Object.assign({}, defaultConfig, serverConfig, localSettingsParsed);\n    return mergedConfig;\n}\n\nexport function setLocalStorage(config: ConfigState): void {\n    const localSettings: LocalConfig = {\n        cwd: config.cwd,\n        lastOpened: config.lastOpened,\n        fileHistory: config.fileHistory,\n        lastConnection: config.lastConnection,\n        starred: config.starred,\n    }\n\n    window.localStorage.setItem(CONFIG_KEY, JSON.stringify(localSettings));\n}\n\nexport function clearLocalStorage(): void {\n    window.localStorage.removeItem(CONFIG_KEY);\n}\n\nexport function getDefaultLocalConfig(): LocalConfig {\n    return {\n        lastOpened: {},\n        fileHistory: [],\n        cwd: \"/\",\n        lastConnection: {\n            type: ClusterTypes.LOCAL,\n            address: \"tcp://localhost:8786\",\n            cudas: [],\n        },\n        starred: [],\n    };\n}\n\nexport function makeUnique<T>(inp: T[]): T[] {\n    return inp.reduce((acc: T[], curr: T) => {\n        if (acc.indexOf(curr) === -1) {\n            return [...acc, curr];\n        } else {\n            return acc;\n        }\n    }, [] as T[]);\n}","import { getApiBasePath } from \"../helpers/apiHelpers\";\nimport { DirectoryListingResponse } from \"../messages\";\n\nexport async function getDirectoryListing(path: string): Promise<DirectoryListingResponse> {\n    const basePath = getApiBasePath();\n    const url = `${basePath}browse/localfs/?path=${encodeURIComponent(path)}`;\n    const r = await fetch(url, {\n        method: 'GET',\n        credentials: \"same-origin\",\n    });\n    return await r.json();\n}","import { ActionCreatorsMapObject } from \"redux\";\nimport { AnalysisDetails, CompoundAnalysisDetails, FollowupPart, MsgPartAnalysis, MsgPartCompoundAnalysis, MsgPartInitialDataset, MsgPartJob } from \"../messages\";\n\nexport interface Message<T extends string> {\n    messageType: T\n}\n\nexport function createMessage<T extends string, O>(messageType: T, attribs: O) {\n    return Object.assign({ messageType }, attribs);\n}\n\nexport enum MessageTypes {\n    INITIAL_STATE = \"INITIAL_STATE\",\n    JOB_STARTED = \"JOB_STARTED\",\n    FINISH_JOB = \"FINISH_JOB\",\n    TASK_RESULT = \"TASK_RESULT\",\n    JOB_ERROR = \"JOB_ERROR\",\n    BINARY = \"BINARY\",\n    OPEN = \"OPEN\",\n    CLOSE = \"CLOSE\",\n    ERROR = \"ERROR\",\n    DELETE_DATASET = \"DELETE_DATASET\",\n    CREATE_DATASET = \"CREATE_DATASET\",\n    CANCEL_JOB_DONE = \"CANCEL_JOB_DONE\",\n    ANALYSIS_CREATED = \"ANALYSIS_CREATED\",\n    ANALYSIS_UPDATED = \"ANALYSIS_UPDATED\",\n    ANALYSIS_REMOVED = \"ANALYSIS_REMOVED\",\n    COMPOUND_ANALYSIS_CREATED = \"COMPOUND_ANALYSIS_CREATED\",\n    COMPOUND_ANALYSIS_UPDATED = \"COMPOUND_ANALYSIS_UPDATED\",\n    COMPOUND_ANALYSIS_REMOVED = \"COMPOUND_ANALYSIS_REMOVED\",\n}\n\nexport const Messages = {\n    initialState: (\n        jobs: MsgPartJob[],\n        datasets: MsgPartInitialDataset[],\n        analyses: MsgPartAnalysis[],\n        compoundAnalyses: MsgPartCompoundAnalysis[]\n    ) => createMessage(MessageTypes.INITIAL_STATE, {\n        jobs, datasets, compoundAnalyses, analyses,\n    }),\n\n    startJob: (job: string, dataset: string) => createMessage(MessageTypes.JOB_STARTED, { job, dataset }),\n    finishJob: (job: string, followup: FollowupPart) => createMessage(MessageTypes.FINISH_JOB, { job, followup }),\n    taskResult: (job: string, followup: FollowupPart) => createMessage(MessageTypes.TASK_RESULT, { job, followup }),\n    jobError: (job: string, msg: string) => createMessage(MessageTypes.JOB_ERROR, { job, msg }),\n    binary: (objectURL: string) => createMessage(MessageTypes.BINARY, { objectURL }),\n    open: () => createMessage(MessageTypes.OPEN, {}),\n    close: () => createMessage(MessageTypes.CLOSE, {}),\n    error: (msg: string) => createMessage(MessageTypes.ERROR, { msg }),\n    deleteDataset: (dataset: string) => createMessage(MessageTypes.DELETE_DATASET, { dataset }),\n    cancelled: (job: string) => createMessage(MessageTypes.CANCEL_JOB_DONE, { job }),\n    analysisCreated: (analysis: string, dataset: string, details: AnalysisDetails) => createMessage(MessageTypes.ANALYSIS_CREATED, { dataset, analysis, details }),\n    analysisUpdated: (analysis: string, dataset: string, details: AnalysisDetails) => createMessage(MessageTypes.ANALYSIS_UPDATED, { dataset, analysis, details }),\n    analysisRemoved: (analysis: string) => createMessage(MessageTypes.ANALYSIS_REMOVED, { analysis }),\n\n    compoundAnalysisCreated: (compoundAnalysis: string, dataset: string, details: CompoundAnalysisDetails) => createMessage(MessageTypes.COMPOUND_ANALYSIS_CREATED, { dataset, compoundAnalysis, details }),\n    compoundAnalysisUpdated: (compoundAnalysis: string, dataset: string, details: CompoundAnalysisDetails) => createMessage(MessageTypes.COMPOUND_ANALYSIS_UPDATED, { dataset, compoundAnalysis, details }),\n    compoundAnalysisRemoved: (compoundAnalysis: string) => createMessage(MessageTypes.ANALYSIS_REMOVED, { compoundAnalysis }),\n}\n\nexport type MessagesUnion<A extends ActionCreatorsMapObject> = ReturnType<A[keyof A]>\nexport type Messages = MessagesUnion<typeof Messages>;\n\n// types of messages sent by the server:\n/*\nexport type InitialStateMessage = ReturnType<typeof Messages.initialState>;\nexport type StartJobMessage = ReturnType<typeof Messages.startJob>;\nexport type FinishJobMessage = ReturnType<typeof Messages.finishJob>;\nexport type TaskResultMessage = ReturnType<typeof Messages.taskResult>;\n*/\n\nexport type BinaryMessage = ReturnType<typeof Messages.binary>;","import { call, fork, put, select, take } from \"redux-saga/effects\";\nimport uuid from 'uuid/v4';\nimport { joinPaths } from \"../config/helpers\";\nimport { ConfigState } from \"../config/reducers\";\nimport { DirectoryListingResponse } from \"../messages\";\nimport { RootReducer } from \"../store\";\nimport * as browserActions from './actions';\nimport { getDirectoryListing } from \"./api\";\nimport { DirectoryBrowserState } from \"./types\";\n\nexport function* directoryListingSaga() {\n    yield fork(fetchOnRequest);\n    yield fork(fetchDirectoryListOnOpen);\n}\n\nfunction* fetchOnRequest() {\n    while (true) {\n        const action: ReturnType<typeof browserActions.Actions.list> = yield take(browserActions.ActionTypes.LIST_DIRECTORY);\n\n        const { name, path } = action.payload;\n        const config: ConfigState = yield select((state: RootReducer) => state.config);\n        const newPath = name !== undefined ? joinPaths(config, path, name) : path;\n        yield fork(fetchDirectoryListing, newPath);\n    }\n}\n\nfunction* fetchDirectoryListing(path: string) {\n    try {\n        const result: DirectoryListingResponse = yield call(getDirectoryListing, path);\n        if (result.status === \"ok\") {\n            yield put(browserActions.Actions.dirListing(result.path, result.dirs, result.files, result.drives, result.places));\n        } else if (result.status === \"error\") {\n            const browserState: DirectoryBrowserState = yield select((state: RootReducer) => state.browser);\n            const timestamp = Date.now();\n            const id = uuid();\n            const alternative = result.alternative ? result.alternative : browserState.places.home.path;\n            // Don't show an error, if it's due to last recent directory not being available\n            const config: ConfigState = yield select((state: RootReducer) => state.config);\n            if (config.cwd !== path) {\n              yield put(browserActions.Actions.error(`Error browsing directory: ${result.msg}`, timestamp, id));\n            }\n            yield put(browserActions.Actions.list(alternative));\n        }\n    } catch (e) {\n        const browserState: DirectoryBrowserState = yield select((state: RootReducer) => state.browser);\n        const timestamp = Date.now();\n        const id = uuid();\n        yield put(browserActions.Actions.error(`Error browsing directory: ${e.toString()}`, timestamp, id));\n        yield put(browserActions.Actions.list(browserState.places.home.path));\n    }\n}\n\nfunction* fetchDirectoryListOnOpen() {\n    while (true) {\n        yield take(browserActions.ActionTypes.OPEN);\n        const config: ConfigState = yield select((state: RootReducer) => state.config);\n        yield put(browserActions.Actions.list(config.cwd));\n    }\n}\n","import { END, eventChannel, EventChannel } from \"redux-saga\";\nimport { call, delay, fork, put, take } from \"redux-saga/effects\";\nimport uuid from \"uuid/v4\";\nimport * as datasetActions from \"../dataset/actions\";\nimport { getApiWSURL } from \"../helpers/apiHelpers\";\nimport * as channelActions from \"./actions\";\nimport * as channelMessages from \"./messages\";\n\ntype SocketChannel = EventChannel<channelMessages.Messages>;\n\n/**\n * create typesafe messages from the websocket messages\n *\n * also creates some synthetic events like open, close, error\n */\nfunction createWebSocketChannel(/* addr */): SocketChannel {\n    return eventChannel((emit) => {\n        function onMessage(msg: MessageEvent) {\n            if (msg.data instanceof Blob) {\n                // TODO: cleanup createObjectURL results somewhere\n                emit(channelMessages.Messages.binary(URL.createObjectURL(msg.data)));\n            } else {\n                const parsed = JSON.parse(msg.data) as channelMessages.Messages;\n                emit(parsed);\n            }\n        }\n\n        function onOpen() {\n            emit(channelMessages.Messages.open());\n        }\n\n        function onClose() {\n            emit(channelMessages.Messages.close());\n            emit(END);\n        }\n\n        function onError(err: Event) {\n            emit(channelMessages.Messages.error(\"Error in weboscket connection\"));\n        }\n\n        const ws = new WebSocket(getApiWSURL());\n        ws.addEventListener(\"message\", onMessage);\n        ws.addEventListener(\"open\", onOpen);\n        ws.addEventListener(\"close\", onClose);\n        ws.addEventListener(\"error\", onError);\n\n        // return cleanup function:\n        return () => {\n            ws.removeEventListener(\"message\", onMessage);\n            ws.removeEventListener(\"open\", onOpen);\n            ws.removeEventListener(\"close\", onClose);\n            ws.removeEventListener(\"error\", onError);\n            // TODO: close connection if still open\n            // (or is it guaranteed that if an error was thrown, the connection is closed?)\n        };\n    });\n}\n\n/**\n * handles the connection lifecycle for our websocket\n */\nexport function* webSocketSaga() {\n    while (true) {\n        const socketChannel = yield call(createWebSocketChannel);\n        yield fork(actionsFromChannel, socketChannel);\n        const action: channelActions.Actions = yield take([channelActions.ActionTypes.OPEN, channelActions.ActionTypes.CLOSE]);\n        if (action.type === channelActions.ActionTypes.OPEN) {\n            const isShutdown: channelActions.Actions = yield take([\n                channelActions.ActionTypes.CLOSE,\n                channelActions.ActionTypes.ERROR,\n                channelActions.ActionTypes.CLOSE_LOOP,\n            ]);\n            if (isShutdown.type === channelActions.ActionTypes.CLOSE_LOOP) {\n                break;\n            }\n        }\n        yield delay(1000);\n    }\n}\n\n/**\n * translates the messages from the channel to redux actions, handles aggregation etc.\n */\nexport function* actionsFromChannel(socketChannel: SocketChannel) {\n    try {\n        while (true) {\n            const msg = yield take(socketChannel);\n            const timestamp = Date.now();\n            switch (msg.messageType) {\n                case channelMessages.MessageTypes.OPEN: {\n                    yield put(channelActions.Actions.open(timestamp));\n                    break;\n                }\n                case channelMessages.MessageTypes.CLOSE: {\n                    yield put(channelActions.Actions.close(timestamp));\n                    break;\n                }\n                case channelMessages.MessageTypes.ERROR: {\n                    const id = uuid();\n                    yield put(channelActions.Actions.error(msg.msg, timestamp, id));\n                    break;\n                }\n                case channelMessages.MessageTypes.INITIAL_STATE: {\n                    yield put(channelActions.Actions.initialState(msg.jobs, msg.datasets, msg.compoundAnalyses, msg.analyses, timestamp));\n                    break;\n                }\n                case channelMessages.MessageTypes.JOB_STARTED: {\n                    yield put(channelActions.Actions.jobStarted(msg.job, msg.details.dataset, timestamp));\n                    break;\n                }\n                case channelMessages.MessageTypes.FINISH_JOB: {\n                    yield call(handleFinishJob, msg, socketChannel, timestamp);\n                    break;\n                }\n                case channelMessages.MessageTypes.TASK_RESULT: {\n                    yield call(handleTaskResult, msg, socketChannel, timestamp);\n                    break;\n                }\n                case channelMessages.MessageTypes.CREATE_DATASET: {\n                    yield put(datasetActions.Actions.created(msg.details));\n                    break;\n                }\n                case channelMessages.MessageTypes.DELETE_DATASET: {\n                    yield put(datasetActions.Actions.deleted(msg.dataset));\n                    break;\n                }\n                case channelMessages.MessageTypes.JOB_ERROR: {\n                    const id = uuid();\n                    yield put(channelActions.Actions.jobError(msg.job, msg.msg, id, timestamp));\n                    break;\n                }\n                case channelMessages.MessageTypes.CANCEL_JOB_DONE: {\n                    yield put(channelActions.Actions.cancelled(msg.job));\n                    break;\n                }\n                /*\n                // FIXME: server needs to know about compount analyses\n                case channelMessages.MessageTypes.ANALYSIS_CREATED: {\n                    yield put(channelActions.Actions.analysisCreated(\n                        msg.analysis,\n                        msg.dataset,\n                        msg.details,\n                    ));\n                    break;\n                }\n                case channelMessages.MessageTypes.ANALYSIS_UPDATED: {\n                    yield put(channelActions.Actions.analysisUpdated(\n                        msg.analysis,\n                        msg.dataset,\n                        msg.details,\n                    ));\n                    break;\n                }\n                case channelMessages.MessageTypes.ANALYSIS_REMOVED: {\n                    yield put(channelActions.Actions.analysisRemoved(\n                        msg.analysis,\n                    ));\n                    break;\n                }\n                */\n            }\n        }\n    } finally {\n        // disconnected\n    }\n}\n\nexport function* handleBinaryParts(numParts: number, socketChannel: SocketChannel) {\n    const parts: channelMessages.BinaryMessage[] = [];\n    while (parts.length < numParts) {\n        const binMsg = yield take(socketChannel);\n        parts.push(binMsg);\n    }\n    return parts;\n}\n\nexport function* handleTaskResult(msg: ReturnType<typeof channelMessages.Messages.taskResult>, socketChannel: SocketChannel, timestamp: number) {\n    const parts: channelMessages.BinaryMessage[] = yield call(handleBinaryParts, msg.followup.numMessages, socketChannel);\n    const images = parts.map((part, idx) => ({ imageURL: part.objectURL, description: msg.followup.descriptions[idx] }));\n    yield put(channelActions.Actions.taskResult(msg.job, images, timestamp));\n}\n\nexport function* handleFinishJob(msg: ReturnType<typeof channelMessages.Messages.finishJob>, socketChannel: SocketChannel, timestamp: number) {\n    const parts: channelMessages.BinaryMessage[] = yield call(handleBinaryParts, msg.followup.numMessages, socketChannel);\n    const images = parts.map((part, idx) => ({ imageURL: part.objectURL, description: msg.followup.descriptions[idx] }));\n    yield put(channelActions.Actions.finishJob(msg.job, images, timestamp));\n}\n","import { genericPut, getApiBasePath } from \"../helpers/apiHelpers\";\nimport { ClusterDetailsResponse, ConnectRequest, ConnectRequestParams, ConnectResponse } from \"../messages\";\n\nexport async function connectToCluster(params: ConnectRequestParams): Promise<ConnectResponse> {\n    const payload: ConnectRequest = {\n        connection: params\n    }\n    return await genericPut(\"config/connection/\", payload);\n}\n\nexport async function checkClusterConnection(): Promise<ConnectResponse> {\n    const basePath = getApiBasePath();\n    const r = await fetch(`${basePath}config/connection/`, {\n        method: 'GET',\n    });\n    return await r.json();\n}\n\nexport async function getClusterDetail(): Promise<ClusterDetailsResponse> {\n    const basePath = getApiBasePath();\n    const url = `${basePath}config/cluster/`;\n    const r = await fetch(url, {\n        method: 'GET',\n        credentials: \"same-origin\",\n    });\n    return await r.json();\n}","import { all, call, put, take, takeEvery } from \"redux-saga/effects\";\nimport uuid from 'uuid/v4';\nimport * as channelActions from '../channel/actions';\nimport { ClusterDetailsResponse, ConnectResponse } from \"../messages\";\nimport * as clusterActions from './actions';\nimport { checkClusterConnection, connectToCluster, getClusterDetail } from \"./api\";\n\nfunction* connectSaga(action: ReturnType<typeof clusterActions.Actions.connect>) {\n    yield put(clusterActions.Actions.connecting())\n    const conn: ConnectResponse = yield call(connectToCluster, action.payload.params);\n    yield call(putClusterStatus, conn);\n}\n\nfunction* putClusterStatus(conn: ConnectResponse) {\n    if (conn.status === \"ok\") {\n        const clusterDetails:ClusterDetailsResponse = yield call(getClusterDetail)\n        yield put(clusterActions.Actions.connected(conn.connection.connection, clusterDetails.details));\n    } else if (conn.status === \"error\") {\n        yield put(clusterActions.Actions.notConnected());\n        const timestamp = Date.now();\n        const id = uuid();\n        yield put(clusterActions.Actions.error(`error connecting to cluster: ${conn.msg}`,timestamp, id));\n    } else {\n        yield put(clusterActions.Actions.notConnected());\n    }\n}\n\n/**\n * when the channel is connected, check if cluster is connected and update status accordingly\n */\nfunction* trackClusterConnection() {\n    while (true) {\n        yield take(channelActions.ActionTypes.OPEN)\n        const conn: ConnectResponse = yield call(checkClusterConnection);\n        yield call(putClusterStatus, conn);\n    }\n}\n\nexport function* clusterConnectionSaga() {\n    yield takeEvery(clusterActions.ActionTypes.CONNECT, connectSaga);\n    yield all([\n        trackClusterConnection(),\n    ])\n}","import { ActionsUnion, createAction } from \"../helpers/actionHelpers\";\nimport { AnalysisDetails, AnalysisTypes } from \"../messages\";\nimport { AnalysisState } from \"./types\";\n\n\nexport enum ActionTypes {\n    CREATE = 'ANALYSIS_CREATE',\n    CREATED = 'ANALYSIS_CREATED',\n    UPDATED = 'ANALYSIS_UPDATED',\n    REMOVE = 'ANALYSIS_REMOVE',\n    REMOVED = 'ANALYSIS_REMOVED',\n    ERROR = 'ANALYSIS_ERROR',\n}\n\nexport const Actions = {\n    create: (\n        dataset: string, analysisType: AnalysisTypes\n    ) => createAction(ActionTypes.CREATE, { dataset, analysisType }),\n\n    created: (\n        analysis: AnalysisState, compoundAnalysis: string, analysisIndex: number\n    ) => createAction(ActionTypes.CREATED, {\n        analysis, compoundAnalysis, analysisIndex\n    }),\n\n    updated: (\n        id: string, details: AnalysisDetails\n    ) => createAction(ActionTypes.UPDATED, { id, details }),\n\n    remove: (id: string) => createAction(ActionTypes.REMOVE, { id }),\n    removed: (id: string) => createAction(ActionTypes.REMOVED, { id }),\n    error: (\n        msg: string, timestamp: number, id: string\n    ) => createAction(ActionTypes.ERROR, { msg, timestamp, id }),\n}\n\nexport type Actions = ActionsUnion<typeof Actions>;\n\nexport type ActionParts = {\n    [K in keyof typeof Actions]: ReturnType<typeof Actions[K]>\n}\n","import { ActionsUnion, createAction } from \"../helpers/actionHelpers\";\n\nexport enum ActionTypes {\n    CREATE = 'JOB_CREATE',\n}\n\nexport const Actions = {\n    create: (id: string, analysis: string, timestamp: number) => createAction(ActionTypes.CREATE, { id, analysis, timestamp }),\n}\n\nexport type Actions = ActionsUnion<typeof Actions>;\n\nexport type ActionParts = {\n    [K in keyof typeof Actions]: ReturnType<typeof Actions[K]>\n}","import { genericDelete, genericPut } from \"../helpers/apiHelpers\";\nimport { CancelJobResponse, StartJobRequest, StartJobResponse } from \"../messages\";\n\nexport async function startJob(jobId: string, analysis: string): Promise<StartJobResponse> {\n    const payload: StartJobRequest = {\n        job: {\n            analysis,\n        }\n    }\n    return await genericPut(`jobs/${jobId}/`, payload);\n}\n\nexport async function cancelJob(jobId: string): Promise<CancelJobResponse> {\n    return await genericDelete(`jobs/${jobId}/`);\n}\n\n\n","import { buffers, Task } from 'redux-saga';\nimport { actionChannel, call, cancel, fork, put, select, take, takeEvery } from 'redux-saga/effects';\nimport uuid from 'uuid/v4';\nimport * as analysisActions from '../analysis/actions';\nimport { AnalysisState } from '../analysis/types';\nimport * as channelActions from '../channel/actions';\nimport * as jobActions from '../job/actions';\nimport { cancelJob, startJob } from '../job/api';\nimport { JobState } from '../job/types';\nimport { AnalysisDetails, DatasetState, DatasetStatus } from '../messages';\nimport { RootReducer } from '../store';\nimport * as compoundAnalysisActions from './actions';\nimport { createOrUpdateAnalysis, createOrUpdateCompoundAnalysis, removeAnalysis, removeCompoundAnalysis } from \"./api\";\nimport { CompoundAnalysis, CompoundAnalysisState } from './types';\n\nfunction selectDataset(state: RootReducer, dataset: string) {\n    return state.datasets.byId[dataset];\n}\n\nfunction selectCompoundAnalysis(state: RootReducer, id: string) {\n    return state.compoundAnalyses.byId[id];\n}\n\nfunction selectAnalysis(state: RootReducer, id: string) {\n    return state.analyses.byId[id];\n}\n\nfunction selectJob(state: RootReducer, id: string) {\n    return state.jobs.byId[id];\n}\n\nexport function* cleanupOnRemove(compoundAnalysis: CompoundAnalysis, sidecarTask: Task) {\n    while (true) {\n        const removeAction: ReturnType<typeof compoundAnalysisActions.Actions.remove> = yield take(compoundAnalysisActions.ActionTypes.REMOVE);\n        if (removeAction.payload.id === compoundAnalysis.compoundAnalysis) {\n            yield cancel(sidecarTask);\n        }\n    }\n}\n\nexport function* createCompoundAnalysisSaga(action: ReturnType<typeof compoundAnalysisActions.Actions.create>) {\n    try {\n        const datasetState: DatasetState = yield select(selectDataset, action.payload.dataset)\n        if (datasetState.status !== DatasetStatus.OPEN) {\n            throw new Error(\"invalid dataset status\");\n        }\n        const compoundAnalysis: CompoundAnalysis = {\n            compoundAnalysis: uuid(),\n            dataset: action.payload.dataset,\n            details: {\n                mainType: action.payload.analysisType,\n                analyses: [],\n            }\n        }\n\n        yield call(\n            createOrUpdateCompoundAnalysis,\n            compoundAnalysis.compoundAnalysis,\n            compoundAnalysis.dataset,\n            compoundAnalysis.details,\n        );\n\n        const sidecarTask = yield fork(analysisSidecar, compoundAnalysis.compoundAnalysis, { doAutoStart: true });\n\n        yield put(compoundAnalysisActions.Actions.created(compoundAnalysis, true));\n        yield fork(cleanupOnRemove, compoundAnalysis, sidecarTask);\n    } catch (e) {\n        const timestamp = Date.now();\n        const id = uuid();\n        yield put(compoundAnalysisActions.Actions.error(`Error creating analysis: ${e.toString()}`, timestamp, id));\n    }\n}\n\nexport function* createFromServerState(action: ReturnType<typeof channelActions.Actions.initialState>) {\n    for (const msgPart of action.payload.compoundAnalyses) {\n        const compoundAnalysis: CompoundAnalysisState = yield select(selectCompoundAnalysis, msgPart.compoundAnalysis);\n        const sidecarTask = yield fork(analysisSidecar, compoundAnalysis.compoundAnalysis, { doAutoStart: false });\n        yield fork(cleanupOnRemove, compoundAnalysis, sidecarTask);\n    }\n}\n\nexport function* cancelOldJob(analysis: AnalysisState, jobIndex: number) {\n    const jobId = analysis.jobs[jobIndex];\n    if (jobId === undefined) {\n        return;\n    } else {\n        const job: JobState = yield select(selectJob, jobId);\n        if (job.running !== \"DONE\") {\n            yield call(cancelJob, jobId);\n        }\n    }\n}\n\nexport function* createOrUpdate(\n    compoundAnalysis: CompoundAnalysisState, analysisId: string | undefined,\n    analysisIndex: number, details: AnalysisDetails\n) {\n    if (analysisId) {\n        // update the analysis on the server:\n        yield call(createOrUpdateAnalysis,\n            compoundAnalysis.compoundAnalysis, analysisId,\n            compoundAnalysis.dataset, details\n        );\n        yield put(analysisActions.Actions.updated(analysisId, details));\n\n        const analysis: AnalysisState = yield select(selectAnalysis, analysisId);\n        const jobs = analysis.jobs ? analysis.jobs : [];\n\n        for (const oldJobId of jobs) {\n            const job: JobState = yield select(selectJob, oldJobId);\n            if (job && job.running !== \"DONE\") {\n                // wait until the job is cancelled:\n                yield call(cancelJob, oldJobId);\n            }\n        }\n        return analysisId;\n    } else {\n        // create the analysis on the server:\n        const newAnalysisId = uuid();\n        yield call(createOrUpdateAnalysis,\n            compoundAnalysis.compoundAnalysis, newAnalysisId,\n            compoundAnalysis.dataset, details\n        );\n        yield put(analysisActions.Actions.created({\n            id: newAnalysisId,\n            dataset: compoundAnalysis.dataset,\n            details,\n            jobs: [],\n        }, compoundAnalysis.compoundAnalysis, analysisIndex));\n\n        const updatedCompoundAnalysis = yield select(selectCompoundAnalysis, compoundAnalysis.compoundAnalysis);\n\n        yield call(\n            createOrUpdateCompoundAnalysis,\n            updatedCompoundAnalysis.compoundAnalysis,\n            updatedCompoundAnalysis.dataset,\n            updatedCompoundAnalysis.details,\n        );\n        return newAnalysisId;\n    }\n}\n\nexport function* analysisSidecar(compoundAnalysisId: string, options: { doAutoStart: boolean }) {\n    // channel for incoming actions:\n    // all actions that arrive while we block in `call` will be buffered here.\n    // because the buffer is sliding of size 1, we only keep the latest action!\n    const runOrParamsChannel = yield actionChannel(compoundAnalysisActions.ActionTypes.RUN, buffers.sliding(2));\n\n    while (true) {\n        try {\n            const action: compoundAnalysisActions.ActionParts[\"run\"] = yield take(runOrParamsChannel);\n\n            // ignore actions meant for other analyses\n            if (action.payload.id !== compoundAnalysisId) {\n                continue;\n            }\n\n            // get the current state incl. configuration\n            const compoundAnalysis: CompoundAnalysisState = yield select(selectCompoundAnalysis, compoundAnalysisId);\n            const { analysisIndex, details } = action.payload;\n\n            const existingAnalysisId = compoundAnalysis.details.analyses[analysisIndex];\n            const analysisId = yield call(createOrUpdate, compoundAnalysis, existingAnalysisId, analysisIndex, details);\n\n            // prepare running the job:\n            const jobId = uuid();\n            yield put(jobActions.Actions.create(jobId, analysisId, Date.now()));\n\n            // FIXME: we have a race here, as the websocket msg FINISH_JOB may\n            // arrive before call(startJob, ...) returns. this causes the apply button\n            // to feel unresponsive (the action gets done, but only after we finish here...)\n            // best reproduced in \"Slow 3G\" network simulation mode in devtools\n\n            // wait until the job is started\n            yield call(startJob, jobId, analysisId);\n            yield put(compoundAnalysisActions.Actions.running(compoundAnalysis.compoundAnalysis, jobId, analysisIndex));\n            // tslint:disable-next-line:no-empty\n        } catch (e) {\n            const timestamp = Date.now();\n            const id = uuid();\n            yield put(compoundAnalysisActions.Actions.error(`Error running analysis: ${e.toString()}`, timestamp, id));\n        }\n    }\n}\n\nfunction* removeJobsForAnalysis(analysis: AnalysisState) {\n    for (const oldJobId of analysis.jobs) {\n        const job: JobState = yield select(selectJob, oldJobId);\n        if (job && job.running !== \"DONE\") {\n            // wait until the job is cancelled:\n            yield call(cancelJob, oldJobId);\n        }\n    }\n}\n\nexport function* doRemoveAnalysisSaga(action: ReturnType<typeof compoundAnalysisActions.Actions.remove>) {\n    const compoundAnalysis: CompoundAnalysisState = yield select(selectCompoundAnalysis, action.payload.id);\n    try {\n        for (const analysisId of compoundAnalysis.details.analyses) {\n            const analysis: AnalysisState = yield select(selectAnalysis, analysisId);\n            yield call(removeJobsForAnalysis, analysis);\n            yield call(removeAnalysis, compoundAnalysis.compoundAnalysis, analysisId);\n            yield put(analysisActions.Actions.removed(analysisId));\n        }\n        yield call(removeCompoundAnalysis, action.payload.id);\n    } finally {\n        yield put(compoundAnalysisActions.Actions.removed(action.payload.id));\n    }\n}\n\nexport function* analysisRootSaga() {\n    yield takeEvery(compoundAnalysisActions.ActionTypes.CREATE, createCompoundAnalysisSaga);\n    yield takeEvery(compoundAnalysisActions.ActionTypes.REMOVE, doRemoveAnalysisSaga);\n    yield takeEvery(channelActions.ActionTypes.INITIAL_STATE, createFromServerState);\n}","import { getApiBasePath } from \"../helpers/apiHelpers\";\nimport { GetConfigResponse } from \"../messages\";\n\nexport async function getConfig(): Promise<GetConfigResponse> {\n    const basePath = getApiBasePath();\n    const r = await fetch(`${basePath}config/`, {\n        method: \"GET\",\n        credentials: \"same-origin\",\n    });\n    return await r.json();\n}","import { call, fork, put, select, take, takeEvery } from 'redux-saga/effects';\nimport uuid from 'uuid/v4';\nimport * as browserActions from '../browser/actions';\nimport * as channelActions from '../channel/actions';\nimport * as clusterActions from '../cluster/actions';\nimport * as datasetActions from '../dataset/actions';\nimport { GetConfigResponse } from '../messages';\nimport { RootReducer } from '../store';\nimport * as configActions from './actions';\nimport { getConfig } from './api';\nimport { clearLocalStorage, getDefaultLocalConfig, mergeLocalStorage, setLocalStorage } from './helpers';\nimport { ConfigState } from './reducers';\n\nfunction* getConfigOnReconnect() {\n    yield takeEvery(channelActions.ActionTypes.OPEN, getConfigSaga);\n}\n\n/**\n * get config from server and try to merge in the localStorage config\n */\nfunction* getConfigSaga() {\n    yield put(configActions.Actions.fetch());\n    const configResponse: GetConfigResponse = yield call(getConfig);\n    try {\n        const mergedConfig = mergeLocalStorage(configResponse.config);\n        yield put(configActions.Actions.fetched(mergedConfig));\n    } catch (e) {\n        try {\n            clearLocalStorage();\n            // tslint:disable-next-line:no-empty\n        } catch (e) { }\n        const defaultConfig = Object.assign({}, configResponse.config, getDefaultLocalConfig());\n        yield put(configActions.Actions.fetched(defaultConfig));\n    }\n}\n\n/**\n * update localStorage config on opening files or using the file browser\n */\nfunction* updateLocalStorageConfig() {\n    while (true) {\n        yield take([\n            datasetActions.ActionTypes.CREATE,\n            browserActions.ActionTypes.DIRECTORY_LISTING,\n            clusterActions.ActionTypes.CONNECTED,\n            configActions.ActionTypes.TOGGLE_STAR,\n        ]);\n        const config: ConfigState = yield select((state: RootReducer) => state.config);\n        setLocalStorage(config);\n    }\n}\n\nexport function* firstConfigFetch() {\n    try {\n        yield call(getConfigSaga);\n    } catch (e) {\n        const timestamp = Date.now();\n        const id = uuid();\n        yield put(configActions.Actions.fetchFailed(`failed to fetch config: ${e.toString()}`, timestamp, id));\n    }\n}\n\nexport function* configRootSaga() {\n    yield fork(firstConfigFetch);\n    yield fork(getConfigOnReconnect);\n    yield fork(updateLocalStorageConfig);\n}","import { call, put, select, takeEvery } from 'redux-saga/effects';\nimport uuid from 'uuid/v4';\nimport * as browserActions from '../browser/actions';\nimport { joinPaths } from '../config/helpers';\nimport { ConfigState } from '../config/reducers';\nimport { DetectDatasetResponse, OpenDatasetResponse } from '../messages';\nimport { RootReducer } from '../store';\nimport * as datasetActions from \"./actions\";\nimport { deleteDataset, detectDataset, openDataset } from './api';\nimport { isKnownDatasetType } from './helpers';\n\n\nexport function* createDatasetSaga(action: ReturnType<typeof datasetActions.Actions.create>) {\n    try {\n        const resp: OpenDatasetResponse = yield call(openDataset, action.payload.dataset.id, { dataset: action.payload.dataset });\n        if (resp.status === \"ok\") {\n            yield put(datasetActions.Actions.created(resp.details));\n        } else if (resp.status === \"error\") {\n            const timestamp = Date.now();\n            const id = uuid();\n            yield put(datasetActions.Actions.error(resp.dataset, resp.msg, timestamp, id));\n        }\n    } catch (e) {\n        const timestamp = Date.now();\n        const id = uuid();\n        yield put(datasetActions.Actions.error(action.payload.dataset.id, `Error loading dataset: ${e.toString()}`, timestamp, id));\n    }\n}\n\nexport function* deleteDatasetSaga(action: ReturnType<typeof datasetActions.Actions.delete>) {\n    try {\n        yield call(deleteDataset, action.payload.dataset);\n    } catch (e) {\n        const timestamp = Date.now();\n        const id = uuid();\n        yield put(datasetActions.Actions.error(action.payload.dataset, `Error closing dataset: ${e.toString()}`, timestamp, id));\n    }\n}\n\nexport function* doDetectDataset(fullPath: string) {\n    yield put(datasetActions.Actions.detect(fullPath));\n    const detectResult: DetectDatasetResponse = yield call(detectDataset, fullPath);\n    let detectedParams;\n    let shouldOpen = true;\n    if (detectResult.status === \"ok\") {\n        if (isKnownDatasetType(detectResult.datasetParams.type)) {\n          detectedParams = detectResult.datasetParams;\n          yield put(datasetActions.Actions.detected(fullPath, detectResult.datasetParams));\n        }\n        else {\n          const timestamp = Date.now();\n          const id = uuid();\n          yield put(datasetActions.Actions.detectFailed(fullPath));\n          shouldOpen = false;\n          yield put(datasetActions.Actions.error(id, detectResult.datasetParams.type + ` dataset type is currently not supported in the GUI`, timestamp, id));\n        }\n    } else {\n        yield put(datasetActions.Actions.detectFailed(fullPath));\n    }\n    return [detectedParams, shouldOpen];\n}\n\nexport function* doOpenDataset(fullPath: string) {\n    const config: ConfigState = yield select((state: RootReducer) => state.config);\n    const cachedParams = config.lastOpened[fullPath];\n    let detectedParams;\n    let shouldOpen = true;\n    try {\n      const doDetectDatasetRes = yield call(doDetectDataset, fullPath);\n      detectedParams = doDetectDatasetRes[0];\n      shouldOpen = doDetectDatasetRes[1];\n    } catch (e) {\n        yield put(datasetActions.Actions.detectFailed(fullPath));\n    }\n    if(shouldOpen) {\n      yield put(datasetActions.Actions.open(fullPath, cachedParams, detectedParams));\n    }\n}\n\nexport function* openDatasetSagaFullPath(action: ReturnType<typeof browserActions.Actions.selectFullPath>) {\n    const fullPath = action.payload.path;\n    yield call(doOpenDataset, fullPath);\n}\n\nexport function* openDatasetSaga(action: ReturnType<typeof browserActions.Actions.select>) {\n    const config: ConfigState = yield select((state: RootReducer) => state.config);\n    const fullPath = joinPaths(config, action.payload.path, action.payload.name);\n    yield call(doOpenDataset, fullPath);\n}\n\nexport function* datasetRootSaga() {\n    yield takeEvery(datasetActions.ActionTypes.CREATE, createDatasetSaga);\n    yield takeEvery(datasetActions.ActionTypes.DELETE, deleteDatasetSaga);\n    yield takeEvery(browserActions.ActionTypes.SELECT, openDatasetSaga);\n    yield takeEvery(browserActions.ActionTypes.SELECT_FULL_PATH, openDatasetSagaFullPath);\n}\n","import { all } from 'redux-saga/effects';\nimport { directoryListingSaga } from './browser/sagas';\nimport { webSocketSaga } from './channel/sagas';\nimport { clusterConnectionSaga } from './cluster/sagas';\nimport { analysisRootSaga } from './compoundAnalysis/sagas';\nimport { configRootSaga } from './config/sagas';\nimport { datasetRootSaga } from './dataset/sagas';\n\nexport function* rootSaga() {\n    yield all([\n        configRootSaga(),\n        webSocketSaga(),\n        analysisRootSaga(),\n        datasetRootSaga(),\n        clusterConnectionSaga(),\n        directoryListingSaga(),\n    ]);\n}","import { AllActions } from \"../actions\";\nimport * as channelActions from '../channel/actions';\nimport { ById, constructById, filterWithPred, insertById, updateById } from \"../helpers/reducerHelpers\";\nimport * as jobActions from '../job/actions';\nimport * as analysisActions from \"./actions\";\nimport { AnalysisState } from \"./types\";\n\n\nexport type AnalysisReducerState = ById<AnalysisState>;\n\nconst initialAnalysisState: AnalysisReducerState = {\n    byId: {},\n    ids: [],\n}\n\nexport function analysisReducer(state = initialAnalysisState, action: AllActions): AnalysisReducerState {\n    switch (action.type) {\n        case analysisActions.ActionTypes.CREATED: {\n            return insertById(state, action.payload.analysis.id, action.payload.analysis);\n        }\n        case analysisActions.ActionTypes.REMOVED: {\n            return filterWithPred(state, (r: AnalysisState) => r.id !== action.payload.id);\n        }\n        case analysisActions.ActionTypes.UPDATED: {\n            return updateById(state, action.payload.id, {\n                details: action.payload.details,\n            });\n        }\n        case jobActions.ActionTypes.CREATE: {\n            const analysis = state.byId[action.payload.analysis];\n            // FIXME: remove old jobs\n            const oldJobs = analysis.jobs ? analysis.jobs : [];\n            return updateById(state, action.payload.analysis, {\n                jobs: [action.payload.id, ...oldJobs],\n            })\n        }\n        case channelActions.ActionTypes.INITIAL_STATE: {\n            const analysisState: AnalysisState[] = action.payload.analyses.map(item => {\n                return {\n                    doAutoStart: false,\n                    id: item.analysis,\n                    dataset: item.dataset,\n                    details: item.details,\n                    // FIXME: add jobs!\n                    jobs: item.jobs,\n                };\n            });\n            return {\n                byId: constructById(analysisState, analysis => analysis.id),\n                ids: action.payload.analyses.map(analysis => analysis.analysis),\n            }\n        }\n        case channelActions.ActionTypes.FINISH_JOB:\n        case channelActions.ActionTypes.TASK_RESULT: {\n            const analysisIdForJob = state.ids.find(id => {\n                const analysis = state.byId[id];\n                const jobs = analysis.jobs ? analysis.jobs : [];\n                return jobs.some(job => job === action.payload.job)\n            });\n            if (!analysisIdForJob) {\n                return state;\n            }\n            return updateById(state, analysisIdForJob, {\n                displayedJob: action.payload.job,\n            });\n        }\n    }\n    return state;\n}\n","import { AllActions } from \"../actions\";\nimport * as configActions from '../config/actions';\nimport { DirectoryListingDetails, FSPlace } from \"../messages\";\nimport * as browserActions from './actions';\nimport { DirectoryBrowserState } from \"./types\";\n\nconst initialBrowserState: DirectoryBrowserState = {\n    isOpen: false,\n    isLoading: true,\n    path: \"/\",\n    drives: [],\n    places: {},\n    files: [] as DirectoryListingDetails[],\n    dirs: [] as DirectoryListingDetails[],\n}\n\nexport function directoryBrowserReducer(state: DirectoryBrowserState = initialBrowserState, action: AllActions): DirectoryBrowserState {\n    switch (action.type) {\n        case configActions.ActionTypes.FETCHED: {\n            return Object.assign({}, state, {\n                path: action.payload.config.cwd,\n            })\n        }\n        case browserActions.ActionTypes.OPEN: {\n            return Object.assign({}, state, {\n                isOpen: true,\n            })\n        }\n        case browserActions.ActionTypes.CANCEL: {\n            return Object.assign({}, state, {\n                isOpen: false,\n            })\n        }\n        case browserActions.ActionTypes.LIST_DIRECTORY: {\n            return Object.assign({}, state, {\n                isLoading: true,\n            })\n        }\n        case browserActions.ActionTypes.DIRECTORY_LISTING: {\n            const places = action.payload.places.reduce((acc, place: FSPlace) => {\n                return Object.assign({}, acc, {\n                    [place.key]: place,\n                })\n            }, {});\n            return Object.assign({}, state, {\n                isLoading: false,\n                path: action.payload.path,\n                files: action.payload.files,\n                dirs: action.payload.dirs,\n                drives: action.payload.drives,\n                places,\n            })\n        }\n        case browserActions.ActionTypes.SELECT_FULL_PATH:\n        case browserActions.ActionTypes.SELECT: {\n            return Object.assign({}, state, {\n                isLoading: false,\n                isOpen: false,\n            });\n        }\n    }\n    return state;\n}","import { AllActions } from \"../actions\";\nimport * as channelActions from './actions';\n\nexport interface ChannelStatusReducer {\n    status: ChannelStatusCodes,\n}\n\nexport enum ChannelStatusCodes {\n    CONNECTING = \"connecting\",\n    CONNECTED = \"connected\",\n    READY = \"ready\",\n    WAITING = \"waiting\",\n    DISCONNECTED = \"disconnected\"\n}\n\nconst initialChannelState: ChannelStatusReducer = {\n    status: ChannelStatusCodes.WAITING,\n}\n\nexport function channelStatusReducer(state = initialChannelState, action: AllActions): ChannelStatusReducer {\n    switch (action.type) {\n        case channelActions.ActionTypes.OPEN: {\n            return { status: ChannelStatusCodes.CONNECTED };\n        }\n        case channelActions.ActionTypes.INITIAL_STATE: {\n            return { status: ChannelStatusCodes.READY };\n        }\n        case channelActions.ActionTypes.CLOSE: {\n            return { status: ChannelStatusCodes.WAITING };\n        }\n        case channelActions.ActionTypes.SHUTDOWN: {\n            return { status: ChannelStatusCodes.DISCONNECTED }\n        }\n    }\n    return state;\n}","import { AllActions } from \"../actions\";\nimport { ConnectRequestParams, HostDetails } from \"../messages\";\nimport * as clusterActions from './actions';\n\nexport type ClusterConnectionState = {\n    status: \"connected\",\n    params: ConnectRequestParams,\n    details: HostDetails[]\n} | {\n    status: \"disconnected\",\n} | {\n    status: \"unknown\"\n} | {\n    status: \"connecting\"\n}\n\nconst initialClusterConnectionState: ClusterConnectionState = {\n    status: \"unknown\"\n}\n\nexport function clusterConnectionReducer(state = initialClusterConnectionState, action: AllActions): ClusterConnectionState {\n    switch (action.type) {\n        case clusterActions.ActionTypes.NOT_CONNECTED: {\n            return {\n                status: \"disconnected\"\n            };\n        }\n        case clusterActions.ActionTypes.CONNECTED: {\n            return {\n                status: \"connected\",\n                params: action.payload.params,\n                details: action.payload.details,\n            }\n        }\n        case clusterActions.ActionTypes.CONNECTING: {\n            return {\n                status: \"connecting\"\n            }\n        }\n    }\n    return state;\n}","import { AllActions } from \"../actions\";\nimport * as analysisActions from \"../analysis/actions\";\nimport * as channelActions from '../channel/actions';\nimport * as datasetActions from \"../dataset/actions\";\nimport { ById, constructById, filterWithPred, insertById, updateById } from \"../helpers/reducerHelpers\";\nimport * as compoundAnalysisActions from \"./actions\";\nimport { CompoundAnalysisState } from \"./types\";\n\nexport type CompoundAnalysisReducerState = ById<CompoundAnalysisState>;\n\nconst initialCompoundAnalysisState: CompoundAnalysisReducerState = {\n    byId: {},\n    ids: [],\n}\n\nexport function compoundAnalysisReducer(state = initialCompoundAnalysisState, action: AllActions): CompoundAnalysisReducerState {\n    switch (action.type) {\n        case compoundAnalysisActions.ActionTypes.CREATED: {\n            const newCompoundAnalysis = {\n                doAutoStart: action.payload.autoStart,\n                ...action.payload.compoundAnalysis,\n            }\n            return insertById(state, action.payload.compoundAnalysis.compoundAnalysis, newCompoundAnalysis);\n        }\n        case compoundAnalysisActions.ActionTypes.REMOVED: {\n            return filterWithPred(state, (r: CompoundAnalysisState) => r.compoundAnalysis !== action.payload.id);\n        }\n        case compoundAnalysisActions.ActionTypes.ENABLE_AUTOSTART: {\n            return updateById(state, action.payload.compoundAnalysisId, {\n                doAutoStart: true,\n            })\n        }\n        case datasetActions.ActionTypes.DELETE: {\n            return filterWithPred(state, (r: CompoundAnalysisState) => r.dataset !== action.payload.dataset);\n        }\n        case analysisActions.ActionTypes.CREATED: {\n            const compoundAnalysis = state.byId[action.payload.compoundAnalysis];\n            const newAnalyses = [...compoundAnalysis.details.analyses];\n            newAnalyses[action.payload.analysisIndex] = action.payload.analysis.id;\n            return updateById(state, action.payload.compoundAnalysis, {\n                details: {\n                    analyses: newAnalyses,\n                    mainType: compoundAnalysis.details.mainType,\n                }\n            });\n        }\n        case channelActions.ActionTypes.INITIAL_STATE: {\n            const compoundAnalyses = action.payload.compoundAnalyses.map(ca => ({ doAutoStart: false, ...ca }));\n            return {\n                byId: constructById(compoundAnalyses, ca => ca.compoundAnalysis),\n                ids: compoundAnalyses.map(ca => ca.compoundAnalysis),\n            };\n        }\n    }\n    return state;\n}","import { AllActions } from \"../actions\";\nimport * as browserActions from '../browser/actions';\nimport * as clusterActions from '../cluster/actions';\nimport * as datasetActions from '../dataset/actions';\nimport { toggleItemInList } from \"../helpers/reducerHelpers\";\nimport { ClusterTypes, DatasetFormParams, MsgPartConfig } from \"../messages\";\nimport * as configActions from './actions';\nimport { makeUnique } from \"./helpers\";\n\nexport interface LocalConfig {\n    cwd: string,\n    fileHistory: string[],\n    lastOpened: {\n        [path: string]: DatasetFormParams\n    },\n    lastConnection: {\n        type: ClusterTypes,\n        address: string,\n        cudas: number[],\n    },\n    starred: string[],\n}\n\nexport type ConfigParams = MsgPartConfig & LocalConfig ;\nexport type ConfigState = ConfigParams & {\n    haveConfig: boolean,\n};\n\nexport const initialConfigState: ConfigState = {\n    version: \"\",\n    revision: \"\",\n    localCores: 0,\n    devices: {\n        cpus: [] as number[],\n        cudas: [] as number[],\n        has_cupy: false,\n    },\n    cwd: \"/\",\n    separator: \"/\",\n    lastOpened: {},\n    resultFileFormats: {},\n    fileHistory: [],\n    haveConfig: false,\n    lastConnection: {\n        type: ClusterTypes.LOCAL,\n        address: \"tcp://localhost:8786\",\n        cudas: [] as number[],\n    },\n    starred: [],\n}\n\nexport function configReducer(state = initialConfigState, action: AllActions): ConfigState {\n    switch (action.type) {\n        case configActions.ActionTypes.FETCHED: {\n            return Object.assign({}, action.payload.config, { haveConfig: true });\n        }\n        case browserActions.ActionTypes.DIRECTORY_LISTING: {\n            return Object.assign({}, state, {\n                cwd: action.payload.path,\n            });\n        }\n        case datasetActions.ActionTypes.CREATE: {\n            const newLastOpened = Object.assign({}, state.lastOpened, { [action.payload.dataset.params.path]: action.payload.dataset.params });\n            const newFileHistory = makeUnique([\n                action.payload.dataset.params.path, ...state.fileHistory\n            ]).slice(0, 11);\n            return Object.assign({}, state, {\n                lastOpened: newLastOpened,\n                fileHistory: newFileHistory,\n            });\n        }\n        case clusterActions.ActionTypes.CONNECT: {\n            if (action.payload.params.type === ClusterTypes.LOCAL) {\n                const newLastConnection = Object.assign({}, state.lastConnection, { type: ClusterTypes.LOCAL, cudas: action.payload.params.cudas })\n                return Object.assign({}, state, {\n                    lastConnection: newLastConnection\n                })\n            }\n            else {\n                const newLastConnection = Object.assign({}, state.lastConnection, { type: ClusterTypes.TCP, address: action.payload.params.address })\n                return Object.assign({}, state, {\n                    lastConnection: newLastConnection\n                })\n            }\n        }\n        case configActions.ActionTypes.TOGGLE_STAR: {\n            const path = action.payload.path;\n            return {\n                ...state,\n                starred: toggleItemInList(state.starred, path),\n            };\n        }\n    }\n    return state;\n}","import { AllActions } from \"../actions\";\nimport * as channelActions from '../channel/actions';\nimport { constructById, filterWithPred, insertById, updateById } from \"../helpers/reducerHelpers\";\nimport { Dataset, DatasetState, DatasetStatus } from \"../messages\";\nimport * as datasetActions from './actions';\nimport { DatasetsState, OpenDatasetState } from \"./types\";\n\nconst initialDatasetState: DatasetsState = {\n    byId: {},\n    ids: [],\n};\n\nexport function datasetReducer(state = initialDatasetState, action: AllActions): DatasetsState {\n    switch (action.type) {\n        case channelActions.ActionTypes.INITIAL_STATE: {\n            const datasets = action.payload.datasets.map(ds => Object.assign({}, ds, { status: DatasetStatus.OPEN }));\n            return {\n                byId: constructById(datasets, ds => ds.id),\n                ids: datasets.map(ds => ds.id),\n            }\n        }\n        case datasetActions.ActionTypes.CREATE: {\n            const ds: Dataset = {\n                ...action.payload.dataset,\n                status: DatasetStatus.OPENING\n            };\n            return insertById(state, action.payload.dataset.id, ds);\n        }\n        case datasetActions.ActionTypes.CREATED: {\n            const ds = Object.assign({}, action.payload.dataset, { status: DatasetStatus.OPEN });\n            if (state.byId[action.payload.dataset.id]) {\n                return updateById(state, action.payload.dataset.id, ds);\n            } else {\n                return insertById(state, action.payload.dataset.id, ds);\n            }\n        }\n        case datasetActions.ActionTypes.ERROR: {\n            return filterWithPred(state, (r: DatasetState) => r.id !== action.payload.dataset);\n        }\n        case datasetActions.ActionTypes.DELETE: {\n            return updateById(state, action.payload.dataset, { status: DatasetStatus.DELETING });\n        }\n        case datasetActions.ActionTypes.DELETED: {\n            return filterWithPred(state, (r: DatasetState) => r.id !== action.payload.dataset);\n        }\n    }\n    return state;\n}\n\nconst initialOpenDatasetState: OpenDatasetState = {\n    busy: false,\n    busyPath: \"\",\n    formVisible: false,\n    formPath: \"/\",\n    formCachedParams: undefined,\n    formDetectedParams: undefined,\n}\n\nexport function openDatasetReducer(state = initialOpenDatasetState, action: AllActions): OpenDatasetState {\n    switch (action.type) {\n        case datasetActions.ActionTypes.OPEN: {\n            return {\n                ...state,\n                formVisible: true,\n                formPath: action.payload.path,\n                formCachedParams: action.payload.cachedParams,\n                formDetectedParams: action.payload.detectedParams,\n            };\n        }\n        case datasetActions.ActionTypes.CANCEL_OPEN: {\n            return {\n                ...state,\n                formVisible: false,\n            }\n        }\n        case datasetActions.ActionTypes.CREATE: {\n            return {\n                ...state,\n                formVisible: false,\n            }\n        }\n        case datasetActions.ActionTypes.DETECT: {\n            return {\n                ...state,\n                busyPath: action.payload.path,\n                busy: true,\n            }\n        }\n        case datasetActions.ActionTypes.DETECTED:\n        case datasetActions.ActionTypes.DETECT_FAILED: {\n            return {\n                ...state,\n                busyPath: \"\",\n                busy: false,\n            }\n        }\n    }\n    return state;\n}","import { AllActions } from \"../actions\";\nimport * as browserActions from '../browser/actions';\nimport * as channelActions from '../channel/actions';\nimport * as clusterActions from '../cluster/actions';\nimport * as analysisActions from '../compoundAnalysis/actions';\nimport * as datasetActions from '../dataset/actions';\nimport { ById, filterWithPred, insertById } from \"../helpers/reducerHelpers\";\nimport * as errorActions from './actions';\n\nexport interface ErrorMessage {\n    id: string,\n    msg: string,\n    timestamp: number,\n}\n\nexport type ErrorState = ById<ErrorMessage>;\n\nconst initialErrorState: ErrorState = {\n    byId: {},\n    ids: [],\n};\n\nexport function errorReducer(state = initialErrorState, action: AllActions): ErrorState {\n    switch (action.type) {\n        case browserActions.ActionTypes.ERROR:\n        case datasetActions.ActionTypes.ERROR:\n        case channelActions.ActionTypes.ERROR:\n        case clusterActions.ActionTypes.ERROR:\n        case analysisActions.ActionTypes.ERROR:\n        case channelActions.ActionTypes.JOB_ERROR: {\n            return insertById(state, action.payload.id, {\n                id: action.payload.id,\n                msg: action.payload.msg,\n                timestamp: action.payload.timestamp,\n            });\n        }\n        case channelActions.ActionTypes.OPEN: {\n            return initialErrorState;\n        }\n        case errorActions.ActionTypes.DISMISS: {\n            return filterWithPred(state, (r: ErrorMessage) => r.id !== action.payload.id);\n        }\n        case errorActions.ActionTypes.DISMISS_ALL: {\n            return initialErrorState;\n        }\n    }\n    return state;\n}","import { AllActions } from \"../actions\";\nimport * as channelActions from '../channel/actions';\nimport { ById, constructById, insertById, updateById } from \"../helpers/reducerHelpers\";\nimport * as jobActions from './actions';\nimport { JobRunning, JobState, JobStatus } from \"./types\";\n\nexport type JobReducerState = ById<JobState>;\n\nconst initialJobState: JobReducerState = {\n    byId: {},\n    ids: [],\n};\n\nexport function jobReducer(state = initialJobState, action: AllActions): JobReducerState {\n    switch (action.type) {\n        case jobActions.ActionTypes.CREATE: {\n            const createResult = insertById(\n                state,\n                action.payload.id,\n                {\n                    id: action.payload.id,\n                    analysis: action.payload.analysis,\n                    running: JobRunning.CREATING,\n                    status: JobStatus.CREATING,\n                    results: [],\n                    startTimestamp: action.payload.timestamp,\n                }\n            )\n            return createResult;\n        }\n        case channelActions.ActionTypes.JOB_STARTED: {\n            return updateById(\n                state,\n                action.payload.job,\n                {\n                    running: JobRunning.RUNNING,\n                    status: JobStatus.IN_PROGRESS,\n                    startTimestamp: action.payload.timestamp,\n                }\n            )\n        }\n        case channelActions.ActionTypes.TASK_RESULT: {\n            return updateById(\n                state,\n                action.payload.job,\n                {\n                    results: action.payload.results,\n                }\n            );\n        }\n        case channelActions.ActionTypes.FINISH_JOB: {\n            const { job, timestamp, results } = action.payload;\n            return updateById(\n                state,\n                job,\n                {\n                    running: JobRunning.DONE,\n                    status: JobStatus.SUCCESS,\n                    results,\n                    endTimestamp: timestamp,\n                }\n            );\n        }\n        case channelActions.ActionTypes.JOB_ERROR: {\n            const { job, timestamp } = action.payload;\n            return updateById(\n                state,\n                job,\n                {\n                    running: JobRunning.DONE,\n                    status: JobStatus.ERROR,\n                    endTimestamp: timestamp,\n                }\n            )\n        }\n        case channelActions.ActionTypes.INITIAL_STATE: {\n            const jobs = action.payload.jobs;\n            const jobState: JobState[] = jobs.map(job => {\n                return {\n                    id: job.id,\n                    analysis: job.analysis,\n                    // FIXME: right job status!\n                    status: JobStatus.SUCCESS,\n                    startTimestamp: 0,\n                    // FIXME: result blobs?\n                    results: [],\n                    // FIXME: right job running status!\n                    running: JobRunning.DONE,\n                    endTimestamp: 0,\n                };\n            })\n\n            return {\n                byId: constructById(jobState, job => job.id),\n                ids: jobState.map(job => job.id),\n            };\n        }\n    }\n    return state;\n}","import { combineReducers } from \"redux\";\nimport { analysisReducer } from \"./analysis/reducers\";\nimport { directoryBrowserReducer } from './browser/reducers';\nimport { channelStatusReducer } from \"./channel/reducers\";\nimport { clusterConnectionReducer } from \"./cluster/reducers\";\nimport { compoundAnalysisReducer } from \"./compoundAnalysis/reducers\";\nimport { configReducer } from \"./config/reducers\";\nimport { datasetReducer, openDatasetReducer } from \"./dataset/reducers\";\nimport { errorReducer } from \"./errors/reducers\";\nimport { jobReducer } from \"./job/reducers\";\n\nexport const rootReducer = combineReducers({\n    compoundAnalyses: compoundAnalysisReducer,\n    analyses: analysisReducer,\n    channelStatus: channelStatusReducer,\n    clusterConnection: clusterConnectionReducer,\n    datasets: datasetReducer,\n    openDataset: openDatasetReducer,\n    jobs: jobReducer,\n    errors: errorReducer,\n    config: configReducer,\n    browser: directoryBrowserReducer,\n})\n\nexport type RootReducer = ReturnType<typeof rootReducer>;","// tslint:disable:ordered-imports\nimport \"core-js/fn/symbol/iterator.js\";\nimport \"core-js/es6/symbol.js\";\nimport 'react-app-polyfill/ie11';\n// tslint:enable:ordered-imports\n\nimport * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport { applyMiddleware, compose, createStore } from 'redux';\nimport createSagaMiddleware from 'redux-saga';\nimport App from './App';\nimport registerServiceWorker from './registerServiceWorker';\nimport { rootSaga } from './sagas';\nimport { rootReducer } from './store';\n\nconst sagaMiddleware = createSagaMiddleware();\n\nconst composeEnhancers = (window as any).__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nconst store = createStore(rootReducer, composeEnhancers(\n    applyMiddleware(\n        sagaMiddleware,\n    )\n));\n\nReactDOM.render(\n    <Provider store={store}>\n        <App />\n    </Provider>,\n    document.getElementById('root') as HTMLElement\n);\nregisterServiceWorker();\n\nsagaMiddleware.run(rootSaga);"],"sourceRoot":""}