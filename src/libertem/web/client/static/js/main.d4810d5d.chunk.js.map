{"version":3,"sources":["job/components/ResultImage.module.css","images/LiberTEM logo-medium.png","cluster/actions.ts","About.tsx","helpers/actionHelpers.ts","helpers/index.ts","messages.ts","browser/actions.ts","cluster/components/LocalConnectionForm.tsx","cluster/components/TCPConnectionForm.tsx","cluster/components/ClusterConnectionForm.tsx","channel/components/ChannelConnecting.tsx","channel/components/ChannelStatus.tsx","browser/components/FileBrowserEntry.tsx","browser/components/FileBrowserHeader.tsx","browser/components/FileEntry.tsx","browser/components/FolderEntry.tsx","browser/components/PathDropDownItem.tsx","browser/components/PathInput.tsx","browser/components/RecentFiles.tsx","browser/components/PathBar.tsx","browser/components/FileBrowser.tsx","browser/components/BrowserWrapper.tsx","widgets/constraints.ts","widgets/styles.ts","widgets/Disk.tsx","widgets/kbdHandler.ts","widgets/DraggableHandle.tsx","analysis/actions.ts","job/types.ts","widgets/BusySpinner.tsx","widgets/BusyWrapper.tsx","widgets/HandleParent.tsx","job/components/ResultImage.tsx","job/components/Result.tsx","job/components/Selectors.tsx","job/components/ResultList.tsx","analysis/components/FrameViewModeSelector.tsx","analysis/components/PickHandle.tsx","analysis/components/Toolbar.tsx","analysis/components/AnalysisItem.tsx","analysis/components/CenterOfMassAnalysis.tsx","analysis/components/DiskMaskAnalysis.tsx","analysis/components/PointSelectionAnalysis.tsx","helpers/svg.ts","widgets/Ring.tsx","analysis/components/RingMaskAnalysis.tsx","analysis/components/RadialFourierAnalysis.tsx","analysis/components/Analysis.tsx","analysis/components/AnalysisList.tsx","helpers/reducerHelpers.ts","analysis/types.ts","dataset/actions.ts","analysis/components/AnalysisSelect.tsx","dataset/components/AddAnalysis.tsx","dataset/components/DatasetParams.tsx","dataset/components/DatasetInfo.tsx","dataset/components/DatasetToolbar.tsx","dataset/components/Dataset.tsx","dataset/helpers.ts","dataset/components/BLOParamsForm.tsx","errors/actions.ts","dataset/components/DatasetTypeSelect.tsx","dataset/components/EMPADParamsForm.tsx","dataset/components/FRMS6ParamsForm.tsx","dataset/components/HDF5ParamsForm.tsx","dataset/components/HDFSParamsForm.tsx","dataset/components/K2ISParamsForm.tsx","dataset/components/MIBParamsForm.tsx","dataset/components/RawFileParamsForm.tsx","dataset/components/SERParamsForm.tsx","dataset/components/DatasetOpen.tsx","dataset/components/DatasetOpenSpinner.tsx","dataset/components/DatasetList.tsx","errors/components/Error.tsx","errors/components/ErrorList.tsx","App.tsx","registerServiceWorker.ts","job/actions.ts","job/api.ts","analysis/sagas.ts","config/helpers.ts","browser/api.ts","channel/actions.ts","browser/sagas.ts","channel/messages.ts","channel/sagas.ts","cluster/api.ts","config/actions.ts","cluster/sagas.ts","config/api.ts","config/sagas.ts","dataset/api.ts","dataset/sagas.ts","sagas.ts","analysis/reducers.ts","browser/reducers.ts","channel/reducers.ts","cluster/reducers.ts","config/reducers.ts","dataset/reducers.ts","errors/reducers.ts","job/reducers.ts","store.ts","index.tsx"],"names":["module","exports","default","fallback","__webpack_require__","p","ActionTypes","connect","state","version","config","revision","_ref","react","Header","as","slice","List","Item","Icon","name","Content","href","src","alt","createAction","type","payload","meta","undefined","Actions","notConnected","NOT_CONNECTED","params","CONNECT","connected","CONNECTED","assertNotReached","message","Error","defaultDebounce","fn","delay","arguments","length","_","maxWait","getEnumValues","e","Object","keys","ClusterTypes","DatasetTypes","DatasetStatus","AnalysisTypes","ClusterTypeMetadata","_ClusterTypeMetadata","defineProperty","LOCAL","label","TCP","helpText","withFormik","mapPropsToValues","ownProps","numWorkers","localCores","handleSubmit","values","formikBag","onSubmit","props","objectSpread","touched","errors","isSubmitting","dirty","handleChange","handleBlur","handleReset","Form","Field","htmlFor","value","onChange","onBlur","Button","primary","disabled","address","mapDispatchToProps","connectToCluster","clusterActions","clusterTypeOptions","map","t","text","ClusterConnectionForm","clusterType","setType","_this","setState","data","this","components_LocalConnectionForm","components_TCPConnectionForm","Dropdown","inline","options","Segment","renderForm","React","ChannelConnecting","msg","Message","icon","loading","messages","waiting","connecting","clusterMessages","channelStatus","clusterConnection","haveConfig","children","status","components_ChannelConnecting","components_ClusterConnectionForm","list","path","LIST_DIRECTORY","dirListing","dirs","files","drives","places","DIRECTORY_LISTING","open","OPEN","cancel","CANCEL","select","SELECT","selectFullPath","SELECT_FULL_PATH","error","timestamp","id","ERROR","detectParams","DETECT_PARAMS","paramsDetected","PARAMS_DETECTED","TimeStamp","ts","date","Date","fmtDate","toLocaleDateString","fmtTime","toLocaleTimeString","title","concat","style","display","whiteSpace","width","marginRight","FileSize","_ref2","fmtSize","bytes","si","thresh","Math","abs","size","unit","units","u","toFixed","humanFileSize","textAlign","Cell","_ref3","overflow","textOverflow","FileBrowserEntry","onClick","_this$props","details","myStyle","cursor","tsStyles","paddingRight","flexGrow","FileBrowserEntry_Cell","FileBrowserEntry_FileSize","owner","FileBrowserEntry_TimeStamp","ctime","mtime","FileBrowserHeader","alignRight","paddingBottom","FileEntry","components_FileBrowserEntry","dispatch","browserActions","window","setTimeout","toString","objectWithoutProperties","newProps","initialPath","enableReinitialize","Input","autoComplete","lastOpened","fileHistory","separator","recentFiles","filter","item","floating","Menu","content","option","idx","key","refresh","currentPath","handleInputChange","goUp","driveOptions","placeOptions","components_RecentFiles","components_PathDropDownItem","components_PathInput","listRef","scrollToTop","current","scrollToItem","sortByKey","array","getKey","sort","a","b","x","y","browser","isLoading","getSortKey","toLowerCase","dirEntries","dir","components_FolderEntry","fileEntries","f","components_FileEntry","entries","index_esm","overflowY","ref","height","itemCount","itemSize","index","Group","components_PathBar","components_FileBrowserHeader","isOpen","components_FileBrowser","labelPosition","inRectConstraint","max","min","cbToRadius","cx","cy","cb","dx","dy","sqrt","dist","keepOnCY","riConstraint","outerPos","otherX","roConstraints","innerPos","defaultMaskStyles","imageWidth","fillOpacity","fill","strokeOpacity","stroke","strokeWidth","Disk","imageHeight","r","handleKeyEvent","update","delta","shiftKey","preventDefault","StyledCircle","styled","circle","_templateObject","Cross","_templateObject2","FocusGroup","g","_templateObject3","Handle","scale","withCross","focusRef","args","transform","crossSpec","cross","d","assign","relativeCoords","parent","elem","svg","ownerSVGElement","inWidthAttr","getAttribute","inWidth","getBoundingClientRect","getScalingFactor","parentPos","pageX","left","pageXOffset","pageY","top","pageYOffset","DraggableHandle","_React$Component","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","posRef","dragging","drag","externalMouseMove","move","externalLeave","stopDrag","externalMouseUp","applyConstraint","constraint","startDrag","parentOnDragStart","assertThisInitialized","focus","onDragMove","constrained","parentOnDrop","_this$state","handleKeyDown","newCoords","inherits","createClass","visibility","DraggableHandle_Handle","onMouseUp","onMouseMove","onMouseDown","onKeyDown","tabIndex","_this$state$drag","renderCommon","_this$props2","renderDragging","JobRunning","JobStatus","create","dataset","analysisType","CREATE","created","analysis","CREATED","updateParameters","parameters","kind","UPDATE_PARAMETERS","setFrameViewMode","mode","initialParams","SET_FRAMEVIEW_MODE","prepareRun","job","PREPARE_RUN","run","RUN","running","RUNNING","remove","REMOVE","removed","REMOVED","BusySpinner","margin","padding","position","bottom","right","color","opacity","BusyWrapper","busy","widgets_BusySpinner","HandleParent","_getPrototypeOf2","_len","Array","_key","apply","currentHandle","handleDragStart","h","handleDrop","handleMouseMove","handleMouseLeave","handleMouseUp","onMouseLeave","onKeyboardEvent","outline","renderHandles","_this2","handles","i","ResultImage","result","results","className","styles","viewBox","xlinkHref","imageURL","ResultWrapper","Result_templateObject","analysisActions","Result","extraHandles","toConsumableArray","widgets_HandleParent","extraWidgets","DONE","widgets_BusyWrapper","components_ResultImage","Selectors","div","Selectors_templateObject","ResultList","selectedChannel","selectChannel","getJob","currentJob","jobsById","history","jobHistory","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","tmpJob","err","return","selectors","pickCoords","currentResult","border","components_Result","dt","endTimestamp","startTimestamp","components_Selectors","ResultList_ResultImageSelector","selectedImg","ResultImageSelector","availableImages","description","analyses","byId","jobId","jobs","ds","datasets","frameDetails","SUM_FRAMES","frameViewModeOptions","PICK_FRAME","FrameViewModeSelector","scanWidth","scanHeight","round","shape","onDragStart","onDrop","_analysis$frameDetail","widgets_DraggableHandle","pickX","pickY","newX","newY","RESULT","getAnalysisStatus","handleApply","handleRemove","applyIconProps","attached","AnalysisItem","frameViewHandles","frameViewWidgets","subtitle","resultWidth","resultHeight","frameWidth","frameHeight","Grid","columns","Row","Column","components_ResultList","components_FrameViewModeSelector","components_PickHandle","components_Toolbar","handleCenterChange","handleRChange","rHandle","widgets_Disk","components_AnalysisItem","DraggableHandle_DraggableHandle","getPathArc","center","start","end","radius","degree","points","push","getLocationFromAngle","clockWise","join","getCirclePath","radian","PI","cos","sin","Ring","ri","pathSpec","ro","fillRule","handleRIChange","handleROChange","riHandle","roHandle","widgets_Ring","resultDetails","APPLY_DISK_MASK","components_DiskMaskAnalysis","APPLY_RING_MASK","components_RingMaskAnalysis","CENTER_OF_MASS","components_CenterOfMassAnalysis","APPLY_POINT_SELECTOR","components_PointSelectionAnalysis","RADIAL_FOURIER","components_RadialFourierAnalysis","AnalysisList","ids","analysisId","Analysis","updateById","partialRecord","newObj","newById","insertById","record","filterWithPred","pred","reduce","acc","AnalysisMetadata","_AnalysisMetadata","long","short","showInUI","getMetadata","analysisTypeOptions","AnalysisSelect","labeled","button","handleAddAnalysis","components_AnalysisSelect","renderParams","Table","DatasetParams","HeaderCell","Body","DiagElem","DatasetInfo_DiagElems","diagnostics","renderValue","DiagElems","DatasetInfo_DiagElem","DatasetInfo","components_DatasetParams","cancelOpen","CANCEL_OPEN","delete","DELETE","deleted","DELETED","detect","DETECT","detected","DETECTED","detectFailed","DETECT_FAILED","handleRemoveDataset","datasetActions","DatasetContainer","_msg","OPENING","DELETING","dividing","marginTop","marginBottom","horizontal","Modal","trigger","link","Popup","components_DatasetInfo","flexShrink","components_DatasetToolbar","components_AnalysisList","components_AddAnalysis","parseNumList","nums","split","part","getInitial","otherwise","initial","tileshape","_formikBag$props","BLO","onCancel","datasetTypeOptions","DatasetTypeSelect","currentType","scan_size","EMPAD","FRMS6","ds_path","HDF5","HDFS","K2IS","MIB","enable_direct","detector_size","dtype","RAW","checked","SER","DatasetOpen","datasetType","setDatasetType","formInitial","formPath","createDataset","form","components_DatasetTypeSelect","components_HDF5ParamsForm","components_HDFSParamsForm","components_RawFileParamsForm","MIBParamsForm","BLOParamsForm","K2ISParamsForm","components_SERParamsForm","components_FRMS6ParamsForm","EMPADParamsForm","formVisible","openDataset","formInitialParams","uuid","busyPath","DatasetList","dsId","Dataset","components_DatasetOpenSpinner","components_DatasetOpen","components_BrowserWrapper","DISMISS","dismiss","errorActions","negative","onDismiss","clusterConnected","channelConnected","latestErrors","showModal","components_Error","App","Container","logo","alignSelf","src_About","components_ErrorList","components_ChannelStatus","components_DatasetList","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","console","log","catch","startJob","datasetId","fetch","body","JSON","stringify","credentials","method","json","cancelJob","createAnalysisSaga","cancelOldJob","analysisSidecar","updateFrameViewMode","updateFrameViewParams","doRemoveAnalysisSaga","analysisRootSaga","getAnalysisDetails","minLength","n_bins","max_order","selectDataset","selectAnalysis","selectJob","action","datasetState","sidecarTask","regenerator_default","wrap","_context","prev","sent","FRAME","fork","put","take","t0","now","stop","_marked","_context2","abrupt","_marked2","runOrParamsChannel","oldJobId","_context3","actionChannel","buffers","sliding","jobActions","_marked3","_context4","_marked4","_context5","_marked5","_context6","finish","_marked6","_context7","takeEvery","_marked7","CONFIG_KEY","joinPaths","parts","replace","RegExp","trim","mergeLocalStorage","serverConfig","localSettings","localStorage","getItem","localSettingsParsed","parse","defaultConfig","setLocalStorage","setItem","getDirectoryListing","url","directoryListingSaga","fetchOnRequest","fetchDirectoryListing","fetchDirectoryListOnOpen","sagas_marked","_action$payload","newPath","sagas_marked2","browserState","alternative","_browserState","_timestamp","_id","home","sagas_marked3","cwd","sagas_marked4","MessageTypes","initialState","INITIAL_STATE","jobStarted","JOB_STARTED","finishJob","FINISH_JOB","taskResult","TASK_RESULT","jobError","JOB_ERROR","close","CLOSE","createMessage","messageType","attribs","Messages","followup","binary","objectURL","BINARY","deleteDataset","DELETE_DATASET","webSocketSaga","actionsFromChannel","handleBinaryParts","handleTaskResult","handleFinishJob","createWebSocketChannel","eventChannel","emit","onMessage","Blob","channelMessages","URL","createObjectURL","parsed","onOpen","onClose","END","onError","ws","WebSocket","port","addEventListener","removeEventListener","socketChannel","channelActions","channel_sagas_marked","channel_sagas_marked2","numParts","binMsg","channel_sagas_marked3","images","numMessages","descriptions","channel_sagas_marked4","sagas_marked5","connection","checkClusterConnection","connectSaga","putClusterStatus","trackClusterConnection","clusterConnectionSaga","conn","cluster_sagas_marked","cluster_sagas_marked2","cluster_sagas_marked3","all","cluster_sagas_marked4","FETCH","fetched","FETCHED","fetchFailed","FETCH_FAILED","getConfig","getConfigOnReconnect","getConfigSaga","updateLocalStorageConfig","firstConfigFetch","configRootSaga","config_sagas_marked","configResponse","mergedConfig","configActions","removeItem","config_sagas_marked2","config_sagas_marked3","config_sagas_marked4","config_sagas_marked5","detectDataset","createDatasetSaga","deleteDatasetSaga","doOpenDataset","openDatasetSagaFullPath","openDatasetSaga","datasetRootSaga","resp","dataset_sagas_marked","dataset_sagas_marked2","fullPath","prefillParams","detectResult","datasetParams","dataset_sagas_marked3","dataset_sagas_marked4","dataset_sagas_marked5","sagas_marked6","rootSaga","src_sagas_marked","initialAnalysisState","ChannelStatusCodes","initialBrowserState","initialChannelState","WAITING","initialClusterConnectionState","initialConfigState","initialDatasetState","initialOpenDatasetState","initialErrorState","initialJobState","rootReducer","combineReducers","newDetails","oldJob","newJobs","newFrameDetails","READY","items","CREATING","IN_PROGRESS","SUCCESS","_action$payload2","inp","newLastOpened","newFileHistory","curr","indexOf","place","sagaMiddleware","createSagaMiddleware","composeEnhancers","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","applyMiddleware","ReactDOM","es","src_App","document","getElementById","process","origin","response","headers","get","ready","unregister","reload","checkValidServiceWorker","registerServiceWorker"],"mappings":"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","file":"static/js/main.d4810d5d.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"default\":\"ResultImage_default__hha9H\",\"fallback\":\"ResultImage_fallback__2xEcm\"};","module.exports = __webpack_public_path__ + \"static/media/LiberTEM logo-medium.7999e0dc.png\";","import { ActionsUnion, createAction } from '../helpers/actionHelpers';\nimport { ConnectRequestParams } from '../messages';\n\nexport enum ActionTypes {\n    NOT_CONNECTED = 'CLUSTER_NOT_CONNECTED',\n    CONNECT = 'CLUSTER_CONNECT',\n    CONNECTED = 'CLUSTER_CONNECTED',\n}\n\nexport const Actions = {\n    notConnected: () => createAction(ActionTypes.NOT_CONNECTED),\n    connect: (params: ConnectRequestParams) => createAction(ActionTypes.CONNECT, { params }),\n    connected: (params: ConnectRequestParams) => createAction(ActionTypes.CONNECTED, { params }),\n}\n\nexport type Actions = ActionsUnion<typeof Actions>;\n","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Header, List } from \"semantic-ui-react\";\nimport { RootReducer } from \"./store\";\n\nconst mapStateToProps = (state: RootReducer) => {\n    return {\n        version: state.config.version,\n        revision: state.config.revision,\n    }\n}\n\ntype MergedProps = ReturnType<typeof mapStateToProps>;\n\nconst About: React.SFC<MergedProps> = ({ version, revision }) => {\n    return (\n        <>\n            <Header as=\"h3\">This is LiberTEM version {version} (revision {revision.slice(0, 8)})</Header>\n            <List>\n                <List.Item>\n                    <List.Icon name=\"github\" />\n                    <List.Content>\n                        Find us on <a href=\"https://github.com/LiberTEM/LiberTEM\">GitHub</a>\n                    </List.Content>\n                </List.Item>\n                <List.Item>\n                    <List.Icon name=\"bug\" />\n                    <List.Content>\n                        Found a bug? Got a feature request? Please <a href=\"https://github.com/LiberTEM/LiberTEM/issues/new\">open an issue!</a>\n                    </List.Content>\n                </List.Item>\n                <List.Item>\n                    <List.Icon name=\"legal\" />\n                    <List.Content>\n                        LiberTEM is licensed under the <a href=\"https://github.com/LiberTEM/LiberTEM/blob/master/LICENSE\">GNU General Public License v3.0</a>\n                    </List.Content>\n                </List.Item>\n                <List.Item>\n                    <List.Icon name=\"book\" />\n                    <List.Content>\n                        Read <a href=\"https://libertem.github.io/LiberTEM/\">the documentation</a>\n                    </List.Content>\n                </List.Item>\n                <List.Item>\n                    <List.Icon name=\"user\" />\n                    <List.Content>\n                        Read <a href=\"https://libertem.github.io/LiberTEM/acknowledgments.html\">the acknowledgments</a>\n                    </List.Content>\n                </List.Item>\n                <List.Item>\n                    <List.Icon name=\"gitter\" />\n                    <List.Content>\n                        Join our <a href=\"https://gitter.im/LiberTEM/Lobby\">chat on gitter!</a>\n                    </List.Content>\n                </List.Item>\n                <List.Item>\n                    <List.Icon name=\"linkify\" />\n                    <List.Content>\n                    <a href=\"https://doi.org/10.5281/zenodo.1478763\"><img src=\"https://zenodo.org/badge/DOI/10.5281/zenodo.1478763.svg\" alt=\"DOI\"/></a>\n                    </List.Content>\n                </List.Item>\n            </List>\n        </>\n    );\n}\n\nexport default connect(mapStateToProps)(About);","import { ActionCreatorsMapObject } from \"redux\";\n\nexport interface Action<T extends string> {\n    type: T\n}\n\nexport interface ActionWithPayload<T extends string, P> extends Action<T> {\n    payload: P\n}\n\nexport interface ActionWithMeta<T extends string, P, M> extends ActionWithPayload<T, P> {\n    meta: M\n}\n\nexport function createAction<T extends string>(type: T): Action<T>\nexport function createAction<T extends string, P, M>(type: T, payload?: P): ActionWithPayload<T, P>\nexport function createAction<T extends string, P, M>(type: T, payload?: P, meta?: M): ActionWithMeta<T, P, M>\nexport function createAction<T extends string, P, M>(type: T, payload?: P, meta?: M) {\n    if (meta === undefined && payload === undefined) {\n        return { type };\n    } else if (meta === undefined) {\n        return { type, payload };\n    } else {\n        return { type, payload, meta }\n    }\n}\n\nexport type ActionsUnion<A extends ActionCreatorsMapObject> = ReturnType<A[keyof A]>","import * as _ from \"lodash\";\n\nexport function assertNotReached(message: string): never {\n    throw new Error(message);\n}\n\nexport function defaultDebounce<T extends (...args: any[]) => any>(fn: T, delay: number = 50) {\n    return _.debounce(fn, delay, { maxWait: delay });\n}\n\nexport function getEnumValues<E>(e: E): Array<keyof E> {\n    return Object.keys(e) as Array<keyof E>;\n}","\n/* \n * Common\n */\n\nexport interface FollowupPart {\n    numMessages: number,\n    descriptions: Array<{ title: string, desc: string }>,\n}\n\nexport interface MsgPartConfig {\n    version: string,\n    revision: string,\n    localCores: number,\n    cwd: string,\n    separator: string,\n}\n\nexport interface GetConfigResponse {\n    status: \"ok\",\n    config: MsgPartConfig,\n}\n\n/*\n * Connection\n */\n\nexport enum ClusterTypes {\n    LOCAL = \"LOCAL\",\n    TCP = \"TCP\",\n}\n\nexport const ClusterTypeMetadata: { [s: string]: { [s: string]: string } } = {\n    [ClusterTypes.LOCAL]: {\n        label: \"Create local cluster\",\n    },\n    [ClusterTypes.TCP]: {\n        label: \"Connect to cluster\",\n        helpText: \"can be either local or remote, connection via TCP\",\n    }\n}\n\nexport interface ConnectRequestLocalCluster {\n    type: ClusterTypes.LOCAL,\n    numWorkers?: number,\n}\n\nexport interface ConnectRequestTCP {\n    type: ClusterTypes.TCP,\n    address: string,\n}\n\nexport type ConnectRequestParams = ConnectRequestLocalCluster | ConnectRequestTCP\n\nexport interface ConnectRequest {\n    connection: ConnectRequestParams\n}\n\nexport type ConnectResponse = {\n    status: \"ok\",\n    connection: ConnectRequest,\n} | {\n    status: \"disconnected\",\n    connection: {},\n}\n\n/*\n * Dataset\n */\n\nexport enum DatasetTypes {\n    HDF5 = \"HDF5\",\n    HDFS = \"HDFS\",\n    RAW = \"RAW\",\n    MIB = \"MIB\",\n    BLO = \"BLO\",\n    K2IS = \"K2IS\",\n    SER = \"SER\",\n    FRMS6 = \"FRMS6\",\n    EMPAD = \"EMPAD\",\n}\n\nexport interface DatasetParamsCommon {\n    name: string,\n}\n\nexport type DatasetParamsHDFS = {\n    type: DatasetTypes.HDFS,\n    path: string,\n    tileshape: number[],\n} & DatasetParamsCommon;\n\nexport type DatasetParamsHDF5 = {\n    type: DatasetTypes.HDF5,\n    path: string,\n    ds_path: string,\n    tileshape: number[],\n} & DatasetParamsCommon\n\nexport type DatasetParamsRaw = {\n    type: DatasetTypes.RAW,\n    path: string,\n    dtype: string,\n    detector_size: number[],\n    enable_direct: boolean,\n    scan_size: number[],\n    tileshape: number[],\n} & DatasetParamsCommon\n\nexport type DatasetParamsMIB = {\n    type: DatasetTypes.MIB,\n    path: string,\n    scan_size: number[],\n    tileshape: number[],\n} & DatasetParamsCommon\n\nexport type DatasetParamsBLO = {\n    type: DatasetTypes.BLO,\n    path: string,\n    tileshape: number[],\n} & DatasetParamsCommon\n\nexport type DatasetParamsK2IS = {\n    type: DatasetTypes.K2IS,\n    path: string,\n} & DatasetParamsCommon\n\nexport type DatasetParamsSER = {\n    type: DatasetTypes.SER,\n    path: string,\n} & DatasetParamsCommon\n\nexport type DatasetParamsFRMS6 = {\n    type: DatasetTypes.FRMS6,\n    path: string,\n} & DatasetParamsCommon\n\nexport type DatasetParamsEMPAD = {\n    type: DatasetTypes.EMPAD,\n    path: string,\n    scan_size: number[],\n} & DatasetParamsCommon\n\nexport type DatasetFormParams = DatasetParamsHDF5 | DatasetParamsHDFS | DatasetParamsRaw | DatasetParamsMIB | DatasetParamsBLO | DatasetParamsK2IS | DatasetParamsSER | DatasetParamsFRMS6 | DatasetParamsEMPAD\n\nexport interface DatasetCreateParams {\n    id: string,\n    params: DatasetFormParams,\n}\n\nexport enum DatasetStatus {\n    OPEN = \"OPEN\",\n    OPENING = \"OPENING\",\n    DELETING = \"DELETING\",\n}\n\nexport interface DiagElemMsg {\n    name: string,\n    value: string | DiagElemMsg[],\n}\n\ninterface DatasetCommon {\n    id: string,\n    params: DatasetFormParams,\n}\n\nexport type DatasetOpening = DatasetCommon & {\n    status: DatasetStatus.OPENING,\n}\n\nexport type DatasetDeleting = DatasetCommon & {\n    status: DatasetStatus.DELETING,\n}\n\nexport type DatasetOpen = DatasetCommon & {\n    status: DatasetStatus.OPEN,\n    params: {\n        shape: number[],\n    }\n    diagnostics: DiagElemMsg[],\n}\n\nexport type Dataset = DatasetOpening | DatasetOpen | DatasetDeleting;\n\nexport interface OpenDatasetRequest {\n    dataset: DatasetCreateParams\n}\n\nexport interface OpenDatasetResponseOk {\n    status: \"ok\",\n    dataset: string,  // TODO: uuid type?\n    details: Dataset,\n}\n\nexport interface OpenDatasetResponseError {\n    status: \"error\",\n    dataset: string,\n    msg: string,\n}\n\nexport type OpenDatasetResponse = OpenDatasetResponseOk | OpenDatasetResponseError\n\nexport interface DeleteDatasetResponse {\n    status: \"ok\",\n    dataset: string,\n}\n\nexport interface DetectDatasetSuccessResponse {\n    status: \"ok\",\n    datasetParams: DatasetFormParams,\n}\n\nexport interface DetectDatasetErrorResponse {\n    status: \"error\",\n    path: string,\n    msg: string,\n}\n\nexport type DetectDatasetResponse = DetectDatasetSuccessResponse | DetectDatasetErrorResponse;\n\nexport type MsgPartInitialDataset = DatasetOpen\n\n// type alias to add client-side state to datasets\nexport type DatasetState = Dataset & {}\n\n/*\n * Job\n */\nexport interface MsgPartJob {\n    id: string,\n    dataset: string,\n}\n\nexport interface MaskDefRing {\n    shape: \"ring\",\n    cx: number,\n    cy: number,\n    ri: number,\n    ro: number\n}\n\nexport interface MaskDefDisk {\n    shape: \"disk\",\n    cx: number,\n    cy: number,\n    r: number,\n}\n\nexport interface PointDef {\n    shape: \"point\",\n    cx: number,\n    cy: number,\n}\n\n// TODO: shape doesn't really make sense here, needs to be restructured\nexport interface CenterOfMassParams {\n    shape: \"com\",\n    cx: number,\n    cy: number,\n    r: number,\n}\n\nexport interface PickFrameParams {\n    x: number,\n    y: number,\n}\n\nexport interface RadialFourierParams {\n    shape: \"radial_fourier\",\n    cx: number,\n    cy: number,\n    ri: number,\n    ro: number,\n    n_bins: number,\n    max_order: number\n}\n\nexport enum AnalysisTypes {\n    APPLY_RING_MASK = \"APPLY_RING_MASK\",\n    APPLY_DISK_MASK = \"APPLY_DISK_MASK\",\n    APPLY_POINT_SELECTOR = \"APPLY_POINT_SELECTOR\",\n    CENTER_OF_MASS = \"CENTER_OF_MASS\",\n    SUM_FRAMES = \"SUM_FRAMES\",\n    PICK_FRAME = \"PICK_FRAME\",\n    RADIAL_FOURIER = \"RADIAL_FOURIER\"\n}\n\nexport interface RingMaskDetails {\n    type: AnalysisTypes.APPLY_RING_MASK,\n    parameters: MaskDefRing,\n}\n\nexport interface DiskMaskDetails {\n    type: AnalysisTypes.APPLY_DISK_MASK,\n    parameters: MaskDefDisk,\n}\n\nexport interface PointDefDetails {\n    type: AnalysisTypes.APPLY_POINT_SELECTOR,\n    parameters: PointDef,\n}\n\nexport interface CenterOfMassDetails {\n    type: AnalysisTypes.CENTER_OF_MASS,\n    parameters: CenterOfMassParams,\n}\n\nexport interface SumFramesDetails {\n    type: AnalysisTypes.SUM_FRAMES,\n    parameters: {},\n}\n\nexport interface PickFrameDetails {\n    type: AnalysisTypes.PICK_FRAME,\n    parameters: PickFrameParams,\n}\n\nexport interface RadialFourierDetails {\n    type: AnalysisTypes.RADIAL_FOURIER,\n    parameters: RadialFourierParams,\n}\n\nexport type AnalysisParameters = MaskDefRing | MaskDefDisk | CenterOfMassParams | PointDef | PickFrameParams;\nexport type AnalysisDetails = RingMaskDetails | DiskMaskDetails | CenterOfMassDetails | PointDefDetails | SumFramesDetails | PickFrameDetails | RadialFourierDetails;\n\nexport interface StartJobRequest {\n    job: {\n        dataset: string,\n        analysis: AnalysisDetails,\n    }\n}\n\nexport interface StartJobResponse {\n    status: \"ok\",\n    job: string,\n    details: MsgPartJob,\n}\n\nexport interface CancelJobResponse {\n    status: \"ok\",\n    job: string,\n}\n\n\n/*\n * fs browser \n */\n\n// some named place, i.e. \"Documents\", \"Home\", ...\nexport interface FSPlace {\n    title: string,\n    path: string,\n    key: string,\n}\n\nexport interface DirectoryListingDetails {\n    name: string,\n    size: number,\n    ctime: number,\n    mtime: number,\n    owner: string,\n}\n\nexport interface DirectoryListingResponseOK {\n    status: \"ok\",\n    path: string,\n    files: DirectoryListingDetails[],\n    dirs: DirectoryListingDetails[],\n    drives: string[],\n    places: FSPlace[],\n}\n\nexport interface DirectoryListingResponseError {\n    status: \"error\",\n    path: string,\n    code: string,\n    msg: string,\n    alternative?: string,\n}\n\nexport type DirectoryListingResponse = DirectoryListingResponseOK | DirectoryListingResponseError;\n","import { ActionsUnion, createAction } from \"../helpers/actionHelpers\";\nimport { DatasetFormParams, DirectoryListingDetails, FSPlace } from \"../messages\";\n\nexport enum ActionTypes {\n    LIST_DIRECTORY = 'BROWSER_LIST_DIRECTORY',\n    LIST_FULL_PATH = 'BROWSER_LIST_DIRECTORY_FULL',\n    DIRECTORY_LISTING = 'BROWSER_DIRECTORY_LISTING',\n    DETECT_PARAMS = 'BROWSER_DETECT_PARAMS',\n    PARAMS_DETECTED = 'BROWSER_PARAMS_DETECTED',\n    ERROR = 'BROWSER_ERROR',\n    OPEN = 'BROWSER_OPEN',\n    CANCEL = 'BROWSER_CANCEL',\n    SELECT = 'BROWSER_SELECT',\n    SELECT_FULL_PATH = 'BROWSER_SELECT_FULL_PATH',\n}\n\nexport const Actions = {\n    list: (path: string, name?: string) => createAction(ActionTypes.LIST_DIRECTORY, { path, name }),\n    dirListing: (path: string, dirs: DirectoryListingDetails[], files: DirectoryListingDetails[], drives: string[], places: FSPlace[]) => createAction(ActionTypes.DIRECTORY_LISTING, { path, dirs, files, drives, places }),\n    open: () => createAction(ActionTypes.OPEN),\n    cancel: () => createAction(ActionTypes.CANCEL),\n    select: (path: string, name: string) => createAction(ActionTypes.SELECT, { path, name }),\n    selectFullPath: (path: string) => createAction(ActionTypes.SELECT_FULL_PATH, { path }),\n    error: (msg: string, timestamp: number, id: string) => createAction(ActionTypes.ERROR, { msg, timestamp, id }),\n    detectParams: (path: string) => createAction(ActionTypes.DETECT_PARAMS, { path }),\n    paramsDetected: (path: string, params: DatasetFormParams) => createAction(ActionTypes.PARAMS_DETECTED, { path, params }),\n}\n\nexport type Actions = ActionsUnion<typeof Actions>;","import { FormikProps, withFormik } from \"formik\";\nimport * as React from \"react\";\nimport { Button, Form } from \"semantic-ui-react\";\nimport { ConfigState } from \"../../config/reducers\";\nimport { Omit } from \"../../helpers/types\";\nimport { ClusterTypes, ConnectRequestLocalCluster } from \"../../messages\";\n\ntype FormValues = Omit<ConnectRequestLocalCluster, \"type\">;\n\ninterface FormProps {\n    onSubmit: (params: ConnectRequestLocalCluster) => void,\n    config: ConfigState,\n}\n\ntype MergedProps = FormikProps<FormValues> & FormProps;\n\nconst LocalConnectionForm: React.SFC<MergedProps> = ({\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    handleReset,\n}) => {\n    return (\n        <Form onSubmit={handleSubmit}>\n            <Form.Field>\n                <label htmlFor=\"numWorkers\">Number of Workers:</label>\n                <input type=\"number\" name=\"numWorkers\" value={values.numWorkers}\n                    onChange={handleChange}\n                    onBlur={handleBlur} />\n                {errors.numWorkers && touched.numWorkers && errors.numWorkers}\n            </Form.Field>\n            <Button primary={true} type=\"submit\" disabled={isSubmitting}>Connect</Button>\n        </Form>\n    )\n}\n\nexport default withFormik<FormProps, FormValues>({\n    mapPropsToValues: (ownProps: FormProps) => ({\n        numWorkers: ownProps.config.localCores,\n    }),\n    handleSubmit: (values, formikBag) => {\n        const { onSubmit } = formikBag.props;\n        onSubmit({\n            type: ClusterTypes.LOCAL,\n            ...values,\n        });\n    }\n})(LocalConnectionForm);\n","\nimport { FormikProps, withFormik } from \"formik\";\nimport * as React from \"react\";\nimport { Button, Form } from \"semantic-ui-react\";\nimport { Omit } from \"../../helpers/types\";\nimport { ClusterTypes, ConnectRequestTCP } from \"../../messages\";\n\ntype FormValues = Omit<ConnectRequestTCP, \"type\">;\n\ninterface FormProps {\n    onSubmit: (params: ConnectRequestTCP) => void,\n}\n\ntype MergedProps = FormikProps<FormValues> & FormProps;\n\nconst TCPConnectionForm: React.SFC<MergedProps> = ({\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    handleReset,\n}) => {\n    return (\n        <Form onSubmit={handleSubmit}>\n            <Form.Field>\n                <label htmlFor=\"address\">Scheduler URI</label>\n                <input type=\"text\" name=\"address\" value={values.address}\n                    onChange={handleChange}\n                    onBlur={handleBlur} />\n                {errors.address && touched.address && errors.address}\n            </Form.Field>\n            <Button primary={true} type=\"submit\" disabled={isSubmitting}>Connect</Button>\n        </Form>\n    )\n}\n\nexport default withFormik<FormProps, FormValues>({\n    mapPropsToValues: () => ({\n        address: \"tcp://localhost:8786\",\n    }),\n    handleSubmit: (values, formikBag) => {\n        const { onSubmit } = formikBag.props;\n        onSubmit({\n            type: ClusterTypes.TCP,\n            ...values\n        });\n    }\n})(TCPConnectionForm);\n","\nimport * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Dropdown, DropdownProps, Segment } from \"semantic-ui-react\";\nimport * as clusterActions from \"../../cluster/actions\";\nimport { getEnumValues } from \"../../helpers\";\nimport { ClusterTypeMetadata, ClusterTypes, ConnectRequestParams } from \"../../messages\";\nimport { RootReducer } from \"../../store\";\nimport LocalConnectionForm from \"./LocalConnectionForm\";\nimport TCPConnectionForm from \"./TCPConnectionForm\";\n\n\nconst mapDispatchToProps = {\n    connectToCluster: clusterActions.Actions.connect,\n};\n\nconst mapStateToProps = (state: RootReducer) => {\n    return {\n        config: state.config,\n    }\n}\n\ntype MergedProps = DispatchProps<typeof mapDispatchToProps> & ReturnType<typeof mapStateToProps>;\n\nconst clusterTypeKeys = getEnumValues(ClusterTypes);\nconst clusterTypeOptions = clusterTypeKeys.map(t => ({\n    text: ClusterTypeMetadata[ClusterTypes[t]].label,\n    value: ClusterTypes[t],\n}));\n\ninterface ConnectionParamsState {\n    clusterType: ClusterTypes\n}\n\nclass ClusterConnectionForm extends React.Component<MergedProps, ConnectionParamsState> {\n    public state = {\n        clusterType: ClusterTypes.LOCAL,\n    }\n\n    public setType = (type: ClusterTypes) => {\n        this.setState({\n            clusterType: type,\n        });\n    }\n\n    public handleChange = (e: React.SyntheticEvent, data: DropdownProps) => {\n        const value = data.value as ClusterTypes;\n        this.setType(value);\n    }\n\n    public handleSubmit = (params: ConnectRequestParams) => {\n        this.props.connectToCluster(params);\n    }\n\n    public renderForm() {\n        const { clusterType } = this.state;\n        const { config } = this.props;\n\n        switch (clusterType) {\n            case ClusterTypes.LOCAL: {\n                return <LocalConnectionForm config={config} onSubmit={this.handleSubmit} />\n            }\n            case ClusterTypes.TCP: {\n                return <TCPConnectionForm onSubmit={this.handleSubmit} />\n            }\n        }\n    }\n\n    public render() {\n        return (\n            <>\n                <div>\n                    <Dropdown\n                        inline={true}\n                        options={clusterTypeOptions}\n                        value={this.state.clusterType}\n                        onChange={this.handleChange}\n                    />\n                </div>\n                <Segment>\n                    {this.renderForm()}\n                </Segment>\n            </>\n        )\n    }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ClusterConnectionForm);","import * as React from 'react';\nimport { Icon, Message } from 'semantic-ui-react';\n\ninterface ChannelConnectingProps {\n    msg: string,\n}\n\nconst ChannelConnecting: React.SFC<ChannelConnectingProps> = ({ msg }) => (\n    <Message icon={true}>\n        <Icon name='cog' loading={true} />\n        <Message.Content>\n            <Message.Header>Connecting to LiberTEM</Message.Header>\n            {msg}\n        </Message.Content>\n    </Message>\n)\n\nexport default ChannelConnecting;","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport ClusterConnectionForm from \"../../cluster/components/ClusterConnectionForm\";\nimport { RootReducer } from \"../../store\";\nimport ChannelConnecting from \"./ChannelConnecting\";\n\nconst mapStateToProps = (state: RootReducer) => {\n    return {\n        channelStatus: state.channelStatus,\n        clusterConnection: state.clusterConnection,\n        haveConfig: state.config.haveConfig,\n    }\n}\n\n\ntype MergedProps = ReturnType<typeof mapStateToProps>;\n\nconst messages = {\n    waiting: \"Waiting...\",\n    connecting: \"Connecting...\",\n}\n\nconst clusterMessages = {\n    connected: \"Connected, waiting for initial state...\",\n    unknown: \"Connected, fetching cluster status...\",\n}\n\nconst ChannelStatus: React.SFC<MergedProps> = ({ haveConfig, children, channelStatus, clusterConnection }) => {\n    switch (channelStatus.status) {\n        case \"waiting\":\n        case \"connecting\": {\n            return <ChannelConnecting msg={messages[channelStatus.status]} />;\n        }\n        case \"connected\": {\n            if (!haveConfig) {\n                return <ChannelConnecting msg=\"waiting for configuration...\" />;\n            }\n            if (clusterConnection.status === \"disconnected\") {\n                return <ClusterConnectionForm />\n            } else if (clusterConnection.status === \"connected\") {\n                return <ChannelConnecting msg={clusterMessages.connected} />;\n            } else if (clusterConnection.status === \"unknown\") {\n                return <ChannelConnecting msg={clusterMessages.unknown} />;\n            }\n        }\n    }\n    return <>{children}</>;\n}\n\nexport default connect(mapStateToProps)(ChannelStatus);","import * as React from \"react\";\nimport { Icon, SemanticICONS } from \"semantic-ui-react\";\nimport { DirectoryListingDetails } from \"../../messages\";\n\n\ninterface FileBrowserEntryProps {\n    style: object,\n    details: DirectoryListingDetails,\n    onClick?: () => void,\n    icon?: SemanticICONS,\n}\n\ninterface TimeStampProps {\n    ts: number,\n}\n\nexport const TimeStamp: React.SFC<TimeStampProps> = ({ ts }) => {\n    const date = new Date(ts * 1000);\n    const fmtDate = date.toLocaleDateString();\n    const fmtTime = date.toLocaleTimeString();\n    const title = `${fmtDate} ${fmtTime}`;\n    return (\n        <div style={{ display: \"flex\", whiteSpace: \"nowrap\" }} title={title}>\n            <div style={{ width: \"50%\", marginRight: \"10px\" }}>{fmtDate}</div>\n            <div style={{ width: \"45%\" }}>{fmtTime}</div>\n        </div>\n    )\n}\n\n// adapted from https://stackoverflow.com/a/14919494/540644\nfunction humanFileSize(bytes: number, si: boolean = false) {\n    const thresh = si ? 1000 : 1024;\n    if (Math.abs(bytes) < thresh) {\n        return {\n            size: bytes,\n            unit: 'B',\n        }\n    }\n    const units = si\n        ? ['kB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB']\n        : ['KiB', 'MiB', 'GiB', 'TiB', 'PiB', 'EiB', 'ZiB', 'YiB'];\n    let u = -1;\n    do {\n        bytes /= thresh;\n        ++u;\n    } while (Math.abs(bytes) >= thresh && u < units.length - 1);\n\n    return {\n        size: bytes.toFixed(1),\n        unit: units[u],\n    }\n}\n\ninterface FileSizeProps {\n    size: number,\n    si?: boolean,\n}\n\nexport const FileSize: React.SFC<FileSizeProps> = ({ size, si }) => {\n    const fmtSize = humanFileSize(size, si)\n    return (\n        <div style={{ textAlign: \"right\" }}>\n            {fmtSize.size} {fmtSize.unit}\n        </div>\n    );\n}\n\nexport const Cell: React.SFC<{ title?: string }> = ({ children, title }) => {\n    const styles: React.CSSProperties = {\n        whiteSpace: \"nowrap\",\n        overflow: \"hidden\",\n        textOverflow: \"ellipsis\",\n        marginRight: \"10px\",\n    }\n    return (\n        <div style={styles} title={title}>{children}</div>\n    );\n}\n\n\nclass FileBrowserEntry extends React.Component<FileBrowserEntryProps> {\n    public onClick = (e: React.MouseEvent) => {\n        const { onClick } = this.props;\n        if (onClick) {\n            onClick();\n        }\n    }\n\n    public render() {\n        const { details, style, icon } = this.props;\n        const myStyle: React.CSSProperties = {\n            cursor: \"pointer\",\n            ...style,\n        };\n\n        const tsStyles: React.CSSProperties = {\n            textAlign: \"right\",\n        };\n\n        return (\n            <div onClick={this.onClick} style={myStyle}>\n                <div style={{ display: \"flex\", paddingRight: \"10px\" }}>\n                    <div style={{ width: \"20%\", flexGrow: 1 }}>\n                        <Cell title={details.name}>\n                            {icon && <Icon name={icon} />}\n                            {details.name}\n                        </Cell>\n                    </div>\n                    <div style={{ width: \"10%\" }}><Cell><FileSize size={details.size} si={false} /></Cell></div>\n                    <div style={{ width: \"10%\" }}><Cell>{details.owner}</Cell></div>\n                    <div style={{ width: \"18%\", ...tsStyles }}>\n                        <Cell><TimeStamp ts={details.ctime} /></Cell>\n                    </div>\n                    <div style={{ width: \"18%\", ...tsStyles }}>\n                        <Cell><TimeStamp ts={details.mtime} /></Cell>\n                    </div>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default FileBrowserEntry;","import * as React from \"react\";\nimport { Cell } from \"./FileBrowserEntry\";\n\nconst FileBrowserHeader: React.SFC = () => {\n    const alignRight: React.CSSProperties = {\n        textAlign: \"right\",\n    };\n\n    // ugly hack: padding-right to compensate for scrollbar size\n    return (\n        <div style={{ paddingRight: \"20px\", paddingBottom: \"10px\" }}>\n            <div style={{ display: \"flex\" }}>\n                <div style={{ width: \"20%\", flexGrow: 1 }}>\n                    <Cell>Name</Cell>\n                </div>\n                <div style={{ width: \"10%\", ...alignRight }}>\n                    <Cell>Size</Cell>\n                </div>\n                <div style={{ width: \"10%\" }}>\n                    <Cell>Owner</Cell>\n                </div>\n                <div style={{ width: \"18%\", ...alignRight }}>\n                    <Cell>Created</Cell>\n                </div>\n                <div style={{ width: \"18%\", ...alignRight }}>\n                    <Cell>Modified</Cell>\n                </div>\n            </div>\n        </div>\n    );\n}\n\nexport default FileBrowserHeader;","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\nimport { DirectoryListingDetails } from \"../../messages\";\nimport * as browserActions from '../actions';\nimport FileBrowserEntry from \"./FileBrowserEntry\";\n\ninterface FileEntryProps {\n    path: string,\n    style: object,\n    details: DirectoryListingDetails,\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch, ownProps: FileEntryProps) => {\n    return {\n        select: () => dispatch(browserActions.Actions.select(ownProps.path, ownProps.details.name)),\n    };\n}\n\ntype MergedProps = FileEntryProps & ReturnType<typeof mapDispatchToProps>;\n\nclass FileEntry extends React.Component<MergedProps> {\n    public render() {\n        const { details, style, select } = this.props;\n\n        return (\n            <FileBrowserEntry onClick={select} style={style} details={details}\n                icon=\"file outline\" />\n        )\n    }\n}\n\nexport default connect(null, mapDispatchToProps)(FileEntry);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\nimport { DirectoryListingDetails } from \"../../messages\";\nimport * as browserActions from '../actions';\nimport FileBrowserEntry from \"./FileBrowserEntry\";\n\nconst mapDispatchToProps = (dispatch: Dispatch, ownProps: FolderEntryProps) => {\n    return {\n        list: () => {\n            dispatch(browserActions.Actions.list(ownProps.path, ownProps.details.name));\n            window.setTimeout(() => ownProps.onChange(), 0);\n        },\n    };\n}\n\ninterface FolderEntryProps {\n    path: string,\n    style: object,\n    details: DirectoryListingDetails,\n    onChange: () => void,\n}\n\ntype MergedProps = FolderEntryProps & ReturnType<typeof mapDispatchToProps>;\n\nconst FolderEntry: React.SFC<MergedProps> = ({ list, details, style, onChange }) => {\n    return (\n        <FileBrowserEntry onClick={list} style={style} details={details} icon=\"folder\" />\n    )\n}\n\nexport default connect(null, mapDispatchToProps)(FolderEntry);\n","import * as React from 'react';\nimport { connect } from \"react-redux\";\nimport { Dispatch } from 'redux';\nimport { Dropdown, DropdownItemProps } from \"semantic-ui-react\";\nimport * as browserActions from '../actions';\n\nconst mapDispatchToProps = (dispatch: Dispatch, ownProps: DropdownItemProps) => {\n    return {\n        list: () => {\n            if (ownProps.value !== undefined) {\n                dispatch(browserActions.Actions.list(ownProps.value.toString()));\n                window.setTimeout(() => ownProps.onChange(), 0);\n            }\n        },\n    };\n}\n\ntype MergedProps = ReturnType<typeof mapDispatchToProps> & DropdownItemProps & {\n    onChange: () => void,\n};\n\nconst PathDropDownItem: React.SFC<MergedProps> = ({ list, ...props }) => {\n    const newProps = {\n        onClick: list,\n        ...props,\n    }\n    return <Dropdown.Item {...newProps} />;\n}\n\nexport default connect(null, mapDispatchToProps)(PathDropDownItem);","import { FormikProps, withFormik } from \"formik\";\nimport * as React from \"react\";\nimport { Form, Input } from \"semantic-ui-react\";\n\ninterface FormValues {\n    path: string,\n}\n\ninterface PathInputProps {\n    onChange: (path: string) => void,\n    initialPath: string,\n}\n\ntype MergedProps = FormikProps<FormValues> & PathInputProps;\n\nconst PathInput: React.SFC<MergedProps> = ({\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    handleReset,\n}) => {\n    return (\n        <Form onSubmit={handleSubmit} style={{ flexGrow: 1 }}>\n            <Form.Field>\n                <Input autoComplete=\"off\" onBlur={handleBlur} onChange={handleChange} value={values.path} name=\"path\" />\n            </Form.Field>\n        </Form>\n    )\n}\n\nexport default withFormik<PathInputProps, FormValues>({\n    mapPropsToValues: ({ initialPath }) => ({\n        path: initialPath,\n    }),\n    handleSubmit: (values, formikBag) => {\n        const { onChange } = formikBag.props;\n        onChange(values.path);\n    },\n    enableReinitialize: true,\n})(PathInput);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\nimport { Dropdown, DropdownItemProps } from \"semantic-ui-react\";\nimport { DatasetTypes } from \"../../messages\";\nimport { RootReducer } from \"../../store\";\nimport * as browserActions from '../actions';\n\n\ntype DropdownOptions = Array<{\n    text: string,\n    value: {\n        type: DatasetTypes,\n        path: string,\n    },\n}>;\n\nconst mapStateToProps = (state: RootReducer) => {\n    return {\n        lastOpened: state.config.lastOpened,\n        fileHistory: state.config.fileHistory,\n        separator: state.config.separator,\n    };\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch) => {\n    return {\n        select: (path: string) => dispatch(browserActions.Actions.selectFullPath(path)),\n    };\n}\n\ntype MergedProps = ReturnType<typeof mapStateToProps> & ReturnType<typeof mapDispatchToProps>;\n\nconst RecentFiles: React.SFC<MergedProps> = ({ lastOpened, fileHistory, select }) => {\n\n    const recentFiles: DropdownOptions = fileHistory.filter((path: string) => lastOpened[path]).map((path: string) => {\n        const item = lastOpened[path];\n        return {\n            text: item.path,\n            value: {\n                type: item.type,\n                path: item.path,\n            },\n        };\n    });\n\n    const onClick = (e: React.MouseEvent<HTMLDivElement>, data: DropdownItemProps) => data.value && select(data.value.toString())\n\n    return (\n        <Dropdown item={true} text=\"Recent\" floating={true}>\n            <Dropdown.Menu>\n                <Dropdown.Header content=\"recent datasets\" />\n                {recentFiles.map((option, idx) => (\n                    <Dropdown.Item key={idx} value={option.value.path} content={option.text} onClick={onClick} />\n                ))}\n            </Dropdown.Menu>\n        </Dropdown>\n    );\n}\n\n\nexport default connect(mapStateToProps, mapDispatchToProps)(RecentFiles);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\nimport { Dropdown, Menu } from \"semantic-ui-react\";\nimport * as browserActions from '../actions';\nimport { FSPlaces } from \"../types\";\nimport PathDropDownItem from \"./PathDropDownItem\";\nimport PathInput from \"./PathInput\";\nimport RecentFiles from \"./RecentFiles\";\n\nconst mapDispatchToProps = (dispatch: Dispatch, ownProps: PathBarProps) => {\n    return {\n        refresh: () => {\n            dispatch(browserActions.Actions.list(ownProps.currentPath));\n            window.setTimeout(() => ownProps.onChange(), 0);\n        },\n        handleInputChange: (path: string) => {\n            dispatch(browserActions.Actions.list(path));\n            window.setTimeout(() => ownProps.onChange(), 0);\n        },\n        goUp: () => {\n            dispatch(browserActions.Actions.list(ownProps.currentPath, '..'));\n            window.setTimeout(() => ownProps.onChange(), 0);\n        },\n    };\n}\n\ninterface PathBarProps {\n    currentPath: string,\n    onChange: () => void,\n    drives: string[],\n    places: FSPlaces,\n}\n\ntype MergedProps = ReturnType<typeof mapDispatchToProps> & PathBarProps;\n\nconst PathBar: React.SFC<MergedProps> = ({ currentPath, drives, places, onChange, refresh, goUp, handleInputChange }) => {\n    const driveOptions = drives.map((path) => ({ key: path, text: path }));\n    const placeOptions = Object.keys(places).map((key) => ({ key: places[key].path, text: places[key].title }))\n    return (\n        <Menu>\n            <RecentFiles />\n            <Dropdown text=\"Go to...\" floating={true} item={true}>\n                <Dropdown.Menu>\n                    <Dropdown.Header content=\"Drives\" />\n                    {driveOptions.map((option) => {\n                        return <PathDropDownItem key={option.key} value={option.key} content={option.text} onChange={onChange} />\n                    })}\n                    <Dropdown.Header content=\"Places\" />\n                    {placeOptions.map((option) => {\n                        return <PathDropDownItem key={option.key} value={option.key} content={option.text} onChange={onChange} />\n                    })}\n                </Dropdown.Menu>\n            </Dropdown>\n            <Menu.Item icon=\"arrow up\" onClick={goUp} />\n            <Menu.Item style={{ flexGrow: 1 }}>\n                <PathInput onChange={handleInputChange} initialPath={currentPath} />\n            </Menu.Item>\n            <Menu.Item icon=\"refresh\" onClick={refresh} />\n        </Menu>\n    );\n}\n\n\nexport default connect(null, mapDispatchToProps)(PathBar);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { FixedSizeList as List } from \"react-window\";\nimport { Dispatch } from \"redux\";\nimport { Button, Header, Segment } from \"semantic-ui-react\";\nimport { DirectoryListingDetails } from \"../../messages\";\nimport { RootReducer } from \"../../store\";\nimport * as browserActions from '../actions';\nimport FileBrowserHeader from \"./FileBrowserHeader\";\nimport FileEntry from \"./FileEntry\";\nimport FolderEntry from \"./FolderEntry\";\nimport PathBar from \"./PathBar\";\n\nconst mapStateToProps = (state: RootReducer) => {\n    const { browser } = state;\n    return {\n        files: browser.files,\n        dirs: browser.dirs,\n        path: browser.path,\n        drives: browser.drives,\n        places: browser.places,\n        isLoading: browser.isLoading,\n    };\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch) => {\n    return {\n        cancel: () => dispatch(browserActions.Actions.cancel()),\n    };\n}\n\ntype MergedProps = ReturnType<typeof mapStateToProps> & ReturnType<typeof mapDispatchToProps>;\n\ninterface EntryFnArgs {\n    index: number,\n    style: object\n}\ntype EntryFn = (arg: EntryFnArgs) => void\n\nconst listRef = React.createRef<List>();\n\nconst scrollToTop = () => {\n    if (listRef.current === null) {\n        return;\n    }\n    listRef.current.scrollToItem(0);\n}\n\nfunction sortByKey<T extends object>(array: T[], getKey: (item: T) => any) {\n    return array.sort((a, b) => {\n        const x = getKey(a);\n        const y = getKey(b);\n        return ((x < y) ? -1 : ((x > y) ? 1 : 0));\n    });\n}\n\nconst FileBrowser: React.SFC<MergedProps> = ({ files, dirs, path, drives, places, cancel, isLoading }) => {\n    const getSortKey = (item: DirectoryListingDetails) => item.name.toLowerCase();\n    const dirEntries = sortByKey(dirs, getSortKey).map((dir) => (style: object) => <FolderEntry style={style} onChange={scrollToTop} path={path} details={dir} />);\n    const fileEntries = sortByKey(files, getSortKey).map((f) => ((style: object) => <FileEntry style={style} path={path} details={f} />));\n    const entries = dirEntries.concat(fileEntries);\n\n    const cellFn: EntryFn = ({ index, style }) => {\n        return entries[index](style)\n    }\n\n    let list = (\n        <List style={{ overflowY: \"scroll\" }} ref={listRef} height={300} width=\"100%\" itemCount={entries.length} itemSize={35}>\n            {cellFn}\n        </List>\n    );\n\n    if (isLoading) {\n        // FIXME: hardcoded height\n        list = (\n            <Segment loading={true} style={{ height: \"300px\" }} />\n        )\n    }\n\n    return (\n        <Segment.Group>\n            <Segment>\n                <Header as=\"h2\">Open dataset</Header>\n            </Segment>\n            <Segment>\n                <PathBar currentPath={path} drives={drives} places={places} onChange={scrollToTop} />\n            </Segment>\n            <Segment>\n                <FileBrowserHeader />\n                {list}\n            </Segment>\n            <Segment>\n                <Button onClick={cancel}>Cancel</Button>\n            </Segment>\n        </Segment.Group>\n    );\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(FileBrowser);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Button, Icon } from \"semantic-ui-react\";\nimport { RootReducer } from \"../../store\";\nimport * as browserActions from '../actions';\nimport FileBrowser from \"./FileBrowser\";\n\nexport const mapStateToProps = (state: RootReducer) => {\n    return {\n        isOpen: state.browser.isOpen,\n    }\n}\n\nexport const mapDispatchToProps = {\n    open: browserActions.Actions.open,\n}\n\ntype MergedProps = ReturnType<typeof mapStateToProps> & DispatchProps<typeof mapDispatchToProps>;\n\nconst BrowserWrapper: React.SFC<MergedProps> = ({ isOpen, open }) => {\n    if (!isOpen) {\n        return (\n            <Button icon={true} labelPosition=\"left\" onClick={open}>\n                <Icon name='add' />\n                Browse\n            </Button>\n        );\n    }\n    return (\n        <FileBrowser />\n    );\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(BrowserWrapper)","export const inRectConstraint = (width: number, height: number) => (p: Point2D) => {\n    return {\n        x: Math.max(0, Math.min(width - 1, p.x)),\n        y: Math.max(0, Math.min(height - 1, p.y)),\n    }\n}\n\nexport const dist = (cx: number, cy: number, x: number, y: number) => {\n    const dx = cx - x;\n    const dy = cy - y;\n    return Math.sqrt(dx * dx + dy * dy);\n}\n\nexport const cbToRadius = (cx: number, cy: number, cb: ((r: number) => void) | undefined) => (x: number, y: number) => cb && cb(dist(cx, cy, x, y))\n\nexport const keepOnCY = (cy: number) => (p: Point2D) => {\n    return {\n        x: p.x,\n        y: cy,\n    }\n}\n\nexport const keepXLargerThan = (otherX: number) => (p: Point2D) => {\n    return {\n        x: otherX > p.x ? otherX : p.x,\n        y: p.y,\n    }\n}\n\nexport const keepXSmallerThan = (otherX: number) => (p: Point2D) => {\n    return {\n        x: otherX < p.x ? otherX : p.x,\n        y: p.y,\n    }\n}\n\nexport const riConstraint = (outerPos: number, cy: number) => (p: Point2D) => {\n    return keepXLargerThan(outerPos)(\n        keepOnCY(cy)(p)\n    );\n}\n\nexport const roConstraints = (innerPos: number, cy: number) => (p: Point2D) => {\n    return keepXSmallerThan(innerPos)(\n        keepOnCY(cy)(p)\n    );\n}","import { CSSProperties } from \"react\";\n\nexport const defaultMaskStyles = (imageWidth: number): CSSProperties => ({\n    fillOpacity: 0.3,\n    fill: \"red\",\n    strokeOpacity: 0.7,\n    stroke: \"red\",\n    strokeWidth: imageWidth / 128 / 3,\n});","import * as React from \"react\";\nimport { defaultMaskStyles } from \"./styles\";\n\nexport interface DiskProps {\n    imageWidth: number,\n    imageHeight: number,\n    cx: number,\n    cy: number,\n    r: number,\n}\n\nconst Disk: React.SFC<DiskProps> = ({ imageWidth, imageHeight, cx, cy, r }) => {\n    return (\n        <circle cx={cx} cy={cy} r={r} style={{ ...defaultMaskStyles(imageWidth) }} />\n    );\n}\n\nexport default Disk;","export type ModifyCoords = ((x: number, y: number) => ({ x: number, y: number }));\n\n/**\n * Call this function whenever a keyboard event happens. The keyboard event is then translated\n * to a coordinate transformation, which is passed to the update callback. The update callback is\n * only called if relevant keys were pressed (example: arrow keys).\n * \n * @param e keyboard event\n * @param update a callback to handle coordinate updates\n */\nexport const handleKeyEvent = (e: React.KeyboardEvent<SVGElement>, update: (fn: ModifyCoords) => void) => {\n    let delta = 1;\n    if (e.shiftKey) {\n        delta = 10;\n    }\n    switch (e.key) {\n        case \"ArrowUp\":\n            update((x: number, y: number) => ({ x, y: y - delta }));\n            break;\n        case \"ArrowDown\":\n            update((x: number, y: number) => ({ x, y: y + delta }));\n            break;\n        case \"ArrowLeft\":\n            update((x: number, y: number) => ({ x: x - delta, y }));\n            break;\n        case \"ArrowRight\":\n            update((x: number, y: number) => ({ x: x + delta, y }));\n            break;\n        default:\n            return;\n    }\n    e.preventDefault();\n}\n","import * as React from \"react\";\nimport styled from 'styled-components';\nimport { handleKeyEvent, ModifyCoords } from \"./kbdHandler\";\n\nexport type HandleProps = {\n    x: number,\n    y: number,\n    scale: number,\n    withCross?: boolean,\n    focusRef: React.RefObject<SVGGElement>,\n} & React.SVGProps<SVGGElement>;\n\nconst StyledCircle = styled.circle`\n    stroke: red;\n    stroke-width: 1;\n    fill: transparent;\n    g:focus > & {\n        stroke: lightgreen;\n    }\n`;\n\nconst Cross = styled.path`\n    stroke: red;\n    stroke-width: 1;\n    fill: transparent;\n    g:focus > & {\n        stroke: lightgreen;\n    }\n`;\n\nconst FocusGroup = styled.g`\n    &:focus { outline: none; }\n`;\n\nconst Handle: React.SFC<HandleProps> = ({ scale, x, y, withCross, focusRef, ...args }) => {\n    const r = 3;\n    // scaleMatrix is needed to set the origin of the scale\n    const scaleMatrix = `matrix(${scale}, 0, 0, ${scale}, ${x - scale * x}, ${y - scale * y})`;\n    const style: React.CSSProperties = { transform: scaleMatrix };\n    const crossSpec = `\n        M${x - r / 2} ${y} L ${x + r / 2} ${y}\n        M${x} ${y - r / 2} L ${x} ${y + r / 2}\n    `;\n    const cross = withCross ? <Cross d={crossSpec} style={style} /> : null;\n    return (\n        <FocusGroup {...args} ref={focusRef}>\n            <StyledCircle cx={x} cy={y} r={r} style={style} />\n            {cross}\n        </FocusGroup>\n    )\n}\n\nexport interface DraggableHandleProps {\n    x: number,\n    y: number,\n    withCross?: boolean,\n    imageWidth?: number,\n    onDragMove?: (x: number, y: number) => void,\n    parentOnDragStart: (h: DraggableHandle) => void,\n    parentOnDrop: (x: number, y: number) => void,\n    onKeyboardEvent?: (e: React.KeyboardEvent<SVGElement>) => void,\n    constraint?: (p: Point2D) => Point2D,\n}\n\nexport function getScalingFactor(elem: SVGElement): number {\n    const svg = elem.ownerSVGElement;\n    if (svg === null) {\n        throw new Error(\"no owner SVG element?\");\n    }\n    const inWidthAttr = svg.getAttribute(\"width\");\n    if (inWidthAttr === null) {\n        throw new Error(\"no width on SVG element?\");\n    }\n    const inWidth = +inWidthAttr;\n    const svgMeasurements = svg.getBoundingClientRect();\n    return svgMeasurements.width / inWidth;\n}\n\nfunction relativeCoords(e: React.MouseEvent, parent: SVGElement) {\n    const f = getScalingFactor(parent);\n    const parentPos = parent.getBoundingClientRect();\n    const res = {\n        x: (e.pageX - (parentPos.left + window.pageXOffset)) / f,\n        y: (e.pageY - (parentPos.top + window.pageYOffset)) / f,\n    }\n    return res;\n}\n\n/**\n * stateful draggable handle, to be used as part of <svg/>\n */\nexport class DraggableHandle extends React.Component<DraggableHandleProps> {\n    public posRef: React.RefObject<SVGRectElement>;\n    public focusRef: React.RefObject<SVGGElement>;\n\n    public state = {\n        dragging: false,\n        drag: { x: 0, y: 0 },\n    }\n\n    constructor(props: DraggableHandleProps) {\n        super(props);\n        this.posRef = React.createRef<SVGRectElement>();\n        this.focusRef = React.createRef<SVGGElement>();\n    }\n\n    // mousemove event from outside (delegated from surrounding element)\n    public externalMouseMove = (e: React.MouseEvent<SVGElement>): void => {\n        this.move(e);\n    }\n\n    // mouseleave event from outside (delegated from surrounding element)\n    public externalLeave = (e: React.MouseEvent<SVGElement>): void => {\n        this.stopDrag(e);\n    }\n\n    // mouseup event from outside (delegated from surrounding element)\n    public externalMouseUp = (e: React.MouseEvent<SVGElement>): void => {\n        this.stopDrag(e);\n    }\n\n    public applyConstraint = (p: Point2D) => {\n        const { constraint } = this.props;\n        if (constraint) {\n            return constraint(p);\n        } else {\n            return p;\n        }\n    }\n\n    public startDrag = (e: React.MouseEvent<SVGElement>): void => {\n        e.preventDefault();\n        const { parentOnDragStart } = this.props;\n        if (this.posRef.current) {\n            this.setState({\n                dragging: true,\n                drag: this.applyConstraint(relativeCoords(e, this.posRef.current)),\n            });\n            if (parentOnDragStart) {\n                parentOnDragStart(this);\n            }\n            if (this.focusRef.current && this.focusRef.current.focus) {\n                this.focusRef.current.focus();\n            }\n        } else {\n            throw new Error(\"startDrag without posRef\");\n        }\n    }\n\n    public move = (e: React.MouseEvent<SVGElement>): void => {\n        const { onDragMove } = this.props;\n        if (!this.state.dragging) {\n            return;\n        }\n        if (this.posRef.current) {\n            this.setState({\n                drag: this.applyConstraint(relativeCoords(e, this.posRef.current)),\n            }, () => {\n                if (onDragMove) {\n                    const constrained = this.applyConstraint(this.state.drag)\n                    onDragMove(constrained.x, constrained.y);\n                }\n            })\n        } else {\n            throw new Error(\"move without posRef\");\n        }\n    }\n\n    public stopDrag = (e: React.MouseEvent<SVGElement>): void => {\n        const { parentOnDrop } = this.props;\n        const { dragging, drag } = this.state;\n        if (!dragging) {\n            return;\n        }\n        this.setState({\n            dragging: false,\n        })\n        if (parentOnDrop) {\n            parentOnDrop(drag.x, drag.y);\n        }\n    }\n\n    public handleKeyDown = (e: React.KeyboardEvent<SVGElement>) => {\n        const update = (fn: ModifyCoords) => {\n            const { x, y, onDragMove } = this.props;\n            const newCoords = fn(x, y);\n            const constrained = this.applyConstraint(newCoords);\n            if (onDragMove) {\n                onDragMove(constrained.x, constrained.y);\n            }\n        }\n        handleKeyEvent(e, update);\n    }\n\n    public renderCommon(x: number, y: number) {\n        const { imageWidth } = this.props;\n        const scale = imageWidth === undefined ? 1 : imageWidth / 128;\n        // empty zero-size <rect> as relative position reference\n        return (\n            <g>\n                <rect\n                    style={{ visibility: \"hidden\" }}\n                    ref={this.posRef}\n                    x={0} y={0} width={0} height={0}\n                />\n                <Handle scale={scale} x={x + .5} y={y + .5} withCross={this.props.withCross}\n                    focusRef={this.focusRef}\n                    onMouseUp={this.stopDrag}\n                    onMouseMove={this.move}\n                    onMouseDown={this.startDrag}\n                    onKeyDown={this.handleKeyDown}\n                    tabIndex={0}\n                />\n            </g>\n        );\n    }\n\n    public renderDragging() {\n        const { x, y } = this.state.drag;\n        return this.renderCommon(x, y);\n    }\n\n    public render() {\n        const { x, y } = this.props;\n        // either render from state (when dragging) or from props\n        if (this.state.dragging) {\n            return this.renderDragging();\n        } else {\n            return this.renderCommon(x, y);\n        }\n    }\n}\n\nexport default DraggableHandle;","import { ActionsUnion, createAction } from \"../helpers/actionHelpers\";\nimport { AnalysisParameters, AnalysisTypes } from \"../messages\";\nimport { AnalysisState, FrameMode, JobKind } from \"./types\";\n\n\nexport enum ActionTypes {\n    CREATE = 'ANALYSIS_CREATE',\n    CREATED = 'ANALYSIS_CREATED',\n    UPDATE_PARAMETERS = 'ANALYSIS_UPDATE_PARAMETERS',\n    PREPARE_RUN = 'ANALYSIS_PREPARE_RUN',\n    RUN = 'ANALYSIS_RUN',\n    RUNNING = 'ANALYSIS_RUNNING',\n    REMOVE = 'ANALYSIS_REMOVE',\n    REMOVED = 'ANALYSIS_REMOVED',\n    ERROR = 'ANALYSIS_ERROR',\n    SET_FRAMEVIEW_MODE = 'ANALYSIS_SET_FRAMEVIEW_MODE',\n}\n\nexport const Actions = {\n    create: (dataset: string, analysisType: AnalysisTypes) => createAction(ActionTypes.CREATE, { dataset, analysisType }),\n    created: (analysis: AnalysisState) => createAction(ActionTypes.CREATED, { analysis }),\n    updateParameters: (id: string, parameters: Partial<AnalysisParameters>, kind: JobKind) => createAction(ActionTypes.UPDATE_PARAMETERS, { id, kind, parameters }),\n    setFrameViewMode: (id: string, mode: FrameMode, initialParams: Partial<AnalysisParameters>) => createAction(ActionTypes.SET_FRAMEVIEW_MODE, { id, mode, initialParams }),\n    prepareRun: (id: string, kind: JobKind, job: string) => createAction(ActionTypes.PREPARE_RUN, { id, kind, job }),\n    run: (id: string, kind: JobKind) => createAction(ActionTypes.RUN, { id, kind }),\n    running: (id: string, job: string, kind: JobKind) => createAction(ActionTypes.RUNNING, { id, job, kind }),\n    remove: (id: string) => createAction(ActionTypes.REMOVE, { id }),\n    removed: (id: string) => createAction(ActionTypes.REMOVED, { id }),\n    error: (msg: string, timestamp: number, id: string) => createAction(ActionTypes.ERROR, { msg, timestamp, id }),\n}\n\nexport type Actions = ActionsUnion<typeof Actions>;\n\nexport type ActionParts = {\n    [K in keyof typeof Actions]: ReturnType<typeof Actions[K]>\n}","\nexport interface JobResultType {\n    imageURL: string,\n    description: { title: string, desc: string },\n}\n\nexport enum JobRunning {\n    CREATING = 'CREATING',\n    RUNNING = 'RUNNING',\n    DONE = 'DONE',\n}\n\nexport enum JobStatus {\n    CREATING = 'CREATING',\n    IN_PROGRESS = 'IN_PROGRESS',\n    CANCELLED = 'CANCELLED',\n    SUCCESS = 'SUCCESS',\n    ERROR = 'ERROR',\n}\n\nexport interface JobStateCommon {\n    id: string,\n    dataset: string,\n    status: JobStatus,\n    startTimestamp: number,\n    results: JobResultType[],\n}\n\nexport type JobStateStart = JobStateCommon & {\n    running: JobRunning.CREATING | JobRunning.RUNNING,\n}\n\nexport type JobStateDone = JobStateCommon & {\n    running: JobRunning.DONE,\n    endTimestamp: number,\n}\n\nexport type JobState = JobStateStart | JobStateDone;","import * as React from \"react\";\nimport { Icon } from \"semantic-ui-react\";\n\nconst BusySpinner: React.SFC = () => {\n    const styles: React.CSSProperties = {\n        margin: 0,\n        padding: 0,\n        position: \"absolute\",\n        bottom: \"10px\",\n        right: \"10px\",\n        color: \"white\",\n        opacity: 0.7,\n        filter: \"drop-shadow(0 0 3px #000)\",\n    };\n    return (\n        <Icon name=\"cog\" loading={true} style={styles} />\n    )\n}\n\nexport default BusySpinner;","import * as React from \"react\";\nimport BusySpinner from \"./BusySpinner\";\n\ninterface BusyWrapperProps {\n    busy: boolean,\n}\n\nconst BusyWrapper: React.SFC<BusyWrapperProps> = ({ children, busy }) => {\n    const styles: React.CSSProperties = {\n        position: \"relative\",\n    };\n    return (\n        <div style={styles}>\n            {children}\n            {busy && <BusySpinner />}\n        </div>\n    )\n}\n\nexport default BusyWrapper;","import * as React from \"react\";\nimport { DraggableHandle } from \"./DraggableHandle\";\nimport { HandleRenderFunction } from \"./types\";\n\nexport interface HandleParentProps {\n    width: number,\n    height: number,\n    onKeyboardEvent?: React.KeyboardEventHandler<SVGElement>,\n    handles: HandleRenderFunction[],\n}\n\nexport class HandleParent extends React.Component<HandleParentProps> {\n    public currentHandle: DraggableHandle | undefined;\n\n    public handleDragStart = (h: DraggableHandle): void => {\n        this.currentHandle = h;\n    }\n\n    public handleDrop = (): void => {\n        this.currentHandle = undefined;\n    }\n\n    public handleMouseMove = (e: React.MouseEvent<SVGElement>): void => {\n        if (this.currentHandle) {\n            return this.currentHandle.externalMouseMove(e);\n        }\n    }\n\n    public handleMouseLeave = (e: React.MouseEvent<SVGElement>): void => {\n        if (this.currentHandle) {\n            this.currentHandle.externalLeave(e);\n        }\n    }\n\n    public handleMouseUp = (e: React.MouseEvent<SVGElement>): void => {\n        if (this.currentHandle) {\n            this.currentHandle.externalMouseUp(e);\n        }\n    }\n\n    public render() {\n        const { width, height } = this.props;\n        const styles = {\n            outline: \"1px dashed black\"\n        }\n        return (\n            <g\n                onMouseMove={this.handleMouseMove}\n                onMouseLeave={this.handleMouseLeave}\n                onMouseUp={this.handleMouseUp}\n                onKeyDown={this.props.onKeyboardEvent}\n                style={styles}\n                tabIndex={0}\n            >\n                <rect style={{ fill: \"transparent\" }}\n                    x={0} y={0} width={width} height={height}\n                />\n                {this.renderHandles()}\n            </g>\n        );\n    }\n\n    public renderHandles() {\n        const { handles, onKeyboardEvent } = this.props;\n        // we need to inform the handle when there are move/up/leave events\n        // on this parent element, for which we need to know the current handle.\n        // so we pass the handle a dragstart/drop function and kindly ask it\n        // to call us if it starts to be dragged or is dropped.\n        return handles.map((h, i) => {\n            const elem = h(this.handleDragStart, this.handleDrop, onKeyboardEvent);\n            if (React.isValidElement(elem)) {\n                return React.cloneElement(elem, { key: i });\n            }\n        });\n    }\n}\n\nexport default HandleParent;","import * as React from \"react\";\nimport { JobState } from \"../types\";\nimport styles from \"./ResultImage.module.css\";\n\ninterface ResultImageProps {\n    job: JobState,\n    idx: number,\n    width: number,\n    height: number,\n}\n\nconst ResultImage: React.SFC<ResultImageProps> = ({ job, idx, width, height }) => {\n    const result = job.results[idx];\n    if (result === undefined) {\n        return (\n            <svg className={styles.fallback} width={width} height={height} viewBox={`0 0 ${width} ${height}`} key={-1} />\n        )\n    }\n    return (\n        <image className={styles.default} xlinkHref={result.imageURL} width={width} height={height} />\n    );\n}\n\nexport default ResultImage;","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport styled from 'styled-components';\nimport * as analysisActions from '../../analysis/actions';\nimport { AnalysisState, JobKind } from \"../../analysis/types\";\nimport { DatasetState } from \"../../messages\";\nimport BusyWrapper from \"../../widgets/BusyWrapper\";\nimport HandleParent from \"../../widgets/HandleParent\";\nimport { HandleRenderFunction } from \"../../widgets/types\";\nimport { JobRunning, JobState } from \"../types\";\nimport ResultImage from \"./ResultImage\";\n\ninterface ResultProps {\n    width: number,\n    height: number,\n    job: JobState,\n    dataset: DatasetState,\n    analysis: AnalysisState,\n    extraHandles?: HandleRenderFunction,\n    extraWidgets?: React.ReactElement<SVGElement>,\n    idx: number,\n    kind: JobKind,\n}\n\nconst ResultWrapper = styled.svg`\n    display: block;\n    border: 1px solid black;\n    width: 100%;\n    height: auto;\n`;\n\nconst mapDispatchToProps = {\n    updateParameters: analysisActions.Actions.updateParameters,\n};\n\ntype MergedProps = ResultProps & DispatchProps<typeof mapDispatchToProps>;\n\nclass Result extends React.Component<MergedProps> {\n    public renderHandles() {\n        const { width, height, extraHandles } = this.props;\n        let handles: HandleRenderFunction[] = [];\n        if (extraHandles) {\n            handles = [...handles, extraHandles];\n        }\n\n        return (\n            <HandleParent width={width} height={height} handles={handles} />\n        )\n    }\n\n    public render() {\n        const { job, idx, width, height, extraWidgets } = this.props;\n        const busy = job.running !== JobRunning.DONE;\n\n        return (\n            <BusyWrapper busy={busy}>\n                <ResultWrapper width={width} height={height} viewBox={`0 0 ${width} ${height}`}>\n                    <ResultImage job={job} idx={idx} width={width} height={height} />\n                    {extraWidgets}\n                    {this.renderHandles()}\n                </ResultWrapper>\n            </BusyWrapper>\n        );\n    }\n};\n\nexport default connect(null, mapDispatchToProps)(Result);","import styled from 'styled-components';\n\n\nconst Selectors = styled.div`\n    display: flex;\n    & > * {\n        margin-right: 10px;\n    }\n`;\n\n\n\nexport default Selectors;","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Dropdown, DropdownProps } from \"semantic-ui-react\";\nimport { JobKind } from \"../../analysis/types\";\nimport { AnalysisTypes } from \"../../messages\";\nimport { RootReducer } from \"../../store\";\nimport { HandleRenderFunction } from \"../../widgets/types\";\nimport { JobRunning, JobState } from \"../types\";\nimport Result from \"./Result\";\nimport Selectors from \"./Selectors\";\n\ninterface ResultListProps {\n    width: number,\n    height: number,\n    kind: JobKind,\n    selectors?: React.ReactElement<any>,\n    extraHandles?: HandleRenderFunction,\n    extraWidgets?: React.ReactElement<SVGElement>,\n}\n\ninterface ExternalResultListProps {\n    analysis: string,\n    kind: JobKind,\n}\n\nconst mapStateToProps = (state: RootReducer, ownProps: ExternalResultListProps) => {\n    const analysis = state.analyses.byId[ownProps.analysis];\n    const jobId = analysis.jobs[ownProps.kind];\n    const job = jobId ? state.jobs.byId[jobId] : undefined;\n    const ds = job ? state.datasets.byId[job.dataset] : undefined;\n    const pickCoords = (\n        (analysis.frameDetails.type === AnalysisTypes.SUM_FRAMES || ownProps.kind === \"FRAME\") ?\n            null\n            : <>Pick: x={analysis.frameDetails.parameters.x}, y={analysis.frameDetails.parameters.y} &emsp;</>\n    );\n\n    return {\n        currentJob: job,\n        jobsById: state.jobs.byId,\n        analysis,\n        dataset: ds,\n        pickCoords,\n    };\n};\n\ntype MergedProps = ResultListProps & ReturnType<typeof mapStateToProps>;\n\ninterface ResultListState {\n    selectedChannel: number,\n}\n\nclass ResultList extends React.Component<MergedProps, ResultListState> {\n    public state: ResultListState = { selectedChannel: 0 };\n\n    public selectChannel = (e: React.SyntheticEvent, data: DropdownProps) => {\n        const value = data.value as number;\n        this.setState({ selectedChannel: value });\n    }\n\n    public getJob = () => {\n        const { currentJob, analysis, jobsById, kind } = this.props;\n        if (!currentJob) {\n            return;\n        }\n        if (currentJob.results.length > 0) {\n            return currentJob;\n        }\n        const history = analysis.jobHistory[kind];\n        for (const tmpJobId of history) {\n            const tmpJob = jobsById[tmpJobId];\n            if (tmpJob.results.length > 0) {\n                return tmpJob;\n            }\n        }\n        return;\n    }\n\n    public render() {\n        const {\n            kind, selectors, analysis, dataset, children, width, height, pickCoords,\n            extraHandles, extraWidgets\n        } = this.props;\n        let msg;\n        let currentResult = (\n            // placeholder:\n            <svg style={{ display: \"block\", border: \"1px solid black\", width: \"100%\", height: \"auto\" }} width={width} height={height} viewBox={`0 0 ${width} ${height}`} key={-1} />\n        );\n        const job = this.getJob();\n        if (!job || !dataset) {\n            msg = <>&nbsp;</>;\n        } else {\n            currentResult = (\n                <Result analysis={analysis} job={job} dataset={dataset}\n                    kind={kind}\n                    extraHandles={extraHandles}\n                    extraWidgets={extraWidgets}\n                    width={width} height={height}\n                    idx={this.state.selectedChannel}\n                />\n            );\n            if (job.running === JobRunning.DONE) {\n                const dt = (job.endTimestamp - job.startTimestamp) / 1000;\n                msg = <>Analysis done in {dt.toFixed(3)}s</>;\n            } else {\n                msg = <>Analysis running...</>;\n            }\n        }\n        return (\n            <div>\n                {currentResult}\n                {children}\n                <Selectors>\n                    <ResultImageSelector job={job} handleChange={this.selectChannel} selectedImg={this.state.selectedChannel} />\n                    {selectors}\n                </Selectors>\n                <p>{pickCoords} {msg}</p>\n            </div>\n        );\n    }\n}\n\ninterface ImageSelectorProps {\n    job?: JobState,\n    handleChange: (e: React.SyntheticEvent, data: DropdownProps) => void,\n    selectedImg: number,\n}\n\nconst ResultImageSelector: React.SFC<ImageSelectorProps> = ({ job, handleChange, selectedImg }) => {\n    if (!job) {\n        return null;\n    }\n    const availableImages = job.results.map((result, idx) => ({ text: result.description.title, value: idx }));\n    return (\n        <>\n            <div>\n                Channel:{' '}\n                <Dropdown\n                    inline={true}\n                    options={availableImages}\n                    value={selectedImg}\n                    onChange={handleChange}\n                />\n            </div>\n        </>\n    )\n}\n\n\nexport default connect(mapStateToProps)(ResultList);\n","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Dropdown, DropdownProps } from \"semantic-ui-react\";\nimport { AnalysisTypes, DatasetStatus } from \"../../messages\";\nimport { RootReducer } from \"../../store\";\nimport * as analysisActions from '../actions';\nimport { AnalysisState, FrameMode } from \"../types\";\n\nconst frameViewModeOptions = [\n    {\n        text: \"Average\",\n        value: AnalysisTypes.SUM_FRAMES,\n    },\n    {\n        text: \"Pick\",\n        value: AnalysisTypes.PICK_FRAME,\n    }\n]\n\nconst mapDispatchToProps = {\n    setFrameViewMode: analysisActions.Actions.setFrameViewMode,\n}\n\nconst mapStateToProps = (state: RootReducer, ownProps: PMSProps) => {\n    const dataset = state.datasets.byId[ownProps.analysis.dataset]\n    if (dataset.status !== DatasetStatus.OPEN) {\n        throw Error(\"invalid dataset status\");\n    }\n    const shape = dataset.params.shape;\n    const scanWidth = shape[1];\n    const scanHeight = shape[0];\n    return {\n        scanWidth,\n        scanHeight,\n    }\n}\n\ninterface PMSProps {\n    analysis: AnalysisState,\n}\n\ntype MergedProps = PMSProps & DispatchProps<typeof mapDispatchToProps> & ReturnType<typeof mapStateToProps>;\n\nclass FrameViewModeSelector extends React.Component<MergedProps> {\n    public handleChange = (e: React.SyntheticEvent, data: DropdownProps) => {\n        const value = data.value as FrameMode;\n        const { analysis, scanWidth, scanHeight } = this.props;\n        let initialParams = {};\n        if (value === AnalysisTypes.PICK_FRAME) {\n            initialParams = {\n                x: Math.round(scanWidth / 2),\n                y: Math.round(scanHeight / 2),\n            }\n        }\n        this.props.setFrameViewMode(analysis.id, value, initialParams);\n    }\n\n    public render() {\n        const { analysis } = this.props;\n\n        return (\n            <>\n                <div>\n                    Mode:{' '}\n                    <Dropdown\n                        inline={true}\n                        options={frameViewModeOptions}\n                        value={analysis.frameDetails.type}\n                        onChange={this.handleChange}\n                    />\n                </div>\n            </>\n        )\n    }\n\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(FrameViewModeSelector);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport * as analysisActions from '../../analysis/actions';\nimport { AnalysisTypes } from \"../../messages\";\nimport { inRectConstraint } from \"../../widgets/constraints\";\nimport DraggableHandle from \"../../widgets/DraggableHandle\";\nimport { HandleDragStartFn, HandleDropFn } from \"../../widgets/types\";\nimport { AnalysisState } from \"../types\";\n\ninterface PickHandleProps {\n    analysis: AnalysisState,\n    width: number,\n    height: number,\n    onDragStart: HandleDragStartFn,\n    onDrop: HandleDropFn,\n}\n\nconst mapDispatchToProps = {\n    updateParameters: analysisActions.Actions.updateParameters,\n};\n\ntype MergedProps = DispatchProps<typeof mapDispatchToProps> & PickHandleProps;\n\nconst PickHandle: React.SFC<MergedProps> = ({\n    analysis,\n    width,\n    height,\n    updateParameters,\n    onDragStart,\n    onDrop,\n}) => {\n    if (analysis.frameDetails.type !== AnalysisTypes.PICK_FRAME) {\n        return null;\n    }\n    const { x, y } = analysis.frameDetails.parameters;\n    const onPickChange = (pickX: number, pickY: number) => {\n        if (analysis.frameDetails.type !== AnalysisTypes.PICK_FRAME) {\n            return;\n        }\n        const newX = Math.round(pickX);\n        const newY = Math.round(pickY);\n        if (x === newX && y === newY) {\n            return;\n        }\n        updateParameters(analysis.id, {\n            x: newX,\n            y: newY,\n        }, \"FRAME\");\n    }\n\n\n    return (\n        <DraggableHandle x={x} y={y} withCross={true}\n            imageWidth={width}\n            onDragMove={onPickChange}\n            parentOnDragStart={onDragStart}\n            parentOnDrop={onDrop}\n            constraint={inRectConstraint(width, height)} />\n    );\n}\n\nexport default connect(null, mapDispatchToProps)(PickHandle);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\nimport { Button, Icon, IconProps, Segment } from \"semantic-ui-react\";\nimport { JobReducerState } from \"../../job/reducers\";\nimport { JobRunning } from \"../../job/types\";\nimport { RootReducer } from \"../../store\";\nimport * as analysisActions from \"../actions\";\nimport { AnalysisState } from \"../types\";\n\ninterface ToolbarProps {\n    analysis: AnalysisState,\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch, ownProps: ToolbarProps) => {\n    return {\n        handleApply: () => {\n            dispatch(analysisActions.Actions.run(ownProps.analysis.id, \"RESULT\"))\n        },\n        handleRemove: () => dispatch(analysisActions.Actions.remove(ownProps.analysis.id)),\n    }\n}\n\ntype MergedProps = ToolbarProps & ReturnType<typeof mapDispatchToProps> & ReturnType<typeof mapStateToProps>;\n\nconst Toolbar: React.SFC<MergedProps> = ({ status, handleApply, handleRemove }) => {\n    const running = status === \"busy\";\n    const applyIconProps: IconProps = running ? { name: 'cog', loading: true } : { name: 'check' }\n    return (\n        <Segment attached=\"bottom\">\n            <Button.Group>\n                <Button primary={true} onClick={handleApply} icon={true}>\n                    <Icon {...applyIconProps} />\n                    Apply\n                </Button>\n                <Button onClick={handleRemove} icon={true}>\n                    <Icon name='remove' />\n                    Remove\n                </Button>\n            </Button.Group>\n        </Segment>\n    );\n}\n\nconst getAnalysisStatus = (analysis: AnalysisState, jobs: JobReducerState): \"idle\" | \"busy\" => {\n    const jobId = analysis.jobs.RESULT;\n    if (jobId === undefined) {\n        return \"idle\";\n    }\n    const isDone = jobs.byId[jobId].running === JobRunning.DONE;\n    return isDone ? \"idle\" : \"busy\";\n}\n\nconst mapStateToProps = (state: RootReducer, ownProps: ToolbarProps) => {\n    const status = getAnalysisStatus(ownProps.analysis, state.jobs);\n    return {\n        status,\n    };\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Toolbar);","import * as React from \"react\";\nimport { Grid, Header, Icon, Segment } from \"semantic-ui-react\";\nimport ResultList from \"../../job/components/ResultList\";\nimport { DatasetOpen } from \"../../messages\";\nimport { HandleRenderFunction } from \"../../widgets/types\";\nimport { AnalysisState } from \"../types\";\nimport FrameViewModeSelector from \"./FrameViewModeSelector\";\nimport PickHandle from \"./PickHandle\";\nimport Toolbar from \"./Toolbar\";\n\ninterface AnalysisItemProps {\n    analysis: AnalysisState,\n    dataset: DatasetOpen,\n    title: string,\n    subtitle: React.ReactNode,\n    frameViewHandles?: HandleRenderFunction,\n    frameViewWidgets?: React.ReactElement<SVGElement>,\n}\n\ntype MergedProps = AnalysisItemProps;\n\nconst AnalysisItem: React.SFC<MergedProps> = ({\n    frameViewHandles, frameViewWidgets,\n    analysis, dataset, title, subtitle,\n}) => {\n    const { shape } = dataset.params;\n    const resultWidth = shape[1];\n    const resultHeight = shape[0];\n    const frameWidth = shape[3];\n    const frameHeight = shape[2];\n\n    const resultHandles: HandleRenderFunction = (handleDragStart, handleDrop) => (\n        <PickHandle\n            analysis={analysis}\n            width={resultWidth}\n            height={resultHeight}\n            onDragStart={handleDragStart}\n            onDrop={handleDrop}\n        />\n    );\n\n    return (\n        <>\n            <Header as='h3' attached=\"top\">\n                <Icon name=\"cog\" />\n                <Header.Content>{title}</Header.Content>\n            </Header>\n            <Segment attached={true}>\n                <Grid columns={2}>\n                    <Grid.Row>\n                        <Grid.Column>\n                            <ResultList\n                                extraHandles={frameViewHandles} extraWidgets={frameViewWidgets}\n                                kind=\"FRAME\"\n                                analysis={analysis.id} width={frameWidth} height={frameHeight}\n                                selectors={\n                                    <FrameViewModeSelector analysis={analysis} />\n                                } />\n                            <p>{subtitle}</p>\n                        </Grid.Column>\n                        <Grid.Column>\n                            <ResultList\n                                extraHandles={resultHandles}\n                                kind='RESULT'\n                                analysis={analysis.id} width={resultWidth} height={resultHeight}\n                            />\n                        </Grid.Column>\n                    </Grid.Row>\n                </Grid>\n            </Segment>\n            <Toolbar analysis={analysis} />\n        </>\n    )\n}\n\nexport default AnalysisItem","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\nimport { defaultDebounce } from \"../../helpers\";\nimport { CenterOfMassParams, DatasetOpen } from \"../../messages\";\nimport { cbToRadius, inRectConstraint, keepOnCY } from \"../../widgets/constraints\";\nimport Disk from \"../../widgets/Disk\";\nimport { DraggableHandle } from \"../../widgets/DraggableHandle\";\nimport { HandleRenderFunction } from \"../../widgets/types\";\nimport * as analysisActions from \"../actions\";\nimport { AnalysisState } from \"../types\";\nimport AnalysisItem from \"./AnalysisItem\";\n\ninterface AnalysisProps {\n    parameters: CenterOfMassParams,\n    analysis: AnalysisState,\n    dataset: DatasetOpen,\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch, ownProps: AnalysisProps) => {\n    return {\n        handleCenterChange: defaultDebounce((cx: number, cy: number) => {\n            dispatch(analysisActions.Actions.updateParameters(ownProps.analysis.id, { cx, cy }, \"RESULT\"));\n        }),\n        handleRChange: defaultDebounce((r: number) => {\n            dispatch(analysisActions.Actions.updateParameters(ownProps.analysis.id, { r }, \"RESULT\"));\n        }),\n    }\n}\n\n\ntype MergedProps = AnalysisProps & ReturnType<typeof mapDispatchToProps>\n\nconst CenterOfMassAnalysis: React.SFC<MergedProps> = ({ parameters, analysis, dataset, handleRChange, handleCenterChange }) => {\n    const { shape } = dataset.params;\n\n    const imageWidth = shape[3];\n    const imageHeight = shape[2];\n\n    const { cx, cy, r } = parameters;\n\n    const rHandle = {\n        x: cx - r,\n        y: cy,\n    }\n\n    const frameViewHandles: HandleRenderFunction = (handleDragStart, handleDrop) => (<>\n        <DraggableHandle x={cx} y={cy}\n            imageWidth={imageWidth}\n            onDragMove={handleCenterChange}\n            parentOnDragStart={handleDragStart}\n            parentOnDrop={handleDrop}\n            constraint={inRectConstraint(imageWidth, imageHeight)} />\n        <DraggableHandle x={rHandle.x} y={rHandle.y}\n            imageWidth={imageWidth}\n            onDragMove={cbToRadius(cx, cy, handleRChange)}\n            parentOnDragStart={handleDragStart}\n            parentOnDrop={handleDrop}\n            constraint={keepOnCY(cy)} />\n    </>);\n\n    const frameViewWidgets = (\n        <Disk cx={parameters.cx} cy={parameters.cy} r={parameters.r}\n            imageWidth={imageWidth} imageHeight={imageHeight} />\n    )\n\n    const subtitle = <>Disk: center=(x={parameters.cx.toFixed(2)}, y={parameters.cy.toFixed(2)}), r={parameters.r.toFixed(2)}</>;\n\n    return (\n        <AnalysisItem analysis={analysis} dataset={dataset}\n            title=\"COM analysis\" subtitle={subtitle}\n            frameViewHandles={frameViewHandles} frameViewWidgets={frameViewWidgets}\n        />\n    );\n}\n\nexport default connect(null, mapDispatchToProps)(CenterOfMassAnalysis);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\nimport { defaultDebounce } from \"../../helpers\";\nimport { DatasetOpen, MaskDefDisk } from \"../../messages\";\nimport { cbToRadius, inRectConstraint, keepOnCY } from \"../../widgets/constraints\";\nimport Disk from \"../../widgets/Disk\";\nimport DraggableHandle from \"../../widgets/DraggableHandle\";\nimport { HandleRenderFunction } from \"../../widgets/types\";\nimport * as analysisActions from \"../actions\";\nimport { AnalysisState } from \"../types\";\nimport AnalysisItem from \"./AnalysisItem\";\n\ninterface AnalysisProps {\n    parameters: MaskDefDisk,\n    analysis: AnalysisState,\n    dataset: DatasetOpen,\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch, ownProps: AnalysisProps) => {\n    return {\n        handleCenterChange: defaultDebounce((cx: number, cy: number) => {\n            dispatch(analysisActions.Actions.updateParameters(ownProps.analysis.id, { cx, cy }, \"RESULT\"));\n        }),\n        handleRChange: defaultDebounce((r: number) => {\n            dispatch(analysisActions.Actions.updateParameters(ownProps.analysis.id, { r }, \"RESULT\"));\n        }),\n    }\n}\n\n\ntype MergedProps = AnalysisProps & ReturnType<typeof mapDispatchToProps>\n\nconst DiskMaskAnalysis: React.SFC<MergedProps> = ({ parameters, analysis, dataset, handleRChange, handleCenterChange }) => {\n    const { shape } = dataset.params;\n    const imageWidth = shape[3];\n    const imageHeight = shape[2];\n\n    const { cx, cy, r } = parameters;\n\n    const rHandle = {\n        x: cx - r,\n        y: cy,\n    }\n\n    const frameViewHandles: HandleRenderFunction = (handleDragStart, handleDrop) => (<>\n        <DraggableHandle x={cx} y={cy}\n            imageWidth={imageWidth}\n            onDragMove={handleCenterChange}\n            parentOnDragStart={handleDragStart}\n            parentOnDrop={handleDrop}\n            constraint={inRectConstraint(imageWidth, imageHeight)} />\n        <DraggableHandle x={rHandle.x} y={rHandle.y}\n            imageWidth={imageWidth}\n            onDragMove={cbToRadius(cx, cy, handleRChange)}\n            parentOnDragStart={handleDragStart}\n            parentOnDrop={handleDrop}\n            constraint={keepOnCY(cy)} />\n    </>);\n\n    const frameViewWidgets = (\n        <Disk cx={parameters.cx} cy={parameters.cy} r={parameters.r}\n            imageWidth={imageWidth} imageHeight={imageHeight}\n        />\n    );\n\n    const subtitle = <>Disk: center=(x={parameters.cx.toFixed(2)}, y={parameters.cy.toFixed(2)}), r={parameters.r.toFixed(2)}</>;\n\n    return (\n        <AnalysisItem analysis={analysis} dataset={dataset}\n            title=\"Disk analysis\" subtitle={subtitle}\n            frameViewHandles={frameViewHandles} frameViewWidgets={frameViewWidgets}\n        />\n    );\n}\n\nexport default connect(null, mapDispatchToProps)(DiskMaskAnalysis);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\nimport { defaultDebounce } from \"../../helpers\";\nimport { DatasetOpen, PointDef } from \"../../messages\";\nimport { inRectConstraint } from \"../../widgets/constraints\";\nimport DraggableHandle from \"../../widgets/DraggableHandle\";\nimport { HandleRenderFunction } from \"../../widgets/types\";\nimport * as analysisActions from \"../actions\";\nimport { AnalysisState } from \"../types\";\nimport AnalysisItem from \"./AnalysisItem\";\n\ninterface AnalysisProps {\n    parameters: PointDef,\n    analysis: AnalysisState,\n    dataset: DatasetOpen,\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch, ownProps: AnalysisProps) => {\n    return {\n        handleCenterChange: defaultDebounce((cx: number, cy: number) => {\n            dispatch(analysisActions.Actions.updateParameters(ownProps.analysis.id, { cx, cy }, \"RESULT\"));\n        }),\n    }\n}\n\n\ntype MergedProps = AnalysisProps & ReturnType<typeof mapDispatchToProps>\n\nconst PointSelectionAnalysis: React.SFC<MergedProps> = ({ parameters, analysis, dataset, handleCenterChange }) => {\n    const { shape } = dataset.params;\n    const imageWidth = shape[3];\n    const imageHeight = shape[2];\n\n    const { cx, cy } = parameters;\n\n    const frameViewHandles: HandleRenderFunction = (handleDragStart, handleDrop) => (<>\n        <DraggableHandle x={cx} y={cy} withCross={true}\n            onDragMove={handleCenterChange}\n            imageWidth={imageWidth}\n            parentOnDragStart={handleDragStart}\n            parentOnDrop={handleDrop}\n            constraint={inRectConstraint(imageWidth, imageHeight)} />\n    </>);\n\n    const subtitle = (\n        <>Point: center=(x={parameters.cx.toFixed(2)}, y={parameters.cy.toFixed(2)})</>\n    )\n\n    return (\n        <AnalysisItem analysis={analysis} dataset={dataset}\n            title=\"Point analysis\" subtitle={subtitle}\n            frameViewHandles={frameViewHandles}\n        />\n    );\n}\n\nexport default connect(null, mapDispatchToProps)(PointSelectionAnalysis);","// from https://stackoverflow.com/a/45100420/540644\nexport function getPathArc(center: { x: number, y: number }, start: number, end: number, radius: number) {\n    if (end === start) { end += 360; }\n    let degree = end - start;\n    degree = degree < 0 ? (degree + 360) : degree;\n    const points = [];\n    points.push(getLocationFromAngle(start, radius, center));\n    points.push(getLocationFromAngle(start + degree / 3, radius, center));\n    points.push(getLocationFromAngle(start + degree * 2 / 3, radius, center));\n    points.push(getLocationFromAngle(end, radius, center));\n    return getCirclePath(points, radius, (degree < 180) ? 0 : 1);\n}\n\nfunction getCirclePath(points: Array<{ x: number, y: number }>, radius: number, clockWise: 0 | 1) {\n    return ['M', points[0].x, points[0].y,\n        'A', radius, radius, 0, 0, clockWise, points[1].x, points[1].y,\n        'A', radius, radius, 0, 0, clockWise, points[2].x, points[2].y,\n        'A', radius, radius, 0, 0, clockWise, points[3].x, points[3].y\n    ].join(' ');\n}\n\nfunction getLocationFromAngle(degree: number, radius: number, center: { x: number, y: number }) {\n    const radian = (degree * Math.PI) / 180;\n    return {\n        x: Math.cos(radian) * radius + center.x,\n        y: Math.sin(radian) * radius + center.y\n    }\n}\n","import * as React from \"react\";\nimport { getPathArc } from \"../helpers/svg\";\nimport { defaultMaskStyles } from \"./styles\";\n\nexport interface RingProps {\n    imageWidth: number,\n    cx: number,\n    cy: number,\n    ri: number,\n    ro: number,\n}\n\nconst Ring: React.SFC<RingProps> = ({ imageWidth, cx, cy, ri, ro }) => {\n    // see also: https://stackoverflow.com/a/37883328/540644\n    const pathSpecs = [\n        getPathArc({ x: cx, y: cy }, 90, 90, ro),\n        getPathArc({ x: cx, y: cy }, 90, 90, ri)\n    ]\n    const pathSpec = pathSpecs.join(' ');\n\n    return (\n        <path d={pathSpec} fillRule=\"evenodd\" style={{ ...defaultMaskStyles(imageWidth) }} />\n    );\n}\n\nexport default Ring;","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\nimport { defaultDebounce } from \"../../helpers\";\nimport { DatasetOpen, MaskDefRing } from \"../../messages\";\nimport { cbToRadius, inRectConstraint, riConstraint, roConstraints } from \"../../widgets/constraints\";\nimport DraggableHandle from \"../../widgets/DraggableHandle\";\nimport Ring from \"../../widgets/Ring\";\nimport { HandleRenderFunction } from \"../../widgets/types\";\nimport * as analysisActions from \"../actions\";\nimport { AnalysisState } from \"../types\";\nimport AnalysisItem from \"./AnalysisItem\";\n\ninterface AnalysisProps {\n    parameters: MaskDefRing,\n    analysis: AnalysisState,\n    dataset: DatasetOpen,\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch, ownProps: AnalysisProps) => {\n    return {\n        handleCenterChange: defaultDebounce((cx: number, cy: number) => {\n            dispatch(analysisActions.Actions.updateParameters(ownProps.analysis.id, { cx, cy }, \"RESULT\"));\n        }),\n        handleRIChange: defaultDebounce((ri: number) => {\n            dispatch(analysisActions.Actions.updateParameters(ownProps.analysis.id, { ri }, \"RESULT\"));\n        }),\n        handleROChange: defaultDebounce((ro: number) => {\n            dispatch(analysisActions.Actions.updateParameters(ownProps.analysis.id, { ro }, \"RESULT\"));\n        }),\n    }\n}\n\ntype MergedProps = AnalysisProps & ReturnType<typeof mapDispatchToProps>\n\nconst RingMaskAnalysis: React.SFC<MergedProps> = ({ analysis, dataset, parameters, handleCenterChange, handleRIChange, handleROChange }) => {\n    const { shape } = dataset.params;\n    const imageWidth = shape[3];\n    const imageHeight = shape[2];\n\n    const { cx, cy, ri, ro } = parameters;\n\n    const riHandle = {\n        x: cx - ri,\n        y: cy,\n    }\n    const roHandle = {\n        x: cx - ro,\n        y: cy,\n    }\n\n    const frameViewHandles: HandleRenderFunction = (handleDragStart, handleDrop) => (<>\n        <DraggableHandle x={cx} y={cy}\n            imageWidth={imageWidth}\n            onDragMove={handleCenterChange}\n            parentOnDrop={handleDrop}\n            parentOnDragStart={handleDragStart}\n            constraint={inRectConstraint(imageWidth, imageHeight)} />\n        <DraggableHandle x={roHandle.x} y={roHandle.y}\n            imageWidth={imageWidth}\n            onDragMove={cbToRadius(cx, cy, handleROChange)}\n            parentOnDrop={handleDrop}\n            parentOnDragStart={handleDragStart}\n            constraint={roConstraints(riHandle.x, cy)} />\n        <DraggableHandle x={riHandle.x} y={riHandle.y}\n            imageWidth={imageWidth}\n            parentOnDrop={handleDrop}\n            parentOnDragStart={handleDragStart}\n            onDragMove={cbToRadius(cx, cy, handleRIChange)}\n            constraint={riConstraint(roHandle.x, cy)} />\n    </>);\n\n    const frameViewWidgets = (\n        <Ring cx={parameters.cx} cy={parameters.cy} ri={parameters.ri} ro={parameters.ro}\n            imageWidth={imageWidth} />\n    )\n\n    const subtitle = (\n        <>Ring: center=(x={parameters.cx.toFixed(2)}, y={parameters.cy.toFixed(2)}), ri={parameters.ri.toFixed(2)}, ro={parameters.ro.toFixed(2)}</>\n    )\n\n\n    return (\n        <AnalysisItem analysis={analysis} dataset={dataset}\n            title=\"Ring analysis\" subtitle={subtitle}\n            frameViewHandles={frameViewHandles} frameViewWidgets={frameViewWidgets}\n        />\n    );\n}\n\nexport default connect(null, mapDispatchToProps)(RingMaskAnalysis);","import * as React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { Dispatch } from \"redux\";\r\nimport { defaultDebounce } from \"../../helpers\";\r\nimport { DatasetOpen, RadialFourierParams } from \"../../messages\";\r\nimport { cbToRadius, inRectConstraint, riConstraint, roConstraints } from \"../../widgets/constraints\";\r\nimport DraggableHandle from \"../../widgets/DraggableHandle\";\r\nimport Ring from \"../../widgets/Ring\";\r\nimport { HandleRenderFunction } from \"../../widgets/types\";\r\nimport * as analysisActions from \"../actions\";\r\nimport { AnalysisState } from \"../types\";\r\nimport AnalysisItem from \"./AnalysisItem\";\r\n\r\ninterface AnalysisProps {\r\n    parameters: RadialFourierParams,\r\n    analysis: AnalysisState,\r\n    dataset: DatasetOpen,\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: Dispatch, ownProps: AnalysisProps) => {\r\n    return {\r\n        handleCenterChange: defaultDebounce((cx: number, cy: number) => {\r\n            dispatch(analysisActions.Actions.updateParameters(ownProps.analysis.id, { cx, cy }, \"RESULT\"));\r\n        }),\r\n        handleRIChange: defaultDebounce((ri: number) => {\r\n            dispatch(analysisActions.Actions.updateParameters(ownProps.analysis.id, { ri }, \"RESULT\"));\r\n        }),\r\n        handleROChange: defaultDebounce((ro: number) => {\r\n            dispatch(analysisActions.Actions.updateParameters(ownProps.analysis.id, { ro }, \"RESULT\"));\r\n        }),\r\n    }\r\n}\r\n\r\ntype MergedProps = AnalysisProps & ReturnType<typeof mapDispatchToProps>\r\n\r\nconst RadialFourierAnalysis: React.SFC<MergedProps> = ({ analysis, dataset, parameters, handleCenterChange, handleRIChange, handleROChange }) => {\r\n    const { shape } = dataset.params;\r\n    const imageWidth = shape[3];\r\n    const imageHeight = shape[2];\r\n\r\n    const { cx, cy, ri, ro } = parameters;\r\n\r\n    const riHandle = {\r\n        x: cx - ri,\r\n        y: cy,\r\n    }\r\n    const roHandle = {\r\n        x: cx - ro,\r\n        y: cy,\r\n    }\r\n\r\n    const frameViewHandles: HandleRenderFunction = (handleDragStart, handleDrop) => (<>\r\n        <DraggableHandle x={cx} y={cy}\r\n            imageWidth={imageWidth}\r\n            onDragMove={handleCenterChange}\r\n            parentOnDrop={handleDrop}\r\n            parentOnDragStart={handleDragStart}\r\n            constraint={inRectConstraint(imageWidth, imageHeight)} />\r\n        <DraggableHandle x={roHandle.x} y={roHandle.y}\r\n            imageWidth={imageWidth}\r\n            onDragMove={cbToRadius(cx, cy, handleROChange)}\r\n            parentOnDrop={handleDrop}\r\n            parentOnDragStart={handleDragStart}\r\n            constraint={roConstraints(riHandle.x, cy)} />\r\n        <DraggableHandle x={riHandle.x} y={riHandle.y}\r\n            imageWidth={imageWidth}\r\n            parentOnDrop={handleDrop}\r\n            parentOnDragStart={handleDragStart}\r\n            onDragMove={cbToRadius(cx, cy, handleRIChange)}\r\n            constraint={riConstraint(roHandle.x, cy)} />\r\n    </>);\r\n\r\n    const frameViewWidgets = (\r\n        <Ring cx={parameters.cx} cy={parameters.cy} ri={parameters.ri} ro={parameters.ro}\r\n            imageWidth={imageWidth} />\r\n    )\r\n\r\n    const subtitle = (\r\n        <>Ring: center=(x={parameters.cx.toFixed(2)}, y={parameters.cy.toFixed(2)}), ri={parameters.ri.toFixed(2)}, ro={parameters.ro.toFixed(2)}</>\r\n    )\r\n\r\n\r\n    return (\r\n        <AnalysisItem analysis={analysis} dataset={dataset}\r\n            title=\"Radial Fourier analysis\" subtitle={subtitle}\r\n            frameViewHandles={frameViewHandles} frameViewWidgets={frameViewWidgets}\r\n        />\r\n    );\r\n}\r\n\r\nexport default connect(null, mapDispatchToProps)(RadialFourierAnalysis);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { assertNotReached } from '../../helpers';\nimport { AnalysisTypes, DatasetStatus } from \"../../messages\";\nimport { RootReducer } from \"../../store\";\nimport { AnalysisState } from \"../types\";\nimport CenterOfMassAnalysis from \"./CenterOfMassAnalysis\";\nimport DiskMaskAnalysis from \"./DiskMaskAnalysis\";\nimport PointSelectionAnalysis from \"./PointSelectionAnalysis\";\nimport RingMaskAnalysis from \"./RingMaskAnalysis\";\nimport RadialFourierAnalysis from \"./RadialFourierAnalysis\";\n\ninterface AnalysisProps {\n    analysis: AnalysisState,\n}\n\nconst mapStateToProps = (state: RootReducer, ownProps: AnalysisProps) => {\n    return {\n        dataset: state.datasets.byId[ownProps.analysis.dataset],\n    }\n}\n\ntype MergedProps = AnalysisProps & ReturnType<typeof mapStateToProps>;\n\nconst AnalysisComponent: React.SFC<MergedProps> = ({ analysis, dataset }) => {\n    if (dataset.status !== DatasetStatus.OPEN) {\n        return null;\n    }\n\n    switch (analysis.resultDetails.type) {\n        case AnalysisTypes.APPLY_DISK_MASK: {\n            return <DiskMaskAnalysis dataset={dataset} analysis={analysis} parameters={analysis.resultDetails.parameters} />;\n        };\n        case AnalysisTypes.APPLY_RING_MASK: {\n            return <RingMaskAnalysis dataset={dataset} analysis={analysis} parameters={analysis.resultDetails.parameters} />;\n        }\n        case AnalysisTypes.CENTER_OF_MASS: {\n            return <CenterOfMassAnalysis dataset={dataset} analysis={analysis} parameters={analysis.resultDetails.parameters} />;\n        }\n        case AnalysisTypes.APPLY_POINT_SELECTOR: {\n            return <PointSelectionAnalysis dataset={dataset} analysis={analysis} parameters={analysis.resultDetails.parameters} />\n        }\n        case AnalysisTypes.RADIAL_FOURIER: {\n            return <RadialFourierAnalysis dataset={dataset} analysis={analysis} parameters={analysis.resultDetails.parameters} />\n        }\n    }\n\n    return assertNotReached(\"unknown analysis type\");\n}\n\nexport default connect(mapStateToProps)(AnalysisComponent);","import * as React from \"react\";\nimport { AnalysisReducerState } from \"../reducers\";\nimport Analysis from \"./Analysis\";\n\ninterface AnalysisProps {\n    analyses: AnalysisReducerState,\n}\n\nconst AnalysisList: React.SFC<AnalysisProps> = ({ analyses }) => {\n    return (<>{\n        analyses.ids.map(analysisId => <Analysis key={analysisId} analysis={analyses.byId[analysisId]} />)\n    }</>);\n}\n\nexport default AnalysisList;","interface IdMap<R> {\n    [s: string]: R\n}\n\nexport interface ById<R> {\n    ids: string[],\n    byId: IdMap<R>,\n};\n\n// TODO: make ById DeepReadonly\n// import { DeepReadonly } from 'utility-types'\n\nexport function updateById<R>(state: ById<R>, id: string, partialRecord: Partial<R>): ById<R> {\n    const newObj = Object.assign({}, state.byId[id], partialRecord);\n    const newById = Object.assign({}, state.byId, { [id]: newObj });\n    return Object.assign({}, state, { byId: newById });\n}\n\nexport function insertById<R>(state: ById<R>, id: string, record: R): ById<R> {\n    const newById = Object.assign({}, state.byId, { [id]: record });\n    const newIds = [...state.ids, id];\n    return { byId: newById, ids: newIds };\n}\n\nexport function constructById<R>(items: R[], key: (k: R) => string): IdMap<R> {\n    const byId = items.reduce((acc, item) => Object.assign(acc, {\n        [key(item)]: item,\n    }), {} as IdMap<R>);\n    return byId;\n}\n\nexport type Predicate<R> = (item: R) => boolean;\n\nexport function filterWithPred<R>(state: ById<R>, pred: Predicate<R>): ById<R> {\n    const ids = state.ids.filter(id => pred(state.byId[id]));\n    const byId: IdMap<R> = ids.reduce((acc, id) => Object.assign(acc, {\n        [id]: state.byId[id],\n    }), {});\n    return {\n        byId,\n        ids,\n    };\n}","import { AnalysisDetails, AnalysisTypes, PickFrameDetails, SumFramesDetails } from \"../messages\";\n\nexport type FrameMode = AnalysisTypes.PICK_FRAME | AnalysisTypes.SUM_FRAMES;\n\nexport type JobKind = \"FRAME\" | \"RESULT\";\n\nexport type AnalysisStatus = \"busy\" | \"idle\";\n\nexport type JobList = Partial<{ [K in JobKind]: string }>;\n\nexport type JobHistory = {\n    [K in JobKind]: string[]\n};\n\nexport type FrameAnalysisDetails = PickFrameDetails | SumFramesDetails;\n\nexport interface Analysis {\n    id: string,\n    dataset: string,\n    jobs: JobList,\n    jobHistory: JobHistory,\n    frameDetails: FrameAnalysisDetails,\n    resultDetails: AnalysisDetails,\n}\n\nexport type AnalysisState = Analysis & {\n};\n\ninterface AnalysisMetadataItem {\n    long: string,\n    short: string,\n    showInUI: boolean,\n}\n\nexport const AnalysisMetadata: { [s: string]: AnalysisMetadataItem } = {\n    [AnalysisTypes.APPLY_RING_MASK]: {\n        long: \"Apply a ring mask with center cx, cy; inner radius ri, outer radius ro\",\n        short: \"Ring\",\n        showInUI: true,\n    },\n    [AnalysisTypes.APPLY_DISK_MASK]: {\n        long: \"Apply a disk mask with center cx, cy; radius r\",\n        short: \"Disk\",\n        showInUI: true,\n    },\n    [AnalysisTypes.CENTER_OF_MASS]: {\n        long: \"Compute the center of mass of all diffraction images\",\n        short: \"Center of mass\",\n        showInUI: true,\n    },\n    [AnalysisTypes.APPLY_POINT_SELECTOR]: {\n        long: \"Create an image from a single pixel selected in the detector\",\n        short: \"Point selection\",\n        showInUI: true,\n    },\n    [AnalysisTypes.SUM_FRAMES]: {\n        long: \"Create a sum of all detector frames\",\n        short: \"Sum all frames\",\n        showInUI: false,\n    },\n    [AnalysisTypes.PICK_FRAME]: {\n        long: \"Pick a single frame\",\n        short: \"Pick frame\",\n        showInUI: false,\n    },\n    [AnalysisTypes.RADIAL_FOURIER]: {\n        long: \"Compute a radial Fourier analysis\",\n        short: \"Radial Fourier\",\n        showInUI: true,\n    },\n}","import { ActionsUnion, createAction } from '../helpers/actionHelpers';\nimport { DatasetCreateParams, DatasetFormParams, DatasetState } from '../messages';\n\nexport enum ActionTypes {\n    OPEN = 'DATASET_OPEN',\n    CANCEL_OPEN = 'DATASET_CANCEL_OPEN',\n    CREATE = 'DATASET_CREATE',\n    CREATED = 'DATASET_CREATED',\n    ERROR = 'DATASET_ERROR',\n    DELETE = 'DATASET_DELETE',\n    DELETED = 'DATASET_DELETED',\n    DETECT = 'DATASET_DETECT',\n    DETECTED = 'DATASET_DETECTED',\n    DETECT_FAILED = 'DATASET_DETECT_FAILED',\n}\n\nexport const Actions = {\n    open: (path: string, initialParams?: DatasetFormParams) => createAction(ActionTypes.OPEN, { path, initialParams }),\n    cancelOpen: () => createAction(ActionTypes.CANCEL_OPEN),\n    create: (dataset: DatasetCreateParams) => createAction(ActionTypes.CREATE, { dataset }),\n    created: (dataset: DatasetState) => createAction(ActionTypes.CREATED, { dataset }),\n    error: (dataset: string, msg: string, timestamp: number, id: string) => createAction(ActionTypes.ERROR, { dataset, msg, timestamp, id }),\n    delete: (dataset: string) => createAction(ActionTypes.DELETE, { dataset }),\n    deleted: (dataset: string) => createAction(ActionTypes.DELETED, { dataset }),\n    detect: (path: string) => createAction(ActionTypes.DETECT, { path }),\n    detected: (path: string, params: DatasetFormParams) => createAction(ActionTypes.DETECTED, { path, params }),\n    detectFailed: (path: string) => createAction(ActionTypes.DETECT_FAILED, { path }),\n}\n\nexport type Actions = ActionsUnion<typeof Actions>;\n","import * as React from \"react\";\nimport { Dropdown, DropdownItemProps } from \"semantic-ui-react\";\nimport { getEnumValues } from \"../../helpers\";\nimport { AnalysisTypes } from \"../../messages\";\nimport { AnalysisMetadata } from \"../types\";\n\n\nconst getMetadata = (t: any) => AnalysisMetadata[AnalysisTypes[t]];\nconst analysisTypeKeys = getEnumValues(AnalysisTypes);\nconst analysisTypeOptions = analysisTypeKeys.filter(t => getMetadata(t).showInUI).map(t => ({\n    text: getMetadata(t).short,\n    value: AnalysisTypes[t],\n}));\n\ninterface AnalysisSelectProps {\n    onClick: (analysisType: AnalysisTypes) => void,\n    label: string,\n}\n\nconst selectData = (fn: (v: AnalysisTypes) => void) => (e: React.MouseEvent, data: DropdownItemProps) => {\n    return fn(data.value as AnalysisTypes);\n}\n\nconst AnalysisSelect: React.SFC<AnalysisSelectProps> = ({ onClick, label }) => {\n    return (\n        <Dropdown text={label} icon='add' floating={true} labeled={true} button={true} className='icon'>\n            <Dropdown.Menu>\n                <Dropdown.Header content='implemented analyses' />\n                {analysisTypeOptions.map(option => <Dropdown.Item key={option.value} onClick={selectData(onClick)} {...option} />)}\n            </Dropdown.Menu>\n        </Dropdown>\n    );\n}\n\nexport default AnalysisSelect;","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\nimport * as analysisActions from \"../../analysis/actions\";\nimport AnalysisSelect from \"../../analysis/components/AnalysisSelect\";\nimport { AnalysisTypes, DatasetState } from \"../../messages\";\n\ninterface DatasetProps {\n    dataset: DatasetState\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch, ownProps: DatasetProps) => {\n    return {\n        handleAddAnalysis: (type: AnalysisTypes) => {\n            dispatch(analysisActions.Actions.create(ownProps.dataset.id, type));\n        },\n    }\n}\ntype MergedProps = DatasetProps & ReturnType<typeof mapDispatchToProps>;\n\nconst AddAnalysis: React.SFC<MergedProps> = ({ handleAddAnalysis }) => {\n    return <AnalysisSelect onClick={handleAddAnalysis} label='Add analysis' />\n}\n\n\nexport default connect(null, mapDispatchToProps)(AddAnalysis);","import * as React from \"react\";\nimport { Table } from \"semantic-ui-react\";\nimport { DatasetState } from \"../../messages\";\n\ninterface DatasetProps {\n    dataset: DatasetState\n}\n\nconst renderParamValue = (value: any) => {\n    if (value instanceof Array) {\n        return `(${value.join(\",\")})`;\n    } else {\n        return value;\n    }\n}\n\nconst renderParams = (params: any) => {\n    return Object.keys(params).map((key: string, idx: number) => {\n        return (\n            <Table.Row key={idx}>\n                <Table.Cell>{key}</Table.Cell>\n                <Table.Cell>{renderParamValue(params[key])}</Table.Cell>\n            </Table.Row>\n        );\n    })\n}\n\n\nconst DatasetParams: React.SFC<DatasetProps> = ({ dataset }) => {\n    return (\n        <Table>\n            <Table.Header>\n                <Table.Row>\n                    <Table.HeaderCell>Parameter</Table.HeaderCell>\n                    <Table.HeaderCell>Value</Table.HeaderCell>\n                </Table.Row>\n            </Table.Header>\n            <Table.Body>\n                {renderParams(dataset.params)}\n            </Table.Body>\n        </Table>\n    );\n}\n\n\nexport default DatasetParams;","import * as React from \"react\";\nimport { Table } from \"semantic-ui-react\";\nimport { DatasetOpen, DiagElemMsg } from \"../../messages\";\nimport DatasetParams from \"./DatasetParams\";\n\ninterface DatasetInfoProps {\n    dataset: DatasetOpen,\n}\n\nconst renderValue = (elem: DiagElemMsg) => {\n    if (elem.value instanceof Array) {\n        return <DiagElems diagnostics={elem.value} />\n    } else {\n        return elem.value;\n    }\n}\n\nconst DiagElem: React.SFC<{ elem: DiagElemMsg }> = ({ elem }) => {\n    return (\n        <Table.Row>\n            <Table.Cell>{elem.name}</Table.Cell>\n            <Table.Cell>{renderValue(elem)}</Table.Cell>\n        </Table.Row>\n    )\n}\n\nconst DiagElems: React.SFC<{ diagnostics: DiagElemMsg[] }> = ({ diagnostics }) => {\n    if (diagnostics.length === 0) {\n        return null;\n    }\n    return (\n        <Table>\n            <Table.Header>\n                <Table.Row>\n                    <Table.HeaderCell>Name</Table.HeaderCell>\n                    <Table.HeaderCell>Value</Table.HeaderCell>\n                </Table.Row>\n            </Table.Header>\n            <Table.Body>\n                {diagnostics.map((elem, idx) => (\n                    <DiagElem elem={elem} key={idx} />\n                ))}\n            </Table.Body>\n        </Table>\n    );\n}\n\nconst DatasetInfo: React.SFC<DatasetInfoProps> = ({ dataset }) => {\n    return (\n        <>\n            <DatasetParams dataset={dataset} />\n            <DiagElems diagnostics={dataset.diagnostics} />\n        </>\n    );\n}\n\nexport default DatasetInfo;","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Dispatch } from \"redux\";\nimport { Button } from \"semantic-ui-react\";\nimport { DatasetState } from \"../../messages\";\nimport * as datasetActions from \"../actions\";\n\ninterface DatasetProps {\n    dataset: DatasetState,\n}\n\nconst mapDispatchToProps = (dispatch: Dispatch, ownProps: DatasetProps) => {\n    return {\n        handleRemoveDataset: () => {\n            dispatch(datasetActions.Actions.delete(ownProps.dataset.id));\n        }\n    }\n}\n\ntype MergedProps = DatasetProps & ReturnType<typeof mapDispatchToProps>;\n\nconst DatasetToolbar: React.SFC<MergedProps> = ({ dataset, handleRemoveDataset }) => {\n    return (\n        <>\n            <Button icon=\"remove\" labelPosition=\"left\" onClick={handleRemoveDataset} content='Close Dataset' />\n        </>\n    );\n}\n\n\nexport default connect(null, mapDispatchToProps)(DatasetToolbar);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Header, Icon, Message, Modal, Popup, Segment } from 'semantic-ui-react';\nimport AnalysisList from \"../../analysis/components/AnalysisList\";\nimport { AnalysisState } from \"../../analysis/types\";\nimport { filterWithPred } from \"../../helpers/reducerHelpers\";\nimport { DatasetState, DatasetStatus } from \"../../messages\";\nimport { RootReducer } from \"../../store\";\nimport AddAnalysis from \"./AddAnalysis\";\nimport DatasetInfo from \"./DatasetInfo\";\nimport DatasetToolbar from \"./DatasetToolbar\";\n\ninterface DatasetProps {\n    dataset: DatasetState\n}\n\nconst mapStateToProps = (state: RootReducer, ownProps: DatasetProps) => {\n    const p = (analysis: AnalysisState) => analysis.dataset === ownProps.dataset.id;\n    return {\n        analyses: filterWithPred(state.analyses, p),\n    }\n}\n\ntype MergedProps = DatasetProps & ReturnType<typeof mapStateToProps>;\n\nconst DatasetComponent: React.SFC<MergedProps> = ({ dataset, analyses }) => {\n    const msg = {\n        [DatasetStatus.OPENING]: `Opening dataset ${dataset.params.name}`,\n        [DatasetStatus.DELETING]: `Closing dataset ${dataset.params.name}`,\n    }\n    if (dataset.status === DatasetStatus.OPENING || dataset.status === DatasetStatus.DELETING) {\n        return (\n            <>\n                <Header as=\"h2\" dividing={true}>{dataset.params.name}</Header>\n                <Message icon={true}>\n                    <Icon name='cog' loading={true} />\n                    <Message.Content>\n                        <Message.Header>{msg[dataset.status]}</Message.Header>\n                    </Message.Content>\n                </Message>\n            </>\n        );\n    }\n\n    return (\n        <Segment.Group style={{ marginTop: \"3em\", marginBottom: \"3em\" }}>\n            <Segment.Group horizontal={true}>\n                <Segment>\n                    <Header as=\"h2\">\n                        <Icon name=\"database\" />\n                        <Modal trigger={\n                            <Header.Content>\n                                {dataset.params.name}\n                                {' '}\n                                <Icon name=\"info circle\" size=\"small\" link={true} />\n                            </Header.Content>\n                        }>\n                            <Popup.Header>{dataset.params.type} Dataset {dataset.params.name}</Popup.Header>\n                            <Popup.Content>\n                                <DatasetInfo dataset={dataset} />\n                            </Popup.Content>\n                        </Modal>\n                    </Header>\n                </Segment>\n                <Segment style={{ flexShrink: 1, flexGrow: 0 }}>\n                    <DatasetToolbar dataset={dataset} />\n                </Segment>\n            </Segment.Group>\n            {\n                analyses.ids.length > 0 ? (\n                    <>\n                        <Segment>\n                            <AnalysisList analyses={analyses} />\n                        </Segment>\n                    </>\n                ) : null\n            }\n            <Segment textAlign=\"center\">\n                <AddAnalysis dataset={dataset} />\n            </Segment>\n        </Segment.Group>\n    );\n}\n\nconst DatasetContainer = connect(mapStateToProps)(DatasetComponent);\n\nexport default DatasetContainer;","\nexport function parseNumList(nums: string) {\n    return nums.split(\",\").map(part => +part);\n}\n\nexport function getInitial<T extends object, K extends keyof T, V>(key: K, otherwise: V, values?: T): V | T[K] {\n    if (!values) {\n        return otherwise;\n    }\n    const res = values[key] !== undefined ? values[key] : otherwise;\n    return res;\n}","import { FormikProps, withFormik } from \"formik\";\nimport * as React from \"react\";\nimport { Button, Form } from \"semantic-ui-react\";\nimport { Omit } from \"../../helpers/types\";\nimport { DatasetParamsBLO, DatasetTypes } from \"../../messages\";\nimport { getInitial, parseNumList } from \"../helpers\";\nimport { OpenFormProps } from \"../types\";\n\n// some fields have different types in the form vs. in messages\ntype DatasetParamsBLOForForm = Omit<DatasetParamsBLO,\n    \"path\"\n    | \"type\"\n    | \"tileshape\"> & {\n        tileshape: string,\n    };\n\ntype FormValues = DatasetParamsBLOForForm\n\n\ntype MergedProps = FormikProps<FormValues> & OpenFormProps<DatasetParamsBLO>;\n\nconst BLOFileParamsForm: React.SFC<MergedProps> = ({\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    handleReset,\n    onCancel,\n}) => {\n    return (\n        <Form onSubmit={handleSubmit}>\n            <Form.Field>\n                <label htmlFor=\"id_name\">Name:</label>\n                <input type=\"text\" name=\"name\" id=\"id_name\" value={values.name}\n                    onChange={handleChange}\n                    onBlur={handleBlur} />\n                {errors.name && touched.name && errors.name}\n            </Form.Field>\n            <Form.Field>\n                <label htmlFor=\"id_tileshape\">Tileshape:</label>\n                <input type=\"text\" name=\"tileshape\" id=\"id_tileshape\" value={values.tileshape}\n                    onChange={handleChange} onBlur={handleBlur} />\n            </Form.Field>\n\n            <Button primary={true} type=\"submit\" disabled={isSubmitting}>Load Dataset</Button>\n            <Button type=\"button\" onClick={onCancel}>Cancel</Button>\n        </Form>\n    )\n}\n\nexport default withFormik<OpenFormProps<DatasetParamsBLO>, FormValues>({\n    mapPropsToValues: ({ initial }) => ({\n        name: getInitial(\"name\", \"\", initial),\n        tileshape: getInitial(\"tileshape\", \"1, 8, 128, 128\", initial).toString(),\n    }),\n    handleSubmit: (values, formikBag) => {\n        const { onSubmit, path } = formikBag.props;\n        onSubmit({\n            path,\n            type: DatasetTypes.BLO,\n            name: values.name,\n            tileshape: parseNumList(values.tileshape),\n        });\n    }\n})(BLOFileParamsForm);\n","import { ActionsUnion, createAction } from \"../helpers/actionHelpers\";\n\nexport enum ActionTypes {\n    DISMISS = \"ERROR_DISMISS\",\n}\n\nexport const Actions = {\n    dismiss: (id: string) => createAction(ActionTypes.DISMISS, { id }),\n}\n\nexport type Actions = ActionsUnion<typeof Actions>;","import * as React from \"react\";\nimport { Dropdown, DropdownProps } from \"semantic-ui-react\";\nimport { getEnumValues } from \"../../helpers\";\nimport { DatasetTypes } from \"../../messages\";\n\n\nconst datasetTypeKeys = getEnumValues(DatasetTypes);\nconst datasetTypeOptions = datasetTypeKeys.map(t => ({\n    // text: DatasetTypeMetadata[DatasetTypes[t as any]].short,\n    text: DatasetTypes[t],\n    value: DatasetTypes[t],\n}));\n\ninterface DatasetTypeSelectProps {\n    onClick: (e: React.SyntheticEvent, data: DropdownProps) => void,\n    currentType: DatasetTypes,\n}\n\nconst DatasetTypeSelect: React.SFC<DatasetTypeSelectProps> = ({ currentType, onClick }) => {\n    return (\n        <>\n            <Dropdown\n                inline={true}\n                options={datasetTypeOptions}\n                value={currentType}\n                onChange={onClick}\n            />\n        </>\n    );\n}\n\nexport default DatasetTypeSelect;","import { FormikProps, withFormik } from \"formik\";\nimport * as React from \"react\";\nimport { Button, Form } from \"semantic-ui-react\";\nimport { Omit } from \"../../helpers/types\";\nimport { DatasetParamsEMPAD, DatasetTypes } from \"../../messages\";\nimport { getInitial, parseNumList } from \"../helpers\";\nimport { OpenFormProps } from \"../types\";\n\n// some fields have different types in the form vs. in messages\ntype DatasetParamsEMPADForForm = Omit<DatasetParamsEMPAD,\n    \"path\"\n    | \"type\"\n    | \"scan_size\"\n> & {\n    scan_size: string,\n};\n\ntype FormValues = DatasetParamsEMPADForForm\n\ntype MergedProps = FormikProps<FormValues> & OpenFormProps<DatasetParamsEMPAD>;\n\nconst RawFileParamsForm: React.SFC<MergedProps> = ({\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    handleReset,\n    onCancel,\n}) => {\n    return (\n        <Form onSubmit={handleSubmit}>\n            <Form.Field>\n                <label htmlFor=\"id_name\">Name:</label>\n                <input type=\"text\" name=\"name\" id=\"id_name\" value={values.name}\n                    onChange={handleChange}\n                    onBlur={handleBlur} />\n                {errors.name && touched.name && errors.name}\n            </Form.Field>\n            <Form.Field>\n                <label htmlFor=\"id_scan_size\">Scan Size:</label>\n                <input type=\"text\" name=\"scan_size\" id=\"id_scan_size\" value={values.scan_size}\n                    onChange={handleChange} onBlur={handleBlur} />\n            </Form.Field>\n            <Button primary={true} type=\"submit\" disabled={isSubmitting}>Load Dataset</Button>\n            <Button type=\"button\" onClick={onCancel}>Cancel</Button>\n        </Form>\n    )\n}\n\nexport default withFormik<OpenFormProps<DatasetParamsEMPAD>, FormValues>({\n    mapPropsToValues: ({ initial }) => ({\n        name: getInitial(\"name\", \"\", initial),\n        scan_size: getInitial(\"scan_size\", \"\", initial).toString(),\n    }),\n    handleSubmit: (values, formikBag) => {\n        const { onSubmit, path } = formikBag.props;\n        onSubmit({\n            path,\n            type: DatasetTypes.EMPAD,\n            name: values.name,\n            scan_size: parseNumList(values.scan_size),\n        });\n    }\n})(RawFileParamsForm);\n\n","import { DatasetParamsFRMS6 } from \"../../messages\";\n\nimport { FormikProps, withFormik } from \"formik\";\nimport * as React from \"react\";\nimport { Button, Form } from \"semantic-ui-react\";\nimport { Omit } from \"../../helpers/types\";\nimport { DatasetTypes } from \"../../messages\";\nimport { getInitial } from \"../helpers\";\nimport { OpenFormProps } from \"../types\";\n\n// some fields have different types in the form vs. in messages\ntype DatasetParamsFRMS6ForForm = Omit<DatasetParamsFRMS6,\n    \"path\" | \"type\">;\n\ntype FormValues = DatasetParamsFRMS6ForForm\n\n\ntype MergedProps = FormikProps<FormValues> & OpenFormProps<DatasetParamsFRMS6>;\nconst FRMS6ParamsForm: React.SFC<MergedProps> = ({\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    handleReset,\n    onCancel,\n}) => {\n    return (\n        <Form onSubmit={handleSubmit}>\n            <Form.Field>\n                <label htmlFor=\"id_name\">Name:</label>\n                <input type=\"text\" name=\"name\" id=\"id_name\" value={values.name}\n                    onChange={handleChange}\n                    onBlur={handleBlur} />\n                {errors.name && touched.name && errors.name}\n            </Form.Field>\n\n            <Button primary={true} type=\"submit\" disabled={isSubmitting}>Load Dataset</Button>\n            <Button type=\"button\" onClick={onCancel}>Cancel</Button>\n        </Form>\n    )\n}\n\nexport default withFormik<OpenFormProps<DatasetParamsFRMS6>, FormValues>({\n    mapPropsToValues: ({ initial }) => ({\n        name: getInitial(\"name\", \"\", initial),\n    }),\n    handleSubmit: (values, formikBag) => {\n        const { onSubmit, path } = formikBag.props;\n        onSubmit({\n            path,\n            type: DatasetTypes.FRMS6,\n            name: values.name,\n        });\n    }\n})(FRMS6ParamsForm);\n","import { FormikProps, withFormik } from \"formik\";\nimport * as React from \"react\";\nimport { Button, Form } from \"semantic-ui-react\";\nimport { Omit } from \"../../helpers/types\";\nimport { DatasetParamsHDF5, DatasetTypes } from \"../../messages\";\nimport { getInitial } from \"../helpers\";\nimport { OpenFormProps } from \"../types\";\n\ntype DatasetParamsHDF5ForForm = Omit<DatasetParamsHDF5, \"path\" | \"type\" | \"tileshape\"> & { tileshape: string, };\n\ntype FormValues = DatasetParamsHDF5ForForm\n\ntype MergedProps = FormikProps<FormValues> & OpenFormProps<DatasetParamsHDF5>;\n\nconst HDF5ParamsForm: React.SFC<MergedProps> = ({\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    handleReset,\n    onCancel,\n}) => {\n    return (\n        <Form onSubmit={handleSubmit}>\n            <Form.Field>\n                <label htmlFor=\"id_name\">Name:</label>\n                <input type=\"text\" name=\"name\" id=\"id_name\" value={values.name}\n                    onChange={handleChange}\n                    onBlur={handleBlur} />\n                {errors.name && touched.name && errors.name}\n            </Form.Field>\n            <Form.Field>\n                <label htmlFor=\"id_ds_path\">HDF5 Dataset Path:</label>\n                <input type=\"text\" name=\"ds_path\" id=\"id_ds_path\" value={values.ds_path}\n                    onChange={handleChange} onBlur={handleBlur} />\n            </Form.Field>\n            <Form.Field>\n                <label htmlFor=\"id_tileshape\">Tileshape:</label>\n                <input type=\"text\" name=\"tileshape\" id=\"id_tileshape\" value={values.tileshape}\n                    onChange={handleChange} onBlur={handleBlur} />\n            </Form.Field>\n            <Button primary={true} type=\"submit\" disabled={isSubmitting}>Load Dataset</Button>\n            <Button onClick={onCancel} >Cancel</Button>\n        </Form>\n    )\n}\n\nexport default withFormik<OpenFormProps<DatasetParamsHDF5>, FormValues>({\n    mapPropsToValues: ({ initial }) => ({\n        name: getInitial(\"name\", \"\", initial),\n        tileshape: getInitial(\"tileshape\", \"1, 8, 128, 128\", initial).toString(),\n        ds_path: getInitial(\"ds_path\", \"\", initial),\n    }),\n    handleSubmit: (values, formikBag) => {\n        const { onSubmit, path } = formikBag.props;\n        onSubmit({\n            path,\n            type: DatasetTypes.HDF5,\n            name: values.name,\n            ds_path: values.ds_path,\n            tileshape: values.tileshape.split(\",\").map(part => +part),\n        });\n    }\n})(HDF5ParamsForm);","import { FormikProps, withFormik } from \"formik\";\nimport * as React from \"react\";\nimport { Button, Form } from \"semantic-ui-react\";\nimport { Omit } from \"../../helpers/types\";\nimport { DatasetParamsHDFS, DatasetTypes } from \"../../messages\";\nimport { getInitial } from \"../helpers\";\nimport { OpenFormProps } from \"../types\";\n\ntype RawDatasetParamsHDFS = Omit<DatasetParamsHDFS, \"path\" | \"type\" | \"tileshape\"> & {\n    tileshape: string,\n};\n\ntype FormValues = RawDatasetParamsHDFS\n\ntype MergedProps = FormikProps<FormValues> & OpenFormProps<DatasetParamsHDFS>;\n\nconst HDFSParamsForm: React.SFC<MergedProps> = ({\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    handleReset,\n    onCancel,\n}) => {\n    return (\n        <Form onSubmit={handleSubmit}>\n            <Form.Field>\n                <label htmlFor=\"id_name\">Name:</label>\n                <input type=\"text\" name=\"name\" id=\"id_name\" value={values.name}\n                    onChange={handleChange}\n                    onBlur={handleBlur} />\n                {errors.name && touched.name && errors.name}\n            </Form.Field>\n            <Form.Field>\n                <label htmlFor=\"id_tileshape\">Tileshape:</label>\n                <input type=\"text\" name=\"tileshape\" id=\"id_tileshape\" value={values.tileshape}\n                    onChange={handleChange} onBlur={handleBlur} />\n            </Form.Field>\n            <Button primary={true} type=\"submit\" disabled={isSubmitting}>Load Dataset</Button>\n            <Button type=\"button\" onClick={onCancel}>Cancel</Button>\n        </Form>\n    )\n}\n\nexport default withFormik<OpenFormProps<DatasetParamsHDFS>, FormValues>({\n    mapPropsToValues: ({ initial }) => ({\n        name: getInitial(\"name\", \"\", initial),\n        tileshape: getInitial(\"tileshape\", \"1, 8, 128, 128\", initial).toString(),\n    }),\n    handleSubmit: (values, formikBag) => {\n        const { onSubmit, path } = formikBag.props;\n        onSubmit({\n            path,\n            type: DatasetTypes.HDFS,\n            name: values.name,\n            tileshape: values.tileshape.split(\",\").map(part => +part),\n        });\n    }\n})(HDFSParamsForm);","import { FormikProps, withFormik } from \"formik\";\nimport * as React from \"react\";\nimport { Button, Form } from \"semantic-ui-react\";\nimport { Omit } from \"../../helpers/types\";\nimport { DatasetParamsK2IS, DatasetTypes } from \"../../messages\";\nimport { getInitial } from \"../helpers\";\nimport { OpenFormProps } from \"../types\";\n\n// some fields have different types in the form vs. in messages\ntype DatasetParamsK2ISForForm = Omit<DatasetParamsK2IS,\n    \"path\" | \"type\">;\n\ntype FormValues = DatasetParamsK2ISForForm\n\n\ntype MergedProps = FormikProps<FormValues> & OpenFormProps<DatasetParamsK2IS>;\n\nconst K2ISFileParamsForm: React.SFC<MergedProps> = ({\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    handleReset,\n    onCancel,\n}) => {\n    return (\n        <Form onSubmit={handleSubmit}>\n            <Form.Field>\n                <label htmlFor=\"id_name\">Name:</label>\n                <input type=\"text\" name=\"name\" id=\"id_name\" value={values.name}\n                    onChange={handleChange}\n                    onBlur={handleBlur} />\n                {errors.name && touched.name && errors.name}\n            </Form.Field>\n\n            <Button primary={true} type=\"submit\" disabled={isSubmitting}>Load Dataset</Button>\n            <Button type=\"button\" onClick={onCancel}>Cancel</Button>\n        </Form>\n    )\n}\n\nexport default withFormik<OpenFormProps<DatasetParamsK2IS>, FormValues>({\n    mapPropsToValues: ({ initial }) => ({\n        name: getInitial(\"name\", \"\", initial),\n    }),\n    handleSubmit: (values, formikBag) => {\n        const { onSubmit, path } = formikBag.props;\n        onSubmit({\n            path,\n            type: DatasetTypes.K2IS,\n            name: values.name,\n        });\n    }\n})(K2ISFileParamsForm);\n\n","import { FormikProps, withFormik } from \"formik\";\nimport * as React from \"react\";\nimport { Button, Form } from \"semantic-ui-react\";\nimport { Omit } from \"../../helpers/types\";\nimport { DatasetParamsMIB, DatasetTypes } from \"../../messages\";\nimport { getInitial, parseNumList } from \"../helpers\";\nimport { OpenFormProps } from \"../types\";\n\n// some fields have different types in the form vs. in messages\ntype DatasetParamsMIBForForm = Omit<DatasetParamsMIB,\n    \"path\"\n    | \"type\"\n    | \"tileshape\"\n    | \"scan_size\"\n> & {\n    tileshape: string,\n    scan_size: string,\n};\n\ntype FormValues = DatasetParamsMIBForForm\n\ntype MergedProps = FormikProps<FormValues> & OpenFormProps<DatasetParamsMIB>;\n\nconst RawFileParamsForm: React.SFC<MergedProps> = ({\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    handleReset,\n    onCancel,\n}) => {\n    return (\n        <Form onSubmit={handleSubmit}>\n            <Form.Field>\n                <label htmlFor=\"id_name\">Name:</label>\n                <input type=\"text\" name=\"name\" id=\"id_name\" value={values.name}\n                    onChange={handleChange}\n                    onBlur={handleBlur} />\n                {errors.name && touched.name && errors.name}\n            </Form.Field>\n            <Form.Field>\n                <label htmlFor=\"id_tileshape\">Tileshape:</label>\n                <input type=\"text\" name=\"tileshape\" id=\"id_tileshape\" value={values.tileshape}\n                    onChange={handleChange} onBlur={handleBlur} />\n            </Form.Field>\n            <Form.Field>\n                <label htmlFor=\"id_scan_size\">Scan Size:</label>\n                <input type=\"text\" name=\"scan_size\" id=\"id_scan_size\" value={values.scan_size}\n                    onChange={handleChange} onBlur={handleBlur} />\n            </Form.Field>\n            <Button primary={true} type=\"submit\" disabled={isSubmitting}>Load Dataset</Button>\n            <Button type=\"button\" onClick={onCancel}>Cancel</Button>\n        </Form>\n    )\n}\n\nexport default withFormik<OpenFormProps<DatasetParamsMIB>, FormValues>({\n    mapPropsToValues: ({ initial }) => ({\n        name: getInitial(\"name\", \"\", initial),\n        tileshape: getInitial(\"tileshape\", \"1, 8, 256, 256\", initial).toString(),\n        scan_size: getInitial(\"scan_size\", \"\", initial).toString(),\n    }),\n    handleSubmit: (values, formikBag) => {\n        const { onSubmit, path } = formikBag.props;\n        onSubmit({\n            path,\n            type: DatasetTypes.MIB,\n            name: values.name,\n            tileshape: parseNumList(values.tileshape),\n            scan_size: parseNumList(values.scan_size),\n        });\n    }\n})(RawFileParamsForm);\n","import { FormikProps, withFormik } from \"formik\";\nimport * as React from \"react\";\nimport { Button, Form } from \"semantic-ui-react\";\nimport { Omit } from \"../../helpers/types\";\nimport { DatasetParamsRaw, DatasetTypes } from \"../../messages\";\nimport { getInitial, parseNumList } from \"../helpers\";\nimport { OpenFormProps } from \"../types\";\n\n// some fields have different types in the form vs. in messages\ntype DatasetParamsRawForForm = Omit<DatasetParamsRaw,\n    \"type\"\n    | \"path\"\n    | \"tileshape\"\n    | \"scan_size\"\n    | \"detector_size\"> & {\n        tileshape: string,\n        scan_size: string\n        detector_size: string,\n    };\n\ntype FormValues = DatasetParamsRawForForm\n\ntype MergedProps = FormikProps<FormValues> & OpenFormProps<DatasetParamsRaw>;\n\nconst RawFileParamsForm: React.SFC<MergedProps> = ({\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    handleReset,\n    onCancel,\n}) => {\n    return (\n        <Form onSubmit={handleSubmit}>\n            <Form.Field>\n                <label htmlFor=\"id_name\">Name:</label>\n                <input type=\"text\" name=\"name\" id=\"id_name\" value={values.name}\n                    onChange={handleChange}\n                    onBlur={handleBlur} />\n                {errors.name && touched.name && errors.name}\n            </Form.Field>\n            <Form.Field>\n                <label htmlFor=\"id_tileshape\">Tileshape:</label>\n                <input type=\"text\" name=\"tileshape\" id=\"id_tileshape\" value={values.tileshape}\n                    onChange={handleChange} onBlur={handleBlur} />\n            </Form.Field>\n            <Form.Field>\n                <label htmlFor=\"id_scan_size\">Scan Size:</label>\n                <input type=\"text\" name=\"scan_size\" id=\"id_scan_size\" value={values.scan_size}\n                    onChange={handleChange} onBlur={handleBlur} />\n            </Form.Field>\n            <Form.Field>\n                <label htmlFor=\"id_dtype\">Datatype (uint16, uint32, float32, float64, &gt;u2, ..., can be anything that is <a href=\"https://docs.scipy.org/doc/numpy-1.15.1/reference/arrays.dtypes.html\">understood by numpy as a dtype</a>):</label>\n                <input type=\"text\" name=\"dtype\" id=\"id_dtype\" value={values.dtype}\n                    onChange={handleChange} onBlur={handleBlur} />\n            </Form.Field>\n\n            <Form.Field>\n                <label htmlFor=\"id_detector_size\">Detector Size (as in the file):</label>\n                <input type=\"text\" name=\"detector_size\" id=\"id_detector_size\" value={values.detector_size}\n                    onChange={handleChange} onBlur={handleBlur} />\n            </Form.Field>\n            <Form.Field>\n                <label htmlFor=\"id_enable_direct\">Enable Direct I/O (for usage with fast SSDs and files much larger than RAM):</label>\n                <input type=\"checkbox\" name=\"enable_direct\" id=\"id_enable_direct\" checked={values.enable_direct}\n                    onChange={handleChange} onBlur={handleBlur} />\n            </Form.Field>\n            <Button primary={true} type=\"submit\" disabled={isSubmitting}>Load Dataset</Button>\n            <Button type=\"button\" onClick={onCancel}>Cancel</Button>\n        </Form>\n    )\n}\n\nexport default withFormik<OpenFormProps<DatasetParamsRaw>, FormValues>({\n    mapPropsToValues: ({ initial }) => ({\n        name: getInitial(\"name\", \"\", initial),\n        enable_direct: getInitial(\"enable_direct\", false, initial),\n        tileshape: getInitial(\"tileshape\", \"1, 8, 128, 128\", initial).toString(),\n        detector_size: getInitial(\"detector_size\", \"\", initial).toString(),\n        scan_size: getInitial(\"scan_size\", \"\", initial).toString(),\n        dtype: getInitial(\"dtype\", \"float32\", initial),\n    }),\n    handleSubmit: (values, formikBag) => {\n        const { onSubmit, path } = formikBag.props;\n        onSubmit({\n            path,\n            type: DatasetTypes.RAW,\n            name: values.name,\n            dtype: values.dtype,\n            enable_direct: values.enable_direct,\n            tileshape: parseNumList(values.tileshape),\n            scan_size: parseNumList(values.scan_size),\n            detector_size: parseNumList(values.detector_size),\n        });\n    }\n})(RawFileParamsForm);\n","import { DatasetParamsSER } from \"../../messages\";\n\nimport { FormikProps, withFormik } from \"formik\";\nimport * as React from \"react\";\nimport { Button, Form } from \"semantic-ui-react\";\nimport { Omit } from \"../../helpers/types\";\nimport { DatasetTypes } from \"../../messages\";\nimport { getInitial } from \"../helpers\";\nimport { OpenFormProps } from \"../types\";\n\n// some fields have different types in the form vs. in messages\ntype DatasetParamsSERForForm = Omit<DatasetParamsSER,\n    \"path\" | \"type\">;\n\ntype FormValues = DatasetParamsSERForForm\n\n\ntype MergedProps = FormikProps<FormValues> & OpenFormProps<DatasetParamsSER>;\nconst SERParamsForm: React.SFC<MergedProps> = ({\n    values,\n    touched,\n    errors,\n    dirty,\n    isSubmitting,\n    handleChange,\n    handleBlur,\n    handleSubmit,\n    handleReset,\n    onCancel,\n}) => {\n    return (\n        <Form onSubmit={handleSubmit}>\n            <Form.Field>\n                <label htmlFor=\"id_name\">Name:</label>\n                <input type=\"text\" name=\"name\" id=\"id_name\" value={values.name}\n                    onChange={handleChange}\n                    onBlur={handleBlur} />\n                {errors.name && touched.name && errors.name}\n            </Form.Field>\n\n            <Button primary={true} type=\"submit\" disabled={isSubmitting}>Load Dataset</Button>\n            <Button type=\"button\" onClick={onCancel}>Cancel</Button>\n        </Form>\n    )\n}\n\nexport default withFormik<OpenFormProps<DatasetParamsSER>, FormValues>({\n    mapPropsToValues: ({ initial }) => ({\n        name: getInitial(\"name\", \"\", initial),\n    }),\n    handleSubmit: (values, formikBag) => {\n        const { onSubmit, path } = formikBag.props;\n        onSubmit({\n            path,\n            type: DatasetTypes.SER,\n            name: values.name,\n        });\n    }\n})(SERParamsForm);","import * as React from \"react\";\nimport { connect } from 'react-redux';\nimport { Dispatch } from \"redux\";\nimport { DropdownProps, Header, Segment } from \"semantic-ui-react\";\nimport uuid from \"uuid/v4\";\nimport { assertNotReached } from \"../../helpers\";\nimport { DatasetFormParams, DatasetTypes } from '../../messages';\nimport { RootReducer } from \"../../store\";\nimport * as datasetActions from \"../actions\";\nimport BLOParamsForm from \"./BLOParamsForm\";\nimport DatasetTypeSelect from \"./DatasetTypeSelect\";\nimport EMPADParamsForm from \"./EMPADParamsForm\";\nimport FRMS6ParamsForm from \"./FRMS6ParamsForm\";\nimport HDF5ParamsForm from \"./HDF5ParamsForm\";\nimport HDFSParamsForm from './HDFSParamsForm';\nimport K2ISParamsForm from \"./K2ISParamsForm\";\nimport MIBParamsForm from \"./MIBParamsForm\";\nimport RawFileParamsForm from \"./RawFileParamsForm\";\nimport SERParamsForm from \"./SERParamsForm\";\n\nconst mapDispatchToProps = (dispatch: Dispatch) => {\n    return {\n        createDataset: (params: DatasetFormParams) => {\n            dispatch(datasetActions.Actions.create({\n                id: uuid(),\n                params,\n            }));\n        },\n        onCancel: () => dispatch(datasetActions.Actions.cancelOpen()),\n    };\n}\n\nconst mapStateToProps = (state: RootReducer) => {\n    return {\n        formVisible: state.openDataset.formVisible,\n        formPath: state.openDataset.formPath,\n        formInitial: state.openDataset.formInitialParams,\n    };\n}\n\n\ntype MergedProps = ReturnType<typeof mapDispatchToProps> & ReturnType<typeof mapStateToProps>;\n\ninterface DatasetOpenState {\n    datasetType: DatasetTypes\n}\n\n\nclass DatasetOpen extends React.Component<MergedProps, DatasetOpenState> {\n    public state = {\n        datasetType: DatasetTypes.RAW,\n    }\n\n    constructor(props: MergedProps) {\n        super(props);\n        if (props.formInitial !== undefined) {\n            this.state = {\n                datasetType: props.formInitial.type,\n            };\n        }\n    }\n\n    public setDatasetType = (e: React.SyntheticEvent, data: DropdownProps) => {\n        const type = data.value as DatasetTypes;\n        this.setState({\n            datasetType: type,\n        })\n    }\n\n    public render() {\n        const { formPath, formInitial, createDataset, onCancel } = this.props;\n        const { datasetType } = this.state;\n\n        const renderForm = (form: React.ReactNode) => {\n            return (\n                <Segment>\n                    Type: <DatasetTypeSelect onClick={this.setDatasetType} currentType={datasetType} />\n                    <Header as=\"h2\">Open: {formPath}</Header>\n                    {form}\n                </Segment>\n            );\n        }\n        switch (datasetType) {\n            case DatasetTypes.HDF5: {\n                const initial = formInitial && datasetType === formInitial.type ? formInitial : undefined;\n                return renderForm(<HDF5ParamsForm path={formPath} initial={initial} onSubmit={createDataset} onCancel={onCancel} />);\n            }\n            case DatasetTypes.HDFS: {\n                const initial = formInitial && datasetType === formInitial.type ? formInitial : undefined;\n                return renderForm(<HDFSParamsForm path={formPath} initial={initial} onSubmit={createDataset} onCancel={onCancel} />);\n            }\n            case DatasetTypes.RAW: {\n                const initial = formInitial && datasetType === formInitial.type ? formInitial : undefined;\n                return renderForm(<RawFileParamsForm path={formPath} initial={initial} onSubmit={createDataset} onCancel={onCancel} />);\n            }\n            case DatasetTypes.MIB: {\n                const initial = formInitial && datasetType === formInitial.type ? formInitial : undefined;\n                return renderForm(<MIBParamsForm path={formPath} initial={initial} onSubmit={createDataset} onCancel={onCancel} />);\n            }\n            case DatasetTypes.BLO: {\n                const initial = formInitial && datasetType === formInitial.type ? formInitial : undefined;\n                return renderForm(<BLOParamsForm path={formPath} initial={initial} onSubmit={createDataset} onCancel={onCancel} />);\n            }\n            case DatasetTypes.K2IS: {\n                const initial = formInitial && datasetType === formInitial.type ? formInitial : undefined;\n                return renderForm(<K2ISParamsForm path={formPath} initial={initial} onSubmit={createDataset} onCancel={onCancel} />);\n            }\n            case DatasetTypes.SER: {\n                const initial = formInitial && datasetType === formInitial.type ? formInitial : undefined;\n                return renderForm(<SERParamsForm path={formPath} initial={initial} onSubmit={createDataset} onCancel={onCancel} />);\n            }\n            case DatasetTypes.FRMS6: {\n                const initial = formInitial && datasetType === formInitial.type ? formInitial : undefined;\n                return renderForm(<FRMS6ParamsForm path={formPath} initial={initial} onSubmit={createDataset} onCancel={onCancel} />);\n            }\n            case DatasetTypes.EMPAD: {\n                const initial = formInitial && datasetType === formInitial.type ? formInitial : undefined;\n                return renderForm(<EMPADParamsForm path={formPath} initial={initial} onSubmit={createDataset} onCancel={onCancel} />)\n            }\n        }\n        return assertNotReached(\"unknown dataset type\");\n    }\n\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(DatasetOpen)","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Header, Icon, Message } from \"semantic-ui-react\";\nimport { RootReducer } from \"../../store\";\n\nconst mapStateToProps = (state: RootReducer) => {\n    return {\n        busy: state.openDataset.busy,\n        path: state.openDataset.busyPath,\n    };\n}\n\ntype MergedProps = ReturnType<typeof mapStateToProps>;\n\nconst DatasetOpenSpinner: React.SFC<MergedProps> = ({ busy, path }) => {\n    if (!busy) {\n        return null;\n    }\n    return (\n        <>\n            <Header as=\"h2\" dividing={true}>Loading...</Header>\n            <Message icon={true}>\n                <Icon name='cog' loading={true} />\n                <Message.Content>\n                    <Message.Header>Detecting parameters for {path}</Message.Header>\n                </Message.Content>\n            </Message>\n        </>\n    );\n}\n\nexport default connect(mapStateToProps)(DatasetOpenSpinner);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport BrowserWrapper from \"../../browser/components/BrowserWrapper\";\nimport { RootReducer } from \"../../store\";\nimport { DatasetsState } from \"../types\";\nimport Dataset from \"./Dataset\";\nimport DatasetOpen from \"./DatasetOpen\";\nimport DatasetOpenSpinner from \"./DatasetOpenSpinner\";\n\ninterface DatasetListProps {\n    datasets: DatasetsState\n}\n\nconst mapStateToProps = (state: RootReducer) => {\n    return {\n        datasets: state.datasets,\n        formVisible: state.openDataset.formVisible,\n        formPath: state.openDataset.formPath,\n    };\n}\n\ntype MergedProps = DatasetListProps & ReturnType<typeof mapStateToProps>;\n\nclass DatasetList extends React.Component<MergedProps> {\n    public render() {\n        const { formVisible, datasets } = this.props;\n\n        return (\n            <>\n                {datasets.ids.map((dsId: string) => <Dataset dataset={datasets.byId[dsId]} key={dsId} />)}\n                <DatasetOpenSpinner />\n                {formVisible && <DatasetOpen />}\n                <BrowserWrapper />\n            </>\n        );\n    }\n}\n\nexport default connect(mapStateToProps)(DatasetList);","import * as React from 'react';\nimport { connect } from 'react-redux';\nimport { Dispatch } from 'redux';\nimport { Message } from 'semantic-ui-react';\nimport * as errorActions from '../actions';\nimport { ErrorMessage } from '../reducers';\n\nconst mapDispatchToProps = (dispatch: Dispatch, ownProps: ErrorProps) => {\n    return {\n        dismiss: () => dispatch(errorActions.Actions.dismiss(ownProps.error.id)),\n    }\n}\n\ninterface ErrorProps {\n    error: ErrorMessage,\n}\n\ntype MergedProps = ErrorProps & ReturnType<typeof mapDispatchToProps>;\n\nconst ErrorComponent: React.SFC<MergedProps> = ({ dismiss, error }) => {\n    return (\n        <Message negative={true} onDismiss={dismiss}>{error.msg}</Message>\n    )\n}\n\nexport default connect(null, mapDispatchToProps)(ErrorComponent);","import * as React from \"react\";\nimport { connect } from \"react-redux\";\nimport { Modal } from \"semantic-ui-react\";\nimport { RootReducer } from \"../../store\";\nimport Error from \"./Error\";\n\nconst mapStateToProps = (state: RootReducer) => {\n    return {\n        errors: state.errors,\n        clusterConnected: state.clusterConnection.status === \"connected\",\n        channelConnected: (state.channelStatus.status === \"connected\" ||\n            state.channelStatus.status === \"ready\"),\n    }\n}\n\ntype MergedProps = ReturnType<typeof mapStateToProps>;\n\nconst ErrorList: React.SFC<MergedProps> = ({ errors, clusterConnected, channelConnected }) => {\n    const numShown = 3;\n    const latestErrors = errors.ids.slice(Math.max(0, errors.ids.length - numShown));\n    const showModal = errors.ids.length > 0 && clusterConnected && channelConnected;\n    return (\n        <Modal open={showModal}>\n            {latestErrors.map(error => <Error error={errors.byId[error]} key={error} />)}\n        </Modal>\n    );\n}\n\nexport default connect(mapStateToProps)(ErrorList);","import * as React from 'react';\nimport 'semantic-ui-css/semantic.min.css';\nimport { Container, Icon, Modal, Popup } from 'semantic-ui-react';\nimport About from './About';\nimport ChannelStatus from './channel/components/ChannelStatus';\nimport DatasetList from './dataset/components/DatasetList';\nimport ErrorList from './errors/components/ErrorList';\nimport logo from './images/LiberTEM logo-medium.png';\n\nclass App extends React.Component {\n    public render() {\n        return (\n            <Container style={{ margin: \"5em 1em 5em 1em\" }}>\n                <div style={{ display: \"flex\" }}>\n                    <img src={logo} width=\"200\" height=\"46\" alt=\"LiberTEM\" style={{ marginBottom: \"20px\" }} />\n                    {' '}\n                    <Modal trigger={\n                        <Icon name=\"info circle\" link={true} style={{ alignSelf: \"flex-start\" }} />\n                    }>\n                        <Popup.Header>About LiberTEM</Popup.Header>\n                        <Popup.Content>\n                            <About />\n                        </Popup.Content>\n                    </Modal>\n                </div>\n                <ErrorList />\n                <ChannelStatus>\n                    <DatasetList />\n                </ChannelStatus>\n            </Container>\n        );\n    }\n}\n\nexport default App;\n","// tslint:disable:no-console\n// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the 'N+1' visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL!,\n      window.location.toString()\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker) {\n          installingWorker.onstatechange = () => {\n            if (installingWorker.state === 'installed') {\n              if (navigator.serviceWorker.controller) {\n                // At this point, the old content will have been purged and\n                // the fresh content will have been added to the cache.\n                // It's the perfect time to display a 'New content is\n                // available; please refresh.' message in your web app.\n                console.log('New content is available; please refresh.');\n              } else {\n                // At this point, everything has been precached.\n                // It's the perfect time to display a\n                // 'Content is cached for offline use.' message.\n                console.log('Content is cached for offline use.');\n              }\n            }\n          };\n        }\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type')!.indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import { ActionsUnion, createAction } from \"../helpers/actionHelpers\";\n\nexport enum ActionTypes {\n    CREATE = 'JOB_CREATE',\n}\n\nexport const Actions = {\n    create: (id: string, dataset: string, timestamp: number) => createAction(ActionTypes.CREATE, { id, dataset, timestamp }),\n}\n\nexport type Actions = ActionsUnion<typeof Actions>;\n\nexport type ActionParts = {\n    [K in keyof typeof Actions]: ReturnType<typeof Actions[K]>\n}","import { AnalysisDetails, CancelJobResponse, StartJobRequest, StartJobResponse } from \"../messages\";\n\nexport function startJob(jobId: string, datasetId: string, analysis: AnalysisDetails): Promise<StartJobResponse> {\n    const payload: StartJobRequest = {\n        job: {\n            dataset: datasetId,\n            analysis,\n        }\n    }\n    return fetch(`/api/jobs/${jobId}/`, {\n        body: JSON.stringify(payload),\n        credentials: \"same-origin\",\n        method: \"PUT\",\n    }).then(r => r.json());\n}\n\nexport function cancelJob(jobId: string): Promise<CancelJobResponse> {\n    return fetch(`/api/jobs/${jobId}/`, {\n        method: \"DELETE\",\n        credentials: \"same-origin\",\n    }).then(r => r.json());\n}","import { buffers } from 'redux-saga';\nimport { actionChannel, call, cancel, fork, put, select, take, takeEvery } from 'redux-saga/effects';\nimport uuid from 'uuid/v4';\nimport { assertNotReached } from '../helpers';\nimport * as jobActions from '../job/actions';\nimport { cancelJob, startJob } from '../job/api';\nimport { JobState } from '../job/types';\nimport { AnalysisDetails, AnalysisTypes, DatasetOpen, DatasetState, DatasetStatus } from '../messages';\nimport { RootReducer } from '../store';\nimport * as analysisActions from './actions';\nimport { AnalysisState, JobKind } from './types';\n\n\n// TODO: flip this around - create classes for each analysis type\n// classes should provide:\n//  + methods for default parameters\n//  + creation of a job from current parameters\nfunction getAnalysisDetails(analysisType: AnalysisTypes, dataset: DatasetOpen): AnalysisDetails {\n    const shape = dataset.params.shape;\n    const width = shape[3];\n    const height = shape[2];\n    const minLength = Math.min(width, height);\n\n    switch (analysisType) {\n        case AnalysisTypes.APPLY_DISK_MASK: {\n            return {\n                type: analysisType,\n                parameters: {\n                    shape: \"disk\",\n                    cx: width / 2,\n                    cy: height / 2,\n                    r: minLength / 2,\n                }\n            };\n        }\n        case AnalysisTypes.APPLY_RING_MASK: {\n            return {\n                type: analysisType,\n                parameters: {\n                    shape: \"ring\",\n                    cx: width / 2,\n                    cy: height / 2,\n                    ri: minLength / 4,\n                    ro: minLength / 2,\n                }\n            }\n        }\n        case AnalysisTypes.CENTER_OF_MASS: {\n            return {\n                type: analysisType,\n                parameters: {\n                    shape: \"com\",\n                    cx: width / 2,\n                    cy: height / 2,\n                    r: minLength / 2,\n                },\n            };\n        }\n        case AnalysisTypes.APPLY_POINT_SELECTOR: {\n            return {\n                type: analysisType,\n                parameters: {\n                    shape: \"point\",\n                    cx: width / 2,\n                    cy: width / 2,\n                }\n            }\n        }\n        case AnalysisTypes.SUM_FRAMES: {\n            return {\n                type: AnalysisTypes.SUM_FRAMES,\n                parameters: {},\n            }\n        }\n        case AnalysisTypes.PICK_FRAME: {\n            return {\n                type: AnalysisTypes.PICK_FRAME,\n                parameters: {\n                    x: Math.round(width / 2),\n                    y: Math.round(height / 2),\n                }\n            }\n        }\n        case AnalysisTypes.RADIAL_FOURIER: {\n            return {\n                type: analysisType,\n                parameters: {\n                    shape: \"radial_fourier\",\n                    cx: width / 2,\n                    cy: height / 2,\n                    ri: minLength / 4,\n                    ro: minLength / 2,\n                    n_bins: 1,\n                    max_order: 8\n                }\n            }\n        }\n    }\n    return assertNotReached(\"unhandeled analysis type\");\n}\n\nfunction selectDataset(state: RootReducer, dataset: string) {\n    return state.datasets.byId[dataset];\n}\n\nfunction selectAnalysis(state: RootReducer, id: string) {\n    return state.analyses.byId[id];\n}\n\nfunction selectJob(state: RootReducer, id: string) {\n    return state.jobs.byId[id];\n}\n\n\nexport function* createAnalysisSaga(action: ReturnType<typeof analysisActions.Actions.create>) {\n    try {\n        const datasetState: DatasetState = yield select(selectDataset, action.payload.dataset)\n        if (datasetState.status !== DatasetStatus.OPEN) {\n            throw new Error(\"invalid dataset status\");\n        }\n        const analysis: AnalysisState = {\n            id: uuid(),\n            dataset: action.payload.dataset,\n            resultDetails: getAnalysisDetails(action.payload.analysisType, datasetState),\n            frameDetails: { type: AnalysisTypes.SUM_FRAMES, parameters: {} },\n            jobs: {},\n            jobHistory: {\n                FRAME: [],\n                RESULT: [],\n            }\n        }\n\n        const sidecarTask = yield fork(analysisSidecar, analysis.id);\n\n        yield put(analysisActions.Actions.created(analysis));\n        yield put(analysisActions.Actions.run(analysis.id, \"FRAME\"));\n\n        while (true) {\n            const removeAction: ReturnType<typeof analysisActions.Actions.remove> = yield take(analysisActions.ActionTypes.REMOVE);\n            if (removeAction.payload.id === analysis.id) {\n                yield cancel(sidecarTask);\n            }\n        }\n    } catch (e) {\n        const timestamp = Date.now();\n        const id = uuid();\n        yield put(analysisActions.Actions.error(`Error creating analysis: ${e.toString()}`, timestamp, id));\n    }\n}\n\nexport function* cancelOldJob(analysis: AnalysisState, kind: JobKind) {\n    const jobId = analysis.jobs[kind]\n    if (jobId === undefined) {\n        return;\n    } else {\n        const job: JobState = yield select(selectJob, jobId);\n        if (job.running !== \"DONE\") {\n            yield call(cancelJob, jobId);\n        }\n    }\n}\n\nexport function* analysisSidecar(analysisId: string) {\n    // channel for incoming actions:\n    // all actions that arrive while we block in `call` will be buffered here.\n    // because the buffer is sliding of size 1, we only keep the latest action!\n    const runOrParamsChannel = yield actionChannel(analysisActions.ActionTypes.RUN, buffers.sliding(1));\n\n    while (true) {\n        try {\n            const action: analysisActions.ActionParts[\"run\"] = yield take(runOrParamsChannel);\n\n            // ignore actions meant for other analyses\n            if (action.payload.id !== analysisId) {\n                continue;\n            }\n\n            // get the current state incl. configuration\n            const analysis: AnalysisState = yield select(selectAnalysis, analysisId);\n            const { kind } = action.payload;\n\n            // prepare running the job:\n            const jobId = uuid();\n            yield put(jobActions.Actions.create(jobId, analysis.dataset, Date.now()));\n            yield put(analysisActions.Actions.prepareRun(analysis.id, kind, jobId));\n\n            const oldJobId = analysis.jobs[kind];\n            if (oldJobId !== undefined) {\n                const job: JobState = yield select(selectJob, oldJobId);\n                if (job && job.running !== \"DONE\") {\n                    // wait until the job is cancelled:\n                    yield call(cancelJob, oldJobId);\n                }\n            }\n\n            // FIXME: we have a race here, as the websocket msg FINISH_JOB may\n            // arrive before call(startJob, ...) returns. this causes the apply button\n            // to feel unresponsive (the action gets done, but only after we finish here...)\n            // best reproduced in \"Slow 3G\" network simulation mode in devtools\n\n            // wait until the job is started\n            if (kind === \"FRAME\") {\n                yield call(startJob, jobId, analysis.dataset, analysis.frameDetails);\n            } else if (kind === \"RESULT\") {\n                yield call(startJob, jobId, analysis.dataset, analysis.resultDetails);\n            }\n            yield put(analysisActions.Actions.running(analysis.id, jobId, kind))\n        } catch (e) {\n            const timestamp = Date.now();\n            const id = uuid();\n            yield put(analysisActions.Actions.error(`Error running analysis: ${e.toString()}`, timestamp, id));\n        }\n    }\n}\n\nexport function* updateFrameViewMode(action: ReturnType<typeof analysisActions.Actions.setFrameViewMode>) {\n    yield put(analysisActions.Actions.run(action.payload.id, \"FRAME\"));\n}\n\nexport function* updateFrameViewParams(action: ReturnType<typeof analysisActions.Actions.updateParameters>) {\n    if (action.payload.kind === \"FRAME\") {\n        yield put(analysisActions.Actions.run(action.payload.id, \"FRAME\"));\n    }\n}\n\nexport function* doRemoveAnalysisSaga(action: ReturnType<typeof analysisActions.Actions.remove>) {\n    const analysis: AnalysisState = yield select(selectAnalysis, action.payload.id)\n    try {\n        yield call(cancelOldJob, analysis, \"RESULT\");\n        yield call(cancelOldJob, analysis, \"FRAME\");\n    } finally {\n        yield put(analysisActions.Actions.removed(action.payload.id));\n    }\n}\n\nexport function* analysisRootSaga() {\n    yield takeEvery(analysisActions.ActionTypes.CREATE, createAnalysisSaga);\n    yield takeEvery(analysisActions.ActionTypes.REMOVE, doRemoveAnalysisSaga);\n    yield takeEvery(analysisActions.ActionTypes.SET_FRAMEVIEW_MODE, updateFrameViewMode);\n    yield takeEvery(analysisActions.ActionTypes.UPDATE_PARAMETERS, updateFrameViewParams);\n}","import * as _ from 'lodash';\nimport { MsgPartConfig } from \"../messages\";\nimport { ConfigParams, ConfigState, LocalConfig } from \"./reducers\";\n\nconst CONFIG_KEY = \"LiberTEM.config\";\n\nexport function joinPaths(config: ConfigState, ...parts: string[]) {\n    const removeSep = (part: string) => part.replace(new RegExp(`${_.escapeRegExp(config.separator)}$`), \"\")\n    parts = [removeSep(parts[0]), ...parts.slice(1)];\n    return parts.map(part => part.trim()).join(config.separator);\n}\n\nexport function mergeLocalStorage(serverConfig: MsgPartConfig): ConfigParams {\n    const localSettings = window.localStorage.getItem(CONFIG_KEY);\n    if (localSettings === null) {\n        return Object.assign({}, serverConfig, getDefaultLocalConfig(serverConfig));\n    }\n    const localSettingsParsed = JSON.parse(localSettings);\n    const defaultConfig = getDefaultLocalConfig(serverConfig);\n    const mergedConfig = Object.assign({}, defaultConfig, serverConfig, localSettingsParsed);\n    return mergedConfig;\n}\n\nexport function setLocalStorage(config: ConfigState): void {\n    const keys: Array<Partial<keyof ConfigState>> = [\"cwd\", \"lastOpened\", \"fileHistory\"];\n    const localSettings = keys.reduce((acc, item) => {\n        acc[item] = config[item];\n        return acc;\n    }, {} as ConfigState);\n    window.localStorage.setItem(CONFIG_KEY, JSON.stringify(localSettings));\n}\n\nexport function clearLocalStorage(): void {\n    window.localStorage.removeItem(CONFIG_KEY);\n}\n\nexport function getDefaultLocalConfig(config: MsgPartConfig): LocalConfig {\n    return {\n        lastOpened: {},\n        fileHistory: [],\n    };\n}\n\nexport function makeUnique<T>(inp: T[]): T[] {\n    return inp.reduce((acc: T[], curr: T) => {\n        if (acc.indexOf(curr) === -1) {\n            return [...acc, curr];\n        } else {\n            return acc;\n        }\n    }, [] as T[]);\n}","import { DirectoryListingResponse } from \"../messages\";\n\nexport function getDirectoryListing(path: string): Promise<DirectoryListingResponse> {\n    const url = `/api/browse/localfs/?path=${path}`;\n    return fetch(url, {\n        method: 'GET',\n        credentials: \"same-origin\",\n    }).then(r => r.json());\n}","import { ActionsUnion, createAction } from '../helpers/actionHelpers';\nimport { JobResultType } from '../job/types';\nimport { MsgPartInitialDataset, MsgPartJob } from '../messages';\n\n\nexport type PartialResultType = JobResultType;\n\nexport enum ActionTypes {\n    INITIAL_STATE = 'CHANNEL_INITIAL_STATE',\n    JOB_STARTED = 'CHANNEL_JOB_STARTED',\n    FINISH_JOB = 'CHANNEL_FINISH_JOB',\n    TASK_RESULT = 'CHANNEL_TASK_RESULT',\n    JOB_ERROR = 'CHANNEL_JOB_ERROR',\n    OPEN = \"CHANNEL_OPEN\",\n    CLOSE = \"CHANNEL_CLOSE\",\n    ERROR = \"CHANNEL_ERROR\",\n}\n\nexport const Actions = {\n    initialState: (jobs: MsgPartJob[], datasets: MsgPartInitialDataset[], timestamp: number) => createAction(ActionTypes.INITIAL_STATE, { jobs, datasets, timestamp }),\n    jobStarted: (job: string, dataset: string, timestamp: number) => createAction(ActionTypes.JOB_STARTED, { job, timestamp, dataset }),\n    finishJob: (job: string, results: JobResultType[], timestamp: number) => createAction(ActionTypes.FINISH_JOB, { job, results, timestamp }),\n    taskResult: (job: string, results: PartialResultType[], timestamp: number) => createAction(ActionTypes.TASK_RESULT, { job, results, timestamp }),\n    jobError: (job: string, msg: string, id: string, timestamp: number) => createAction(ActionTypes.JOB_ERROR, { job, msg, id, timestamp }),\n    open: (timestamp: number) => createAction(ActionTypes.OPEN, { timestamp }),\n    close: (timestamp: number) => createAction(ActionTypes.CLOSE, { timestamp }),\n    error: (msg: string, timestamp: number, id: string) => createAction(ActionTypes.ERROR, { msg, timestamp, id }),\n}\n\nexport type Actions = ActionsUnion<typeof Actions>;","import { call, fork, put, select, take } from \"redux-saga/effects\";\nimport uuid from 'uuid/v4';\nimport { joinPaths } from \"../config/helpers\";\nimport { ConfigState } from \"../config/reducers\";\nimport { DirectoryListingResponse } from \"../messages\";\nimport { RootReducer } from \"../store\";\nimport * as browserActions from './actions';\nimport { getDirectoryListing } from \"./api\";\nimport { DirectoryBrowserState } from \"./types\";\n\nexport function* directoryListingSaga() {\n    yield fork(fetchOnRequest);\n    yield fork(fetchDirectoryListOnOpen);\n}\n\nfunction* fetchOnRequest() {\n    while (true) {\n        const action: ReturnType<typeof browserActions.Actions.list> = yield take(browserActions.ActionTypes.LIST_DIRECTORY);\n\n        const { name, path } = action.payload;\n        const config: ConfigState = yield select((state: RootReducer) => state.config)\n        const newPath = name !== undefined ? joinPaths(config, path, name) : path;\n        yield fork(fetchDirectoryListing, newPath);\n    }\n}\n\nfunction* fetchDirectoryListing(path: string) {\n    try {\n        const result: DirectoryListingResponse = yield call(getDirectoryListing, path);\n        if (result.status === \"ok\") {\n            yield put(browserActions.Actions.dirListing(result.path, result.dirs, result.files, result.drives, result.places));\n        } else if (result.status === \"error\") {\n            const browserState: DirectoryBrowserState = yield select((state: RootReducer) => state.browser);\n            const timestamp = Date.now();\n            const id = uuid();\n            const alternative = result.alternative ? result.alternative : browserState.places.home.path;\n            yield put(browserActions.Actions.error(`Error browsing directory: ${result.msg}`, timestamp, id));\n            yield put(browserActions.Actions.list(alternative));\n        }\n    } catch (e) {\n        const browserState: DirectoryBrowserState = yield select((state: RootReducer) => state.browser);\n        const timestamp = Date.now();\n        const id = uuid();\n        yield put(browserActions.Actions.error(`Error browsing directory: ${e.toString()}`, timestamp, id));\n        yield put(browserActions.Actions.list(browserState.places.home.path));\n    }\n}\n\nfunction* fetchDirectoryListOnOpen() {\n    while (true) {\n        yield take(browserActions.ActionTypes.OPEN);\n        const config: ConfigState = yield select((state: RootReducer) => state.config)\n        yield put(browserActions.Actions.list(config.cwd));\n    }\n}","import { ActionCreatorsMapObject } from \"redux\";\nimport { FollowupPart, MsgPartInitialDataset, MsgPartJob } from \"../messages\";\n\nexport interface Message<T extends string> {\n    messageType: T\n}\n\nexport function createMessage<T extends string, O>(messageType: T, attribs: O) {\n    return Object.assign({ messageType }, attribs);\n}\n\nexport enum MessageTypes {\n    INITIAL_STATE = \"INITIAL_STATE\",\n    JOB_STARTED = \"JOB_STARTED\",\n    FINISH_JOB = \"FINISH_JOB\",\n    TASK_RESULT = \"TASK_RESULT\",\n    JOB_ERROR = \"JOB_ERROR\",\n    BINARY = \"BINARY\",\n    OPEN = \"OPEN\",\n    CLOSE = \"CLOSE\",\n    ERROR = \"ERROR\",\n    DELETE_DATASET = \"DELETE_DATASET\"\n}\n\nexport const Messages = {\n    initialState: (jobs: MsgPartJob[], datasets: MsgPartInitialDataset[]) => createMessage(MessageTypes.INITIAL_STATE, { jobs, datasets }),\n    startJob: (job: string, dataset: string) => createMessage(MessageTypes.JOB_STARTED, { job, dataset }),\n    finishJob: (job: string, followup: FollowupPart) => createMessage(MessageTypes.FINISH_JOB, { job, followup }),\n    taskResult: (job: string, followup: FollowupPart) => createMessage(MessageTypes.TASK_RESULT, { job, followup }),\n    jobError: (job: string, msg: string) => createMessage(MessageTypes.JOB_ERROR, { job, msg }),\n    binary: (objectURL: string) => createMessage(MessageTypes.BINARY, { objectURL }),\n    open: () => createMessage(MessageTypes.OPEN, {}),\n    close: () => createMessage(MessageTypes.CLOSE, {}),\n    error: (msg: string) => createMessage(MessageTypes.ERROR, { msg }),\n    deleteDataset: (dataset: string) => createMessage(MessageTypes.DELETE_DATASET, { dataset }),\n}\n\nexport type MessagesUnion<A extends ActionCreatorsMapObject> = ReturnType<A[keyof A]>\nexport type Messages = MessagesUnion<typeof Messages>;\n\n// types of messages sent by the server:\n/*\nexport type InitialStateMessage = ReturnType<typeof Messages.initialState>;\nexport type StartJobMessage = ReturnType<typeof Messages.startJob>;\nexport type FinishJobMessage = ReturnType<typeof Messages.finishJob>;\nexport type TaskResultMessage = ReturnType<typeof Messages.taskResult>;\n*/\n\nexport type BinaryMessage = ReturnType<typeof Messages.binary>;","import { Channel, delay, END, eventChannel } from \"redux-saga\";\nimport { call, fork, put, take } from \"redux-saga/effects\";\nimport uuid from 'uuid/v4';\nimport * as datasetActions from '../dataset/actions';\nimport * as channelActions from \"./actions\";\nimport * as channelMessages from './messages';\n\ntype SocketChannel = Channel<channelMessages.Messages>;\n\n\n/**\n * create typesafe messages from the websocket messages\n * \n * also creates some synthetic events like open, close, error\n */\nfunction createWebSocketChannel(/* addr */): SocketChannel {\n    return eventChannel(emit => {\n        function onMessage(msg: MessageEvent) {\n            if (msg.data instanceof Blob) {\n                // TODO: cleanup createObjectURL results somewhere\n                emit(channelMessages.Messages.binary(URL.createObjectURL(msg.data)));\n            } else {\n                const parsed = JSON.parse(msg.data) as channelMessages.Messages;\n                emit(parsed);\n            }\n        }\n\n        function onOpen() {\n            emit(channelMessages.Messages.open());\n        }\n\n        function onClose() {\n            emit(channelMessages.Messages.close());\n            emit(END);\n        }\n\n        function onError(err: Event) {\n            emit(channelMessages.Messages.error(\"Error in weboscket connection\"));\n        }\n\n        const ws = new WebSocket(`ws://${window.location.hostname}:${window.location.port}/api/events/`);\n        ws.addEventListener(\"message\", onMessage);\n        ws.addEventListener(\"open\", onOpen);\n        ws.addEventListener(\"close\", onClose);\n        ws.addEventListener(\"error\", onError);\n\n        // return cleanup function:\n        return () => {\n            ws.removeEventListener(\"message\", onMessage);\n            ws.removeEventListener(\"open\", onOpen);\n            ws.removeEventListener(\"close\", onClose);\n            ws.removeEventListener(\"error\", onError);\n            // TODO: close connection if still open\n            // (or is it guaranteed that if an error was thrown, the connection is closed?)\n        };\n    });\n}\n\n/**\n * handles the connection lifecycle for our websocket\n */\nexport function* webSocketSaga() {\n    while (true) {\n        const socketChannel = yield call(createWebSocketChannel);\n        yield fork(actionsFromChannel, socketChannel);\n        const action: channelActions.Actions = yield take([\n            channelActions.ActionTypes.OPEN,\n            channelActions.ActionTypes.CLOSE,\n        ]);\n        if (action.type === channelActions.ActionTypes.OPEN) {\n            yield take([\n                channelActions.ActionTypes.CLOSE,\n                channelActions.ActionTypes.ERROR,\n            ]);\n        }\n        yield delay(1000);\n    }\n}\n\n/**\n * translates the messages from the channel to redux actions, handles aggregation etc.\n */\nexport function* actionsFromChannel(socketChannel: SocketChannel) {\n    try {\n        while (true) {\n            const msg = yield take(socketChannel);\n            const timestamp = Date.now();\n            switch (msg.messageType) {\n                case channelMessages.MessageTypes.OPEN: {\n                    yield put(channelActions.Actions.open(timestamp));\n                    break;\n                }\n                case channelMessages.MessageTypes.CLOSE: {\n                    yield put(channelActions.Actions.close(timestamp));\n                    break;\n                }\n                case channelMessages.MessageTypes.ERROR: {\n                    const id = uuid();\n                    yield put(channelActions.Actions.error(msg.msg, timestamp, id));\n                    break;\n                }\n                case channelMessages.MessageTypes.INITIAL_STATE: {\n                    yield put(channelActions.Actions.initialState(msg.jobs, msg.datasets, timestamp));\n                    break;\n                }\n                case channelMessages.MessageTypes.JOB_STARTED: {\n                    yield put(channelActions.Actions.jobStarted(msg.job, msg.details.dataset, timestamp));\n                    break;\n                }\n                case channelMessages.MessageTypes.FINISH_JOB: {\n                    yield call(handleFinishJob, msg, socketChannel, timestamp);\n                    break;\n                }\n                case channelMessages.MessageTypes.TASK_RESULT: {\n                    yield call(handleTaskResult, msg, socketChannel, timestamp);\n                    break;\n                }\n                case channelMessages.MessageTypes.DELETE_DATASET: {\n                    yield put(datasetActions.Actions.deleted(msg.dataset));\n                    break;\n                }\n                case channelMessages.MessageTypes.JOB_ERROR: {\n                    const id = uuid();\n                    yield put(channelActions.Actions.jobError(msg.job, msg.msg, id, timestamp));\n                }\n            }\n        }\n    } finally {\n        // disconnected\n    }\n}\n\nexport function* handleBinaryParts(numParts: number, socketChannel: SocketChannel) {\n    const parts: channelMessages.BinaryMessage[] = [];\n    while (parts.length < numParts) {\n        const binMsg = yield take(socketChannel)\n        parts.push(binMsg);\n    }\n    return parts;\n}\n\nexport function* handleTaskResult(msg: ReturnType<typeof channelMessages.Messages.taskResult>, socketChannel: SocketChannel, timestamp: number) {\n    const parts: channelMessages.BinaryMessage[] = yield call(handleBinaryParts, msg.followup.numMessages, socketChannel);\n    const images = parts.map((part, idx) => ({ imageURL: part.objectURL, description: msg.followup.descriptions[idx] }));\n    yield put(channelActions.Actions.taskResult(msg.job, images, timestamp));\n}\n\nexport function* handleFinishJob(msg: ReturnType<typeof channelMessages.Messages.finishJob>, socketChannel: SocketChannel, timestamp: number) {\n    const parts: channelMessages.BinaryMessage[] = yield call(handleBinaryParts, msg.followup.numMessages, socketChannel);\n    const images = parts.map((part, idx) => ({ imageURL: part.objectURL, description: msg.followup.descriptions[idx] }));\n    yield put(channelActions.Actions.finishJob(msg.job, images, timestamp));\n}","import { ConnectRequest, ConnectRequestParams, ConnectResponse } from \"../messages\";\n\nexport function connectToCluster(params: ConnectRequestParams): Promise<ConnectResponse> {\n    const payload: ConnectRequest = {\n        connection: params\n    }\n    return fetch(`/api/config/connection/`, {\n        body: JSON.stringify(payload),\n        credentials: \"same-origin\",\n        method: \"PUT\",\n    }).then(r => r.json());\n}\n\nexport function checkClusterConnection(): Promise<ConnectResponse> {\n    return fetch(`/api/config/connection/`, {\n        method: 'GET',\n    }).then(r => r.json());\n}","import { ActionsUnion, createAction } from \"../helpers/actionHelpers\";\nimport { ConfigParams } from \"./reducers\";\n\nexport enum ActionTypes {\n    FETCHED = \"CONFIG_FETCHED\",\n    FETCH = \"CONFIG_FETCH\",\n    FETCH_FAILED = \"CONFIG_FETCH_FAILED\",\n}\n\nexport const Actions = {\n    fetch: () => createAction(ActionTypes.FETCH),\n    fetched: (config: ConfigParams) => createAction(ActionTypes.FETCHED, { config }),\n    fetchFailed: (msg: string, timestamp: number, id: string) => createAction(ActionTypes.FETCH_FAILED, { msg, timestamp, id }),\n}\n\nexport type Actions = ActionsUnion<typeof Actions>;","import { all, call, put, take, takeEvery } from \"redux-saga/effects\";\nimport * as channelActions from '../channel/actions';\nimport { ConnectResponse } from \"../messages\";\nimport * as clusterActions from './actions';\nimport { checkClusterConnection, connectToCluster } from \"./api\";\n\nfunction* connectSaga(action: ReturnType<typeof clusterActions.Actions.connect>) {\n    const conn: ConnectResponse = yield call(connectToCluster, action.payload.params);\n    yield call(putClusterStatus, conn);\n}\n\nfunction* putClusterStatus(conn: ConnectResponse) {\n    if (conn.status === \"ok\") {\n        yield put(clusterActions.Actions.connected(conn.connection.connection));\n    } else {\n        yield put(clusterActions.Actions.notConnected());\n    }\n}\n\n/**\n * when the channel is connected, check if cluster is connected and update status accordingly\n */\nfunction* trackClusterConnection() {\n    while (true) {\n        yield take(channelActions.ActionTypes.OPEN)\n        const conn: ConnectResponse = yield call(checkClusterConnection);\n        yield call(putClusterStatus, conn);\n    }\n}\n\nexport function* clusterConnectionSaga() {\n    yield takeEvery(clusterActions.ActionTypes.CONNECT, connectSaga);\n    yield all([\n        trackClusterConnection(),\n    ])\n}","import { GetConfigResponse } from \"../messages\";\n\nexport function getConfig(): Promise<GetConfigResponse> {\n    return fetch(`/api/config/`, {\n        method: \"GET\",\n        credentials: \"same-origin\",\n    }).then(r => r.json());\n}","import { call, fork, put, select, take, takeEvery } from 'redux-saga/effects';\nimport uuid from 'uuid/v4';\nimport * as browserActions from '../browser/actions';\nimport * as channelActions from '../channel/actions';\nimport * as datasetActions from '../dataset/actions';\nimport { GetConfigResponse } from '../messages';\nimport { RootReducer } from '../store';\nimport * as configActions from './actions';\nimport { getConfig } from './api';\nimport { clearLocalStorage, getDefaultLocalConfig, mergeLocalStorage, setLocalStorage } from './helpers';\nimport { ConfigState } from './reducers';\n\nfunction* getConfigOnReconnect() {\n    yield takeEvery(channelActions.ActionTypes.OPEN, getConfigSaga);\n}\n\n/**\n * get config from server and try to merge in the localStorage config\n */\nfunction* getConfigSaga() {\n    yield put(configActions.Actions.fetch());\n    const configResponse: GetConfigResponse = yield call(getConfig);\n    try {\n        const mergedConfig = mergeLocalStorage(configResponse.config);\n        yield put(configActions.Actions.fetched(mergedConfig));\n    } catch (e) {\n        try {\n            clearLocalStorage();\n            // tslint:disable-next-line:no-empty\n        } catch (e) { }\n        const defaultConfig = Object.assign({}, configResponse.config, getDefaultLocalConfig(configResponse.config));\n        yield put(configActions.Actions.fetched(defaultConfig));\n    }\n}\n\n/**\n * update localStorage config on opening files or using the file browser\n */\nfunction* updateLocalStorageConfig() {\n    while (true) {\n        yield take([\n            datasetActions.ActionTypes.CREATE,\n            browserActions.ActionTypes.DIRECTORY_LISTING\n        ]);\n        const config: ConfigState = yield select((state: RootReducer) => state.config);\n        setLocalStorage(config);\n    }\n}\n\nexport function* firstConfigFetch() {\n    try {\n        yield call(getConfigSaga);\n    } catch (e) {\n        const timestamp = Date.now();\n        const id = uuid();\n        yield put(configActions.Actions.fetchFailed(`failed to fetch config: ${e.toString()}`, timestamp, id));\n    }\n}\n\nexport function* configRootSaga() {\n    yield fork(firstConfigFetch);\n    yield fork(getConfigOnReconnect);\n    yield fork(updateLocalStorageConfig);\n}","import { DeleteDatasetResponse, DetectDatasetResponse, OpenDatasetRequest, OpenDatasetResponse } from \"../messages\";\n\nexport function openDataset(id: string, dataset: OpenDatasetRequest): Promise<OpenDatasetResponse> {\n    return fetch(`/api/datasets/${id}/`, {\n        body: JSON.stringify(dataset),\n        credentials: \"same-origin\",\n        method: \"PUT\",\n    }).then(r => r.json());\n}\n\nexport function deleteDataset(id: string): Promise<DeleteDatasetResponse> {\n    return fetch(`/api/datasets/${id}/`, {\n        credentials: \"same-origin\",\n        method: \"DELETE\",\n    }).then(r => r.json());\n}\n\n\nexport function detectDataset(path: string): Promise<DetectDatasetResponse> {\n    return fetch(`/api/datasets/detect/?path=${path}`, {\n        credentials: \"same-origin\",\n        method: \"GET\",\n    }).then(r => r.json());\n}","import { call, put, select, takeEvery } from 'redux-saga/effects';\nimport uuid from 'uuid/v4';\nimport * as browserActions from '../browser/actions';\nimport { joinPaths } from '../config/helpers';\nimport { ConfigState } from '../config/reducers';\nimport { DetectDatasetResponse, OpenDatasetResponse } from '../messages';\nimport { RootReducer } from '../store';\nimport * as datasetActions from \"./actions\";\nimport { deleteDataset, detectDataset, openDataset } from './api';\n\n\nexport function* createDatasetSaga(action: ReturnType<typeof datasetActions.Actions.create>) {\n    try {\n        const resp: OpenDatasetResponse = yield call(openDataset, action.payload.dataset.id, { dataset: action.payload.dataset });\n        if (resp.status === \"ok\") {\n            yield put(datasetActions.Actions.created(resp.details));\n        } else if (resp.status === \"error\") {\n            const timestamp = Date.now();\n            const id = uuid();\n            yield put(datasetActions.Actions.error(resp.dataset, resp.msg, timestamp, id));\n        }\n    } catch (e) {\n        const timestamp = Date.now();\n        const id = uuid();\n        yield put(datasetActions.Actions.error(action.payload.dataset.id, `Error loading dataset: ${e.toString()}`, timestamp, id));\n    }\n}\n\nexport function* deleteDatasetSaga(action: ReturnType<typeof datasetActions.Actions.delete>) {\n    try {\n        yield call(deleteDataset, action.payload.dataset);\n    } catch (e) {\n        const timestamp = Date.now();\n        const id = uuid();\n        yield put(datasetActions.Actions.error(action.payload.dataset, `Error closing dataset: ${e.toString()}`, timestamp, id));\n    }\n}\n\nexport function* doOpenDataset(fullPath: string) {\n    const config: ConfigState = yield select((state: RootReducer) => state.config);\n    let prefillParams = config.lastOpened[fullPath];\n    if (!prefillParams) {\n        try {\n            yield put(datasetActions.Actions.detect(fullPath));\n            const detectResult: DetectDatasetResponse = yield call(detectDataset, fullPath);\n            if (detectResult.status === \"ok\") {\n                prefillParams = detectResult.datasetParams;\n                yield put(datasetActions.Actions.detected(fullPath, detectResult.datasetParams));\n            } else {\n                yield put(datasetActions.Actions.detectFailed(fullPath));\n            }\n        } catch (e) {\n            yield put(datasetActions.Actions.detectFailed(fullPath));\n        }\n    }\n    yield put(datasetActions.Actions.open(fullPath, prefillParams));\n}\n\nexport function* openDatasetSagaFullPath(action: ReturnType<typeof browserActions.Actions.selectFullPath>) {\n    const fullPath = action.payload.path;\n    yield call(doOpenDataset, fullPath);\n}\n\nexport function* openDatasetSaga(action: ReturnType<typeof browserActions.Actions.select>) {\n    const config: ConfigState = yield select((state: RootReducer) => state.config);\n    const fullPath = joinPaths(config, action.payload.path, action.payload.name);\n    yield call(doOpenDataset, fullPath);\n}\n\nexport function* datasetRootSaga() {\n    yield takeEvery(datasetActions.ActionTypes.CREATE, createDatasetSaga);\n    yield takeEvery(datasetActions.ActionTypes.DELETE, deleteDatasetSaga);\n    yield takeEvery(browserActions.ActionTypes.SELECT, openDatasetSaga);\n    yield takeEvery(browserActions.ActionTypes.SELECT_FULL_PATH, openDatasetSagaFullPath);\n}","import { all } from 'redux-saga/effects';\nimport { analysisRootSaga } from './analysis/sagas';\nimport { directoryListingSaga } from './browser/sagas';\nimport { webSocketSaga } from './channel/sagas';\nimport { clusterConnectionSaga } from './cluster/sagas';\nimport { configRootSaga } from './config/sagas';\nimport { datasetRootSaga } from './dataset/sagas';\n\nexport function* rootSaga() {\n    yield all([\n        configRootSaga(),\n        webSocketSaga(),\n        analysisRootSaga(),\n        datasetRootSaga(),\n        clusterConnectionSaga(),\n        directoryListingSaga(),\n    ]);\n}","import { AllActions } from \"../actions\";\nimport * as datasetActions from \"../dataset/actions\";\nimport { ById, filterWithPred, insertById, updateById } from \"../helpers/reducerHelpers\";\nimport * as analysisActions from \"./actions\";\nimport { Analysis, AnalysisState, FrameAnalysisDetails, JobList } from \"./types\";\n\nexport type AnalysisReducerState = ById<AnalysisState>;\n\nconst initialAnalysisState: AnalysisReducerState = {\n    byId: {},\n    ids: [],\n}\n\nexport function analysisReducer(state = initialAnalysisState, action: AllActions): AnalysisReducerState {\n    switch (action.type) {\n        case analysisActions.ActionTypes.CREATED: {\n            return insertById(state, action.payload.analysis.id, action.payload.analysis);\n        }\n        case analysisActions.ActionTypes.UPDATE_PARAMETERS: {\n            const key: keyof Analysis = action.payload.kind === \"FRAME\" ? \"frameDetails\" : \"resultDetails\";\n            const details = state.byId[action.payload.id][key];\n            const newDetails = Object.assign({}, details, {\n                parameters: Object.assign({}, details.parameters, action.payload.parameters),\n            })\n            // TODO: convince typescript that `[key]: newDetails` is a better way...\n            if (action.payload.kind === \"FRAME\") {\n                return updateById(state, action.payload.id, {\n                    frameDetails: newDetails as FrameAnalysisDetails,\n                });\n            } else {\n                return updateById(state, action.payload.id, {\n                    resultDetails: newDetails,\n                });\n            }\n        }\n        case analysisActions.ActionTypes.PREPARE_RUN: {\n            const { kind, id } = action.payload;\n            const analysis = state.byId[id];\n            const oldJob = analysis.jobs[kind];\n            let jobHistory = analysis.jobHistory;\n            if (oldJob !== undefined) {\n                // TODO: length restriction?\n                jobHistory = Object.assign({}, jobHistory, {\n                    [kind]: [oldJob, ...jobHistory[kind]],\n                });\n            }\n            const newJobs: JobList = Object.assign({}, analysis.jobs, {\n                [action.payload.kind]: action.payload.job,\n            });\n            return updateById(state, action.payload.id, { jobs: newJobs, jobHistory })\n        }\n        case analysisActions.ActionTypes.REMOVED: {\n            return filterWithPred(state, (r: AnalysisState) => r.id !== action.payload.id);\n        }\n        case analysisActions.ActionTypes.SET_FRAMEVIEW_MODE: {\n            const newFrameDetails = Object.assign({}, state.byId[action.payload.id].frameDetails, {\n                type: action.payload.mode,\n                parameters: action.payload.initialParams,\n            });\n            return updateById(state, action.payload.id, { frameDetails: newFrameDetails });\n        }\n        case datasetActions.ActionTypes.DELETE: {\n            return filterWithPred(state, (r: AnalysisState) => r.dataset !== action.payload.dataset);\n        }\n    }\n    return state;\n}","import { AllActions } from \"../actions\";\nimport * as configActions from '../config/actions';\nimport { DirectoryListingDetails, FSPlace } from \"../messages\";\nimport * as browserActions from './actions';\nimport { DirectoryBrowserState } from \"./types\";\n\nconst initialBrowserState: DirectoryBrowserState = {\n    isOpen: false,\n    isLoading: true,\n    path: \"/\",\n    drives: [],\n    places: {},\n    files: [] as DirectoryListingDetails[],\n    dirs: [] as DirectoryListingDetails[],\n}\n\nexport function directoryBrowserReducer(state: DirectoryBrowserState = initialBrowserState, action: AllActions): DirectoryBrowserState {\n    switch (action.type) {\n        case configActions.ActionTypes.FETCHED: {\n            return Object.assign({}, state, {\n                path: action.payload.config.cwd,\n            })\n            break;\n        }\n        case browserActions.ActionTypes.OPEN: {\n            return Object.assign({}, state, {\n                isOpen: true,\n            })\n            break;\n        }\n        case browserActions.ActionTypes.CANCEL: {\n            return Object.assign({}, state, {\n                isOpen: false,\n            })\n            break;\n        }\n        case browserActions.ActionTypes.LIST_DIRECTORY: {\n            return Object.assign({}, state, {\n                isLoading: true,\n            })\n            break;\n        }\n        case browserActions.ActionTypes.DIRECTORY_LISTING: {\n            const places = action.payload.places.reduce((acc, place: FSPlace) => {\n                return Object.assign({}, acc, {\n                    [place.key]: place,\n                })\n            }, {});\n            return Object.assign({}, state, {\n                isLoading: false,\n                path: action.payload.path,\n                files: action.payload.files,\n                dirs: action.payload.dirs,\n                drives: action.payload.drives,\n                places,\n            })\n            break;\n        }\n        case browserActions.ActionTypes.SELECT_FULL_PATH:\n        case browserActions.ActionTypes.SELECT: {\n            return Object.assign({}, state, {\n                isLoading: false,\n                isOpen: false,\n            });\n        }\n    }\n    return state;\n}","import { AllActions } from \"../actions\";\nimport * as channelActions from './actions';\n\nexport interface ChannelStatusReducer {\n    status: ChannelStatusCodes,\n}\n\nexport enum ChannelStatusCodes {\n    CONNECTING = \"connecting\",\n    CONNECTED = \"connected\",\n    READY = \"ready\",\n    WAITING = \"waiting\",\n}\n\nconst initialChannelState: ChannelStatusReducer = {\n    status: ChannelStatusCodes.WAITING,\n}\n\nexport function channelStatusReducer(state = initialChannelState, action: AllActions): ChannelStatusReducer {\n    switch (action.type) {\n        case channelActions.ActionTypes.OPEN: {\n            return { status: ChannelStatusCodes.CONNECTED };\n        }\n        case channelActions.ActionTypes.INITIAL_STATE: {\n            return { status: ChannelStatusCodes.READY };\n        }\n        case channelActions.ActionTypes.CLOSE: {\n            return { status: ChannelStatusCodes.WAITING };\n        }\n    }\n    return state;\n}","import { AllActions } from \"../actions\";\nimport { ConnectRequestParams } from \"../messages\";\nimport * as clusterActions from './actions';\n\nexport type ClusterConnectionState = {\n    status: \"connected\",\n    params: ConnectRequestParams,\n} | {\n    status: \"disconnected\",\n} | {\n    status: \"unknown\",\n}\n\nconst initialClusterConnectionState: ClusterConnectionState = {\n    status: \"unknown\"\n}\n\nexport function clusterConnectionReducer(state = initialClusterConnectionState, action: AllActions): ClusterConnectionState {\n    switch (action.type) {\n        case clusterActions.ActionTypes.NOT_CONNECTED: {\n            return {\n                status: \"disconnected\"\n            };\n        }\n        case clusterActions.ActionTypes.CONNECTED: {\n            return {\n                status: \"connected\",\n                params: action.payload.params,\n            }\n        }\n    }\n    return state;\n}","import { AllActions } from \"../actions\";\nimport * as browserActions from '../browser/actions';\nimport * as datasetActions from '../dataset/actions';\nimport { DatasetFormParams, MsgPartConfig } from \"../messages\";\nimport * as configActions from './actions';\nimport { makeUnique } from \"./helpers\";\n\nexport interface LocalConfig {\n    fileHistory: string[],\n    lastOpened: {\n        [path: string]: DatasetFormParams\n    }\n}\n\nexport interface ConfigMeta {\n    haveConfig: boolean,\n}\n\nexport type ConfigParams = MsgPartConfig & LocalConfig;\nexport type ConfigState = ConfigParams & ConfigMeta;\n\nconst initialConfigState: ConfigState = {\n    version: \"\",\n    revision: \"\",\n    localCores: 0,\n    cwd: \"/\",\n    separator: \"/\",\n    lastOpened: {},\n    fileHistory: [],\n    haveConfig: false,\n}\n\nexport function configReducer(state = initialConfigState, action: AllActions): ConfigState {\n    switch (action.type) {\n        case configActions.ActionTypes.FETCHED: {\n            return Object.assign({}, action.payload.config, { haveConfig: true });\n        }\n        case browserActions.ActionTypes.DIRECTORY_LISTING: {\n            return Object.assign({}, state, {\n                cwd: action.payload.path,\n            });\n        }\n        case datasetActions.ActionTypes.CREATE: {\n            const newLastOpened = Object.assign({}, state.lastOpened, { [action.payload.dataset.params.path]: action.payload.dataset.params });\n            const newFileHistory = makeUnique([\n                action.payload.dataset.params.path, ...state.fileHistory\n            ]).slice(0, 11);\n            return Object.assign({}, state, {\n                lastOpened: newLastOpened,\n                fileHistory: newFileHistory,\n            });\n        }\n    }\n    return state;\n}","import { AllActions } from \"../actions\";\nimport * as channelActions from '../channel/actions';\nimport { constructById, filterWithPred, insertById, updateById } from \"../helpers/reducerHelpers\";\nimport { Dataset, DatasetState, DatasetStatus } from \"../messages\";\nimport * as datasetActions from './actions';\nimport { DatasetsState, OpenDatasetState } from \"./types\";\n\nconst initialDatasetState: DatasetsState = {\n    byId: {},\n    ids: [],\n};\n\nexport function datasetReducer(state = initialDatasetState, action: AllActions): DatasetsState {\n    switch (action.type) {\n        case channelActions.ActionTypes.INITIAL_STATE: {\n            const datasets = action.payload.datasets.map(ds => Object.assign({}, ds, { status: DatasetStatus.OPEN }));\n            return {\n                byId: constructById(datasets, ds => ds.id),\n                ids: datasets.map(ds => ds.id),\n            }\n        }\n        case datasetActions.ActionTypes.CREATE: {\n            const ds: Dataset = {\n                ...action.payload.dataset,\n                status: DatasetStatus.OPENING\n            };\n            return insertById(state, action.payload.dataset.id, ds);\n        }\n        case datasetActions.ActionTypes.CREATED: {\n            const ds = Object.assign({}, action.payload.dataset, { status: DatasetStatus.OPEN });\n            return updateById(state, action.payload.dataset.id, ds);\n        }\n        case datasetActions.ActionTypes.ERROR: {\n            return filterWithPred(state, (r: DatasetState) => r.id !== action.payload.dataset);\n        }\n        case datasetActions.ActionTypes.DELETE: {\n            return updateById(state, action.payload.dataset, { status: DatasetStatus.DELETING });\n        }\n        case datasetActions.ActionTypes.DELETED: {\n            return filterWithPred(state, (r: DatasetState) => r.id !== action.payload.dataset);\n        }\n    }\n    return state;\n}\n\nconst initialOpenDatasetState: OpenDatasetState = {\n    busy: false,\n    busyPath: \"\",\n    formVisible: false,\n    formPath: \"/\",\n    formInitialParams: undefined,\n}\n\nexport function openDatasetReducer(state = initialOpenDatasetState, action: AllActions): OpenDatasetState {\n    switch (action.type) {\n        case datasetActions.ActionTypes.OPEN: {\n            return {\n                ...state,\n                formVisible: true,\n                formPath: action.payload.path,\n                formInitialParams: action.payload.initialParams,\n            };\n        }\n        case datasetActions.ActionTypes.CANCEL_OPEN: {\n            return {\n                ...state,\n                formVisible: false,\n            }\n        }\n        case datasetActions.ActionTypes.CREATE: {\n            return {\n                ...state,\n                formVisible: false,\n            }\n        }\n        case datasetActions.ActionTypes.DETECT: {\n            return {\n                ...state,\n                busyPath: action.payload.path,\n                busy: true,\n            }\n        }\n        case datasetActions.ActionTypes.DETECTED:\n        case datasetActions.ActionTypes.DETECT_FAILED: {\n            return {\n                ...state,\n                busyPath: \"\",\n                busy: false,\n            }\n        }\n    }\n    return state;\n}","import { AllActions } from \"../actions\";\nimport * as analysisActions from '../analysis/actions';\nimport * as browserActions from '../browser/actions';\nimport * as channelActions from '../channel/actions';\nimport * as datasetActions from '../dataset/actions';\nimport { ById, filterWithPred, insertById } from \"../helpers/reducerHelpers\";\nimport * as errorActions from './actions';\n\nexport interface ErrorMessage {\n    id: string,\n    msg: string,\n    timestamp: number,\n}\n\nexport type ErrorState = ById<ErrorMessage>;\n\nconst initialErrorState: ErrorState = {\n    byId: {},\n    ids: [],\n};\n\nexport function errorReducer(state = initialErrorState, action: AllActions): ErrorState {\n    switch (action.type) {\n        case browserActions.ActionTypes.ERROR:\n        case datasetActions.ActionTypes.ERROR:\n        case channelActions.ActionTypes.ERROR:\n        case analysisActions.ActionTypes.ERROR:\n        case channelActions.ActionTypes.JOB_ERROR: {\n            return insertById(state, action.payload.id, {\n                id: action.payload.id,\n                msg: action.payload.msg,\n                timestamp: action.payload.timestamp,\n            });\n        }\n        case channelActions.ActionTypes.OPEN: {\n            return initialErrorState;\n        }\n        case errorActions.ActionTypes.DISMISS: {\n            return filterWithPred(state, (r: ErrorMessage) => r.id !== action.payload.id);\n        }\n    }\n    return state;\n}","import { AllActions } from \"../actions\";\nimport * as channelActions from '../channel/actions';\nimport { ById, insertById, updateById } from \"../helpers/reducerHelpers\";\nimport * as jobActions from './actions';\nimport { JobRunning, JobState, JobStatus } from \"./types\";\n\nexport type JobReducerState = ById<JobState>;\n\nconst initialJobState: JobReducerState = {\n    byId: {},\n    ids: [],\n};\n\nexport function jobReducer(state = initialJobState, action: AllActions): JobReducerState {\n    switch (action.type) {\n        case jobActions.ActionTypes.CREATE: {\n            const createResult = insertById(\n                state,\n                action.payload.id,\n                {\n                    id: action.payload.id,\n                    dataset: action.payload.dataset,\n                    running: JobRunning.CREATING,\n                    status: JobStatus.CREATING,\n                    results: [],\n                    startTimestamp: action.payload.timestamp,\n                }\n            )\n            return createResult;\n        }\n        case channelActions.ActionTypes.JOB_STARTED: {\n            return updateById(\n                state,\n                action.payload.job,\n                {\n                    running: JobRunning.RUNNING,\n                    status: JobStatus.IN_PROGRESS,\n                    startTimestamp: action.payload.timestamp,\n                }\n            )\n        }\n        case channelActions.ActionTypes.TASK_RESULT: {\n            return updateById(\n                state,\n                action.payload.job,\n                {\n                    results: action.payload.results,\n                }\n            );\n        }\n        case channelActions.ActionTypes.FINISH_JOB: {\n            const { job, timestamp, results } = action.payload;\n            return updateById(\n                state,\n                job,\n                {\n                    running: JobRunning.DONE,\n                    status: JobStatus.SUCCESS,\n                    results,\n                    endTimestamp: timestamp,\n                }\n            );\n        }\n        case channelActions.ActionTypes.JOB_ERROR: {\n            const { job, timestamp } = action.payload;\n            return updateById(\n                state,\n                job,\n                {\n                    running: JobRunning.DONE,\n                    status: JobStatus.ERROR,\n                    endTimestamp: timestamp,\n                }\n            )\n        }\n    }\n    return state;\n}","import { combineReducers } from \"redux\";\nimport { analysisReducer } from \"./analysis/reducers\";\nimport { directoryBrowserReducer } from './browser/reducers';\nimport { channelStatusReducer } from \"./channel/reducers\";\nimport { clusterConnectionReducer } from \"./cluster/reducers\";\nimport { configReducer } from \"./config/reducers\";\nimport { datasetReducer, openDatasetReducer } from \"./dataset/reducers\";\nimport { errorReducer } from \"./errors/reducers\";\nimport { jobReducer } from \"./job/reducers\";\n\nexport const rootReducer = combineReducers({\n    analyses: analysisReducer,\n    channelStatus: channelStatusReducer,\n    clusterConnection: clusterConnectionReducer,\n    datasets: datasetReducer,\n    openDataset: openDatasetReducer,\n    jobs: jobReducer,\n    errors: errorReducer,\n    config: configReducer,\n    browser: directoryBrowserReducer,\n})\n\nexport type RootReducer = ReturnType<typeof rootReducer>;","// tslint:disable:ordered-imports\nimport \"core-js/fn/symbol/iterator.js\";\nimport \"core-js/es6/symbol.js\";\nimport 'react-app-polyfill/ie11';\n// tslint:enable:ordered-imports\n\nimport * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\nimport { applyMiddleware, compose, createStore } from 'redux';\nimport createSagaMiddleware from 'redux-saga';\nimport App from './App';\nimport registerServiceWorker from './registerServiceWorker';\nimport { rootSaga } from './sagas';\nimport { rootReducer } from './store';\n\nconst sagaMiddleware = createSagaMiddleware();\n\nconst composeEnhancers = (window as any).__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\n\nconst store = createStore(rootReducer, composeEnhancers(\n    applyMiddleware(\n        sagaMiddleware,\n    )\n));\n\nReactDOM.render(\n    <Provider store={store}>\n        <App />\n    </Provider>,\n    document.getElementById('root') as HTMLElement\n);\nregisterServiceWorker();\n\nsagaMiddleware.run(rootSaga);"],"sourceRoot":""}