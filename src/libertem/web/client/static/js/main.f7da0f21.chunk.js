(this["webpackJsonplibertem-client"]=this["webpackJsonplibertem-client"]||[]).push([[0],{234:function(e,t,n){e.exports={default:"ResultImage_default__1X7FO",fallback:"ResultImage_fallback__kO3cw"}},366:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAjVBMVEX///8AAAB2dnb8/Pz19fXt7e3j4+P4+Pj09PTg4ODT09O1tbXo6Ojw8PDMzMxycnJRUVF9fX2EhITIyMiqqqrCwsJXV1c9PT1fX1+Pj4+hoaHY2NgoKCgxMTFHR0ciIiKZmZkUFBRnZ2evr686OjobGxtCQkILCwuJiYksLCyTk5NKSkokJCQcHBxjY2PU34P+AAAMC0lEQVR4nO1d6WKyOhAtIiKLAgIWd0CrVtu+/+PdWpeiTGYCBEK/6/nbGjmSZZYzk5eXJ5544oknnnjiiSeeuIfa7ff7XVX2Y4iGavjr6WTkdRwn/TohdZyON5pM177x58na1iR1t5v3VaLkkXy+b7Zuurd6sh+zHHR/f4R4QUiWo1CX/cBF0NeGo3dOcr+Yj4Za/y/MWtu00l1hemfsvtamLZsADtsPorL0LogCv7Uk1eHUmVej94MPZzps42zVg85WAL0ztp2gbTuPFh8/hfE74e140GSTysD2VkLpnbHyWrIgdcOpgd4ZqSF/suqGVxu/EzzJHNXZ4a1Wgt/2zmEmcWPtxeK2Tza2sTTDNRg3wO+EcSCFnxHVPUF/8RYZzROMRZgv/JjHDfMzj43yO2FpNshvME0aJ/jteUwHTRE0OxL4neA09BqtjSSCirKxGuA3iBNpBL/P/7j2mVqjEcoHp+ZzQ8Ie+oh699RQNr0fhLXxUwPZ3C4IarLFu7FsZjfE3ToIahPZvDKY1BDisOv1dItCfITD7lSMgwrGriOYoibLUGOjI3Si9mWf8xCcvjiC3TYS/KYobEdVRzJ5JO+vy+NxAf1pJOhcVMFzcO6O3eUiqZWcslt2DoE1nBmzMP4C/h6LoRjkd9HPdBp+f63pW+v4q7Zwhhtb5u9a6wGb3U5IiMrKM9j69u3HU20z3NfhMY4es/wasBvMBTiMw/zTfzxa9117KPg0SeJefqccRPl/fB1WJdgDYqIp8H+qHotLPr1N4YPAAuKX44rh4gH0bljeSzgWEkHdTFn7hwqthk41r38KPQL738O0cppts0dsFfBcnlYhCHq8EfIBtbxM4QdzD11XFvihCh6xBh4E+Pal5bIZyWIZOd4kngY3xBMvdTf5Of1l4bk0Ff5ZyluosLFGzXsj/rh+tetNQ39ozgx7oN8tLn1gG+bQt6be+Fd5s5qS/gJo2ihOWYLgIlQ2pB2hzyIliQ6h0bMHxD+rA7tnmMHoxHPMkShkOKkll6L5Co7GYwzqg65exKBS9W5f40n2MkJhr6XibyyPyS8zmCjo8DOVczPgOaooUpWEKsusKDFPZ0t4qIVUCYjKSjsfZ0WH6u4ZQ0VShTwqMx62LzpPfdbBPRIYOygB1tpRdgX3B91ljcQ0GpsBO6/gFhPerJkD1Zc04MKM+WDKutBA7HEq+2PV0GM/GeIR5MHaZtrNcM8/jJ38SYYJ/0GGRQ9bzFAZ8Y4ywwJLbWa44T320TRamxkqE75BZmiuXjJDA2XIabsxzYY2MCSUBFwGuIFrKpvQ7CDAf35lzKNFgaM9N8RSVckqFXnmeAFQ7DyLjlTLW4XjDpnHo10fk4gGbqX6hywf/4aEjGfoB2oMqT7+kHo6ehUNyLI6qc4FLQh5p4KdPjlER6aDiB/4P6A8YVJ+n0jQlGdAK+vG+ABdcgBLro/fpecpHrBh+/YXeI1prRkwyCIW3NdnhmcuWBYO2omGCsgK7uFiH+8Tn04q5erEQEsJhjtsmhIWmzKWPUdPAKQT98AsN+LneSsWzqoJKvUSkWSbSqxiYiNuCuEH/phb9nYfEu9fatopA0B1ksWcbXYd8I1m2yAJFMSxvzswP0k4TpLD3RkQxnOH9TkbN9lW7WkDQEjOxywPL4R1AFdwBrKagIYzXLBm2xRfhnJN7nvgrj5Tsog7v24bTvsriIAUY6sBNWy/qKtQpRRsnCFD6zbDze4mi1RJaPg0dWEHwUf34GWbluFLF5eev8O2CW52j9q0DEkfATa+ce+3FUb3L0ycIfi0Ol6a1h6D5gcz3KwBRfx44c9CckbmET18WwRD35Ci+xdj6eGLexCFWKD6e4ZuwE6behp9o4ubpq/QCzFRifZIfrOfe+AVuyvo9MZTAnHDBEgQxwW0bfz7DPGMRQvCiPcgGEJGDf6Rv8YQOL6JYvu/xhDwhHTc5fprDAGRKJH8/WsMD/nTjSl7/psMJ/nkBeFx/TWGgOybYBg3ToEAkekc5Rn2/xZDlYhFAYJ74h1O2hSHeiEtb+gdEjuNJ7cIIYcBkc8H1qGO/yhpS7qlXmETScRJ/rQgghhcor8GYRCKA0AaRSzdbavCpd/+Op5jgWwaFd9+523Jjl5AxNqUNbAzEmnHlsXaKIbQ4xKyP8na4EdQqpHiPr5yqKW9VlkQpzfM0EzQj7TruBgQCkNQSEvsTptWHRca0Z9iAUUTDaIlYquOC7zsQlGO0PugrIRWbTVUf0NwTRHOhWSR/gOglkpZwLW8xO9SofuEeBAEFViqQB0xLcrNILWyZ8BLKiSaBHFX99UPSgr9CVtgJqFM/GiYBgJKYcrwE6jNtD3TlDJKWeaJinv5FdrAiAap12fVPFM9ZpOWxGr6pFw/ZnzSotpYtSRoGiTEc36wrBO8PFZB5cUNQqeOe3axLCkRf5Nzk8YDSK2+kjLfBNnFM2qBMKpPNzBkN1dYU40BP1ugjKKU+oqyYjsJNtnDMpJ+GyNVxfuNDeKs01fjSG5PQ1vPCl4WQjcln0s2bDQiTnoCuxiBdp2/kUrdbMhq9RPQlcRxuabUY59jjioLdASe3vkSo98ccwyfpHxDfEiLuhElLxcQ2z3HQlYiSaFTKmd4xoYYhUgenyFHitmdcDV/pSxLjoJ3RU5GGG6cngc1wfqU9X2G2IsJeEC3s7g8GZlfoZsq/CBt2HzTeHv703r03qOT+HH8cpzU3TwsArfRKH+P9Akv4Gjv/ZDtdg/W7NuK6RphMLnfqz/CxkxU1We0Gs2Dpzrrrs18nDVDDWuUda+SuKFTQ5ty32POJTfQMzP+sQlGf3h3JEWNmDf+F3+L8D3XvPqNEgD1tPowW7Qw39d+bPS9AhfRM4tH76HefEz4SLh7jXV7/XGhFu/MEucHWJc4wYZRYxHeRR3f/boy/KpG1O0+4p1bMHKp6D+yqkjM+63NtewatlXNjMmIzAOgaylgXKQ1CfPlzB6MfDcYiq2p6ZuWU/gKgl2B6rMLAfZLz1XULvaWMKdq4Acjqi9btVd4S+4s2JMvfzlLMh6tqx+QqhmM0pLX1hQyJC8rEdmbLGASrZZpXOFN9q2DM34tfc+JV+jLrk4UkvdlOCGfmzQo6XgY1e5VKvatN2csZX+O+VVFVvzdl1a6I7OoGsa+5uhcn7UYmeH10m3b8SJPHF+FJ85tnX0ybw4JYZ1uUlpbRCixMZTQv2YKbVOWwQ53YaggmLaSsgyBGhkSGRN7y7zhCdrXCzQOfwTRuIKNcr9qJjDyypgDapg3/Ktchca+3AEHM62No5v5QRmtNKD66EpdXjjDTY8oqxKZZZ6eHSL1kux37RaV3Kl1UWP7B6+lDf9syIadONTiaLmZr1bzxdbtVNRoAjf1caBCUCzTGO0dG2YwtNZry69ue+cifTzAUzHEF2Z+Uq+JngM60WwOglPJOQ0z9nUjAVLeuOgvKl6AmI2efgkigYIvqZDBomq8L9seq4lAfuGbh6uLmDJt9pvQJhZlWGWXuSJjvTUQxi94Y6sn5JF+JYsNKKKKMUwFBaRvjmkDe00hhswOkIVxdfjf628WVYQhWBhTDvpVH10s2FMGBRguRR7QVxUEZ+ajAvgZCq7bvXr8taswuBkKL0y+UhR0XzsTvAyZDmt52Ofv3tVcwsbJMKpDInmhWNkOxMHHMK1HeKadt5ttrUcGF8NOXQKCwfnQYIWlhICH4aS+7a5/PvqrhWJw0Ax30zpd8Yu7uAP6aggCybBk4JAfl57fr8OaTg2KYUWPngfDi7/ozWoRKOAMEzHeEoHe9SEmwxq2NJThsiGNef96hULiBL7obQ1j2GlMLKhaN7d/k+4Dvydw6rAZLsqmlkthlgmJJZtjlHa80f6Milsdk2E6a7Zah91qq2IcgMVQwkVaJiPDEFUbFmboyOnx2wHzROIZvkXSOm2HEaCpEc4wWkvs/WPHefGEYIbjQG7nH9XMpaWFMnQD+X1/BsNlbQxdS3rF6g8G66QWhuNhexri9A9vohnunFY13np50fYbQQy9k9ghatWdNhf09kchDE0nPbSmh8oDjPinLqIiwxe9ha/vhp7VSRpIbUiFZjKFjP8M2jzHnnjiiSeeeOL/i/8A3jW5xjoSgjkAAAAASUVORK5CYII="},367:function(e,t,n){e.exports=n.p+"static/media/libertem_logo.4ecbfe5d.png"},384:function(e,t,n){e.exports=n.p+"static/media/LiberTEM logo-medium.7999e0dc.png"},397:function(e,t,n){e.exports=n(700)},700:function(e,t,n){"use strict";n.r(t);n(398),n(410),n(420);var a,r=n(0),c=n.n(r),i=n(64),s=n(10),o=n(55),l=n(90),u=n(34),d=n(35),m=n(37),p=n(36),E=n(38),f=(n(481),n(714)),h=n(716),b=n(68),y=n(718),g=n(727),O=n(721),v=Object(s.b)((function(e){return{version:e.config.version,revision:e.config.revision}}))((function(e){var t=e.version,n=e.revision;return r.createElement(r.Fragment,null,r.createElement(g.a,{as:"h3"},"This is LiberTEM version ",t," (revision ",n.slice(0,8),")"),r.createElement(O.a,null,r.createElement(O.a.Item,null,r.createElement(O.a.Icon,{name:"github"}),r.createElement(O.a.Content,null,"Find us on ",r.createElement("a",{href:"https://github.com/LiberTEM/LiberTEM"},"GitHub"))),r.createElement(O.a.Item,null,r.createElement(O.a.Icon,{name:"bug"}),r.createElement(O.a.Content,null,"Found a bug? Got a feature request? Please ",r.createElement("a",{href:"https://github.com/LiberTEM/LiberTEM/issues/new"},"open an issue!"))),r.createElement(O.a.Item,null,r.createElement(O.a.Icon,{name:"legal"}),r.createElement(O.a.Content,null,"LiberTEM is licensed under the ",r.createElement("a",{href:"https://github.com/LiberTEM/LiberTEM/blob/master/LICENSE"},"GNU General Public License v3.0"))),r.createElement(O.a.Item,null,r.createElement(O.a.Icon,{name:"book"}),r.createElement(O.a.Content,null,"Read ",r.createElement("a",{href:"https://libertem.github.io/LiberTEM/"},"the documentation"))),r.createElement(O.a.Item,null,r.createElement(O.a.Icon,{name:"user"}),r.createElement(O.a.Content,null,"Read ",r.createElement("a",{href:"https://libertem.github.io/LiberTEM/acknowledgments.html"},"the acknowledgments"))),r.createElement(O.a.Item,null,r.createElement(O.a.Icon,{name:"gitter"}),r.createElement(O.a.Content,null,"Join our ",r.createElement("a",{href:"https://gitter.im/LiberTEM/Lobby"},"chat on gitter!"))),r.createElement(O.a.Item,null,r.createElement(O.a.Icon,{name:"linkify"}),r.createElement(O.a.Content,null,r.createElement("a",{href:"https://doi.org/10.5281/zenodo.1477847"},r.createElement("img",{src:"https://zenodo.org/badge/DOI/10.5281/zenodo.1477847.svg",alt:"doi.org/10.5281/zenodo.1477847"}))))))})),x=function(e){return{noOfDatasets:e.datasets.ids.length,isVisible:e.openDataset.formVisible,isbusy:e.openDataset.busy}},A=n(720),S=n(725);function j(e,t,n){return void 0===n&&void 0===t?{type:e}:void 0===n?{type:e,payload:t}:{type:e,payload:t,meta:n}}!function(e){e.NOT_CONNECTED="CLUSTER_NOT_CONNECTED",e.CONNECT="CLUSTER_CONNECT",e.CONNECTING="CLUSTER_CONNECTING",e.CONNECTED="CLUSTER_CONNECTED",e.ERROR="CLUSTER_ERROR"}(a||(a={}));var C={notConnected:function(){return j(a.NOT_CONNECTED)},connect:function(e){return j(a.CONNECT,{params:e})},connecting:function(){return j(a.CONNECTING)},connected:function(e){return j(a.CONNECTED,{params:e})},error:function(e,t,n){return j(a.ERROR,{msg:e,timestamp:t,id:n})}},R=n(168),T=n.n(R);function D(e){throw new Error(e)}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;return R.debounce(e,t,{maxWait:t})}function I(e){return Object.keys(e)}var _,k,L=n(25);!function(e){e.LOCAL="LOCAL",e.TCP="TCP"}(k||(k={}));var M,N,F,P,H=(_={},Object(L.a)(_,k.LOCAL,{label:"Create local cluster"}),Object(L.a)(_,k.TCP,{label:"Connect to cluster",helpText:"can be either local or remote, connection via TCP"}),_);!function(e){e.HDF5="HDF5",e.RAW="RAW",e.MIB="MIB",e.BLO="BLO",e.K2IS="K2IS",e.SER="SER",e.FRMS6="FRMS6",e.EMPAD="EMPAD"}(M||(M={})),function(e){e.dataset_paths="dataset_paths"}(N||(N={})),function(e){e.OPEN="OPEN",e.OPENING="OPENING",e.DELETING="DELETING"}(F||(F={})),function(e){e.APPLY_RING_MASK="APPLY_RING_MASK",e.APPLY_DISK_MASK="APPLY_DISK_MASK",e.APPLY_POINT_SELECTOR="APPLY_POINT_SELECTOR",e.CENTER_OF_MASS="CENTER_OF_MASS",e.SUM_FRAMES="SUM_FRAMES",e.SD_FRAMES="SD_FRAMES",e.PICK_FRAME="PICK_FRAME",e.PICK_FFT_FRAME="PICK_FFT_FRAME",e.APPLY_FFT_MASK="APPLY_FFT_MASK",e.FFTSUM_FRAMES="FFTSUM_FRAMES",e.RADIAL_FOURIER="RADIAL_FOURIER",e.FEM="FEM",e.CLUST="CLUST",e.SUM_SIG="SUM_SIG"}(P||(P={}));var W,U=n(23),B=n(19),G=n(715),Y=n(701),K=Object(B.c)({mapPropsToValues:function(e){return{numWorkers:e.config.localCores}},handleSubmit:function(e,t){(0,t.props.onSubmit)(Object(U.a)({type:k.LOCAL},e))}})((function(e){var t=e.values,n=e.touched,a=e.errors,c=(e.dirty,e.isSubmitting),i=e.handleChange,s=e.handleBlur,o=e.handleSubmit;e.handleReset;return r.createElement(G.a,{onSubmit:o},r.createElement(G.a.Field,null,r.createElement("label",{htmlFor:"numWorkers"},"Number of Workers:"),r.createElement("input",{type:"number",name:"numWorkers",value:t.numWorkers,onChange:i,onBlur:s}),a.numWorkers&&n.numWorkers&&a.numWorkers),r.createElement(Y.a,{primary:!0,type:"submit",disabled:c},"Connect"))})),z=Object(B.c)({mapPropsToValues:function(e){return{address:e.config.lastConnection.address}},handleSubmit:function(e,t){(0,t.props.onSubmit)(Object(U.a)({type:k.TCP},e))}})((function(e){var t=e.values,n=e.touched,a=e.errors,c=(e.dirty,e.isSubmitting),i=e.handleChange,s=e.handleBlur,o=e.handleSubmit;e.handleReset;return r.createElement(G.a,{onSubmit:o},r.createElement(G.a.Field,null,r.createElement("label",{htmlFor:"address"},"Scheduler URI"),r.createElement("input",{type:"text",name:"address",value:t.address,onChange:i,onBlur:s}),a.address&&n.address&&a.address),r.createElement(Y.a,{primary:!0,type:"submit",disabled:c},"Connect"))})),V={connectToCluster:C.connect},J=I(k).map((function(e){return{text:H[k[e]].label,value:k[e]}})),Q=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={clusterType:n.props.lastConnectionType},n.setType=function(e){n.setState({clusterType:e})},n.handleChange=function(e,t){var a=t.value;n.setType(a)},n.handleSubmit=function(e){n.props.connectToCluster(e)},n}return Object(E.a)(t,e),Object(d.a)(t,[{key:"renderForm",value:function(){var e=this.state.clusterType,t=this.props.config;switch(e){case k.LOCAL:return r.createElement(K,{config:t,onSubmit:this.handleSubmit});case k.TCP:return r.createElement(z,{config:t,onSubmit:this.handleSubmit})}}},{key:"render",value:function(){return r.createElement(r.Fragment,null,r.createElement("div",null,r.createElement(A.a,{inline:!0,options:J,value:this.state.clusterType,onChange:this.handleChange})),r.createElement(S.a,null,this.renderForm()))}}]),t}(r.Component),q=Object(s.b)((function(e){return{config:e.config,lastConnectionType:e.config.lastConnection.type}}),V)(Q),Z=n(723),X=function(e){var t=e.msg;return r.createElement(Z.a,{icon:!0},r.createElement(b.a,{name:"cog",loading:!0}),r.createElement(Z.a.Content,null,r.createElement(Z.a.Header,null,"Connecting to LiberTEM"),t))},$={waiting:"Waiting...",connecting:"Connecting..."},ee="Connected, waiting for initial state...",te="Connected, fetching cluster status...",ne="Connecting to cluster",ae=function(){var e=Object(s.d)((function(e){return e.config.haveConfig})),t=Object(s.d)((function(e){return e.clusterConnection}));return e?"disconnected"===t.status?r.createElement(q,null):"connected"===t.status?r.createElement(X,{msg:ee}):"unknown"===t.status?r.createElement(X,{msg:te}):"connecting"===t.status?r.createElement(X,{msg:ne}):void D("should not happen"):r.createElement(X,{msg:"waiting for configuration..."})},re=function(e){var t=e.children,n=Object(s.d)((function(e){return e.channelStatus}));switch(n.status){case"waiting":case"connecting":return r.createElement(X,{msg:$[n.status]});case"connected":return r.createElement(ae,null);case"ready":return r.createElement(r.Fragment,null,t);default:D("should not happen")}};!function(e){e.OPEN="DATASET_OPEN",e.CANCEL_OPEN="DATASET_CANCEL_OPEN",e.CREATE="DATASET_CREATE",e.CREATED="DATASET_CREATED",e.ERROR="DATASET_ERROR",e.DELETE="DATASET_DELETE",e.DELETED="DATASET_DELETED",e.DETECT="DATASET_DETECT",e.DETECTED="DATASET_DETECTED",e.DETECT_FAILED="DATASET_DETECT_FAILED"}(W||(W={}));var ce,ie={open:function(e,t,n){return j(W.OPEN,{path:e,cachedParams:t,detectedParams:n})},cancelOpen:function(){return j(W.CANCEL_OPEN)},create:function(e){return j(W.CREATE,{dataset:e})},created:function(e){return j(W.CREATED,{dataset:e})},error:function(e,t,n,a){return j(W.ERROR,{dataset:e,msg:t,timestamp:n,id:a})},delete:function(e){return j(W.DELETE,{dataset:e})},deleted:function(e){return j(W.DELETED,{dataset:e})},detect:function(e){return j(W.DETECT,{path:e})},detected:function(e,t){return j(W.DETECTED,{path:e,params:t})},detectFailed:function(e){return j(W.DETECT_FAILED,{path:e})}};!function(e){e.LIST_DIRECTORY="BROWSER_LIST_DIRECTORY",e.LIST_FULL_PATH="BROWSER_LIST_DIRECTORY_FULL",e.DIRECTORY_LISTING="BROWSER_DIRECTORY_LISTING",e.DETECT_PARAMS="BROWSER_DETECT_PARAMS",e.PARAMS_DETECTED="BROWSER_PARAMS_DETECTED",e.ERROR="BROWSER_ERROR",e.OPEN="BROWSER_OPEN",e.CANCEL="BROWSER_CANCEL",e.SELECT="BROWSER_SELECT",e.SELECT_FULL_PATH="BROWSER_SELECT_FULL_PATH"}(ce||(ce={}));var se={list:function(e,t){return j(ce.LIST_DIRECTORY,{path:e,name:t})},dirListing:function(e,t,n,a,r){return j(ce.DIRECTORY_LISTING,{path:e,dirs:t,files:n,drives:a,places:r})},open:function(){return j(ce.OPEN)},cancel:function(){return j(ce.CANCEL)},select:function(e,t){return j(ce.SELECT,{path:e,name:t})},selectFullPath:function(e){return j(ce.SELECT_FULL_PATH,{path:e})},error:function(e,t,n){return j(ce.ERROR,{msg:e,timestamp:t,id:n})},detectParams:function(e){return j(ce.DETECT_PARAMS,{path:e})},paramsDetected:function(e,t){return j(ce.PARAMS_DETECTED,{path:e,params:t})}},oe=n(366),le=n.n(oe),ue=x,de=Object(s.b)(ue)((function(e){var t=e.noOfDatasets,n=e.isVisible,a=e.isbusy;return r.createElement("div",null,t||n||a?"":r.createElement("div",{style:{paddingTop:"5%",paddingBottom:"5%"}},r.createElement("a",{href:"https://libertem.github.io/LiberTEM/",rel:"noopener noreferrer",target:"_blank"},"Visit LiberTEM documentation"),r.createElement("div",{style:{marginTop:"3%"}},r.createElement("img",{src:le.a,alt:"github",style:{height:"25px",width:"25px",marginLeft:"-25px"}}),r.createElement("a",{href:"https://github.com/LiberTEM/LiberTEM",rel:"noopener noreferrer",target:"_blank"},"Star us on GitHub"))))})),me=n(367),pe=n.n(me),Ee=x,fe=Object(s.b)(Ee)((function(e){var t=e.noOfDatasets,n=e.isVisible,a=e.isbusy;return r.createElement("div",null,t||n||a?"":r.createElement("div",null,r.createElement("h1",null,"Get Started With LiberTEM"),r.createElement("img",{src:pe.a,alt:"libertem",style:{paddingTop:"5%",paddingBottom:"5%",opacity:"0.6"}}),r.createElement("div",{style:{marginLeft:"30%",marginRight:"30%",paddingBottom:"5%"}},r.createElement("text",null,'LiberTEM is an open source platform for high-throughput distributed processing of pixelated scanning transmission electron microscopy (STEM) data. Click on "Browse" to select the dataset you want to analyze.'))))})),he=n(386),be=function(e){var t=e.ts,n=new Date(1e3*t),a=n.toLocaleDateString(),c=n.toLocaleTimeString(),i="".concat(a," ").concat(c);return r.createElement("div",{style:{display:"flex",whiteSpace:"nowrap"},title:i},r.createElement("div",{style:{width:"50%",marginRight:"10px"}},a),r.createElement("div",{style:{width:"45%"}},c))};var ye=function(e){var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?1e3:1024;if(Math.abs(e)<n)return{size:e,unit:"B"};var a=t?["kB","MB","GB","TB","PB","EB","ZB","YB"]:["KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],r=-1;do{e/=n,++r}while(Math.abs(e)>=n&&r<a.length-1);return{size:e.toFixed(1),unit:a[r]}}(e.size,e.si);return r.createElement("div",{style:{textAlign:"right"}},t.size," ",t.unit)},ge=function(e){var t=e.children,n=e.title;return r.createElement("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",marginRight:"10px"},title:n},t)},Oe=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).onClick=function(e){var t=n.props.onClick;t&&t()},n}return Object(E.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.details,n=e.style,a=e.icon,c=Object(U.a)({cursor:"pointer"},n),i={textAlign:"right"};return r.createElement("div",{onClick:this.onClick,style:c},r.createElement("div",{style:{display:"flex",paddingRight:"10px"}},r.createElement("div",{style:{width:"20%",flexGrow:1}},r.createElement(ge,{title:t.name},a&&r.createElement(b.a,{name:a}),t.name)),r.createElement("div",{style:{width:"10%"}},r.createElement(ge,null,r.createElement(ye,{size:t.size,si:!1}))),r.createElement("div",{style:{width:"10%"}},r.createElement(ge,null,t.owner)),r.createElement("div",{style:Object(U.a)({width:"18%"},i)},r.createElement(ge,null,r.createElement(be,{ts:t.ctime}))),r.createElement("div",{style:Object(U.a)({width:"18%"},i)},r.createElement(ge,null,r.createElement(be,{ts:t.mtime})))))}}]),t}(r.Component),ve=function(){var e={textAlign:"right"};return r.createElement("div",{style:{paddingRight:"20px",paddingBottom:"10px"}},r.createElement("div",{style:{display:"flex"}},r.createElement("div",{style:{width:"20%",flexGrow:1}},r.createElement(ge,null,"Name")),r.createElement("div",{style:Object(U.a)({width:"10%"},e)},r.createElement(ge,null,"Size")),r.createElement("div",{style:{width:"10%"}},r.createElement(ge,null,"Owner")),r.createElement("div",{style:Object(U.a)({width:"18%"},e)},r.createElement(ge,null,"Created")),r.createElement("div",{style:Object(U.a)({width:"18%"},e)},r.createElement(ge,null,"Modified"))))},xe=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.details,n=e.style,a=e.select;return r.createElement(Oe,{onClick:a,style:n,details:t,icon:"file outline"})}}]),t}(r.Component),Ae=Object(s.b)(null,(function(e,t){return{select:function(){return e(se.select(t.path,t.details.name))}}}))(xe),Se=Object(s.b)(null,(function(e,t){return{list:function(){e(se.list(t.path,t.details.name)),window.setTimeout((function(){return t.onChange()}),0)}}}))((function(e){var t=e.list,n=e.details,a=e.style;e.onChange;return r.createElement(Oe,{onClick:t,style:a,details:n,icon:"folder"})})),je=n(724),Ce=n(173),Re=Object(s.b)(null,(function(e,t){return{list:function(){void 0!==t.value&&(e(se.list(t.value.toString())),window.setTimeout((function(){return t.onChange()}),0))}}}))((function(e){var t=e.list,n=Object(Ce.a)(e,["list"]),a=Object(U.a)({onClick:t},n);return r.createElement(A.a.Item,a)})),Te=n(711),De=Object(B.c)({mapPropsToValues:function(e){return{path:e.initialPath}},handleSubmit:function(e,t){(0,t.props.onChange)(e.path)},enableReinitialize:!0})((function(e){var t=e.values,n=(e.touched,e.errors,e.dirty,e.isSubmitting,e.handleChange),a=e.handleBlur,c=e.handleSubmit;e.handleReset;return r.createElement(G.a,{onSubmit:c,style:{flexGrow:1}},r.createElement(G.a.Field,null,r.createElement(Te.a,{autoComplete:"off",onBlur:a,onChange:n,value:t.path,name:"path"})))})),we=Object(s.b)((function(e){return{lastOpened:e.config.lastOpened,fileHistory:e.config.fileHistory,separator:e.config.separator}}),(function(e){return{select:function(t){return e(se.selectFullPath(t))}}}))((function(e){var t=e.lastOpened,n=e.fileHistory,a=e.select,c=n.filter((function(e){return t[e]})).map((function(e){var n=t[e];return{text:n.path,value:{type:n.type,path:n.path}}})),i=function(e,t){return t.value&&a(t.value.toString())};return r.createElement(A.a,{item:!0,text:"Recent",floating:!0},r.createElement(A.a.Menu,null,r.createElement(A.a.Header,{content:"recent datasets"}),c.map((function(e,t){return r.createElement(A.a.Item,{key:t,value:e.value.path,content:e.text,onClick:i})}))))})),Ie=Object(s.b)(null,(function(e,t){return{refresh:function(){e(se.list(t.currentPath)),window.setTimeout((function(){return t.onChange()}),0)},handleInputChange:function(n){e(se.list(n)),window.setTimeout((function(){return t.onChange()}),0)},goUp:function(){e(se.list(t.currentPath,"..")),window.setTimeout((function(){return t.onChange()}),0)}}}))((function(e){var t=e.currentPath,n=e.drives,a=e.places,c=e.onChange,i=e.refresh,s=e.goUp,o=e.handleInputChange,l=n.map((function(e){return{key:e,text:e}})),u=Object.keys(a).map((function(e){return{key:a[e].path,text:a[e].title}}));return r.createElement(je.a,null,r.createElement(we,null),r.createElement(A.a,{text:"Go to...",floating:!0,item:!0},r.createElement(A.a.Menu,null,r.createElement(A.a.Header,{content:"Drives"}),l.map((function(e){return r.createElement(Re,{key:e.key,value:e.key,content:e.text,onChange:c})})),r.createElement(A.a.Header,{content:"Places"}),u.map((function(e){return r.createElement(Re,{key:e.key,value:e.key,content:e.text,onChange:c})})))),r.createElement(je.a.Item,{icon:"arrow up",onClick:s}),r.createElement(je.a.Item,{style:{flexGrow:1}},r.createElement(De,{onChange:o,initialPath:t})),r.createElement(je.a.Item,{icon:"refresh",onClick:i}))})),_e=r.createRef(),ke=function(){null!==_e.current&&_e.current.scrollToItem(0)};function Le(e,t){return e.sort((function(e,n){var a=t(e),r=t(n);return a<r?-1:a>r?1:0}))}var Me,Ne,Fe=Object(s.b)((function(e){var t=e.browser;return{files:t.files,dirs:t.dirs,path:t.path,drives:t.drives,places:t.places,isLoading:t.isLoading}}),(function(e){return{cancel:function(){return e(se.cancel())}}}))((function(e){var t=e.files,n=e.dirs,a=e.path,c=e.drives,i=e.places,s=e.cancel,o=e.isLoading,l=function(e){return e.name.toLowerCase()},u=Le(n,l).map((function(e){return function(t){return r.createElement(Se,{style:t,onChange:ke,path:a,details:e})}})),d=Le(t,l).map((function(e){return function(t){return r.createElement(Ae,{style:t,path:a,details:e})}})),m=u.concat(d),p=r.createElement(he.a,{style:{overflowY:"scroll"},ref:_e,height:300,width:"100%",itemCount:m.length,itemSize:35},(function(e){var t=e.index,n=e.style;return m[t](n)}));return o&&(p=r.createElement(S.a,{loading:!0,style:{height:"300px"}})),r.createElement(S.a.Group,null,r.createElement(S.a,null,r.createElement(g.a,{as:"h2"},"Open dataset")),r.createElement(S.a,null,r.createElement(Ie,{currentPath:a,drives:c,places:i,onChange:ke})),r.createElement(S.a,null,r.createElement(ve,null),p),r.createElement(S.a,null,r.createElement(Y.a,{onClick:s},"Cancel")))})),Pe={open:se.open,detect:ie.detect},He=Object(s.b)((function(e){return{isOpen:e.browser.isOpen,busy:e.openDataset.busy,formVisible:e.openDataset.formVisible}}),Pe)((function(e){var t=e.formVisible,n=e.isOpen,a=e.open,c=e.busy;return t||c?null:n?r.createElement(Fe,null):r.createElement("div",{style:{textAlign:"center"}},r.createElement(fe,null),r.createElement(Y.a,{icon:!0,labelPosition:"left",onClick:a,color:"blue"},r.createElement(b.a,{name:"add"}),"Browse"),r.createElement(de,null))})),We=n(12);!function(e){e.CREATING="CREATING",e.RUNNING="RUNNING",e.DONE="DONE"}(Me||(Me={})),function(e){e.CREATING="CREATING",e.IN_PROGRESS="IN_PROGRESS",e.CANCELLED="CANCELLED",e.SUCCESS="SUCCESS",e.ERROR="ERROR"}(Ne||(Ne={}));var Ue=n(48),Be=n(79),Ge=n(80),Ye=function(){return r.createElement(b.a,{name:"cog",loading:!0,style:{margin:0,padding:0,position:"absolute",bottom:"10px",right:"10px",color:"white",opacity:.7,filter:"drop-shadow(0 0 3px #000)"}})},Ke=function(e){var t=e.children,n=e.busy;return r.createElement("div",{style:{position:"relative"}},t,n&&r.createElement(Ye,null))},ze=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).currentHandle=void 0,n.handleDragStart=function(e){n.currentHandle=e},n.handleDrop=function(){n.currentHandle=void 0},n.handleMouseMove=function(e){if(n.currentHandle)return n.currentHandle.externalMouseMove(e)},n.handleMouseLeave=function(e){n.currentHandle&&n.currentHandle.externalLeave(e)},n.handleMouseUp=function(e){n.currentHandle&&n.currentHandle.externalMouseUp(e)},n}return Object(E.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.width,n=e.height;return r.createElement("g",{onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onMouseUp:this.handleMouseUp,onKeyDown:this.props.onKeyboardEvent,style:{outline:"1px dashed black"},tabIndex:0},r.createElement("rect",{style:{fill:"transparent"},x:0,y:0,width:t,height:n}),this.renderHandles())}},{key:"renderHandles",value:function(){var e=this,t=this.props,n=t.handles,a=t.onKeyboardEvent;return n.map((function(t,n){var c=t(e.handleDragStart,e.handleDrop,a);return r.isValidElement(c)?r.cloneElement(c,{key:n}):null}))}}]),t}(r.Component),Ve=n(234),Je=n.n(Ve),Qe=function(e){var t=e.job,n=e.channel,a=e.width,c=e.height,i=t.results[n];return void 0===i?r.createElement("svg",{className:Je.a.fallback,width:a,height:c,viewBox:"0 0 ".concat(a," ").concat(c),key:-1}):r.createElement("image",{className:Je.a.default,xlinkHref:i.imageURL,width:a,height:c})};function qe(){var e=Object(Be.a)(["\n    display: block;\n    border: 1px solid black;\n    width: 100%;\n    height: auto;\n"]);return qe=function(){return e},e}var Ze=Ge.a.svg(qe()),Xe=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(d.a)(t,[{key:"renderHandles",value:function(){var e=this.props,t=e.width,n=e.height,a=e.extraHandles,c=[];return a&&(c=[].concat(Object(Ue.a)(c),[a])),r.createElement(ze,{width:t,height:n,handles:c})}},{key:"render",value:function(){var e=this.props,t=e.job,n=e.channel,a=e.width,c=e.height,i=e.extraWidgets,s=t.running!==Me.DONE;return r.createElement(Ke,{busy:s},r.createElement(Ze,{width:a,height:c,viewBox:"0 0 ".concat(a," ").concat(c)},r.createElement(Qe,{job:t,channel:n,width:a,height:c}),i,this.renderHandles()))}}]),t}(r.Component),$e=Object(s.b)(null,null)(Xe);function et(){var e=Object(Be.a)(["\n    display: flex;\n    & > * {\n        margin-right: 10px;\n    }\n"]);return et=function(){return e},e}var tt=Ge.a.div(et()),nt=function(e){var t=e.width,n=e.height;return r.createElement("svg",{style:{display:"block",border:"1px solid black",width:"100%",height:"auto"},width:t,height:n,viewBox:"0 0 ".concat(t," ").concat(n),key:-1})},at=function(e){function t(){var e,n;Object(u.a)(this,t);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(n=Object(m.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={selectedChannel:0},n.selectChannel=function(e,t){var a=t.value;n.setState({selectedChannel:a})},n}return Object(E.a)(t,e),Object(d.a)(t,[{key:"getJob",value:function(){var e=this.props,t=e.analysis,n=e.jobsById;if(t&&t.displayedJob&&n[t.displayedJob])return n[t.displayedJob]}},{key:"getMsg",value:function(e){if(!e)return r.createElement(r.Fragment,null,"\xa0");if(e.running===Me.DONE){var t=(e.endTimestamp-e.startTimestamp)/1e3;return r.createElement(r.Fragment,null,"Analysis done in ",t.toFixed(3),"s")}return r.createElement(r.Fragment,null,"Analysis running...")}},{key:"genericRender",value:function(e,t){var n=this.props,a=n.subtitle,c=n.children,i=n.selectors,s=this.getMsg(t);return r.createElement("div",null,e,c,r.createElement(tt,null,r.createElement(rt,{job:t,handleChange:this.selectChannel,selectedImg:this.state.selectedChannel}),i),r.createElement("p",null,a," ",s))}},{key:"render",value:function(){var e=this.getJob(),t=this.props,n=t.width,a=t.height,c=t.extraHandles,i=t.extraWidgets;return e?this.genericRender(r.createElement($e,{job:e,extraHandles:c,extraWidgets:i,width:n,height:a,channel:this.state.selectedChannel}),e):this.genericRender(r.createElement(nt,{width:n,height:a}),e)}}]),t}(r.Component),rt=function(e){var t=e.job,n=e.handleChange,a=e.selectedImg;if(!t)return null;var c=t.results.map((function(e,t){return{text:e.description.title,value:t}}));return r.createElement(r.Fragment,null,r.createElement("div",null,"Channel:"," ",r.createElement(A.a,{inline:!0,options:c,value:a,onChange:n})))},ct=Object(s.b)((function(e,t){var n=e.compoundAnalyses.byId[t.compoundAnalysis],a=e.analyses.byId[n.details.analyses[t.analysisIndex]];return{jobsById:e.jobs.byId,analysis:a,compoundAnalysis:n,analysisIndex:t.analysisIndex}}))(at),it=function(e,t){return function(n){return{x:Math.max(0,Math.min(e-1,n.x)),y:Math.max(0,Math.min(t-1,n.y))}}},st=function(e,t,n){return function(a,r){return n&&n(function(e,t,n,a){var r=e-n,c=t-a;return Math.sqrt(r*r+c*c)}(e,t,a,r))}},ot=function(e){return function(t){return{x:t.x,y:e}}},lt=function(e,t){return function(n){return(a=e,function(e){return{x:a>e.x?a:e.x,y:e.y}})(ot(t)(n));var a}},ut=function(e,t){return function(n){return(a=e,function(e){return{x:a<e.x?a:e.x,y:e.y}})(ot(t)(n));var a}},dt=function(e){return{fillOpacity:.3,fill:"red",strokeOpacity:.7,stroke:"red",strokeWidth:e/128/3}},mt=function(e){var t=e.imageWidth,n=(e.imageHeight,e.cx),a=e.cy,c=e.r;return r.createElement("circle",{cx:n+.5,cy:a+.5,r:c,style:Object(U.a)({},dt(t))})},pt=n(163);function Et(){var e=Object(Be.a)(["\n    &:focus { outline: none; }\n"]);return Et=function(){return e},e}function ft(){var e=Object(Be.a)(["\n    stroke: red;\n    stroke-width: 1;\n    fill: transparent;\n    g:focus > & {\n        stroke: lightgreen;\n    }\n"]);return ft=function(){return e},e}function ht(){var e=Object(Be.a)(["\n    stroke: red;\n    stroke-width: 1;\n    fill: transparent;\n    g:focus > & {\n        stroke: lightgreen;\n    }\n"]);return ht=function(){return e},e}var bt=Ge.a.circle(ht()),yt=Ge.a.path(ft()),gt=Ge.a.g(Et()),Ot=function(e){var t=e.scale,n=e.x,a=e.y,c=e.withCross,i=e.focusRef,s=Object(Ce.a)(e,["scale","x","y","withCross","focusRef"]),o={transform:"matrix(".concat(t,", 0, 0, ").concat(t,", ").concat(n-t*n,", ").concat(a-t*a,")")},l="\n        M".concat(n-4-1.5," ").concat(a," L ").concat(n-1.5," ").concat(a," M").concat(n+1.5," ").concat(a," L ").concat(n+4+1.5," ").concat(a,"\n        M").concat(n," ").concat(a-4-1.5," L ").concat(n," ").concat(a-1.5," M").concat(n," ").concat(a+1.5," L ").concat(n," ").concat(a+4+1.5,"\n    "),u=c?r.createElement(yt,{d:l,style:o}):null;return r.createElement(gt,Object.assign({},s,{ref:i}),r.createElement(bt,{cx:n,cy:a,r:3,style:o}),u)};function vt(e,t){var n=function(e){var t=e.ownerSVGElement;if(null===t)throw new Error("no owner SVG element?");var n=t.getAttribute("width");if(null===n)throw new Error("no width on SVG element?");var a=+n;return t.getBoundingClientRect().width/a}(t),a=t.getBoundingClientRect();return{x:(e.pageX-(a.left+window.pageXOffset))/n,y:(e.pageY-(a.top+window.pageYOffset))/n}}var xt,At=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(m.a)(this,Object(p.a)(t).call(this,e))).posRef=void 0,n.focusRef=void 0,n.state={dragging:!1,drag:{x:0,y:0}},n.externalMouseMove=function(e){n.move(e)},n.externalLeave=function(e){n.stopDrag(e)},n.externalMouseUp=function(e){n.stopDrag(e)},n.applyConstraint=function(e){var t=n.props.constraint;return t?t(e):e},n.startDrag=function(e){e.preventDefault();var t=n.props.parentOnDragStart;if(!n.posRef.current)throw new Error("startDrag without posRef");n.setState({dragging:!0,drag:n.applyConstraint(vt(e,n.posRef.current))}),t&&t(Object(pt.a)(n)),n.focusRef.current&&n.focusRef.current.focus&&n.focusRef.current.focus()},n.move=function(e){var t=n.props.onDragMove;if(n.state.dragging){if(!n.posRef.current)throw new Error("move without posRef");n.setState({drag:n.applyConstraint(vt(e,n.posRef.current))},(function(){if(t){var e=n.applyConstraint(n.state.drag);t(e.x,e.y)}}))}},n.stopDrag=function(e){var t=n.props.parentOnDrop,a=n.state,r=a.dragging,c=a.drag;r&&(n.setState({dragging:!1}),t&&t(c.x,c.y))},n.handleKeyDown=function(e){!function(e,t){var n=1;switch(e.shiftKey&&(n=10),e.key){case"ArrowUp":t((function(e,t){return{x:e,y:t-n}}));break;case"ArrowDown":t((function(e,t){return{x:e,y:t+n}}));break;case"ArrowLeft":t((function(e,t){return{x:e-n,y:t}}));break;case"ArrowRight":t((function(e,t){return{x:e+n,y:t}}));break;default:return}e.preventDefault()}(e,(function(e){var t=n.props,a=t.x,r=t.y,c=t.onDragMove,i=e(a,r),s=n.applyConstraint(i);c&&c(s.x,s.y)}))},n.posRef=r.createRef(),n.focusRef=r.createRef(),n}return Object(E.a)(t,e),Object(d.a)(t,[{key:"renderCommon",value:function(e,t){var n=this.props.imageWidth,a=void 0===n?1:n/128;return r.createElement("g",null,r.createElement("rect",{style:{visibility:"hidden"},ref:this.posRef,x:0,y:0,width:0,height:0}),r.createElement(Ot,{scale:a,x:e+.5,y:t+.5,withCross:this.props.withCross,focusRef:this.focusRef,onMouseUp:this.stopDrag,onMouseMove:this.move,onMouseDown:this.startDrag,onKeyDown:this.handleKeyDown,tabIndex:0}))}},{key:"renderDragging",value:function(){var e=this.state.drag,t=e.x,n=e.y;return this.renderCommon(t,n)}},{key:"render",value:function(){var e=this.props,t=e.x,n=e.y;return this.state.dragging?this.renderDragging():this.renderCommon(t,n)}}]),t}(r.Component),St=At;!function(e){e.CREATE="COMPOUND_ANALYSIS_CREATE",e.CREATED="COMPOUND_ANALYSIS_CREATED",e.UPDATED="COMPOUND_ANALYSIS_UPDATED",e.RUN="COMPOUND_ANALYSIS_RUN",e.RUNNING="COMPOUND_ANALYSIS_RUNNING",e.REMOVE="COMPOUND_ANALYSIS_REMOVE",e.REMOVED="COMPOUND_ANALYSIS_REMOVED",e.ERROR="COMPOUND_ANALYSIS_ERROR",e.ENABLE_AUTOSTART="COMPOUND_ANALYSIS_ENABLE_AUTOSTART"}(xt||(xt={}));var jt,Ct,Rt=function(e,t){return j(xt.CREATE,{dataset:e,analysisType:t})},Tt=function(e,t){return j(xt.CREATED,{compoundAnalysis:e,autoStart:t})},Dt=function(e){return j(xt.ENABLE_AUTOSTART,{compoundAnalysisId:e})},wt=function(e,t,n){return j(xt.RUN,{id:e,analysisIndex:t,details:n})},It=function(e,t,n){return j(xt.RUNNING,{id:e,job:t,jobIndex:n})},_t=function(e){return j(xt.REMOVE,{id:e})},kt=function(e){return j(xt.REMOVED,{id:e})},Lt=function(e,t,n){return j(xt.ERROR,{msg:e,timestamp:t,id:n})},Mt=function(e){var t=e.enabled,n=e.scanWidth,a=e.scanHeight,r=e.analysisIndex,i=e.compoundAnalysisId,o=e.cx,l=e.cy,u=e.setCx,d=e.setCy,m=Object(s.c)();c.a.useEffect((function(){if(t){var e={x:o,y:l};m(wt(i,r,{analysisType:P.PICK_FRAME,parameters:e}))}}),[i,o,l,t,r,m]);var p=function(e,t){var n=Math.round(e),a=Math.round(t);o===n&&l===a||(u(n),d(a))};return{coords:{cx:o,cy:l},handles:function(e,t){return c.a.createElement(St,{x:o,y:l,withCross:!0,imageWidth:n,onDragMove:p,parentOnDragStart:e,parentOnDrop:t,constraint:it(n,a)})}}},Nt=function(e){var t=e.modes,n=e.currentMode,a=e.onModeChange,c=e.label;return r.createElement(r.Fragment,null,r.createElement("div",null,c,":"," ",r.createElement(A.a,{inline:!0,options:t,value:n,onChange:function(e,t){a(t.value)}})))},Ft=function(e){var t,n,a=e.imageWidth,c=(e.imageHeight,e.x),i=e.y,s=e.width,o=e.height;return o*s>0?(t=Math.min(i,i+o),n=Math.min(c,c+s)):o>0&&s<0?(t=i,n=c+s):(t=i+o,n=c),r.createElement("rect",{x:n+.5,y:t+.5,width:Math.abs(s),height:Math.abs(o),style:Object(U.a)({},dt(a))})},Pt=function(e){var t=e.scanWidth,n=e.scanHeight,a=Math.min(t,n),c=Object(r.useState)(t/2),i=Object(We.a)(c,2),s=i[0],o=i[1],l=Object(r.useState)(n/2),u=Object(We.a)(l,2),d=u[0],m=u[1],p=Object(r.useState)(a/8),E=Object(We.a)(p,2),f=E[0],h=E[1],b=Object(r.useState)(a/8),y=Object(We.a)(b,2),g=y[0],O=y[1],v=function(e,t){o(e),m(t)},x=function(e,t){h(e-s),O(t-d)},A={x:s+f,y:d+g};return{rectRoiParameters:{roi:{shape:"rect",x:s,y:d,width:f,height:g}},rectRoiHandles:function(e,n){return r.createElement(r.Fragment,null,r.createElement(St,{x:s,y:d,imageWidth:t,onDragMove:v,parentOnDragStart:e,parentOnDrop:n}),r.createElement(St,{x:A.x,y:A.y,imageWidth:t,onDragMove:x,parentOnDragStart:e,parentOnDrop:n}))},rectRoiWidgets:r.createElement(Ft,{x:s,y:d,width:f,height:g,imageWidth:t,imageHeight:n})}},Ht=function(e){var t=e.compoundAnalysisId,n=e.enabled,a=e.analysisIndex,c=e.roiParameters,i=e.analysisType,o=Object(s.c)();return r.useEffect((function(){var e=setTimeout((function(){n&&o(wt(t,a,{analysisType:i,parameters:c}))}),100);return function(){return clearTimeout(e)}}),[i,t,n,a,JSON.stringify(c),o]),{}};!function(e){e.SUM="SUM",e.SD="SD",e.PICK="PICK"}(jt||(jt={})),function(e){e.ALL="ALL",e.DISK="DISK",e.RECT="RECT"}(Ct||(Ct={}));var Wt=function(e){var t=e.scanWidth,n=e.scanHeight,a=e.compoundAnalysisId,c=e.doAutoStart,i=[{text:"Average",value:jt.SUM},{text:"Standard Deviation",value:jt.SD},{text:"Pick",value:jt.PICK}],o=[{text:"All",value:Ct.ALL},{text:"Disk",value:Ct.DISK},{text:"Rect",value:Ct.RECT}],l=Object(r.useState)(jt.SUM),u=Object(We.a)(l,2),d=u[0],m=u[1],p=Object(r.useState)(Ct.ALL),E=Object(We.a)(p,2),f=E[0],h=E[1],b=Object(s.c)(),y=r.createElement(Nt,{modes:i,currentMode:d,onModeChange:function(e){b(Dt(a)),m(e)},label:"Mode"}),g=r.createElement(Nt,{modes:o,currentMode:f,onModeChange:function(e){b(Dt(a)),h(e)},label:"ROI"});d===jt.PICK&&(g=r.createElement(r.Fragment,null));var O,v=r.useState(Math.round(t/2)),x=Object(We.a)(v,2),A=x[0],S=x[1],j=r.useState(Math.round(n/2)),C=Object(We.a)(j,2),R=C[0],T=C[1],D=Mt({enabled:d===jt.PICK,scanWidth:t,scanHeight:n,analysisIndex:0,compoundAnalysisId:a,cx:A,cy:R,setCx:S,setCy:T}),w=D.coords,I=D.handles,_=Pt({scanHeight:n,scanWidth:t}),k=_.rectRoiHandles,L=_.rectRoiWidgets,M=_.rectRoiParameters,N=function(e){var t=e.scanWidth,n=e.scanHeight,a=Math.min(t,n),c=Object(r.useState)(t/2),i=Object(We.a)(c,2),s=i[0],o=i[1],l=Object(r.useState)(n/2),u=Object(We.a)(l,2),d=u[0],m=u[1],p=Object(r.useState)(a/8),E=Object(We.a)(p,2),f=E[0],h=E[1],b=function(e,t){o(e),m(t)},y=function(e){h(e)},g={x:s-f,y:d};return{diskRoiParameters:{roi:{shape:"disk",cx:s,cy:d,r:f}},diskRoiHandles:function(e,a){return r.createElement(r.Fragment,null,r.createElement(St,{x:s,y:d,imageWidth:t,onDragMove:b,parentOnDragStart:e,parentOnDrop:a,constraint:it(t,n)}),r.createElement(St,{x:g.x,y:g.y,imageWidth:t,onDragMove:st(s,d,y),parentOnDragStart:e,parentOnDrop:a,constraint:ot(d)}))},diskRoiWidgets:r.createElement(mt,{cx:s,cy:d,r:f,imageWidth:t,imageHeight:n})}}({scanHeight:n,scanWidth:t}),F=N.diskRoiHandles,H=N.diskRoiWidgets,W=N.diskRoiParameters,U=function(e,t){return null},B={roi:{}};switch(f){case Ct.DISK:U=F,O=H,B=W;break;case Ct.RECT:U=k,O=L,B=M}switch(d){case jt.PICK:U=I,O=void 0}return Ht({enabled:d===jt.SD&&c,scanWidth:t,scanHeight:n,analysisIndex:0,compoundAnalysisId:a,roiParameters:B,analysisType:P.SD_FRAMES}),Ht({enabled:d===jt.SUM&&c,scanWidth:t,scanHeight:n,analysisIndex:0,compoundAnalysisId:a,roiParameters:B,analysisType:P.SUM_FRAMES}),{frameViewTitle:d!==jt.PICK?null:r.createElement(r.Fragment,null,"Pick: x=",w.cx,", y=",w.cy," \u2003"),frameModeSelector:r.createElement(r.Fragment,null,y," ",g),roiSelector:g,handles:U,widgets:O}},Ut=n(726),Bt=function(e){var t=e.title,n=e.subtitle,a=e.left,c=e.right,i=e.toolbar;return r.createElement(r.Fragment,null,r.createElement(g.a,{as:"h3",attached:"top"},r.createElement(b.a,{name:"cog"}),r.createElement(g.a.Content,null,t)),r.createElement(S.a,{attached:!0},r.createElement(Ut.a,{columns:2},r.createElement(Ut.a.Row,null,r.createElement(Ut.a.Column,null,a,r.createElement("p",null,n)),r.createElement(Ut.a.Column,null,c)))),i)},Gt=n(7),Yt=n.n(Gt),Kt=n(28);function zt(){var e=window.location.pathname;return e.endsWith("/")?"".concat(e,"api/"):"".concat(e,"/api/")}function Vt(e){return Jt.apply(this,arguments)}function Jt(){return(Jt=Object(Kt.a)(Yt.a.mark((function e(t){var n,a;return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=zt(),e.next=3,fetch("".concat(n).concat(t),{credentials:"same-origin",method:"DELETE"});case 3:return a=e.sent,e.next=6,a.json();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qt(e,t){return qt.apply(this,arguments)}function qt(){return(qt=Object(Kt.a)(Yt.a.mark((function e(t,n){var a,r;return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=zt(),e.next=3,fetch("".concat(a).concat(t),{body:JSON.stringify(n),credentials:"same-origin",method:"PUT"});case 3:return r=e.sent,e.next=6,r.json();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Zt=function(e){var t=P[e];return On[t]},Xt=function(e){var t=e.compoundAnalysis,n=e.currentFormat,a=zt(),c=Object(s.d)((function(e){return e.analyses.byId})),i=Object(s.d)((function(e){return e.jobs.byId})),o=t.details.analyses.map((function(e){return c[e]})).filter((function(e){return e.jobs.some((function(e){return i[e].status===Ne.SUCCESS}))}));return r.createElement("ul",null,o.map((function(e){return r.createElement("li",{key:e.id},r.createElement("a",{href:(c=e.id,"".concat(a,"compoundAnalyses/").concat(t.compoundAnalysis,"/analyses/").concat(c,"/download/").concat(n,"/"))},function(e){return Zt(e.details.analysisType).desc}(e)," (channels: ",function(e){return e.displayedJob?i[e.displayedJob].results.filter((function(e){return e.description.includeInDownload})).map((function(e){return e.description.title})):[]}(e).join(", "),")"));var c})))},$t=function(e){var t,n=e.compoundAnalysis,a=Object(s.d)((function(e){return e.config.resultFileFormats})),c=Object.keys(a).map((function(e){return{value:e,text:a[e].description}})),i=Object(r.useState)(null===(t=c[0])||void 0===t?void 0:t.value),o=Object(We.a)(i,2),l=o[0],u=o[1];r.useEffect((function(){0===c.length||l||u(c[0].value)}),[c,l]);return r.createElement(h.a,{trigger:r.createElement(Y.a,{icon:!0},r.createElement(b.a,{name:"download"}),"Download")},r.createElement(y.a.Header,null,"Download Results, format: ",r.createElement(A.a,{inline:!0,options:c,onChange:function(e,t){u(t.value)},value:l})),r.createElement(y.a.Content,null,r.createElement(g.a,{as:"h3"},"Available results:"),r.createElement(Xt,{compoundAnalysis:n,currentFormat:l})))},en=function(e){var t=e.busyIdxs,n=e.onApply,a=e.compoundAnalysis,c=Object(s.c)(),i=Object(s.d)((function(e){return e.analyses})),o=Object(s.d)((function(e){return e.jobs})),l="busy"===function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],r=e.details.analyses;return a.length>0&&(r=r.filter((function(e,t){return-1!==a.indexOf(t)}))),r.reduce((function(e,a){var r=t.byId[a];return r?r.jobs.every((function(e){return n.byId[e].running===Me.DONE}))?e:"busy":e}),"idle")}(a,i,o,t)?{name:"cog",loading:!0}:{name:"check"};return r.createElement(S.a,{attached:"bottom"},r.createElement(Y.a.Group,null,r.createElement(Y.a,{primary:!0,onClick:n,icon:!0},r.createElement(b.a,l),"Apply"),r.createElement($t,{compoundAnalysis:a}),r.createElement(Y.a,{onClick:function(){return c(_t(a.compoundAnalysis))},icon:!0},r.createElement(b.a,{name:"remove"}),"Remove")))},tn=function(e){var t=e.compoundAnalysis,n=e.dataset.params.shape,a=Object(We.a)(n,4),c=a[0],i=a[1],o=a[2],l=a[3],u=Math.min(l,o),d=Object(r.useState)(l/2),m=Object(We.a)(d,2),p=m[0],E=m[1],f=Object(r.useState)(o/2),h=Object(We.a)(f,2),b=h[0],y=h[1],g=Object(r.useState)(u/4),O=Object(We.a)(g,2),v=O[0],x=O[1],A=Object(s.c)(),S={x:p-v,y:b},j=w((function(e,t){E(e),y(t)})),C=w(x),R=r.createElement(mt,{cx:p,cy:b,r:v,imageWidth:l,imageHeight:o}),T=Wt({scanWidth:i,scanHeight:c,compoundAnalysisId:t.compoundAnalysis,doAutoStart:t.doAutoStart}),D=T.frameViewTitle,I=T.frameModeSelector,_=T.handles,k=T.widgets,L=r.createElement(r.Fragment,null,D," Disk: center=(x=",p.toFixed(2),", y=",b.toFixed(2),"), r=",v.toFixed(2)),M=r.createElement(en,{compoundAnalysis:t,onApply:function(){A(wt(t.compoundAnalysis,1,{analysisType:P.CENTER_OF_MASS,parameters:{shape:"com",cx:p,cy:b,r:v}}))},busyIdxs:[1]});return r.createElement(Bt,{title:"COM analysis",subtitle:L,left:r.createElement(r.Fragment,null,r.createElement(ct,{extraHandles:function(e,t){return r.createElement(r.Fragment,null,r.createElement(At,{x:p,y:b,imageWidth:l,onDragMove:j,parentOnDragStart:e,parentOnDrop:t,constraint:it(l,o)}),r.createElement(At,{x:S.x,y:S.y,imageWidth:l,onDragMove:st(p,b,C),parentOnDragStart:e,parentOnDrop:t,constraint:ot(b)}))},extraWidgets:R,analysisIndex:0,compoundAnalysis:t.compoundAnalysis,width:l,height:o,selectors:I})),right:r.createElement(r.Fragment,null,r.createElement(ct,{analysisIndex:1,compoundAnalysis:t.compoundAnalysis,width:i,height:c,extraHandles:_,extraWidgets:k})),toolbar:M})},nn=n(722);function an(e,t,n,a){n===t&&(n+=360);var r=n-t;r=r<0?r+360:r;var c=[];return c.push(rn(t,a,e)),c.push(rn(t+r/3,a,e)),c.push(rn(t+2*r/3,a,e)),c.push(rn(n,a,e)),function(e,t,n){return["M",e[0].x,e[0].y,"A",t,t,0,0,n,e[1].x,e[1].y,"A",t,t,0,0,n,e[2].x,e[2].y,"A",t,t,0,0,n,e[3].x,e[3].y].join(" ")}(c,a,r<180?0:1)}function rn(e,t,n){var a=e*Math.PI/180;return{x:Math.cos(a)*t+n.x,y:Math.sin(a)*t+n.y}}var cn,sn=function(e){var t=e.imageWidth,n=e.cx,a=e.cy,c=e.ri,i=[an({x:n+.5,y:a+.5},90,90,e.ro),an({x:n+.5,y:a+.5},90,90,c)].join(" ");return r.createElement("path",{d:i,fillRule:"evenodd",style:Object(U.a)({},dt(t))})},on=function(e){var t=e.title,n=e.subtitle,a=e.left,c=e.mid,i=e.right,s=e.toolbar,o=e.clustparams,l=e.title1,u=e.title2,d=e.title3;return r.createElement(r.Fragment,null,r.createElement(g.a,{as:"h3",attached:"top"},r.createElement(b.a,{name:"cog"}),r.createElement(g.a.Content,null,t)),r.createElement(S.a,{attached:!0},r.createElement(Ut.a,{columns:3},r.createElement(Ut.a.Row,null,r.createElement(Ut.a.Column,{width:4},r.createElement("p",null,l)),r.createElement(Ut.a.Column,{width:6},r.createElement("p",null,u)),r.createElement(Ut.a.Column,{width:6},r.createElement("p",null,d))),r.createElement(Ut.a.Row,null,r.createElement(Ut.a.Column,{width:4},a),r.createElement(Ut.a.Column,{width:6},c),r.createElement(Ut.a.Column,{width:6},i)),r.createElement(Ut.a.Row,null,r.createElement(Ut.a.Column,{width:16},r.createElement("div",null,o),r.createElement("p",null,n))))),s)},ln=function(e){var t=e.compoundAnalysis,n=e.dataset.params.shape,a=Object(We.a)(n,4),c=a[0],i=a[1],o=a[2],l=a[3],u=Math.min(l,o),d=Object(r.useState)(l/2),m=Object(We.a)(d,2),p=m[0],E=m[1],f=Object(r.useState)(o/2),h=Object(We.a)(f,2),y=h[0],g=h[1],O=Object(r.useState)(u/4),v=Object(We.a)(O,2),x=v[0],A=v[1],S=Object(r.useState)(u/2),j=Object(We.a)(S,2),C=j[0],R=j[1],T={x:p-x,y:y},D={x:p-C,y:y},I=r.useState(1),_=Object(We.a)(I,2),k=_[0],L=_[1],M=r.useState(500),N=Object(We.a)(M,2),F=N[0],H=N[1],W=r.useState(20),U=Object(We.a)(W,2),B=U[0],Y=U[1],K=w((function(e,t){E(e),g(t)})),z=w(A),V=w(R),J=r.createElement(sn,{cx:p,cy:y,ri:x,ro:C,imageWidth:l}),Q=Object(s.c)(),q=Pt({scanWidth:i,scanHeight:c}),Z=q.rectRoiParameters,X=q.rectRoiHandles,$=q.rectRoiWidgets;r.useEffect((function(){t.doAutoStart&&Q(wt(t.compoundAnalysis,1,{analysisType:P.SUM_SIG,parameters:{}}))}),[t.compoundAnalysis,Q,t.doAutoStart]);var ee=Wt({scanWidth:i,scanHeight:c,compoundAnalysisId:t.compoundAnalysis,doAutoStart:t.doAutoStart}),te=ee.frameViewTitle,ne=ee.frameModeSelector,ae=ee.handles,re=ee.widgets,ce=r.createElement(r.Fragment,null,te," Ring: center=(x=",p.toFixed(2),", y=",y.toFixed(2),"), ri=",x.toFixed(2),", ro=",C.toFixed(2)),ie=r.createElement(en,{compoundAnalysis:t,onApply:function(){Q(wt(t.compoundAnalysis,2,{analysisType:P.CLUST,parameters:{roi:Z.roi,cx:p,cy:y,ri:x,ro:C,n_clust:B,n_peaks:F,min_dist:k}}))},busyIdxs:[2]}),se=r.useState(!1),oe=Object(We.a)(se,2),le=oe[0],ue=oe[1],de=r.createElement(nn.a,null,r.createElement(nn.a.Title,{active:le,index:0,onClick:function(e){ue(!le)}},r.createElement(b.a,{name:"dropdown"}),"Parameters"),r.createElement(nn.a.Content,{active:le},r.createElement(G.a,null,r.createElement(G.a.Field,null,r.createElement("label",null," Number of clusters  ",r.createElement("input",{type:"number",value:B,step:"1",min:"2",max:"100",onChange:function(e){Y(e.target.valueAsNumber)}})," ")),r.createElement(G.a.Field,null,r.createElement("label",null,"  Maximal number of possible peak positions to detect (better put higher value, the output is limited to the number of peaks the algorithm could find)  ",r.createElement("input",{type:"number",value:F,step:"1",min:"5",max:"200",onChange:function(e){H(e.target.valueAsNumber)}})," ")),r.createElement(G.a.Field,null,r.createElement("label",null,"  Minimal distance in pixels between peaks  ",r.createElement("input",{type:"number",value:k,step:"1",min:"0",max:"100",onChange:function(e){L(e.target.valueAsNumber)}}),"  ")))));return r.createElement(on,{title:"Region clustering",subtitle:ce,left:r.createElement(r.Fragment,null,r.createElement(ct,{extraHandles:function(e,t){return r.createElement(r.Fragment,null,r.createElement(St,{x:p,y:y,imageWidth:l,onDragMove:K,parentOnDrop:t,parentOnDragStart:e,constraint:it(l,o)}),r.createElement(St,{x:D.x,y:D.y,imageWidth:l,onDragMove:st(p,y,V),parentOnDrop:t,parentOnDragStart:e,constraint:ut(T.x,y)}),r.createElement(St,{x:T.x,y:T.y,imageWidth:l,parentOnDrop:t,parentOnDragStart:e,onDragMove:st(p,y,z),constraint:lt(D.x,y)}))},extraWidgets:J,analysisIndex:0,compoundAnalysis:t.compoundAnalysis,width:l,height:o,selectors:ne})),mid:r.createElement(r.Fragment,null,r.createElement(ct,{analysisIndex:1,compoundAnalysis:t.compoundAnalysis,width:i,height:c,extraHandles:X,extraWidgets:$})),right:r.createElement(r.Fragment,null,r.createElement(ct,{analysisIndex:2,compoundAnalysis:t.compoundAnalysis,width:i,height:c,extraHandles:ae,extraWidgets:re})),toolbar:ie,clustparams:de,title1:"Peaks inside the ring will be considered",title2:"Choose specimen region",title3:"Clustering result"})},un=function(e){var t=e.compoundAnalysis,n=e.dataset.params.shape,a=Object(We.a)(n,4),c=a[0],i=a[1],o=a[2],l=a[3],u=Math.min(l,o),d=Object(r.useState)(l/2),m=Object(We.a)(d,2),p=m[0],E=m[1],f=Object(r.useState)(o/2),h=Object(We.a)(f,2),b=h[0],y=h[1],g=Object(r.useState)(u/4),O=Object(We.a)(g,2),v=O[0],x=O[1],A=function(e,t){E(e),y(t)},S=x,j={x:p-v,y:b},C=r.createElement(mt,{cx:p,cy:b,r:v,imageWidth:l,imageHeight:o}),R=Object(s.c)(),T=Wt({scanWidth:i,scanHeight:c,compoundAnalysisId:t.compoundAnalysis,doAutoStart:t.doAutoStart}),D=T.frameViewTitle,w=T.frameModeSelector,I=T.handles,_=T.widgets,k=r.createElement(r.Fragment,null,D," Disk: center=(x=",p.toFixed(2),", y=",b.toFixed(2),"), r=",v.toFixed(2)),L=r.createElement(en,{compoundAnalysis:t,onApply:function(){R(wt(t.compoundAnalysis,1,{analysisType:P.APPLY_DISK_MASK,parameters:{shape:"disk",cx:p,cy:b,r:v}}))},busyIdxs:[1]});return r.createElement(Bt,{title:"Disk analysis",subtitle:k,left:r.createElement(r.Fragment,null,r.createElement(ct,{extraHandles:function(e,t){return r.createElement(r.Fragment,null,r.createElement(St,{x:p,y:b,imageWidth:l,onDragMove:A,parentOnDragStart:e,parentOnDrop:t,constraint:it(l,o)}),r.createElement(St,{x:j.x,y:j.y,imageWidth:l,onDragMove:st(p,b,S),parentOnDragStart:e,parentOnDrop:t,constraint:ot(b)}))},extraWidgets:C,analysisIndex:0,compoundAnalysis:t.compoundAnalysis,width:l,height:o,selectors:w})),right:r.createElement(r.Fragment,null,r.createElement(ct,{analysisIndex:1,compoundAnalysis:t.compoundAnalysis,width:i,height:c,extraHandles:I,extraWidgets:_})),toolbar:L})},dn=function(e){var t=e.compoundAnalysis,n=e.dataset.params.shape,a=Object(We.a)(n,4),c=a[0],i=a[1],o=a[2],l=a[3],u=Math.min(l,o),d=Object(r.useState)(l/2),m=Object(We.a)(d,2),p=m[0],E=m[1],f=Object(r.useState)(o/2),h=Object(We.a)(f,2),b=h[0],y=h[1],g=Object(r.useState)(u/4),O=Object(We.a)(g,2),v=O[0],x=O[1],A=Object(r.useState)(u/2),S=Object(We.a)(A,2),j=S[0],C=S[1],R={x:p-v,y:b},T={x:p-j,y:b},D=w((function(e,t){E(e),y(t)})),I=w(x),_=w(C),k=r.createElement(sn,{cx:p,cy:b,ri:v,ro:j,imageWidth:l}),L=Object(s.c)(),M=Wt({scanWidth:i,scanHeight:c,compoundAnalysisId:t.compoundAnalysis,doAutoStart:t.doAutoStart}),N=M.frameViewTitle,F=M.frameModeSelector,H=M.handles,W=M.widgets,U=r.createElement(r.Fragment,null,N," Ring: center=(x=",p.toFixed(2),", y=",b.toFixed(2),"), ri=",v.toFixed(2),", ro=",j.toFixed(2)),B=r.createElement(en,{compoundAnalysis:t,onApply:function(){L(wt(t.compoundAnalysis,1,{analysisType:P.FEM,parameters:{shape:"ring",cx:p,cy:b,ri:v,ro:j}}))},busyIdxs:[1]});return r.createElement(Bt,{title:"Fluctuation EM (SD over Ring analysis)",subtitle:U,left:r.createElement(r.Fragment,null,r.createElement(ct,{extraHandles:function(e,t){return r.createElement(r.Fragment,null,r.createElement(St,{x:p,y:b,imageWidth:l,onDragMove:D,parentOnDrop:t,parentOnDragStart:e,constraint:it(l,o)}),r.createElement(St,{x:T.x,y:T.y,imageWidth:l,onDragMove:st(p,b,_),parentOnDrop:t,parentOnDragStart:e,constraint:ut(R.x,b)}),r.createElement(St,{x:R.x,y:R.y,imageWidth:l,parentOnDrop:t,parentOnDragStart:e,onDragMove:st(p,b,I),constraint:lt(T.x,b)}))},extraWidgets:k,analysisIndex:0,compoundAnalysis:t.compoundAnalysis,width:l,height:o,selectors:F})),right:r.createElement(r.Fragment,null,r.createElement(ct,{analysisIndex:1,compoundAnalysis:t.compoundAnalysis,width:i,height:c,extraHandles:H,extraWidgets:W})),toolbar:B})},mn=function(e){var t=e.enabled,n=e.scanWidth,a=e.scanHeight,r=e.analysisIndex,i=e.compoundAnalysisId,o=e.cx,l=e.cy,u=e.real_rad,d=e.real_centerx,m=e.real_centery,p=e.setCx,E=e.setCy,f=Object(s.c)();c.a.useEffect((function(){t&&f(wt(i,r,{analysisType:P.PICK_FFT_FRAME,parameters:{x:o,y:l,real_rad:u,real_centerx:d,real_centery:m}}))}),[i,o,l,t,r,u,d,m,f]);var h=function(e,t){var n=Math.round(e),a=Math.round(t);o===n&&l===a||(p(n),E(a))};return{coords:{cx:o,cy:l},handles:function(e,t){return c.a.createElement(St,{x:o,y:l,withCross:!0,imageWidth:n,onDragMove:h,parentOnDragStart:e,parentOnDrop:t,constraint:it(n,a)})}}},pn=function(e){var t=e.enabled,n=e.analysisIndex,a=e.compoundAnalysisId,r=e.real_rad,i=e.real_centerx,o=e.real_centery,l=Object(s.c)();c.a.useEffect((function(){t&&l(wt(a,n,{analysisType:P.FFTSUM_FRAMES,parameters:{real_rad:r,real_centerx:i,real_centery:o}}))}),[a,t,n,r,i,o,l])},En=function(e){var t=e.scanWidth,n=e.scanHeight,a=e.compoundAnalysisId,c=e.real_rad,i=e.real_centerx,o=e.real_centery,l=e.doAutoStart,u=[{text:"Pick",value:P.PICK_FRAME},{text:"Average",value:P.SUM_FRAMES}],d=Object(r.useState)(P.SUM_FRAMES),m=Object(We.a)(d,2),p=m[0],E=m[1],f=Object(s.c)(),h=r.createElement(Nt,{modes:u,currentMode:p,onModeChange:function(e){f(Dt(a)),E(e)},label:"Mode"}),b=r.useState(Math.round(t/2)),y=Object(We.a)(b,2),g=y[0],O=y[1],v=r.useState(Math.round(n/2)),x=Object(We.a)(v,2),A=x[0],S=x[1],j=Mt({enabled:p===P.PICK_FRAME&&l,scanWidth:t,scanHeight:n,analysisIndex:1,compoundAnalysisId:a,cx:g,cy:A,setCx:O,setCy:S}),C=j.coords,R=j.handles;mn({enabled:p===P.PICK_FRAME&&l,scanWidth:t,scanHeight:n,analysisIndex:0,compoundAnalysisId:a,cx:g,cy:A,setCx:O,setCy:S,real_rad:c,real_centerx:i,real_centery:o}),Ht({enabled:p===P.SUM_FRAMES&&l,analysisIndex:1,compoundAnalysisId:a,scanWidth:t,scanHeight:n,roiParameters:{roi:{}},analysisType:P.SUM_FRAMES}),pn({enabled:p===P.SUM_FRAMES&&l,analysisIndex:0,compoundAnalysisId:a,real_rad:c,real_centerx:i,real_centery:o});return{frameViewTitle:p!==P.PICK_FRAME?null:r.createElement(r.Fragment,null,"Pick: x=",C.cx,", y=",C.cy," \u2003"),handles:p!==P.PICK_FRAME?function(e,t){return null}:R,frameModeSelector:h}},fn=function(e){var t=e.title,n=e.subtitle,a=e.left,c=e.mid,i=e.right,s=e.toolbar,o=e.title1,l=e.title2,u=e.title3;return r.createElement(r.Fragment,null,r.createElement(g.a,{as:"h3",attached:"top"},r.createElement(b.a,{name:"cog"}),r.createElement(g.a.Content,null,t)),r.createElement(S.a,{attached:!0},r.createElement(Ut.a,{columns:3},r.createElement(Ut.a.Row,null,r.createElement(Ut.a.Column,{width:5},r.createElement("p",null,o)),r.createElement(Ut.a.Column,{width:5},r.createElement("p",null,l)),r.createElement(Ut.a.Column,{width:6},r.createElement("p",null,u))),r.createElement(Ut.a.Row,null,r.createElement(Ut.a.Column,{width:5},a),r.createElement(Ut.a.Column,{width:5},c),r.createElement(Ut.a.Column,{width:6},i)),r.createElement(Ut.a.Row,null,r.createElement(Ut.a.Column,{width:10},r.createElement("p",null,n)),r.createElement(Ut.a.Column,{width:6})))),s)},hn=function(e){var t,n,a=e.compoundAnalysis,c=e.dataset.params.shape,i=Object(We.a)(c,4),o=i[0],l=i[1],u=i[2],d=i[3],m=Math.min(d,u),p=d/2,E=u/2,f=Object(r.useState)(m/4),h=Object(We.a)(f,2),b=h[0],y=h[1],g=Object(r.useState)(m/2),O=Object(We.a)(g,2),v=O[0],x=O[1],A=Object(s.c)(),S={x:p-b,y:E},j={x:p-v,y:E},C=w(y),R=w(x),T=r.createElement(sn,{cx:p,cy:E,ri:b,ro:v,imageWidth:d}),D=r.useState(!0),I=Object(We.a)(D,2),_=I[0],k=I[1],L=Object(r.useState)(d/2),M=Object(We.a)(L,2),N=M[0],F=M[1],H=Object(r.useState)(u/2),W=Object(We.a)(H,2),U=W[0],B=W[1],G=Object(r.useState)(m/4),Y=Object(We.a)(G,2),K=Y[0],z=Y[1],V=w((function(e,t){A(Dt(a.compoundAnalysis)),F(e),B(t)})),J=w(z),Q={x:N-K,y:U},q=r.createElement(mt,{cx:N,cy:U,r:K,imageWidth:d,imageHeight:u}),Z=En({scanWidth:l,scanHeight:o,compoundAnalysisId:a.compoundAnalysis,real_rad:_?K:null,real_centerx:_?N:null,real_centery:_?U:null,doAutoStart:a.doAutoStart}),X=Z.frameViewTitle,$=Z.frameModeSelector,ee=Z.handles,te=r.createElement(en,{compoundAnalysis:a,onApply:function(){A(wt(a.compoundAnalysis,2,{analysisType:P.APPLY_FFT_MASK,parameters:{rad_in:b,rad_out:v,real_rad:_?K:null,real_centerx:_?N:null,real_centery:_?U:null}}))},busyIdxs:[2]});return _?(n=r.createElement(r.Fragment,null,r.createElement(ct,{extraHandles:function(e,t){return r.createElement(r.Fragment,null,r.createElement(St,{x:N,y:U,imageWidth:d,onDragMove:V,parentOnDragStart:e,parentOnDrop:t,constraint:it(d,u)}),r.createElement(St,{x:Q.x,y:Q.y,imageWidth:d,onDragMove:st(N,U,J),parentOnDragStart:e,parentOnDrop:t,constraint:ot(U)}))},extraWidgets:q,analysisIndex:1,compoundAnalysis:a.compoundAnalysis,width:d,height:u,selectors:$})),t=r.createElement(r.Fragment,null,X," real_rad=",b.toFixed(2),", real_center=(x=",N.toFixed(2),", y=",U.toFixed(2),"), fourier_rad_in=",b.toFixed(2),", fourier_rad_out=",v.toFixed(2))):(n=r.createElement(r.Fragment,null,r.createElement(ct,{analysisIndex:1,compoundAnalysis:a.compoundAnalysis,width:d,height:u,selectors:$})),t=r.createElement(r.Fragment,null,X," fourier_rad_in=",b.toFixed(2),", fourier_rad_out=",v.toFixed(2))),r.createElement(fn,{title:"FFT analysis",subtitle:t,left:r.createElement(r.Fragment,null,r.createElement(ct,{extraHandles:function(e,t){return r.createElement(r.Fragment,null,r.createElement(St,{x:j.x,y:j.y,imageWidth:d,onDragMove:st(p,E,R),parentOnDrop:t,parentOnDragStart:e,constraint:ut(S.x,E)}),r.createElement(St,{x:S.x,y:S.y,imageWidth:d,parentOnDrop:t,parentOnDragStart:e,onDragMove:st(p,E,C),constraint:lt(j.x,E)}))},extraWidgets:T,analysisIndex:0,compoundAnalysis:a.compoundAnalysis,width:d,height:u})),mid:n,right:r.createElement(r.Fragment,null,r.createElement(ct,{analysisIndex:2,compoundAnalysis:a.compoundAnalysis,width:l,height:o,extraHandles:ee})),toolbar:te,title2:r.createElement(r.Fragment,null,r.createElement("label",null," Masking out of zero order diffraction peak ",r.createElement("input",{type:"checkbox",name:"check",onChange:function(e){A(Dt(a.compoundAnalysis)),k(e.target.checked)},checked:_})," ")),title1:"Masking of intergation region in Fourier space",title3:"Result of analysis"})},bn=function(e){var t=e.compoundAnalysis,n=e.dataset.params.shape,a=Object(We.a)(n,4),c=a[0],i=a[1],o=a[2],l=a[3],u=Object(r.useState)(l/2),d=Object(We.a)(u,2),m=d[0],p=d[1],E=Object(r.useState)(o/2),f=Object(We.a)(E,2),h=f[0],b=f[1],y=w((function(e,t){p(e),b(t)})),g=Wt({scanWidth:i,scanHeight:c,compoundAnalysisId:t.compoundAnalysis,doAutoStart:t.doAutoStart}),O=g.frameViewTitle,v=g.frameModeSelector,x=g.handles,A=g.widgets,S=r.createElement(r.Fragment,null,O," Point: center=(x=",m.toFixed(2),", y=",h.toFixed(2),")"),j=Object(s.c)(),C=r.createElement(en,{compoundAnalysis:t,onApply:function(){j(wt(t.compoundAnalysis,1,{analysisType:P.APPLY_POINT_SELECTOR,parameters:{shape:"point",cx:m,cy:h}}))},busyIdxs:[1]});return r.createElement(Bt,{title:"Point analysis",subtitle:S,left:r.createElement(r.Fragment,null,r.createElement(ct,{extraHandles:function(e,t){return r.createElement(r.Fragment,null,r.createElement(St,{x:m,y:h,withCross:!0,onDragMove:y,imageWidth:l,parentOnDragStart:e,parentOnDrop:t,constraint:it(l,o)}))},analysisIndex:0,compoundAnalysis:t.compoundAnalysis,width:l,height:o,selectors:v})),right:r.createElement(r.Fragment,null,r.createElement(ct,{analysisIndex:1,compoundAnalysis:t.compoundAnalysis,width:i,height:c,extraHandles:x,extraWidgets:A})),toolbar:C})},yn=function(e){var t=e.compoundAnalysis,n=e.dataset.params.shape,a=Object(We.a)(n,4),c=a[0],i=a[1],o=a[2],l=a[3],u=Math.min(l,o),d=Object(r.useState)(l/2),m=Object(We.a)(d,2),p=m[0],E=m[1],f=Object(r.useState)(o/2),h=Object(We.a)(f,2),b=h[0],y=h[1],g=Object(r.useState)(u/4),O=Object(We.a)(g,2),v=O[0],x=O[1],A=Object(r.useState)(u/2),S=Object(We.a)(A,2),j=S[0],C=S[1],R=Object(r.useState)(1),T=Object(We.a)(R,1)[0],D=Object(r.useState)(8),I=Object(We.a)(D,1)[0],_={x:p-v,y:b},k={x:p-j,y:b},L=w((function(e,t){E(e),y(t)})),M=w(x),N=w(C),F=r.createElement(sn,{cx:p,cy:b,ri:v,ro:j,imageWidth:l}),H=Wt({scanWidth:i,scanHeight:c,compoundAnalysisId:t.compoundAnalysis,doAutoStart:t.doAutoStart}),W=H.frameViewTitle,U=H.frameModeSelector,B=H.handles,G=H.widgets,Y=r.createElement(r.Fragment,null,W," Ring: center=(x=",p.toFixed(2),", y=",b.toFixed(2),"), ri=",v.toFixed(2),", ro=",j.toFixed(2)),K=Object(s.c)(),z=r.createElement(en,{compoundAnalysis:t,onApply:function(){K(wt(t.compoundAnalysis,1,{analysisType:P.RADIAL_FOURIER,parameters:{shape:"radial_fourier",cx:p,cy:b,ri:v,ro:j,n_bins:T,max_order:I}}))},busyIdxs:[1]});return r.createElement(Bt,{title:"Radial Fourier analysis",subtitle:Y,left:r.createElement(r.Fragment,null,r.createElement(ct,{extraHandles:function(e,t){return r.createElement(r.Fragment,null,r.createElement(St,{x:p,y:b,imageWidth:l,onDragMove:L,parentOnDrop:t,parentOnDragStart:e,constraint:it(l,o)}),r.createElement(St,{x:k.x,y:k.y,imageWidth:l,onDragMove:st(p,b,N),parentOnDrop:t,parentOnDragStart:e,constraint:ut(_.x,b)}),r.createElement(St,{x:_.x,y:_.y,imageWidth:l,parentOnDrop:t,parentOnDragStart:e,onDragMove:st(p,b,M),constraint:lt(k.x,b)}))},extraWidgets:F,analysisIndex:0,compoundAnalysis:t.compoundAnalysis,width:l,height:o,selectors:U})),right:r.createElement(r.Fragment,null,r.createElement(ct,{analysisIndex:1,compoundAnalysis:t.compoundAnalysis,width:i,height:c,extraHandles:B,extraWidgets:G})),toolbar:z})},gn=function(e){var t=e.compoundAnalysis,n=e.dataset.params.shape,a=Object(We.a)(n,4),c=a[0],i=a[1],o=a[2],l=a[3],u=Math.min(l,o),d=Object(r.useState)(l/2),m=Object(We.a)(d,2),p=m[0],E=m[1],f=Object(r.useState)(o/2),h=Object(We.a)(f,2),b=h[0],y=h[1],g=Object(r.useState)(u/4),O=Object(We.a)(g,2),v=O[0],x=O[1],A=Object(r.useState)(u/2),S=Object(We.a)(A,2),j=S[0],C=S[1],R={x:p-v,y:b},T={x:p-j,y:b},D=w((function(e,t){E(e),y(t)})),I=w(x),_=w(C),k=r.createElement(sn,{cx:p,cy:b,ri:v,ro:j,imageWidth:l}),L=Object(s.c)(),M=Wt({scanWidth:i,scanHeight:c,compoundAnalysisId:t.compoundAnalysis,doAutoStart:t.doAutoStart}),N=M.frameViewTitle,F=M.frameModeSelector,H=M.handles,W=M.widgets,U=r.createElement(r.Fragment,null,N," Ring: center=(x=",p.toFixed(2),", y=",b.toFixed(2),"), ri=",v.toFixed(2),", ro=",j.toFixed(2)),B=r.createElement(en,{compoundAnalysis:t,onApply:function(){L(wt(t.compoundAnalysis,1,{analysisType:P.APPLY_RING_MASK,parameters:{shape:"ring",cx:p,cy:b,ri:v,ro:j}}))},busyIdxs:[1]});return r.createElement(Bt,{title:"Ring analysis",subtitle:U,left:r.createElement(r.Fragment,null,r.createElement(ct,{extraHandles:function(e,t){return r.createElement(r.Fragment,null,r.createElement(St,{x:p,y:b,imageWidth:l,onDragMove:D,parentOnDrop:t,parentOnDragStart:e,constraint:it(l,o)}),r.createElement(St,{x:T.x,y:T.y,imageWidth:l,onDragMove:st(p,b,_),parentOnDrop:t,parentOnDragStart:e,constraint:ut(R.x,b)}),r.createElement(St,{x:R.x,y:R.y,imageWidth:l,parentOnDrop:t,parentOnDragStart:e,onDragMove:st(p,b,I),constraint:lt(T.x,b)}))},extraWidgets:k,analysisIndex:0,compoundAnalysis:t.compoundAnalysis,width:l,height:o,selectors:F})),right:r.createElement(r.Fragment,null,r.createElement(ct,{analysisIndex:1,compoundAnalysis:t.compoundAnalysis,width:i,height:c,extraHandles:H,extraWidgets:W})),toolbar:B})},On=(cn={},Object(L.a)(cn,P.APPLY_RING_MASK,{desc:"Application of a ring mask",title:"Ring",component:gn}),Object(L.a)(cn,P.APPLY_DISK_MASK,{desc:"Application of a disk mask",title:"Disk",component:un}),Object(L.a)(cn,P.FEM,{desc:"Application of a ring mask",title:"FEM (SD over Ring)",component:dn}),Object(L.a)(cn,P.CENTER_OF_MASS,{desc:"The center of mass of all diffraction images",title:"Center of mass",component:tn}),Object(L.a)(cn,P.APPLY_POINT_SELECTOR,{desc:"Image from a single pixel selected in the detector",title:"Point selection",component:bn}),Object(L.a)(cn,P.SUM_FRAMES,{desc:"A sum of all (or selected) detector frames",title:"Sum all frames"}),Object(L.a)(cn,P.SD_FRAMES,{desc:"A SD of all (or selected) detector frames",title:"SD all frames"}),Object(L.a)(cn,P.PICK_FRAME,{desc:"A single picked frame",title:"Pick frame"}),Object(L.a)(cn,P.PICK_FFT_FRAME,{desc:"Fourier transform of a picked frame",title:"Pick frame"}),Object(L.a)(cn,P.APPLY_FFT_MASK,{desc:"Application of a ring mask in Fourier space",title:"FFT analysis",component:hn}),Object(L.a)(cn,P.FFTSUM_FRAMES,{desc:"Fourier transform of sum of all detector frames",title:"FFT of Sum all frames"}),Object(L.a)(cn,P.RADIAL_FOURIER,{desc:"Radial Fourier analysis over the selected ring",title:"Radial Fourier",component:yn}),Object(L.a)(cn,P.CLUST,{desc:"Region clustering based on non-zero order diffraction peaks positions",title:"Clustering",component:ln}),Object(L.a)(cn,P.SUM_SIG,{desc:"Frame integration",title:"Sum"}),cn),vn=function(e){var t=e.analysis,n=Object(s.d)((function(e){return e.datasets.byId[t.dataset]}));if(n.status!==F.OPEN)return null;var a=On[t.details.mainType].component;if(!a)throw new Error("unknown analysis type");return r.createElement(a,{dataset:n,compoundAnalysis:t})},xn=function(e){var t=e.analyses;return r.createElement(r.Fragment,null,t.ids.map((function(e){return r.createElement(vn,{key:e,analysis:t.byId[e]})})))};function An(e,t,n){var a=Object.assign({},e.byId[t],n),r=Object.assign({},e.byId,Object(L.a)({},t,a));return Object.assign({},e,{byId:r})}function Sn(e,t,n){return{byId:Object.assign({},e.byId,Object(L.a)({},t,n)),ids:[].concat(Object(Ue.a)(e.ids),[t])}}function jn(e,t){return e.reduce((function(e,n){return Object.assign(e,Object(L.a)({},t(n),n))}),{})}function Cn(e,t){var n=e.ids.filter((function(n){return t(e.byId[n])}));return{byId:n.reduce((function(t,n){return Object.assign(t,Object(L.a)({},n,e.byId[n]))}),{}),ids:n}}var Rn=I(P).filter((function(e){return void 0!==Zt(e).component})).map((function(e){return{text:Zt(e).title,value:P[e]}})),Tn=function(e){var t=e.onClick,n=e.label;return r.createElement(A.a,{text:n,icon:"add",floating:!0,labeled:!0,button:!0,className:"icon"},r.createElement(A.a.Menu,null,r.createElement(A.a.Header,{content:"implemented analyses"}),Rn.map((function(e){return r.createElement(A.a.Item,Object.assign({key:e.value,onClick:(n=t,function(e,t){return n(t.value)})},e));var n}))))},Dn=Object(s.b)(null,(function(e,t){return{handleAddAnalysis:function(n){e(Rt(t.dataset.id,n))}}}))((function(e){var t=e.handleAddAnalysis;return r.createElement(Tn,{onClick:t,label:"Add analysis"})})),wn=n(719),In=n(238),_n=n(383),kn=n.n(_n);function Ln(e,t){return Mn.apply(this,arguments)}function Mn(){return(Mn=Object(Kt.a)(Yt.a.mark((function e(t,n){return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qt("datasets/".concat(t,"/"),n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Nn(e){return Fn.apply(this,arguments)}function Fn(){return(Fn=Object(Kt.a)(Yt.a.mark((function e(t){return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Vt("datasets/".concat(t,"/"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pn(e){return Hn.apply(this,arguments)}function Hn(){return(Hn=Object(Kt.a)(Yt.a.mark((function e(t){var n,a;return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=zt(),e.next=3,fetch("".concat(n,"datasets/detect/?path=").concat(encodeURIComponent(t)),{credentials:"same-origin",method:"GET"});case 3:return a=e.sent,e.next=6,a.json();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Wn={};function Un(e){return Bn.apply(this,arguments)}function Bn(){return(Bn=Object(Kt.a)(Yt.a.mark((function e(t){var n,a,r,c;return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=zt(),!(a=Wn[t])){e.next=6;break}return e.abrupt("return",new Promise((function(e){return e(a)})));case 6:return e.next=8,fetch("".concat(n,"datasets/schema/?type=").concat(encodeURIComponent(t)),{credentials:"same-origin",method:"GET"});case 8:return r=e.sent,e.next=11,r.json();case 11:return c=e.sent,Wn[t]=c,e.abrupt("return",c);case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Gn(e){var t={};return e.forEach((function(e){var n=e.dataPath.replace(/^\.([^[]+)(\[[^]+\])?$/,(function(e,t){return t}));t[n]=e.message})),t}function Yn(){return(Yn=Object(Kt.a)(Yt.a.mark((function e(t,n){return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Un(t).then((function(e){if("error"===e.status)throw new Error(e.msg);var t=e.schema,a=(new kn.a).compile(t);if(!a(n)){if(a.errors)throw Gn(a.errors);throw new Error("unspecified error while validating fields")}})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Kn(e){return e.split(",").filter((function(e){return""!==e.trim()})).map((function(e){return+e}))}function zn(e,t,n){return n&&void 0!==n[e]?n[e]:t}function Vn(e,t,n){return n&&void 0!==n[e]?n[e]:In.basename(t)}function Jn(e){return!!Object.keys(M).some((function(t){return t===e}))}function Qn(e){return!!Object.keys(N).some((function(t){return t===e}))}function qn(e){return Object(B.c)({mapPropsToValues:e.mapPropsToValues,handleSubmit:function(t,n){var a=n.props,r=a.onSubmit,c=a.path;r(e.formToJson(t,c)),n.setSubmitting(!1)},validate:function(t,n){return function(e,t){return Yn.apply(this,arguments)}(e.type,e.formToJson(t,n.path))},enableReinitialize:!0,validateOnChange:!0,validateOnBlur:!0})}var Zn,Xn=function(e){return Object.keys(e).map((function(t,n){return Qn(t)?null:r.createElement(wn.a.Row,{key:n},r.createElement(wn.a.Cell,null,t),r.createElement(wn.a.Cell,null,(a=e[t])instanceof Array?"(".concat(a.join(","),")"):a));var a}))},$n=function(e){var t=e.dataset;return r.createElement(wn.a,null,r.createElement(wn.a.Header,null,r.createElement(wn.a.Row,null,r.createElement(wn.a.HeaderCell,null,"Parameter"),r.createElement(wn.a.HeaderCell,null,"Value"))),r.createElement(wn.a.Body,null,Xn(t.params)))},ea=function(e){var t=e.elem;return r.createElement(wn.a.Row,null,r.createElement(wn.a.Cell,null,t.name),r.createElement(wn.a.Cell,null,function(e){return e.value instanceof Array?r.createElement(ta,{diagnostics:e.value}):e.value}(t)))},ta=function(e){var t=e.diagnostics;return 0===t.length?null:r.createElement(wn.a,null,r.createElement(wn.a.Header,null,r.createElement(wn.a.Row,null,r.createElement(wn.a.HeaderCell,null,"Name"),r.createElement(wn.a.HeaderCell,null,"Value"))),r.createElement(wn.a.Body,null,t.map((function(e,t){return r.createElement(ea,{elem:e,key:t})}))))},na=function(e){var t=e.dataset;return r.createElement(r.Fragment,null,r.createElement($n,{dataset:t}),r.createElement(ta,{diagnostics:t.diagnostics}))},aa=Object(s.b)(null,(function(e,t){return{handleRemoveDataset:function(){e(ie.delete(t.dataset.id))}}}))((function(e){e.dataset;var t=e.handleRemoveDataset;return r.createElement(r.Fragment,null,r.createElement(Y.a,{icon:"remove",labelPosition:"left",onClick:t,content:"Close Dataset"}))})),ra=Object(s.b)((function(e,t){return{analyses:Cn(e.compoundAnalyses,(function(e){return e.dataset===t.dataset.id}))}}))((function(e){var t,n=e.dataset,a=e.analyses,c=(t={},Object(L.a)(t,F.OPENING,"Opening dataset ".concat(n.params.name)),Object(L.a)(t,F.DELETING,"Closing dataset ".concat(n.params.name)),t);return n.status===F.OPENING||n.status===F.DELETING?r.createElement(r.Fragment,null,r.createElement(g.a,{as:"h2",dividing:!0},n.params.name),r.createElement(Z.a,{icon:!0},r.createElement(b.a,{name:"cog",loading:!0}),r.createElement(Z.a.Content,null,r.createElement(Z.a.Header,null,c[n.status])))):r.createElement(S.a.Group,{style:{marginTop:"3em",marginBottom:"3em"}},r.createElement(S.a.Group,{horizontal:!0},r.createElement(S.a,null,r.createElement(g.a,{as:"h2"},r.createElement(b.a,{name:"database"}),r.createElement(h.a,{trigger:r.createElement(g.a.Content,null,n.params.name," ",r.createElement(b.a,{name:"info circle",size:"small",link:!0}))},r.createElement(y.a.Header,null,n.params.type," Dataset ",n.params.name),r.createElement(y.a.Content,null,r.createElement(na,{dataset:n}))))),r.createElement(S.a,{style:{flexShrink:1,flexGrow:0}},r.createElement(aa,{dataset:n}))),a.ids.length>0?r.createElement(r.Fragment,null,r.createElement(S.a,null,r.createElement(xn,{analyses:a}))):null,r.createElement(S.a,{textAlign:"center"},r.createElement(Dn,{dataset:n})))})),ca=n(30),ia=n.n(ca),sa=qn({mapPropsToValues:function(e){var t=e.path,n=e.initial;return{name:Vn("name",t,n),tileshape:zn("tileshape","1, 8, 128, 128",n).toString()}},formToJson:function(e,t){return{path:t,type:M.BLO,name:e.name,tileshape:Kn(e.tileshape)}},type:M.BLO})((function(e){e.values,e.touched,e.errors,e.dirty;var t=e.isSubmitting,n=(e.handleChange,e.handleBlur,e.handleSubmit),a=e.handleReset,c=e.isValidating,i=e.onCancel;return r.createElement(G.a,{onSubmit:n},r.createElement(G.a.Field,null,r.createElement("label",{htmlFor:"id_name"},"Name:"),r.createElement(B.a,{name:"name"}),r.createElement(B.b,{name:"name",id:"id_name"})),r.createElement(G.a.Field,null,r.createElement("label",{htmlFor:"id_tileshape"},"Tileshape:"),r.createElement(B.a,{name:"tileshape"}),r.createElement(B.b,{name:"tileshape",id:"id_tileshape"})),r.createElement(Y.a,{primary:!0,type:"submit",disabled:t||c},"Load Dataset"),r.createElement(Y.a,{type:"button",onClick:i},"Cancel"),r.createElement(Y.a,{type:"button",onClick:a},"Reset"))})),oa=I(M).map((function(e){return{text:M[e],value:M[e]}})),la=function(e){var t=e.currentType,n=e.onClick;return r.createElement(r.Fragment,null,r.createElement(A.a,{inline:!0,options:oa,value:t,onChange:n}))},ua=qn({mapPropsToValues:function(e){var t=e.path,n=e.initial;return{name:Vn("name",t,n),scan_size:zn("scan_size","",n).toString()}},formToJson:function(e,t){return{path:t,type:M.EMPAD,name:e.name,scan_size:Kn(e.scan_size)}},type:M.EMPAD})((function(e){e.values,e.touched,e.errors,e.dirty;var t=e.isSubmitting,n=(e.handleChange,e.handleBlur,e.handleSubmit),a=e.handleReset,c=e.onCancel;return r.createElement(G.a,{onSubmit:n},r.createElement(G.a.Field,null,r.createElement("label",{htmlFor:"id_name"},"Name:"),r.createElement(B.a,{name:"name"}),r.createElement(B.b,{name:"name",id:"id_name"})),r.createElement(G.a.Field,null,r.createElement("label",{htmlFor:"id_scan_size"},"Scan Size:"),r.createElement(B.a,{name:"scan_size"}),r.createElement(B.b,{name:"scan_size",id:"id_scan_size"})),r.createElement(Y.a,{primary:!0,type:"submit",disabled:t},"Load Dataset"),r.createElement(Y.a,{type:"button",onClick:c},"Cancel"),r.createElement(Y.a,{type:"button",onClick:a},"Reset"))})),da=qn({mapPropsToValues:function(e){return{name:Vn("name",e.path,e.initial)}},formToJson:function(e,t){return{path:t,type:M.FRMS6,name:e.name}},type:M.FRMS6})((function(e){e.values,e.touched,e.errors,e.dirty;var t=e.isSubmitting,n=(e.handleChange,e.handleBlur,e.handleSubmit),a=e.handleReset,c=e.onCancel;return r.createElement(G.a,{onSubmit:n},r.createElement(G.a.Field,null,r.createElement("label",{htmlFor:"id_name"},"Name:"),r.createElement(B.a,{name:"name"}),r.createElement(B.b,{name:"name",id:"id_name"})),r.createElement(Y.a,{primary:!0,type:"submit",disabled:t},"Load Dataset"),r.createElement(Y.a,{type:"button",onClick:c},"Cancel"),r.createElement(Y.a,{type:"button",onClick:a},"Reset"))})),ma=qn({mapPropsToValues:function(e){var t=e.path,n=e.initial;return{name:Vn("name",t,n),dataset_paths:zn("dataset_paths",[],n),tileshape:zn("tileshape","1, 8, 128, 128",n).toString(),ds_path:zn("ds_path","",n)}},formToJson:function(e,t){return{path:t,type:M.HDF5,name:e.name,ds_path:e.ds_path,dataset_paths:e.dataset_paths,tileshape:Kn(e.tileshape)}},type:M.HDF5})((function(e){var t,n=e.values,a=(e.touched,e.errors,e.dirty,e.isSubmitting),c=(e.handleChange,e.handleBlur,e.handleSubmit),i=e.handleReset,s=e.onCancel,o=e.setFieldValue,l=n.dataset_paths.map((function(e){return{key:e,text:e,value:e}}));return t=0===n.dataset_paths.length?r.createElement(B.b,{name:"ds_path",id:"id_ds_path"}):r.createElement(A.a,{name:"ds_path",id:"id_ds_path",placeholder:"Select dataset",fluid:!0,search:!0,selection:!0,defaultValue:n.ds_path,onChange:function(e,t){var n=t.value;n&&o("ds_path",n.toString())},options:l}),r.createElement(G.a,{onSubmit:c},r.createElement(G.a.Field,null,r.createElement("label",{htmlFor:"id_name"},"Name:"),r.createElement(B.a,{name:"name"}),r.createElement(B.b,{name:"name",id:"id_name"})),r.createElement(G.a.Field,null,r.createElement("label",{htmlFor:"id_ds_path"},"HDF5 Dataset Path:"),r.createElement(B.a,{name:"ds_path"}),t),r.createElement(G.a.Field,null,r.createElement("label",{htmlFor:"id_tileshape"},"Tileshape:"),r.createElement(B.a,{name:"tileshape"}),r.createElement(B.b,{name:"tileshape",id:"id_tileshape"})),r.createElement(Y.a,{primary:!0,type:"submit",disabled:a},"Load Dataset"),r.createElement(Y.a,{onClick:s},"Cancel"),r.createElement(Y.a,{type:"button",onClick:i},"Reset"))})),pa=qn({mapPropsToValues:function(e){return{name:Vn("name",e.path,e.initial)}},formToJson:function(e,t){return{path:t,type:M.K2IS,name:e.name}},type:M.K2IS})((function(e){e.values,e.touched,e.errors,e.dirty;var t=e.isSubmitting,n=(e.handleChange,e.handleBlur,e.handleSubmit),a=e.handleReset,c=e.onCancel;return r.createElement(G.a,{onSubmit:n},r.createElement(G.a.Field,null,r.createElement("label",{htmlFor:"id_name"},"Name:"),r.createElement(B.a,{name:"name"}),r.createElement(B.b,{name:"name",id:"id_name"})),r.createElement(Y.a,{primary:!0,type:"submit",disabled:t},"Load Dataset"),r.createElement(Y.a,{type:"button",onClick:c},"Cancel"),r.createElement(Y.a,{type:"button",onClick:a},"Reset"))})),Ea=qn({formToJson:function(e,t){return{path:t,type:M.MIB,name:e.name,tileshape:Kn(e.tileshape),scan_size:Kn(e.scan_size)}},mapPropsToValues:function(e){var t=e.path,n=e.initial;return{name:Vn("name",t,n),tileshape:zn("tileshape","1, 8, 256, 256",n).toString(),scan_size:zn("scan_size","",n).toString()}},type:M.MIB})((function(e){e.values,e.touched,e.errors,e.dirty;var t=e.isSubmitting,n=(e.handleChange,e.handleBlur,e.handleSubmit),a=e.handleReset,c=e.isValidating,i=e.onCancel;return r.createElement(G.a,{onSubmit:n},r.createElement(G.a.Field,null,r.createElement("label",{htmlFor:"id_name"},"Name:"),r.createElement(B.a,{name:"name"}),r.createElement(B.b,{name:"name",id:"id_name"})),r.createElement(G.a.Field,null,r.createElement("label",{htmlFor:"id_tileshape"},"Tileshape:"),r.createElement(B.a,{name:"tileshape"}),r.createElement(B.b,{name:"tileshape",id:"id_tileshape"})),r.createElement(G.a.Field,null,r.createElement("label",{htmlFor:"id_scan_size"},"Scan Size:"),r.createElement(B.a,{name:"scan_size"}),r.createElement(B.b,{name:"scan_size",id:"id_scan_size"})),r.createElement(Y.a,{primary:!0,type:"submit",disabled:t||c},"Load Dataset"),r.createElement(Y.a,{type:"button",onClick:i},"Cancel"),r.createElement(Y.a,{type:"button",onClick:a},"Reset"))})),fa=qn({mapPropsToValues:function(e){var t=e.path,n=e.initial;return{name:Vn("name",t,n),enable_direct:zn("enable_direct",!1,n),detector_size:zn("detector_size","",n).toString(),scan_size:zn("scan_size","",n).toString(),dtype:zn("dtype","float32",n)}},formToJson:function(e,t){return{path:t,type:M.RAW,name:e.name,dtype:e.dtype,enable_direct:e.enable_direct,scan_size:Kn(e.scan_size),detector_size:Kn(e.detector_size)}},type:M.RAW})((function(e){var t=e.values,n=(e.touched,e.errors,e.dirty,e.isSubmitting),a=(e.handleChange,e.handleBlur,e.handleSubmit),c=e.handleReset,i=e.onCancel;return r.createElement(G.a,{onSubmit:a},r.createElement(G.a.Field,null,r.createElement("label",{htmlFor:"id_name"},"Name:"),r.createElement(B.a,{name:"name"}),r.createElement(B.b,{name:"name",id:"id_name"})),r.createElement(G.a.Field,null,r.createElement("label",{htmlFor:"id_scan_size"},"Scan Size:"),r.createElement(B.a,{name:"scan_size"}),r.createElement(B.b,{name:"scan_size",id:"id_scan_size"})),r.createElement(G.a.Field,null,r.createElement("label",{htmlFor:"id_dtype"},"Datatype (uint16, uint32, float32, float64, >u2, ..., can be anything that is ",r.createElement("a",{href:"https://docs.scipy.org/doc/numpy-1.15.1/reference/arrays.dtypes.html"},"understood by numpy as a dtype"),"):"),r.createElement(B.a,{name:"dtype"}),r.createElement(B.b,{name:"dtype",id:"id_dtype"})),r.createElement(G.a.Field,null,r.createElement("label",{htmlFor:"id_detector_size"},"Detector Size (pixels, example: 256,256):"),r.createElement(B.a,{name:"detector_size"}),r.createElement(B.b,{name:"detector_size",id:"id_detector_size"})),r.createElement(G.a.Field,null,r.createElement("label",{htmlFor:"id_enable_direct"},"Enable Direct I/O (for usage with fast SSDs and files much larger than RAM):"),r.createElement(B.a,{name:"enable_direct"}),r.createElement(B.b,{type:"checkbox",name:"enable_direct",checked:t.enable_direct,id:"id_enable_direct"})),r.createElement(Y.a,{primary:!0,type:"submit",disabled:n},"Load Dataset"),r.createElement(Y.a,{type:"button",onClick:i},"Cancel"),r.createElement(Y.a,{type:"button",onClick:c},"Reset"))})),ha=qn({mapPropsToValues:function(e){return{name:Vn("name",e.path,e.initial)}},formToJson:function(e,t){return{path:t,type:M.SER,name:e.name}},type:M.SER})((function(e){e.values,e.touched,e.errors,e.dirty;var t=e.isSubmitting,n=(e.handleChange,e.handleBlur,e.handleSubmit),a=e.handleReset,c=e.onCancel;return r.createElement(G.a,{onSubmit:n},r.createElement(G.a.Field,null,r.createElement("label",{htmlFor:"id_name"},"Name:"),r.createElement(B.a,{name:"name"}),r.createElement(B.b,{name:"name",id:"id_name"})),r.createElement(Y.a,{primary:!0,type:"submit",disabled:t},"Load Dataset"),r.createElement(Y.a,{type:"button",onClick:c},"Cancel"),r.createElement(Y.a,{type:"button",onClick:a},"Reset"))})),ba=function(e,t){var n=t.formCachedParams,a=t.formDetectedParams;return e?a?a.type:M.RAW:n?n.type:a?a.type:M.RAW},ya=function(e,t){var n=t.formCachedParams,a=t.formDetectedParams;if(e)return a?Object(U.a)({name:n?n.name:""},a):void 0;if(n){if(a){var r=function(e){return Object.keys(e).filter(Qn).reduce((function(t,n){return n in e?Object(U.a)({},t,Object(L.a)({},n,e[n])):Object(U.a)({},t)}),{})}(a);return Object(U.a)({},r,{},n)}return n}return a},ga=function(){var e=Object(s.c)(),t=Object(s.d)((function(e){return e.openDataset})),n=r.useState(!1),a=Object(We.a)(n,2),c=a[0],i=a[1],o=ya(c,t),l=ba(c,t),u=r.useState(l),d=Object(We.a)(u,2),m=d[0],p=d[1],E=function(e,t){return p(t.value)},f=function(e){return r.createElement(S.a,null,"Type: ",r.createElement(la,{onClick:E,currentType:m}),r.createElement(g.a,{as:"h2"},"Open: ",t.formPath),e)},h={path:t.formPath,onSubmit:function(t){e(ie.create({id:ia()(),params:t}))},onCancel:function(){return e(ie.cancelOpen())},onReset:function(){i(!0),p(ba(!0,t))}};switch(m){case M.HDF5:var b=o&&m===o.type?o:void 0;return f(r.createElement(ma,Object.assign({},h,{initial:b})));case M.RAW:var y=o&&m===o.type?o:void 0;return f(r.createElement(fa,Object.assign({},h,{initial:y})));case M.MIB:var O=o&&m===o.type?o:void 0;return f(r.createElement(Ea,Object.assign({},h,{initial:O})));case M.BLO:var v=o&&m===o.type?o:void 0;return f(r.createElement(sa,Object.assign({},h,{initial:v})));case M.K2IS:var x=o&&m===o.type?o:void 0;return f(r.createElement(pa,Object.assign({},h,{initial:x})));case M.SER:var A=o&&m===o.type?o:void 0;return f(r.createElement(ha,Object.assign({},h,{initial:A})));case M.FRMS6:var j=o&&m===o.type?o:void 0;return f(r.createElement(da,Object.assign({},h,{initial:j})));case M.EMPAD:var C=o&&m===o.type?o:void 0;return f(r.createElement(ua,Object.assign({},h,{initial:C})))}return D("unknown dataset type")},Oa=Object(s.b)((function(e){return{busy:e.openDataset.busy,path:e.openDataset.busyPath}}))((function(e){var t=e.busy,n=e.path;return t?r.createElement(r.Fragment,null,r.createElement(g.a,{as:"h2",dividing:!0},"Loading..."),r.createElement(Z.a,{icon:!0},r.createElement(b.a,{name:"cog",loading:!0}),r.createElement(Z.a.Content,null,r.createElement(Z.a.Header,null,"Detecting parameters for ",n)))):null})),va=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.formVisible,n=e.datasets;return r.createElement(r.Fragment,null,n.ids.map((function(e){return r.createElement(ra,{dataset:n.byId[e],key:e})})),r.createElement(Oa,null),t&&r.createElement(ga,null),r.createElement(He,null))}}]),t}(r.Component),xa=Object(s.b)((function(e){return{datasets:e.datasets,formVisible:e.openDataset.formVisible,formPath:e.openDataset.formPath}}))(va);!function(e){e.DISMISS="ERROR_DISMISS",e.DISMISS_ALL="ERROR_DISMISS_ALL"}(Zn||(Zn={}));var Aa=function(e){return j(Zn.DISMISS,{id:e})},Sa=function(){return j(Zn.DISMISS_ALL)},ja=Object(s.b)(null,(function(e,t){return{dismiss:function(){return e(Aa(t.error.id))}}}))((function(e){var t=e.dismiss,n=e.error;return r.createElement(Z.a,{negative:!0,onDismiss:t},n.msg)})),Ca=Object(s.b)((function(e){return{errors:e.errors,channelConnected:"connected"===e.channelStatus.status||"ready"===e.channelStatus.status}}))((function(e){var t,n=e.errors,a=e.channelConnected,i=n.ids.slice(Math.max(0,n.ids.length-3)),o=n.ids.length>0&&a,l=Object(s.c)();return t=function(){l(Sa())},c.a.useEffect((function(){var e=function(e){"Escape"!==e.code&&27!==e.keyCode||t()};return document.addEventListener("keyup",e),function(){document.removeEventListener("keyup",e)}})),r.createElement(h.a,{open:o},i.map((function(e){return r.createElement(ja,{error:n.byId[e],key:e})})))})),Ra=n(384),Ta=n.n(Ra),Da=x,wa=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(E.a)(t,e),Object(d.a)(t,[{key:"render",value:function(){var e=this.props,t=e.noOfDatasets,n=e.isVisible,a=e.isbusy;return r.createElement(f.a,{style:{margin:"5em 1em 5em 1em"}},t||n||a?r.createElement("div",{style:{display:"flex"}},r.createElement("img",{src:Ta.a,width:"200",height:"46",alt:"LiberTEM",style:{marginBottom:"20px"}})," ",r.createElement(h.a,{trigger:r.createElement(b.a,{name:"info circle",link:!0,style:{alignSelf:"flex-start"}})},r.createElement(y.a.Header,null,"About LiberTEM"),r.createElement(y.a.Content,null,r.createElement(v,null)))):"",r.createElement(Ca,null),r.createElement(re,null,r.createElement(xa,null)))}}]),t}(r.Component),Ia=Object(s.b)(Da)(wa),_a=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function ka(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var La=n(6);function Ma(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];var r=function(t){return t.replace(new RegExp("".concat(T.a.escapeRegExp(e.separator),"$")),"")};return(n=[r(n[0])].concat(Object(Ue.a)(n.slice(1)))).map((function(e){return e.trim()})).join(e.separator)}function Na(e){var t=window.localStorage.getItem("LiberTEM.config");if(null===t)return Object.assign({},e,Pa(e));var n=JSON.parse(t),a=Pa(e);return Object.assign({},a,e,n)}function Fa(e){var t={cwd:e.cwd,lastOpened:e.lastOpened,fileHistory:e.fileHistory,lastConnection:e.lastConnection};window.localStorage.setItem("LiberTEM.config",JSON.stringify(t))}function Pa(e){return{lastOpened:{},fileHistory:[],cwd:"/",lastConnection:{type:k.LOCAL,address:"tcp://localhost:8786"}}}function Ha(e){return e.reduce((function(e,t){return-1===e.indexOf(t)?[].concat(Object(Ue.a)(e),[t]):e}),[])}function Wa(e){return Ua.apply(this,arguments)}function Ua(){return(Ua=Object(Kt.a)(Yt.a.mark((function e(t){var n,a,r;return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=zt(),a="".concat(n,"browse/localfs/?path=").concat(encodeURIComponent(t)),e.next=4,fetch(a,{method:"GET",credentials:"same-origin"});case 4:return r=e.sent,e.next=7,r.json();case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ba,Ga=Yt.a.mark(Va),Ya=Yt.a.mark(Ja),Ka=Yt.a.mark(Qa),za=Yt.a.mark(qa);function Va(){return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(La.f)(Ja);case 2:return e.next=4,Object(La.f)(qa);case 4:case"end":return e.stop()}}),Ga)}function Ja(){var e,t,n,a,r,c;return Yt.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=3,Object(La.i)(ce.LIST_DIRECTORY);case 3:return e=i.sent,t=e.payload,n=t.name,a=t.path,i.next=7,Object(La.h)((function(e){return e.config}));case 7:return r=i.sent,c=void 0!==n?Ma(r,a,n):a,i.next=11,Object(La.f)(Qa,c);case 11:i.next=0;break;case 13:case"end":return i.stop()}}),Ya)}function Qa(e){var t,n,a,r,c,i,s,o;return Yt.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return l.prev=0,l.next=3,Object(La.c)(Wa,e);case 3:if("ok"!==(t=l.sent).status){l.next=9;break}return l.next=7,Object(La.g)(se.dirListing(t.path,t.dirs,t.files,t.drives,t.places));case 7:l.next=24;break;case 9:if("error"!==t.status){l.next=24;break}return l.next=12,Object(La.h)((function(e){return e.browser}));case 12:return n=l.sent,a=Date.now(),r=ia()(),c=t.alternative?t.alternative:n.places.home.path,l.next=18,Object(La.h)((function(e){return e.config}));case 18:if(l.sent.cwd===e){l.next=22;break}return l.next=22,Object(La.g)(se.error("Error browsing directory: ".concat(t.msg),a,r));case 22:return l.next=24,Object(La.g)(se.list(c));case 24:l.next=37;break;case 26:return l.prev=26,l.t0=l.catch(0),l.next=30,Object(La.h)((function(e){return e.browser}));case 30:return i=l.sent,s=Date.now(),o=ia()(),l.next=35,Object(La.g)(se.error("Error browsing directory: ".concat(l.t0.toString()),s,o));case 35:return l.next=37,Object(La.g)(se.list(i.places.home.path));case 37:case"end":return l.stop()}}),Ka,null,[[0,26]])}function qa(){var e;return Yt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,Object(La.i)(ce.OPEN);case 3:return t.next=5,Object(La.h)((function(e){return e.config}));case 5:return e=t.sent,t.next=8,Object(La.g)(se.list(e.cwd));case 8:t.next=0;break;case 10:case"end":return t.stop()}}),za)}!function(e){e.INITIAL_STATE="CHANNEL_INITIAL_STATE",e.JOB_STARTED="CHANNEL_JOB_STARTED",e.FINISH_JOB="CHANNEL_FINISH_JOB",e.TASK_RESULT="CHANNEL_TASK_RESULT",e.JOB_ERROR="CHANNEL_JOB_ERROR",e.OPEN="CHANNEL_OPEN",e.CLOSE="CHANNEL_CLOSE",e.ERROR="CHANNEL_ERROR",e.CANCELLED="CANCELLED",e.ANALYSIS_CREATED="ANALYSIS_CREATED",e.ANALYSIS_UPDATED="ANALYSIS_UPDATED",e.ANALYSIS_REMOVED="ANALYSIS_REMOVED"}(Ba||(Ba={}));var Za,Xa=function(e,t,n,a,r){return j(Ba.INITIAL_STATE,{jobs:e,datasets:t,timestamp:r,compoundAnalyses:n,analyses:a})},$a=function(e,t,n){return j(Ba.JOB_STARTED,{job:e,timestamp:n,dataset:t})},er=function(e,t,n){return j(Ba.FINISH_JOB,{job:e,results:t,timestamp:n})},tr=function(e,t,n){return j(Ba.TASK_RESULT,{job:e,results:t,timestamp:n})},nr=function(e,t,n,a){return j(Ba.JOB_ERROR,{job:e,msg:t,id:n,timestamp:a})},ar=function(e){return j(Ba.OPEN,{timestamp:e})},rr=function(e){return j(Ba.CLOSE,{timestamp:e})},cr=function(e,t,n){return j(Ba.ERROR,{msg:e,timestamp:t,id:n})},ir=function(e){return j(Ba.CANCELLED,{job:e})};function sr(e,t){return Object.assign({messageType:e},t)}!function(e){e.INITIAL_STATE="INITIAL_STATE",e.JOB_STARTED="JOB_STARTED",e.FINISH_JOB="FINISH_JOB",e.TASK_RESULT="TASK_RESULT",e.JOB_ERROR="JOB_ERROR",e.BINARY="BINARY",e.OPEN="OPEN",e.CLOSE="CLOSE",e.ERROR="ERROR",e.DELETE_DATASET="DELETE_DATASET",e.CREATE_DATASET="CREATE_DATASET",e.CANCEL_JOB_DONE="CANCEL_JOB_DONE",e.ANALYSIS_CREATED="ANALYSIS_CREATED",e.ANALYSIS_UPDATED="ANALYSIS_UPDATED",e.ANALYSIS_REMOVED="ANALYSIS_REMOVED",e.COMPOUND_ANALYSIS_CREATED="COMPOUND_ANALYSIS_CREATED",e.COMPOUND_ANALYSIS_UPDATED="COMPOUND_ANALYSIS_UPDATED",e.COMPOUND_ANALYSIS_REMOVED="COMPOUND_ANALYSIS_REMOVED"}(Za||(Za={}));var or=function(e){return sr(Za.BINARY,{objectURL:e})},lr=function(){return sr(Za.OPEN,{})},ur=function(){return sr(Za.CLOSE,{})},dr=function(e){return sr(Za.ERROR,{msg:e})},mr=Yt.a.mark(yr),pr=Yt.a.mark(gr),Er=Yt.a.mark(Or),fr=Yt.a.mark(vr),hr=Yt.a.mark(xr);function br(){return Object(l.d)((function(e){function t(t){if(t.data instanceof Blob)e(or(URL.createObjectURL(t.data)));else{var n=JSON.parse(t.data);e(n)}}function n(){e(lr())}function a(){e(ur()),e(l.a)}function r(t){e(dr("Error in weboscket connection"))}var c=new WebSocket(function(){var e=zt();return"ws://".concat(window.location.hostname,":").concat(window.location.port).concat(e,"events/")}());return c.addEventListener("message",t),c.addEventListener("open",n),c.addEventListener("close",a),c.addEventListener("error",r),function(){c.removeEventListener("message",t),c.removeEventListener("open",n),c.removeEventListener("close",a),c.removeEventListener("error",r)}}))}function yr(){var e;return Yt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,Object(La.c)(br);case 3:return e=t.sent,t.next=6,Object(La.f)(gr,e);case 6:return t.next=8,Object(La.i)([Ba.OPEN,Ba.CLOSE]);case 8:if(t.sent.type!==Ba.OPEN){t.next=12;break}return t.next=12,Object(La.i)([Ba.CLOSE,Ba.ERROR]);case 12:return t.next=14,Object(La.e)(1e3);case 14:t.next=0;break;case 16:case"end":return t.stop()}}),mr)}function gr(e){var t,n,a,r;return Yt.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:c.prev=0;case 1:return c.next=4,Object(La.i)(e);case 4:t=c.sent,n=Date.now(),c.t0=t.messageType,c.next=c.t0===Za.OPEN?9:c.t0===Za.CLOSE?12:c.t0===Za.ERROR?15:c.t0===Za.INITIAL_STATE?19:c.t0===Za.JOB_STARTED?22:c.t0===Za.FINISH_JOB?25:c.t0===Za.TASK_RESULT?28:c.t0===Za.CREATE_DATASET?31:c.t0===Za.DELETE_DATASET?34:c.t0===Za.JOB_ERROR?37:c.t0===Za.CANCEL_JOB_DONE?41:44;break;case 9:return c.next=11,Object(La.g)(ar(n));case 11:return c.abrupt("break",44);case 12:return c.next=14,Object(La.g)(rr(n));case 14:return c.abrupt("break",44);case 15:return a=ia()(),c.next=18,Object(La.g)(cr(t.msg,n,a));case 18:return c.abrupt("break",44);case 19:return c.next=21,Object(La.g)(Xa(t.jobs,t.datasets,t.compoundAnalyses,t.analyses,n));case 21:return c.abrupt("break",44);case 22:return c.next=24,Object(La.g)($a(t.job,t.details.dataset,n));case 24:return c.abrupt("break",44);case 25:return c.next=27,Object(La.c)(xr,t,e,n);case 27:return c.abrupt("break",44);case 28:return c.next=30,Object(La.c)(vr,t,e,n);case 30:return c.abrupt("break",44);case 31:return c.next=33,Object(La.g)(ie.created(t.details));case 33:return c.abrupt("break",44);case 34:return c.next=36,Object(La.g)(ie.deleted(t.dataset));case 36:return c.abrupt("break",44);case 37:return r=ia()(),c.next=40,Object(La.g)(nr(t.job,t.msg,r,n));case 40:return c.abrupt("break",44);case 41:return c.next=43,Object(La.g)(ir(t.job));case 43:return c.abrupt("break",44);case 44:c.next=1;break;case 46:return c.prev=46,c.finish(46);case 48:case"end":return c.stop()}}),pr,null,[[0,,46,48]])}function Or(e,t){var n,a;return Yt.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=[];case 1:if(!(n.length<e)){r.next=8;break}return r.next=4,Object(La.i)(t);case 4:a=r.sent,n.push(a),r.next=1;break;case 8:return r.abrupt("return",n);case 9:case"end":return r.stop()}}),Er)}function vr(e,t,n){var a,r;return Yt.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(La.c)(Or,e.followup.numMessages,t);case 2:return a=c.sent,r=a.map((function(t,n){return{imageURL:t.objectURL,description:e.followup.descriptions[n]}})),c.next=6,Object(La.g)(tr(e.job,r,n));case 6:case"end":return c.stop()}}),fr)}function xr(e,t,n){var a,r;return Yt.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,Object(La.c)(Or,e.followup.numMessages,t);case 2:return a=c.sent,r=a.map((function(t,n){return{imageURL:t.objectURL,description:e.followup.descriptions[n]}})),c.next=6,Object(La.g)(er(e.job,r,n));case 6:case"end":return c.stop()}}),hr)}function Ar(e){return Sr.apply(this,arguments)}function Sr(){return(Sr=Object(Kt.a)(Yt.a.mark((function e(t){var n;return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={connection:t},e.next=3,Qt("config/connection/",n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function jr(){return Cr.apply(this,arguments)}function Cr(){return(Cr=Object(Kt.a)(Yt.a.mark((function e(){var t,n;return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=zt(),e.next=3,fetch("".concat(t,"config/connection/"),{method:"GET"});case 3:return n=e.sent,e.next=6,n.json();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Rr,Tr=Yt.a.mark(_r),Dr=Yt.a.mark(kr),wr=Yt.a.mark(Lr),Ir=Yt.a.mark(Mr);function _r(e){var t;return Yt.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(La.g)(C.connecting());case 2:return n.next=4,Object(La.c)(Ar,e.payload.params);case 4:return t=n.sent,n.next=7,Object(La.c)(kr,t);case 7:case"end":return n.stop()}}),Tr)}function kr(e){var t,n;return Yt.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if("ok"!==e.status){a.next=5;break}return a.next=3,Object(La.g)(C.connected(e.connection.connection));case 3:a.next=16;break;case 5:if("error"!==e.status){a.next=14;break}return a.next=8,Object(La.g)(C.notConnected());case 8:return t=Date.now(),n=ia()(),a.next=12,Object(La.g)(C.error("error connecting to cluster: ".concat(e.msg),t,n));case 12:a.next=16;break;case 14:return a.next=16,Object(La.g)(C.notConnected());case 16:case"end":return a.stop()}}),Dr)}function Lr(){var e;return Yt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,Object(La.i)(Ba.OPEN);case 3:return t.next=5,Object(La.c)(jr);case 5:return e=t.sent,t.next=8,Object(La.c)(kr,e);case 8:t.next=0;break;case 10:case"end":return t.stop()}}),wr)}function Mr(){return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(La.j)(a.CONNECT,_r);case 2:return e.next=4,Object(La.b)([Lr()]);case 4:case"end":return e.stop()}}),Ir)}!function(e){e.CREATE="ANALYSIS_CREATE",e.CREATED="ANALYSIS_CREATED",e.UPDATED="ANALYSIS_UPDATED",e.REMOVE="ANALYSIS_REMOVE",e.REMOVED="ANALYSIS_REMOVED",e.ERROR="ANALYSIS_ERROR"}(Rr||(Rr={}));var Nr,Fr=function(e,t,n){return j(Rr.CREATED,{analysis:e,compoundAnalysis:t,analysisIndex:n})},Pr=function(e,t){return j(Rr.UPDATED,{id:e,details:t})},Hr=function(e){return j(Rr.REMOVED,{id:e})};!function(e){e.CREATE="JOB_CREATE"}(Nr||(Nr={}));var Wr=function(e,t,n){return j(Nr.CREATE,{id:e,analysis:t,timestamp:n})};function Ur(e,t){return Br.apply(this,arguments)}function Br(){return(Br=Object(Kt.a)(Yt.a.mark((function e(t,n){var a;return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={job:{analysis:n}},e.next=3,Qt("jobs/".concat(t,"/"),a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Gr(e){return Yr.apply(this,arguments)}function Yr(){return(Yr=Object(Kt.a)(Yt.a.mark((function e(t){return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Vt("jobs/".concat(t,"/"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Kr(e,t,n,a){return zr.apply(this,arguments)}function zr(){return(zr=Object(Kt.a)(Yt.a.mark((function e(t,n,a,r){var c;return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c={dataset:a,details:r},e.next=3,Qt("compoundAnalyses/".concat(t,"/analyses/").concat(n,"/"),c);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Vr(e,t){return Jr.apply(this,arguments)}function Jr(){return(Jr=Object(Kt.a)(Yt.a.mark((function e(t,n){return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Vt("compoundAnalyses/".concat(t,"/analyses/").concat(n,"/"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Qr(e,t,n){return qr.apply(this,arguments)}function qr(){return(qr=Object(Kt.a)(Yt.a.mark((function e(t,n,a){var r;return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={dataset:n,details:a},e.next=3,Qt("compoundAnalyses/".concat(t,"/"),r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Zr(e){return Xr.apply(this,arguments)}function Xr(){return(Xr=Object(Kt.a)(Yt.a.mark((function e(t){return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Vt("compoundAnalyses/".concat(t,"/"));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var $r,ec=Yt.a.mark(mc),tc=Yt.a.mark(pc),nc=Yt.a.mark(Ec),ac=Yt.a.mark(fc),rc=Yt.a.mark(hc),cc=Yt.a.mark(bc),ic=Yt.a.mark(yc),sc=Yt.a.mark(gc);function oc(e,t){return e.datasets.byId[t]}function lc(e,t){return e.compoundAnalyses.byId[t]}function uc(e,t){return e.analyses.byId[t]}function dc(e,t){return e.jobs.byId[t]}function mc(e,t){return Yt.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=3,Object(La.i)(xt.REMOVE);case 3:if(n.sent.payload.id!==e.compoundAnalysis){n.next=7;break}return n.next=7,Object(La.d)(t);case 7:n.next=0;break;case 9:case"end":return n.stop()}}),ec)}function pc(e){var t,n,a,r;return Yt.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,Object(La.h)(oc,e.payload.dataset);case 3:if(c.sent.status===F.OPEN){c.next=6;break}throw new Error("invalid dataset status");case 6:return t={compoundAnalysis:ia()(),dataset:e.payload.dataset,details:{mainType:e.payload.analysisType,analyses:[]}},c.next=9,Object(La.c)(Qr,t.compoundAnalysis,t.dataset,t.details);case 9:return c.next=11,Object(La.f)(hc,t.compoundAnalysis,{doAutoStart:!0});case 11:return n=c.sent,c.next=14,Object(La.g)(Tt(t,!0));case 14:return c.next=16,Object(La.f)(mc,t,n);case 16:c.next=24;break;case 18:return c.prev=18,c.t0=c.catch(0),a=Date.now(),r=ia()(),c.next=24,Object(La.g)(Lt("Error creating analysis: ".concat(c.t0.toString()),a,r));case 24:case"end":return c.stop()}}),tc,null,[[0,18]])}function Ec(e){var t,n,a,r,c,i,s,o;return Yt.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:t=!0,n=!1,a=void 0,l.prev=3,r=e.payload.compoundAnalyses[Symbol.iterator]();case 5:if(t=(c=r.next()).done){l.next=18;break}return i=c.value,l.next=9,Object(La.h)(lc,i.compoundAnalysis);case 9:return s=l.sent,l.next=12,Object(La.f)(hc,s.compoundAnalysis,{doAutoStart:!1});case 12:return o=l.sent,l.next=15,Object(La.f)(mc,s,o);case 15:t=!0,l.next=5;break;case 18:l.next=24;break;case 20:l.prev=20,l.t0=l.catch(3),n=!0,a=l.t0;case 24:l.prev=24,l.prev=25,t||null==r.return||r.return();case 27:if(l.prev=27,!n){l.next=30;break}throw a;case 30:return l.finish(27);case 31:return l.finish(24);case 32:case"end":return l.stop()}}),nc,null,[[3,20,24,32],[25,,27,31]])}function fc(e,t,n,a){var r,c,i,s,o,l,u,d,m,p,E;return Yt.a.wrap((function(f){for(;;)switch(f.prev=f.next){case 0:if(!t){f.next=42;break}return f.next=3,Object(La.c)(Kr,e.compoundAnalysis,t,e.dataset,a);case 3:return f.next=5,Object(La.g)(Pr(t,a));case 5:return f.next=7,Object(La.h)(uc,t);case 7:r=f.sent,c=r.jobs?r.jobs:[],i=!0,s=!1,o=void 0,f.prev=12,l=c[Symbol.iterator]();case 14:if(i=(u=l.next()).done){f.next=25;break}return d=u.value,f.next=18,Object(La.h)(dc,d);case 18:if(!(m=f.sent)||"DONE"===m.running){f.next=22;break}return f.next=22,Object(La.c)(Gr,d);case 22:i=!0,f.next=14;break;case 25:f.next=31;break;case 27:f.prev=27,f.t0=f.catch(12),s=!0,o=f.t0;case 31:f.prev=31,f.prev=32,i||null==l.return||l.return();case 34:if(f.prev=34,!s){f.next=37;break}throw o;case 37:return f.finish(34);case 38:return f.finish(31);case 39:return f.abrupt("return",t);case 42:return p=ia()(),f.next=45,Object(La.c)(Kr,e.compoundAnalysis,p,e.dataset,a);case 45:return f.next=47,Object(La.g)(Fr({id:p,dataset:e.dataset,details:a,jobs:[]},e.compoundAnalysis,n));case 47:return f.next=49,Object(La.h)(lc,e.compoundAnalysis);case 49:return E=f.sent,f.next=52,Object(La.c)(Qr,E.compoundAnalysis,E.dataset,E.details);case 52:return f.abrupt("return",p);case 53:case"end":return f.stop()}}),ac,null,[[12,27,31,39],[32,,34,38]])}function hc(e,t){var n,a,r,c,i,s,o,u,d,m,p;return Yt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(La.a)(xt.RUN,l.b.sliding(2));case 2:n=t.sent;case 3:return t.prev=4,t.next=7,Object(La.i)(n);case 7:if((a=t.sent).payload.id===e){t.next=10;break}return t.abrupt("continue",3);case 10:return t.next=12,Object(La.h)(lc,e);case 12:return r=t.sent,c=a.payload,i=c.analysisIndex,s=c.details,o=r.details.analyses[i],t.next=17,Object(La.c)(fc,r,o,i,s);case 17:return u=t.sent,d=ia()(),t.next=21,Object(La.g)(Wr(d,u,Date.now()));case 21:return t.next=23,Object(La.c)(Ur,d,u);case 23:return t.next=25,Object(La.g)(It(r.compoundAnalysis,d,i));case 25:t.next=33;break;case 27:return t.prev=27,t.t0=t.catch(4),m=Date.now(),p=ia()(),t.next=33,Object(La.g)(Lt("Error running analysis: ".concat(t.t0.toString()),m,p));case 33:t.next=3;break;case 35:case"end":return t.stop()}}),rc,null,[[4,27]])}function bc(e){var t,n,a,r,c,i,s;return Yt.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:t=!0,n=!1,a=void 0,o.prev=3,r=e.jobs[Symbol.iterator]();case 5:if(t=(c=r.next()).done){o.next=16;break}return i=c.value,o.next=9,Object(La.h)(dc,i);case 9:if(!(s=o.sent)||"DONE"===s.running){o.next=13;break}return o.next=13,Object(La.c)(Gr,i);case 13:t=!0,o.next=5;break;case 16:o.next=22;break;case 18:o.prev=18,o.t0=o.catch(3),n=!0,a=o.t0;case 22:o.prev=22,o.prev=23,t||null==r.return||r.return();case 25:if(o.prev=25,!n){o.next=28;break}throw a;case 28:return o.finish(25);case 29:return o.finish(22);case 30:case"end":return o.stop()}}),cc,null,[[3,18,22,30],[23,,25,29]])}function yc(e){var t,n,a,r,c,i,s,o;return Yt.a.wrap((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,Object(La.h)(lc,e.payload.id);case 2:t=l.sent,l.prev=3,n=!0,a=!1,r=void 0,l.prev=7,c=t.details.analyses[Symbol.iterator]();case 9:if(n=(i=c.next()).done){l.next=23;break}return s=i.value,l.next=13,Object(La.h)(uc,s);case 13:return o=l.sent,l.next=16,Object(La.c)(bc,o);case 16:return l.next=18,Object(La.c)(Vr,t.compoundAnalysis,s);case 18:return l.next=20,Object(La.g)(Hr(s));case 20:n=!0,l.next=9;break;case 23:l.next=29;break;case 25:l.prev=25,l.t0=l.catch(7),a=!0,r=l.t0;case 29:l.prev=29,l.prev=30,n||null==c.return||c.return();case 32:if(l.prev=32,!a){l.next=35;break}throw r;case 35:return l.finish(32);case 36:return l.finish(29);case 37:return l.next=39,Object(La.c)(Zr,e.payload.id);case 39:return l.prev=39,l.next=42,Object(La.g)(kt(e.payload.id));case 42:return l.finish(39);case 43:case"end":return l.stop()}}),ic,null,[[3,,39,43],[7,25,29,37],[30,,32,36]])}function gc(){return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(La.j)(xt.CREATE,pc);case 2:return e.next=4,Object(La.j)(xt.REMOVE,yc);case 4:return e.next=6,Object(La.j)(Ba.INITIAL_STATE,Ec);case 6:case"end":return e.stop()}}),sc)}!function(e){e.FETCHED="CONFIG_FETCHED",e.FETCH="CONFIG_FETCH",e.FETCH_FAILED="CONFIG_FETCH_FAILED"}($r||($r={}));var Oc=function(){return j($r.FETCH)},vc=function(e){return j($r.FETCHED,{config:e})},xc=function(e,t,n){return j($r.FETCH_FAILED,{msg:e,timestamp:t,id:n})};function Ac(){return Sc.apply(this,arguments)}function Sc(){return(Sc=Object(Kt.a)(Yt.a.mark((function e(){var t,n;return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=zt(),e.next=3,fetch("".concat(t,"config/"),{method:"GET",credentials:"same-origin"});case 3:return n=e.sent,e.next=6,n.json();case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var jc=Yt.a.mark(wc),Cc=Yt.a.mark(Ic),Rc=Yt.a.mark(_c),Tc=Yt.a.mark(kc),Dc=Yt.a.mark(Lc);function wc(){return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(La.j)(Ba.OPEN,Ic);case 2:case"end":return e.stop()}}),jc)}function Ic(){var e,t,n;return Yt.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(La.g)(Oc());case 2:return a.next=4,Object(La.c)(Ac);case 4:return e=a.sent,a.prev=5,t=Na(e.config),a.next=9,Object(La.g)(vc(t));case 9:a.next=17;break;case 11:a.prev=11,a.t0=a.catch(5);try{window.localStorage.removeItem("LiberTEM.config")}catch(r){}return n=Object.assign({},e.config,Pa(e.config)),a.next=17,Object(La.g)(vc(n));case 17:case"end":return a.stop()}}),Cc,null,[[5,11]])}function _c(){return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,Object(La.i)([W.CREATE,ce.DIRECTORY_LISTING,a.CONNECTED]);case 3:return e.next=5,Object(La.h)((function(e){return e.config}));case 5:Fa(e.sent),e.next=0;break;case 9:case"end":return e.stop()}}),Rc)}function kc(){var e,t;return Yt.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,Object(La.c)(Ic);case 3:n.next=11;break;case 5:return n.prev=5,n.t0=n.catch(0),e=Date.now(),t=ia()(),n.next=11,Object(La.g)(xc("failed to fetch config: ".concat(n.t0.toString()),e,t));case 11:case"end":return n.stop()}}),Tc,null,[[0,5]])}function Lc(){return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(La.f)(kc);case 2:return e.next=4,Object(La.f)(wc);case 4:return e.next=6,Object(La.f)(_c);case 6:case"end":return e.stop()}}),Dc)}var Mc=Yt.a.mark(Bc),Nc=Yt.a.mark(Gc),Fc=Yt.a.mark(Yc),Pc=Yt.a.mark(Kc),Hc=Yt.a.mark(zc),Wc=Yt.a.mark(Vc),Uc=Yt.a.mark(Jc);function Bc(e){var t,n,a,r,c;return Yt.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,Object(La.c)(Ln,e.payload.dataset.id,{dataset:e.payload.dataset});case 3:if("ok"!==(t=i.sent).status){i.next=9;break}return i.next=7,Object(La.g)(ie.created(t.details));case 7:i.next=14;break;case 9:if("error"!==t.status){i.next=14;break}return n=Date.now(),a=ia()(),i.next=14,Object(La.g)(ie.error(t.dataset,t.msg,n,a));case 14:i.next=22;break;case 16:return i.prev=16,i.t0=i.catch(0),r=Date.now(),c=ia()(),i.next=22,Object(La.g)(ie.error(e.payload.dataset.id,"Error loading dataset: ".concat(i.t0.toString()),r,c));case 22:case"end":return i.stop()}}),Mc,null,[[0,16]])}function Gc(e){var t,n;return Yt.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,Object(La.c)(Nn,e.payload.dataset);case 3:a.next=11;break;case 5:return a.prev=5,a.t0=a.catch(0),t=Date.now(),n=ia()(),a.next=11,Object(La.g)(ie.error(e.payload.dataset,"Error closing dataset: ".concat(a.t0.toString()),t,n));case 11:case"end":return a.stop()}}),Nc,null,[[0,5]])}function Yc(e){var t,n,a,r,c;return Yt.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(La.g)(ie.detect(e));case 2:return i.next=4,Object(La.c)(Pn,e);case 4:if(t=i.sent,a=!0,"ok"!==t.status){i.next=22;break}if(!Jn(t.datasetParams.type)){i.next=13;break}return n=t.datasetParams,i.next=11,Object(La.g)(ie.detected(e,t.datasetParams));case 11:i.next=20;break;case 13:return r=Date.now(),c=ia()(),i.next=17,Object(La.g)(ie.detectFailed(e));case 17:return a=!1,i.next=20,Object(La.g)(ie.error(c,t.datasetParams.type+" dataset type is currently not supported in the GUI",r,c));case 20:i.next=24;break;case 22:return i.next=24,Object(La.g)(ie.detectFailed(e));case 24:return i.abrupt("return",[n,a]);case 25:case"end":return i.stop()}}),Fc)}function Kc(e){var t,n,a,r,c;return Yt.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Object(La.h)((function(e){return e.config}));case 2:return t=i.sent,n=t.lastOpened[e],r=!0,i.prev=5,i.next=8,Object(La.c)(Yc,e);case 8:c=i.sent,a=c[0],r=c[1],i.next=17;break;case 13:return i.prev=13,i.t0=i.catch(5),i.next=17,Object(La.g)(ie.detectFailed(e));case 17:if(!r){i.next=20;break}return i.next=20,Object(La.g)(ie.open(e,n,a));case 20:case"end":return i.stop()}}),Pc,null,[[5,13]])}function zc(e){var t;return Yt.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.payload.path,n.next=3,Object(La.c)(Kc,t);case 3:case"end":return n.stop()}}),Hc)}function Vc(e){var t,n;return Yt.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(La.h)((function(e){return e.config}));case 2:return t=a.sent,n=Ma(t,e.payload.path,e.payload.name),a.next=6,Object(La.c)(Kc,n);case 6:case"end":return a.stop()}}),Wc)}function Jc(){return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(La.j)(W.CREATE,Bc);case 2:return e.next=4,Object(La.j)(W.DELETE,Gc);case 4:return e.next=6,Object(La.j)(ce.SELECT,Vc);case 6:return e.next=8,Object(La.j)(ce.SELECT_FULL_PATH,zc);case 8:case"end":return e.stop()}}),Uc)}var Qc=Yt.a.mark(qc);function qc(){return Yt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(La.b)([Lc(),yr(),gc(),Jc(),Mr(),Va()]);case 2:case"end":return e.stop()}}),Qc)}var Zc={byId:{},ids:[]};var Xc,$c={isOpen:!1,isLoading:!0,path:"/",drives:[],places:{},files:[],dirs:[]};!function(e){e.CONNECTING="connecting",e.CONNECTED="connected",e.READY="ready",e.WAITING="waiting"}(Xc||(Xc={}));var ei={status:Xc.WAITING};var ti={status:"unknown"};var ni={byId:{},ids:[]};var ai={version:"",revision:"",localCores:0,cwd:"/",separator:"/",lastOpened:{},resultFileFormats:{},fileHistory:[],haveConfig:!1,lastConnection:{type:k.LOCAL,address:"tcp://localhost:8786"}};var ri={byId:{},ids:[]};var ci={busy:!1,busyPath:"",formVisible:!1,formPath:"/",formCachedParams:void 0,formDetectedParams:void 0};var ii={byId:{},ids:[]};var si={byId:{},ids:[]};var oi=Object(o.c)({compoundAnalyses:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ni,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case xt.CREATED:var n=Object(U.a)({doAutoStart:t.payload.autoStart},t.payload.compoundAnalysis);return Sn(e,t.payload.compoundAnalysis.compoundAnalysis,n);case xt.REMOVED:return Cn(e,(function(e){return e.compoundAnalysis!==t.payload.id}));case xt.ENABLE_AUTOSTART:return An(e,t.payload.compoundAnalysisId,{doAutoStart:!0});case W.DELETE:return Cn(e,(function(e){return e.dataset!==t.payload.dataset}));case Rr.CREATED:var a=e.byId[t.payload.compoundAnalysis],r=Object(Ue.a)(a.details.analyses);return r[t.payload.analysisIndex]=t.payload.analysis.id,An(e,t.payload.compoundAnalysis,{details:{analyses:r,mainType:a.details.mainType}});case Ba.INITIAL_STATE:var c=t.payload.compoundAnalyses.map((function(e){return Object(U.a)({doAutoStart:!1},e)}));return{byId:jn(c,(function(e){return e.compoundAnalysis})),ids:c.map((function(e){return e.compoundAnalysis}))}}return e},analyses:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zc,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Rr.CREATED:return Sn(e,t.payload.analysis.id,t.payload.analysis);case Rr.REMOVED:return Cn(e,(function(e){return e.id!==t.payload.id}));case Rr.UPDATED:return An(e,t.payload.id,{details:t.payload.details});case Nr.CREATE:var n=e.byId[t.payload.analysis],a=n.jobs?n.jobs:[];return An(e,t.payload.analysis,{jobs:[t.payload.id].concat(Object(Ue.a)(a))});case Ba.INITIAL_STATE:var r=t.payload.analyses.map((function(e){return{doAutoStart:!1,id:e.analysis,dataset:e.dataset,details:e.details,jobs:e.jobs}}));return{byId:jn(r,(function(e){return e.id})),ids:t.payload.analyses.map((function(e){return e.analysis}))};case Ba.FINISH_JOB:case Ba.TASK_RESULT:var c=e.ids.find((function(n){var a=e.byId[n];return(a.jobs?a.jobs:[]).some((function(e){return e===t.payload.job}))}));return c?An(e,c,{displayedJob:t.payload.job}):e}return e},channelStatus:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ei,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ba.OPEN:return{status:Xc.CONNECTED};case Ba.INITIAL_STATE:return{status:Xc.READY};case Ba.CLOSE:return{status:Xc.WAITING}}return e},clusterConnection:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ti,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.NOT_CONNECTED:return{status:"disconnected"};case a.CONNECTED:return{status:"connected",params:t.payload.params};case a.CONNECTING:return{status:"connecting"}}return e},datasets:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ri,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ba.INITIAL_STATE:var n=t.payload.datasets.map((function(e){return Object.assign({},e,{status:F.OPEN})}));return{byId:jn(n,(function(e){return e.id})),ids:n.map((function(e){return e.id}))};case W.CREATE:var a=Object(U.a)({},t.payload.dataset,{status:F.OPENING});return Sn(e,t.payload.dataset.id,a);case W.CREATED:var r=Object.assign({},t.payload.dataset,{status:F.OPEN});return e.byId[t.payload.dataset.id]?An(e,t.payload.dataset.id,r):Sn(e,t.payload.dataset.id,r);case W.ERROR:return Cn(e,(function(e){return e.id!==t.payload.dataset}));case W.DELETE:return An(e,t.payload.dataset,{status:F.DELETING});case W.DELETED:return Cn(e,(function(e){return e.id!==t.payload.dataset}))}return e},openDataset:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ci,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case W.OPEN:return Object(U.a)({},e,{formVisible:!0,formPath:t.payload.path,formCachedParams:t.payload.cachedParams,formDetectedParams:t.payload.detectedParams});case W.CANCEL_OPEN:case W.CREATE:return Object(U.a)({},e,{formVisible:!1});case W.DETECT:return Object(U.a)({},e,{busyPath:t.payload.path,busy:!0});case W.DETECTED:case W.DETECT_FAILED:return Object(U.a)({},e,{busyPath:"",busy:!1})}return e},jobs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:si,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Nr.CREATE:var n=Sn(e,t.payload.id,{id:t.payload.id,analysis:t.payload.analysis,running:Me.CREATING,status:Ne.CREATING,results:[],startTimestamp:t.payload.timestamp});return n;case Ba.JOB_STARTED:return An(e,t.payload.job,{running:Me.RUNNING,status:Ne.IN_PROGRESS,startTimestamp:t.payload.timestamp});case Ba.TASK_RESULT:return An(e,t.payload.job,{results:t.payload.results});case Ba.FINISH_JOB:var a=t.payload,r=a.job,c=a.timestamp,i=a.results;return An(e,r,{running:Me.DONE,status:Ne.SUCCESS,results:i,endTimestamp:c});case Ba.JOB_ERROR:var s=t.payload,o=s.job,l=s.timestamp;return An(e,o,{running:Me.DONE,status:Ne.ERROR,endTimestamp:l});case Ba.INITIAL_STATE:var u=t.payload.jobs,d=u.map((function(e){return{id:e.id,analysis:e.analysis,status:Ne.SUCCESS,startTimestamp:0,results:[],running:Me.DONE,endTimestamp:0}}));return{byId:jn(d,(function(e){return e.id})),ids:d.map((function(e){return e.id}))}}return e},errors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ii,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ce.ERROR:case W.ERROR:case Ba.ERROR:case a.ERROR:case xt.ERROR:case Ba.JOB_ERROR:return Sn(e,t.payload.id,{id:t.payload.id,msg:t.payload.msg,timestamp:t.payload.timestamp});case Ba.OPEN:return ii;case Zn.DISMISS:return Cn(e,(function(e){return e.id!==t.payload.id}));case Zn.DISMISS_ALL:return ii}return e},config:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ai,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case $r.FETCHED:return Object.assign({},t.payload.config,{haveConfig:!0});case ce.DIRECTORY_LISTING:return Object.assign({},e,{cwd:t.payload.path});case W.CREATE:var n=Object.assign({},e.lastOpened,Object(L.a)({},t.payload.dataset.params.path,t.payload.dataset.params)),r=Ha([t.payload.dataset.params.path].concat(Object(Ue.a)(e.fileHistory))).slice(0,11);return Object.assign({},e,{lastOpened:n,fileHistory:r});case a.CONNECT:if(t.payload.params.type===k.LOCAL){var c=Object.assign({},e.lastConnection,{type:k.LOCAL});return Object.assign({},e,{lastConnection:c})}return Object.assign({},e,{lastConnection:t.payload.params})}return e},browser:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$c,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case $r.FETCHED:return Object.assign({},e,{path:t.payload.config.cwd});case ce.OPEN:return Object.assign({},e,{isOpen:!0});case ce.CANCEL:return Object.assign({},e,{isOpen:!1});case ce.LIST_DIRECTORY:return Object.assign({},e,{isLoading:!0});case ce.DIRECTORY_LISTING:var n=t.payload.places.reduce((function(e,t){return Object.assign({},e,Object(L.a)({},t.key,t))}),{});return Object.assign({},e,{isLoading:!1,path:t.payload.path,files:t.payload.files,dirs:t.payload.dirs,drives:t.payload.drives,places:n});case ce.SELECT_FULL_PATH:case ce.SELECT:return Object.assign({},e,{isLoading:!1,isOpen:!1})}return e}}),li=Object(l.c)(),ui=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||o.d,di=Object(o.e)(oi,ui(Object(o.a)(li)));i.render(r.createElement(s.a,{store:di},r.createElement(Ia,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("./static",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("./static","/service-worker.js");_a?(!function(e){fetch(e).then((function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):ka(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):ka(e)}))}}(),li.run(qc)}},[[397,1,2]]]);
//# sourceMappingURL=main.f7da0f21.chunk.js.map